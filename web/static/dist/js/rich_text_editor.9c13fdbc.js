(function(t){function e(e){for(var r,u,a=e[0],c=e[1],s=e[2],f=0,d=[];f<a.length;f++)u=a[f],Object.prototype.hasOwnProperty.call(o,u)&&o[u]&&d.push(o[u][0]),o[u]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(d.length)d.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,a=1;a<n.length;a++){var c=n[a];0!==o[c]&&(r=!1)}r&&(i.splice(e--,1),t=u(u.s=n[0]))}return t}var r={},o={rich_text_editor:0},i=[];function u(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=t,u.c=r,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/static/dist/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var s=0;s<a.length;s++)e(a[s]);var l=c;i.push([1,"chunk-common"]),n()})({"030f":function(t,e,n){(function(t){(function(e){"use strict";var n=function(){},r=function(t){return function(){return t()}},o=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},i=function(t){return function(){return t}},u=function(t){return t};function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}var c=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},s=function(t){return function(){throw new Error(t)}},l=i(!1),f=i(!0),d=tinymce.util.Tools.resolve("tinymce.ThemeManager"),m=function(){return m=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},m.apply(this,arguments)};function g(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n}function p(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],u=0,a=i.length;u<a;u++,o++)r[o]=i[u];return r}var h,v=function(){return b},b=function(){var t=function(t){return t.isNone()},e=function(t){return t()},r=function(t){return t},o={fold:function(t,e){return t()},is:l,isSome:l,isNone:f,getOr:r,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:i(null),getOrUndefined:i(void 0),or:r,orThunk:e,map:v,each:n,bind:v,exists:l,forall:f,filter:v,equals:t,equals_:t,toArray:function(){return[]},toString:i("none()")};return Object.freeze&&Object.freeze(o),o}(),y=function(t){var e=i(t),n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:f,isNone:l,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return y(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?o:b},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(l,(function(e){return n(t,e)}))}};return o},w=function(t){return null===t||void 0===t?b:y(t)},x={some:y,none:v,from:w},C=function(t){var e=function(e){return t===e},n=function(e){return C(t)},r=function(e){return C(t)},o=function(e){return C(e(t))},u=function(e){return C(t)},a=function(e){e(t)},c=function(e){return e(t)},s=function(e,n){return n(t)},d=function(e){return e(t)},m=function(e){return e(t)},g=function(){return x.some(t)};return{is:e,isValue:f,isError:l,getOr:i(t),getOrThunk:i(t),getOrDie:i(t),or:n,orThunk:r,fold:s,map:o,mapError:u,each:a,bind:c,exists:d,forall:m,toOption:g}},S=function(t){var e=function(t){return t()},r=function(){return s(String(t))()},o=function(t){return t},i=function(t){return t()},a=function(e){return S(t)},c=function(e){return S(e(t))},d=function(e){return S(t)},m=function(e,n){return e(t)};return{is:l,isValue:l,isError:f,getOr:u,getOrThunk:e,getOrDie:r,or:o,orThunk:i,fold:m,map:a,mapError:c,each:n,bind:d,exists:l,forall:f,toOption:x.none}},k=function(t,e){return t.fold((function(){return S(e)}),C)},O={value:C,error:S,fromOption:k},T=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},E=function(t){return function(e){return T(e)===t}},D=E("string"),A=E("object"),_=E("array"),R=E("boolean"),B=E("function"),I=E("number"),N=function(t,e){if(_(t)){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n]))return!1;return!0}return!1},P=Array.prototype.slice,M=Array.prototype.indexOf,F=Array.prototype.push,L=function(t,e){return M.call(t,e)},H=function(t,e){var n=L(t,e);return-1===n?x.none():x.some(n)},z=function(t,e){return L(t,e)>-1},j=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return!0}return!1},V=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},U=function(t,e){for(var n=[],r=0;r<t.length;r+=e){var o=P.call(t,r,r+e);n.push(o)}return n},W=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r},G=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},q=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t[n];e(r,n)}},X=function(t,e){for(var n=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o],a=e(u,o)?n:r;a.push(u)}return{pass:n,fail:r}},$=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n},Y=function(t,e,n){return q(t,(function(t){n=e(n,t)})),n},K=function(t,e,n){return G(t,(function(t){n=e(n,t)})),n},J=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return x.some(o)}return x.none()},Q=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return x.some(n)}return x.none()},Z=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!_(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);F.apply(e,t[n])}return e},tt=function(t,e){var n=W(t,e);return Z(n)},et=function(t,e){for(var n=0,r=t.length;n<r;++n){var o=t[n];if(!0!==e(o,n))return!1}return!0},nt=function(t){var e=P.call(t,0);return e.reverse(),e},rt=function(t,e){return $(t,(function(t){return!z(e,t)}))},ot=function(t){return[t]},it=function(t,e){var n=P.call(t,0);return n.sort(e),n},ut=function(t){return 0===t.length?x.none():x.some(t[0])},at=function(t){return 0===t.length?x.none():x.some(t[t.length-1])},ct=B(Array.from)?Array.from:function(t){return P.call(t)},st=Object.keys,lt=Object.hasOwnProperty,ft=function(t,e){for(var n=st(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];e(u,i)}},dt=function(t,e){return mt(t,(function(t,n){return{k:n,v:e(t,n)}}))},mt=function(t,e){var n={};return ft(t,(function(t,r){var o=e(t,r);n[o.k]=o.v})),n},gt=function(t,e){var n=[];return ft(t,(function(t,r){n.push(e(t,r))})),n},pt=function(t,e){for(var n=st(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];if(e(u,i,t))return x.some(u)}return x.none()},ht=function(t){return gt(t,(function(t){return t}))},vt=function(t,e){return bt(t,e)?x.from(t[e]):x.none()},bt=function(t,e){return lt.call(t,e)},yt=function(t){if(!_(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],r={};return G(t,(function(o,i){var u=st(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==r[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!_(c))throw new Error("case arguments must be an array");n.push(a),r[a]=function(){var r=arguments.length;if(r!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];var s=function(t){var e=st(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));var r=et(n,(function(t){return z(e,t)}));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[a].apply(null,o)};return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);var e=arguments[i];return e.apply(null,o)},match:s,log:function(t){e.console.log(t,{constructors:n,constructor:a,params:o})}}}})),r},wt={generate:yt},xt=Object.prototype.hasOwnProperty,Ct=function(t,e){return e},St=function(t,e){var n=A(t)&&A(e);return n?Ot(t,e):e},kt=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)xt.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},Ot=kt(St),Tt=kt(Ct),Et=function(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}},Dt=wt.generate([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),At=function(t){return Dt.defaultedThunk(i(t))},_t=function(t){return Dt.mergeWithThunk(i(t))},Rt=Dt.strict,Bt=Dt.asOption,It=Dt.defaultedThunk,Nt=Dt.mergeWithThunk,Pt=function(t,e){var n={};return ft(t,(function(t,r){z(e,r)||(n[r]=t)})),n},Mt=function(t){return function(e){return bt(e,t)?x.from(e[t]):x.none()}},Ft=function(t,e){return function(n){return bt(n,t)?n[t]:e}},Lt=function(t,e){return Mt(e)(t)},Ht=function(t,e){return bt(t,e)&&void 0!==t[e]&&null!==t[e]},zt=function(t,e){var n={};return n[t]=e,n},jt=function(t){var e={};return G(t,(function(t){e[t.key]=t.value})),e},Vt=(wt.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(t){var e=[],n=[];return G(t,(function(t){t.fold((function(t){e.push(t)}),(function(t){n.push(t)}))})),{errors:e,values:n}}),Ut=function(t,e){return Pt(t,e)},Wt=function(t){return Mt(t)},Gt=function(t,e){return Ft(t,e)},qt=function(t,e){return Lt(t,e)},Xt=function(t,e){return zt(t,e)},$t=function(t){return jt(t)},Yt=function(t,e){return 0===t.length?O.value(e):O.value(Ot(e,Tt.apply(void 0,t)))},Kt=function(t){return O.error(Z(t))},Jt=function(t,e){var n=Vt(t);return n.errors.length>0?Kt(n.errors):Yt(n.values,e)},Qt=function(t,e){return Ht(t,e)};(function(t){t[t["Error"]=0]="Error",t[t["Value"]=1]="Value"})(h||(h={}));var Zt=function(t,e,n){return t.stype===h.Error?e(t.serror):n(t.svalue)},te=function(t){var e=[],n=[];return G(t,(function(t){Zt(t,(function(t){return n.push(t)}),(function(t){return e.push(t)}))})),{values:e,errors:n}},ee=function(t,e){return t.stype===h.Error?{stype:h.Error,serror:e(t.serror)}:t},ne=function(t,e){return t.stype===h.Value?{stype:h.Value,svalue:e(t.svalue)}:t},re=function(t,e){return t.stype===h.Value?e(t.svalue):t},oe=function(t,e){return t.stype===h.Error?e(t.serror):t},ie=function(t){return{stype:h.Value,svalue:t}},ue=function(t){return{stype:h.Error,serror:t}},ae=function(t){return Zt(t,O.error,O.value)},ce=function(t){return t.fold(ue,ie)},se={fromResult:ce,toResult:ae,svalue:ie,partition:te,serror:ue,bind:re,bindError:oe,map:ne,mapError:ee,fold:Zt},le=function(t,e){return t.length>0?se.svalue(Ot(e,Tt.apply(void 0,t))):se.svalue(e)},fe=function(t){return o(se.serror,Z)(t)},de=function(t,e){var n=se.partition(t);return n.errors.length>0?fe(n.errors):le(n.values,e)},me=function(t){var e=se.partition(t);return e.errors.length>0?fe(e.errors):se.svalue(e.values)},ge={consolidateObj:de,consolidateArr:me},pe=wt.generate([{setOf:["validator","valueType"]},{arrOf:["valueType"]},{objOf:["fields"]},{itemOf:["validator"]},{choiceOf:["key","branches"]},{thunk:["description"]},{func:["args","outputSchema"]}]),he=wt.generate([{field:["name","presence","type"]},{state:["name"]}]),ve=function(t){return A(t)&&st(t).length>100?" removed due to size":JSON.stringify(t,null,2)},be=function(t){var e=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t;return W(e,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))},ye=function(t,e){return se.serror([{path:t,getErrorInfo:e}])},we=function(t,e,n){return ye(t,(function(){return'Could not find valid *strict* value for "'+e+'" in '+ve(n)}))},xe=function(t,e){return ye(t,(function(){return'Choice schema did not contain choice key: "'+e+'"'}))},Ce=function(t,e,n){return ye(t,(function(){return'The chosen schema: "'+n+'" did not exist in branches: '+ve(e)}))},Se=function(t,e){return ye(t,(function(){return"There are unsupported fields: ["+e.join(", ")+"] specified"}))},ke=function(t,e){return ye(t,(function(){return e}))},Oe=wt.generate([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),Te=function(t,e,n){return Lt(e,n).fold((function(){return we(t,n,e)}),se.svalue)},Ee=function(t,e,n){var r=Lt(t,e).fold((function(){return n(t)}),u);return se.svalue(r)},De=function(t,e){return se.svalue(Lt(t,e))},Ae=function(t,e,n){var r=Lt(t,e).map((function(e){return!0===e?n(t):e}));return se.svalue(r)},_e=function(t,e,n,r){return n.fold((function(n,o,u,a){var c=function(e){var i=a.extract(t.concat([n]),r,e);return se.map(i,(function(t){return zt(o,r(t))}))},s=function(e){return e.fold((function(){var t=zt(o,r(x.none()));return se.svalue(t)}),(function(e){var i=a.extract(t.concat([n]),r,e);return se.map(i,(function(t){return zt(o,r(x.some(t)))}))}))};return function(){return u.fold((function(){return se.bind(Te(t,e,n),c)}),(function(t){return se.bind(Ee(e,n,t),c)}),(function(){return se.bind(De(e,n),s)}),(function(t){return se.bind(Ae(e,n,t),s)}),(function(t){var r=t(e),o=se.map(Ee(e,n,i({})),(function(t){return Ot(r,t)}));return se.bind(o,c)}))}()}),(function(t,n){var o=n(e);return se.svalue(zt(t,r(o)))}))},Re=function(t,e,n,r){var o=W(n,(function(n){return _e(t,e,n,r)}));return ge.consolidateObj(o,{})},Be=function(t){var e=function(e,n,r){return t().extract(e,n,r)},n=function(){return t().toString()},r=function(){return t().toDsl()};return{extract:e,toString:n,toDsl:r}},Ie=function(t){var e=function(e,n,r){return se.bindError(t(r,n),(function(t){return ke(e,t)}))},n=function(){return"val"},r=function(){return pe.itemOf(t)};return{extract:e,toString:n,toDsl:r}},Ne=function(t){var e=st(t);return $(e,(function(e){return Qt(t,e)}))},Pe=function(t){var e=Me(t),n=Y(t,(function(t,e){return e.fold((function(e){return Ot(t,Xt(e,!0))}),i(t))}),{}),r=function(t,r,o){var i=R(o)?[]:Ne(o),u=$(i,(function(t){return!Qt(n,t)}));return 0===u.length?e.extract(t,r,o):Se(t,u)};return{extract:r,toString:e.toString,toDsl:e.toDsl}},Me=function(t){var e=function(e,n,r){return Re(e,r,t,n)},n=function(){var e=W(t,(function(t){return t.fold((function(t,e,n,r){return t+" -> "+r.toString()}),(function(t,e){return"state("+t+")"}))}));return"obj{\n"+e.join("\n")+"}"},r=function(){return pe.objOf(W(t,(function(t){return t.fold((function(t,e,n,r){return he.field(t,n,r)}),(function(t,e){return he.state(t)}))})))};return{extract:e,toString:n,toDsl:r}},Fe=function(t){var e=function(e,n,r){var o=W(r,(function(r,o){return t.extract(e.concat(["["+o+"]"]),n,r)}));return ge.consolidateArr(o)},n=function(){return"array("+t.toString()+")"},r=function(){return pe.arrOf(t)};return{extract:e,toString:n,toDsl:r}},Le=function(t,e){var n=function(e,n){return Fe(Ie(t)).extract(e,u,n)},r=function(t,r,o){var i=st(o),u=n(t,i);return se.bind(u,(function(n){var i=W(n,(function(t){return Oe.field(t,t,Rt(),e)}));return Me(i).extract(t,r,o)}))},o=function(){return"setOf("+e.toString()+")"},i=function(){return pe.setOf(t,e)};return{extract:r,toString:o,toDsl:i}},He=i(Ie(se.svalue)),ze=o(Fe,Me),je=Oe.state,Ve=Oe.field,Ue=function(t,e,n,r,o){var i=qt(r,o);return i.fold((function(){return Ce(t,r,o)}),(function(r){return r.extract(t.concat(["branch: "+o]),e,n)}))},We=function(t,e){var n=function(n,r,o){var i=qt(o,t);return i.fold((function(){return xe(n,t)}),(function(t){return Ue(n,r,o,e,t)}))},r=function(){return"chooseOn("+t+"). Possible values: "+st(e)},o=function(){return pe.choiceOf(t,e)};return{extract:n,toString:r,toDsl:o}},Ge=Ie(se.svalue),qe=function(t){return ze(t)},Xe=function(){return Fe(Ge)},$e=Be,Ye=function(t){return Ie((function(e){return t(e).fold(se.serror,se.svalue)}))},Ke=function(t,e){return Le((function(e){return se.fromResult(t(e))}),e)},Je=function(t,e,n,r){var o=e.extract([t],n,r);return se.mapError(o,(function(t){return{input:r,errors:t}}))},Qe=function(t,e,n){return se.toResult(Je(t,e,u,n))},Ze=function(t){return t.fold((function(t){throw new Error(en(t))}),u)},tn=function(t,e,n){return Ze(Qe(t,e,n))},en=function(t){return"Errors: \n"+be(t.errors)+"\n\nInput object: "+ve(t.input)},nn=function(t,e){return We(t,e)},rn=function(t,e){return We(t,dt(e,Me))},on=i(Ge),un=function(t,e){return Ie((function(n){var r=typeof n;return t(n)?se.svalue(n):se.serror("Expected type: "+e+" but got: "+r)}))},an=un(I,"number"),cn=un(D,"string"),sn=un(R,"boolean"),ln=un(B,"function"),fn=function(t){var e=function(t,e){var n=t.next();while(!n.done){if(!e(n.value))return!1;n=t.next()}return!0};if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(e){return fn(t[e])}));case"Map":return e(t.keys(),fn)&&e(t.values(),fn);case"Set":return e(t.keys(),fn);default:return!1}},dn=Ie((function(t){return fn(t)?se.svalue(t):se.serror("Expected value to be acceptable for sending via postMessage")})),mn=function(t){return Ye((function(e){return z(t,e)?O.value(e):O.error('Unsupported value: "'+e+'", choose one of "'+t.join(", ")+'".')}))},gn=function(t){return Ve(t,t,Rt(),He())},pn=function(t,e){return Ve(t,t,Rt(),e)},hn=function(t){return pn(t,an)},vn=function(t){return pn(t,cn)},bn=function(t,e){return Ve(t,t,Rt(),mn(e))},yn=function(t){return pn(t,sn)},wn=function(t){return pn(t,ln)},xn=function(t,e){return Ve(t,t,Bt(),Ie((function(n){return se.serror("The field: "+t+" is forbidden. "+e)})))},Cn=function(t,e){return Ve(t,t,Rt(),Me(e))},Sn=function(t,e){return Ve(t,t,Rt(),ze(e))},kn=function(t,e){return Ve(t,t,Rt(),Fe(e))},On=function(t){return Ve(t,t,Bt(),He())},Tn=function(t,e){return Ve(t,t,Bt(),e)},En=function(t){return Tn(t,an)},Dn=function(t){return Tn(t,cn)},An=function(t){return Tn(t,ln)},_n=function(t,e){return Tn(t,Fe(e))},Rn=function(t,e){return Tn(t,Me(e))},Bn=function(t,e){return Tn(t,Pe(e))},In=function(t,e){return Ve(t,t,At(e),He())},Nn=function(t,e,n){return Ve(t,t,At(e),n)},Pn=function(t,e){return Nn(t,e,an)},Mn=function(t,e){return Nn(t,e,cn)},Fn=function(t,e,n){return Nn(t,e,mn(n))},Ln=function(t,e){return Nn(t,e,sn)},Hn=function(t,e){return Nn(t,e,ln)},zn=function(t,e){return Nn(t,e,dn)},jn=function(t,e,n){return Nn(t,e,Fe(n))},Vn=function(t,e,n){return Nn(t,e,Me(n))},Un=function(t,e){return je(t,e)},Wn=function(t){var e=t,n=function(){return e},r=function(t){e=t},o=function(){return Wn(n())};return{get:n,set:r,clone:o}},Gn=function(t,n){var r=n||e.document,o=r.createElement("div");if(o.innerHTML=t,!o.hasChildNodes()||o.childNodes.length>1)throw e.console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return $n(o.childNodes[0])},qn=function(t,n){var r=n||e.document,o=r.createElement(t);return $n(o)},Xn=function(t,n){var r=n||e.document,o=r.createTextNode(t);return $n(o)},$n=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:i(t)}},Yn=function(t,e,n){var r=t.dom();return x.from(r.elementFromPoint(e,n)).map($n)},Kn={fromHtml:Gn,fromTag:qn,fromText:Xn,fromDom:$n,fromPoint:Yn},Jn=function(t,e,n){return 0!==(t.compareDocumentPosition(e)&n)},Qn=function(t,n){return Jn(t,n,e.Node.DOCUMENT_POSITION_PRECEDING)},Zn=function(t,n){return Jn(t,n,e.Node.DOCUMENT_POSITION_CONTAINED_BY)},tr={documentPositionPreceding:Qn,documentPositionContainedBy:Zn},er=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}},nr=function(t,e){var n=er(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return ir(r(1),r(2))},rr=function(t,e){var n=String(e).toLowerCase();return 0===t.length?or():nr(t,n)},or=function(){return ir(0,0)},ir=function(t,e){return{major:t,minor:e}},ur={nu:ir,detect:rr,unknown:or},ar="Edge",cr="Chrome",sr="IE",lr="Opera",fr="Firefox",dr="Safari",mr=function(t,e){return function(){return e===t}},gr=function(){return pr({current:void 0,version:ur.unknown()})},pr=function(t){var e=t.current,n=t.version;return{current:e,version:n,isEdge:mr(ar,e),isChrome:mr(cr,e),isIE:mr(sr,e),isOpera:mr(lr,e),isFirefox:mr(fr,e),isSafari:mr(dr,e)}},hr={unknown:gr,nu:pr,edge:i(ar),chrome:i(cr),ie:i(sr),opera:i(lr),firefox:i(fr),safari:i(dr)},vr="Windows",br="iOS",yr="Android",wr="Linux",xr="OSX",Cr="Solaris",Sr="FreeBSD",kr=function(t,e){return function(){return e===t}},Or=function(){return Tr({current:void 0,version:ur.unknown()})},Tr=function(t){var e=t.current,n=t.version;return{current:e,version:n,isWindows:kr(vr,e),isiOS:kr(br,e),isAndroid:kr(yr,e),isOSX:kr(xr,e),isLinux:kr(wr,e),isSolaris:kr(Cr,e),isFreeBSD:kr(Sr,e)}},Er={unknown:Or,nu:Tr,windows:i(vr),ios:i(br),android:i(yr),linux:i(wr),osx:i(xr),solaris:i(Cr),freebsd:i(Sr)},Dr=function(t,e,n,r){var o=t.isiOS()&&!0===/ipad/i.test(n),u=t.isiOS()&&!o,a=t.isiOS()||t.isAndroid(),c=a||r("(pointer:coarse)"),s=o||!u&&a&&r("(min-device-width:768px)"),l=u||a&&!s,f=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n),d=!l&&!s&&!f;return{isiPad:i(o),isiPhone:i(u),isTablet:i(s),isPhone:i(l),isTouch:i(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:i(f),isDesktop:i(d)}},Ar=function(t,e){var n=String(e).toLowerCase();return J(t,(function(t){return t.search(n)}))},_r=function(t,e){return Ar(t,e).map((function(t){var n=ur.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Rr=function(t,e){return Ar(t,e).map((function(t){var n=ur.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Br={detectBrowser:_r,detectOs:Rr},Ir=function(t,e,n){if(""===e)return!0;if(t.length<e.length)return!1;var r=t.substr(n,n+e.length);return r===e},Nr=function(t,e){return-1!==t.indexOf(e)},Pr=function(t,e){return Ir(t,e,t.length-e.length)},Mr=function(t){return t.replace(/^\s+|\s+$/g,"")},Fr=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Lr=function(t){return function(e){return Nr(e,t)}},Hr=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Nr(t,"edge/")&&Nr(t,"chrome")&&Nr(t,"safari")&&Nr(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Fr],search:function(t){return Nr(t,"chrome")&&!Nr(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Nr(t,"msie")||Nr(t,"trident")}},{name:"Opera",versionRegexes:[Fr,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Lr("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Lr("firefox")},{name:"Safari",versionRegexes:[Fr,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Nr(t,"safari")||Nr(t,"mobile/"))&&Nr(t,"applewebkit")}}],zr=[{name:"Windows",search:Lr("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Nr(t,"iphone")||Nr(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Lr("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Lr("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Lr("linux"),versionRegexes:[]},{name:"Solaris",search:Lr("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Lr("freebsd"),versionRegexes:[]}],jr={browsers:i(Hr),oses:i(zr)},Vr=function(t,e){var n=jr.browsers(),r=jr.oses(),o=Br.detectBrowser(n,t).fold(hr.unknown,hr.nu),i=Br.detectOs(r,t).fold(Er.unknown,Er.nu),u=Dr(i,o,t,e);return{browser:o,os:i,deviceType:u}},Ur={detect:Vr},Wr=function(t){return e.window.matchMedia(t).matches},Gr=Wn(Ur.detect(e.navigator.userAgent,Wr)),qr=function(){return Gr.get()},Xr=(e.Node.ATTRIBUTE_NODE,e.Node.CDATA_SECTION_NODE,e.Node.COMMENT_NODE,e.Node.DOCUMENT_NODE),$r=(e.Node.DOCUMENT_TYPE_NODE,e.Node.DOCUMENT_FRAGMENT_NODE,e.Node.ELEMENT_NODE),Yr=e.Node.TEXT_NODE,Kr=(e.Node.PROCESSING_INSTRUCTION_NODE,e.Node.ENTITY_REFERENCE_NODE,e.Node.ENTITY_NODE,e.Node.NOTATION_NODE,$r),Jr=Xr,Qr=function(t,e){var n=t.dom();if(n.nodeType!==Kr)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Zr=function(t){return t.nodeType!==Kr&&t.nodeType!==Jr||0===t.childElementCount},to=function(t,n){var r=void 0===n?e.document:n.dom();return Zr(r)?[]:W(r.querySelectorAll(t),Kn.fromDom)},eo=function(t,n){var r=void 0===n?e.document:n.dom();return Zr(r)?x.none():x.from(r.querySelector(t)).map(Kn.fromDom)},no=function(t,e){return t.dom()===e.dom()},ro=function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},oo=function(t,e){return tr.documentPositionContainedBy(t.dom(),e.dom())},io=qr().browser,uo=io.isIE()?oo:ro,ao=function(t,e){return no(t.element(),e.event().target())},co=function(t){if(!Qt(t,"can")&&!Qt(t,"abort")&&!Qt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return tn("Extracting event.handler",Pe([In("can",i(!0)),In("abort",i(!1)),In("run",n)]),t)},so=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return K(t,(function(t,r){return t&&e(r).apply(void 0,n)}),!0)}},lo=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return K(t,(function(t,r){return t||e(r).apply(void 0,n)}),!1)}},fo=function(t){return B(t)?{can:i(!0),abort:i(!1),run:t}:t},mo=function(t){var e=so(t,(function(t){return t.can})),n=lo(t,(function(t){return t.abort})),r=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];G(t,(function(t){t.run.apply(void 0,e)}))};return co({can:e,abort:n,run:r})},go=i("touchstart"),po=i("touchmove"),ho=i("touchend"),vo=i("touchcancel"),bo=i("mousedown"),yo=i("mousemove"),wo=i("mouseout"),xo=i("mouseup"),Co=i("mouseover"),So=i("focusin"),ko=i("focusout"),Oo=i("keydown"),To=i("keyup"),Eo=i("input"),Do=i("change"),Ao=i("click"),_o=i("transitionend"),Ro=i("selectstart"),Bo={tap:i("alloy.tap")},Io=i("alloy.focus"),No=i("alloy.blur.post"),Po=i("alloy.paste.post"),Mo=i("alloy.receive"),Fo=i("alloy.execute"),Lo=i("alloy.focus.item"),Ho=Bo.tap,zo=function(){return qr().deviceType.isTouch()?Bo.tap():Ao()},jo=i("alloy.longpress"),Vo=i("alloy.sandbox.close"),Uo=i("alloy.typeahead.cancel"),Wo=i("alloy.system.init"),Go=i("alloy.system.touchmove"),qo=i("alloy.system.touchend"),Xo=i("alloy.system.scroll"),$o=i("alloy.system.resize"),Yo=i("alloy.system.attached"),Ko=i("alloy.system.detached"),Jo=i("alloy.system.dismissRequested"),Qo=i("alloy.system.repositionRequested"),Zo=i("alloy.focusmanager.shifted"),ti=i("alloy.slotcontainer.visibility"),ei=i("alloy.change.tab"),ni=i("alloy.dismiss.tab"),ri=i("alloy.highlight"),oi=i("alloy.dehighlight"),ii=function(t,e){si(t,t.element(),e,{})},ui=function(t,e,n){si(t,t.element(),e,n)},ai=function(t){ii(t,Fo())},ci=function(t,e,n){si(t,e,n,{})},si=function(t,e,n,r){var o=m({target:e},r);t.getSystem().triggerEvent(n,e,dt(o,i))},li=function(t,e,n,r){t.getSystem().triggerEvent(n,e,r.event())};function fi(t,e,n,r,o){return t(n,r)?x.some(n):B(o)&&o(n)?x.none():e(n,r,o)}"undefined"!==typeof e.window?e.window:Function("return this;")();var di=function(t){var e=t.dom().nodeName;return e.toLowerCase()},mi=function(t){return t.dom().nodeType},gi=function(t){return function(e){return mi(e)===t}},pi=gi($r),hi=gi(Yr),vi=function(t){var e=hi(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)},bi=Et((function(){return yi(Kn.fromDom(e.document))})),yi=function(t){var e=t.dom().body;if(null===e||void 0===e)throw new Error("Body is not available yet");return Kn.fromDom(e)},wi=function(t,e,n){var r=t.dom(),o=B(n)?n:i(!1);while(r.parentNode){r=r.parentNode;var u=Kn.fromDom(r);if(e(u))return x.some(u);if(o(u))break}return x.none()},xi=function(t,e,n){var r=function(t,e){return e(t)};return fi(r,wi,t,e,n)},Ci=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){var o=Kn.fromDom(t.childNodes[r]);if(e(o))return x.some(o);var i=n(t.childNodes[r]);if(i.isSome())return i}return x.none()};return n(t.dom())},Si=function(t,e,n){var r=xi(t,(function(t){return e(t).isSome()}),n);return r.bind(e)},ki=function(t){return $t(t)},Oi=function(t,e){return{key:t,value:co({abort:e})}},Ti=function(t,e){return{key:t,value:co({can:e})}},Ei=function(t){return{key:t,value:co({run:function(t,e){e.event().prevent()}})}},Di=function(t,e){return{key:t,value:co({run:e})}},Ai=function(t,e,n){return{key:t,value:co({run:function(t){e.apply(void 0,[t].concat(n))}})}},_i=function(t){return function(e){return Di(t,e)}},Ri=function(t){return function(e){return{key:t,value:co({run:function(t,n){ao(t,n)&&e(t,n)}})}}},Bi=function(t,e){return Di(t,(function(n,r){n.getSystem().getByUid(e).each((function(e){li(e,e.element(),t,r)}))}))},Ii=function(t,e,n){var r=e.partUids[n];return Bi(t,r)},Ni=function(t,e){return Di(t,(function(t,n){var r=n.event(),o=t.getSystem().getByDom(r.target()).fold((function(){var e=Si(r.target(),(function(e){return t.getSystem().getByDom(e).toOption()}),i(!1));return e.getOr(t)}),(function(t){return t}));e(t,o,n)}))},Pi=function(t){return Di(t,(function(t,e){e.cut()}))},Mi=function(t){return Di(t,(function(t,e){e.stop()}))},Fi=function(t,e){return Ri(t)(e)},Li=Ri(Yo()),Hi=Ri(Ko()),zi=Ri(Wo()),ji=_i(Fo()),Vi=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return G(t,(function(t,n){r[t]=i(e[n])})),r}},Ui=function(t){return t.slice(0).sort()},Wi=function(t,e){throw new Error("All required keys ("+Ui(t).join(", ")+") were not specified. Specified keys were: "+Ui(e).join(", ")+".")},Gi=function(t){throw new Error("Unsupported keys for object: "+Ui(t).join(", "))},qi=function(t,e){if(!_(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");G(e,(function(e){if(!D(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")}))},Xi=function(t){var e=Ui(t),n=J(e,(function(t,n){return n<e.length-1&&t===e[n+1]}));n.each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}))},$i=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return qi("required",t),qi("optional",e),Xi(n),function(r){var o=st(r),u=et(t,(function(t){return z(o,t)}));u||Wi(t,o);var a=$(o,(function(t){return!z(n,t)}));a.length>0&&Gi(a);var c={};return G(t,(function(t){c[t]=i(r[t])})),G(e,(function(t){c[t]=i(Object.prototype.hasOwnProperty.call(r,t)?x.some(r[t]):x.none())})),c}},Yi=function(t){return Kn.fromDom(t.dom().ownerDocument)},Ki=function(t){return Kn.fromDom(t.dom().ownerDocument.documentElement)},Ji=function(t){return Kn.fromDom(t.dom().ownerDocument.defaultView)},Qi=function(t){return x.from(t.dom().parentNode).map(Kn.fromDom)},Zi=function(t){return x.from(t.dom().offsetParent).map(Kn.fromDom)},tu=function(t){return x.from(t.dom().nextSibling).map(Kn.fromDom)},eu=function(t){return W(t.dom().childNodes,Kn.fromDom)},nu=function(t,e){var n=t.dom().childNodes;return x.from(n[e]).map(Kn.fromDom)},ru=function(t){return nu(t,0)},ou=(Vi("element","offset"),function(t,n){var r=n||e.document,o=r.createElement("div");return o.innerHTML=t,eu(Kn.fromDom(o))}),iu=function(t,e){var n=Qi(t);n.each((function(n){n.dom().insertBefore(e.dom(),t.dom())}))},uu=function(t,e){var n=tu(t);n.fold((function(){var n=Qi(t);n.each((function(t){cu(t,e)}))}),(function(t){iu(t,e)}))},au=function(t,e){var n=ru(t);n.fold((function(){cu(t,e)}),(function(n){t.dom().insertBefore(e.dom(),n.dom())}))},cu=function(t,e){t.dom().appendChild(e.dom())},su=function(t,e,n){nu(t,n).fold((function(){cu(t,e)}),(function(t){iu(t,e)}))},lu=function(t,e){G(e,(function(e){iu(t,e)}))},fu=function(t,e){G(e,(function(e){cu(t,e)}))},du=function(t){t.dom().textContent="",G(eu(t),(function(t){mu(t)}))},mu=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},gu=function(t){var e=eu(t);e.length>0&&lu(t,e),mu(t)},pu=function(t){return t.dom().innerHTML},hu=function(t,e){var n=Yi(t),r=n.dom(),o=Kn.fromDom(r.createDocumentFragment()),i=ou(e,r);fu(o,i),du(t),cu(t,o)},vu=function(t){var e=Kn.fromTag("div"),n=Kn.fromDom(t.dom().cloneNode(!0));return cu(e,n),pu(e)},bu=function(t,n,r){if(!(D(r)||R(r)||I(r)))throw e.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,r+"")},yu=function(t,e,n){bu(t.dom(),e,n)},wu=function(t,e){var n=t.dom();ft(e,(function(t,e){bu(n,e,t)}))},xu=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},Cu=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},Su=function(t,e){t.dom().removeAttribute(e)},ku=function(t,e){return Kn.fromDom(t.dom().cloneNode(e))},Ou=function(t){return ku(t,!1)},Tu=function(t){var e=Ou(t);return vu(e)},Eu=function(t){return Tu(t)},Du=function(t,e,n){return no(e,t.element())&&!no(e,n)},Au=ki([Ti(Io(),(function(t,n){var r=n.event().originator(),o=n.event().target();return!Du(t,r,o)||(e.console.warn(Io()+" did not get interpreted by the desired target. \nOriginator: "+Eu(r)+"\nTarget: "+Eu(o)+"\nCheck the "+Io()+" event handlers"),!1)}))]),_u=Object.freeze({events:Au}),Ru=0,Bu=function(t){var e=new Date,n=e.getTime(),r=Math.floor(1e9*Math.random());return Ru++,t+"_"+r+Ru+String(n)},Iu=i("alloy-id-"),Nu=i("data-alloy-id"),Pu=Iu(),Mu=Nu(),Fu=function(t,e){var n=Bu(Pu+t);return Lu(e,n),n},Lu=function(t,e){Object.defineProperty(t.dom(),Mu,{value:e,writable:!0})},Hu=function(t){var e=pi(t)?t.dom()[Mu]:null;return x.from(e)},zu=function(t){return Bu(t)},ju=u,Vu=function(t){var e=function(e){return function(){throw new Error("The component must be in a context to send: "+e+"\n"+Eu(t().element())+" is not in context.")}};return{debugInfo:i("fake"),triggerEvent:e("triggerEvent"),triggerFocus:e("triggerFocus"),triggerEscape:e("triggerEscape"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),broadcast:e("broadcast"),broadcastOn:e("broadcastOn"),broadcastEvent:e("broadcastEvent"),isConnected:i(!1)}},Uu=Vu(),Wu=function(t,e,n){var r=n.toString(),o=r.indexOf(")")+1,i=r.indexOf("("),u=r.substring(i+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:e,parameters:Gu(u.slice(0,1).concat(u.slice(3)))}},t},Gu=function(t){return W(t,(function(t){return Pr(t,"/*")?t.substring(0,t.length-"/*".length):t}))},qu=function(t,e){var n=t.toString(),r=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:e,parameters:Gu(i)}},t},Xu=function(t,e){var n=e.toString(),r=n.indexOf(")")+1,o=n.indexOf("("),i=n.substring(o+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:Gu(i.slice(1))}},t},$u=Bu("alloy-premade"),Yu=function(t){return Xt($u,t)},Ku=function(t){return qt(t,$u)},Ju=function(t){return Xu((function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return t.apply(void 0,[e.getApis()].concat([e].concat(n)))}),t)},Qu={init:function(){return Zu({readState:function(){return"No State required"}})}},Zu=function(t){return t},ta=function(t,e){var n=W(e,(function(t){return Rn(t.name(),[gn("config"),In("state",Qu)])})),r=Qe("component.behaviours",Me(n),t.behaviours).fold((function(e){throw new Error(en(e)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),(function(t){return t}));return{list:e,data:dt(r,(function(t){var e=t,n=e.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return function(){return n}}))}},ea=function(t){return t.list},na=function(t){return t.data},ra=function(t,e){var n={};return ft(t,(function(t,r){ft(t,(function(t,o){var i=Gt(o,[])(n);n[o]=i.concat([e(r,t)])}))})),n},oa=function(t){return{classes:void 0!==t.classes?t.classes:[],attributes:void 0!==t.attributes?t.attributes:{},styles:void 0!==t.styles?t.styles:{}}},ia=function(t,e){return m(m({},t),{attributes:m(m({},t.attributes),e.attributes),styles:m(m({},t.styles),e.styles),classes:t.classes.concat(e.classes)})},ua=function(t,e,n,r){var o=m({},e);G(n,(function(e){o[e.name()]=e.exhibit(t,r)}));var i=function(t,e){return{name:t,modification:e}},u=ra(o,i),a=function(t){return Y(t,(function(t,e){return m(m({},e.modification),t)}),{})},c=Y(u.classes,(function(t,e){return e.modification.concat(t)}),[]),s=a(u.attributes),l=a(u.styles);return oa({classes:c,attributes:s,styles:l})},aa=function(t,e,n,r){var o=n.slice(0);try{var i=o.sort((function(n,o){var i=n[e](),u=o[e](),a=r.indexOf(i),c=r.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(r,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(r,null,2));return a<c?-1:c<a?1:0}));return O.value(i)}catch(u){return O.error([u])}},ca=function(t,e){return{handler:t,purpose:i(e)}},sa=function(t,e){return{cHandler:t,purpose:i(e)}},la=function(t,e){return sa(a.apply(void 0,[t.handler].concat(e)),t.purpose())},fa=function(t){return t.cHandler},da=function(t,e){return{name:i(t),handler:i(e)}},ma=function(t,e){var n={};return G(t,(function(t){n[t.name()]=t.handlers(e)})),n},ga=function(t,e,n){var r=m(m({},n),ma(e,t));return ra(r,da)},pa=function(t,e,n,r){var o=ga(t,n,r);return ya(o,e)},ha=function(t){var e=fo(t);return function(t,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];var i=[t,n].concat(r);e.abort.apply(void 0,i)?n.stop():e.can.apply(void 0,i)&&e.run.apply(void 0,i)}},va=function(t,e){return O.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(W(e,(function(t){return t.name()})),null,2)])},ba=function(t,e,n){var r=e[n];return r?aa("Event: "+n,"name",t,r).map((function(t){var e=W(t,(function(t){return t.handler()}));return mo(e)})):va(n,t)},ya=function(t,e){var n=gt(t,(function(t,n){var r=1===t.length?O.value(t[0].handler()):ba(t,e,n);return r.map((function(r){var o=ha(r),i=t.length>1?$(e[n],(function(e){return j(t,(function(t){return t.name()===e}))})).join(" > "):t[0].name();return Xt(n,ca(o,i))}))}));return Jt(n,{})},wa=function(t){return Qe("custom.definition",Me([Ve("dom","dom",Rt(),Me([gn("tag"),In("styles",{}),In("classes",[]),In("attributes",{}),On("value"),On("innerHtml")])),gn("components"),gn("uid"),In("events",{}),In("apis",{}),Ve("eventOrder","eventOrder",_t({"alloy.execute":["disabling","alloy.base.behaviour","toggling","typeaheadevents"],"alloy.focus":["alloy.base.behaviour","focusing","keying"],"alloy.system.init":["alloy.base.behaviour","disabling","toggling","representing"],input:["alloy.base.behaviour","representing","streaming","invalidating"],"alloy.system.detached":["alloy.base.behaviour","representing","item-events","tooltipping"],mousedown:["focusing","alloy.base.behaviour","item-type-events"],touchstart:["focusing","alloy.base.behaviour","item-type-events"],mouseover:["item-type-events","tooltipping"]}),on()),On("domModification")]),t)},xa=function(t){return m(m({},t.dom),{uid:t.uid,domChildren:W(t.components,(function(t){return t.element()}))})},Ca=function(t){return t.domModification.fold((function(){return oa({})}),oa)},Sa=function(t){return t.events},ka=function(t,e){var n=xu(t,e);return void 0===n||""===n?[]:n.split(" ")},Oa=function(t,e,n){var r=ka(t,e),o=r.concat([n]);return yu(t,e,o.join(" ")),!0},Ta=function(t,e,n){var r=$(ka(t,e),(function(t){return t!==n}));return r.length>0?yu(t,e,r.join(" ")):Su(t,e),!1},Ea=function(t){return void 0!==t.dom().classList},Da=function(t){return ka(t,"class")},Aa=function(t,e){return Oa(t,"class",e)},_a=function(t,e){return Ta(t,"class",e)},Ra=function(t,e){Ea(t)?t.dom().classList.add(e):Aa(t,e)},Ba=function(t){var e=Ea(t)?t.dom().classList:Da(t);0===e.length&&Su(t,"class")},Ia=function(t,e){if(Ea(t)){var n=t.dom().classList;n.remove(e)}else _a(t,e);Ba(t)},Na=function(t,e){return Ea(t)&&t.dom().classList.contains(e)},Pa=function(t,e){G(e,(function(e){Ra(t,e)}))},Ma=function(t,e){G(e,(function(e){Ia(t,e)}))},Fa=function(t){return void 0!==t.style&&B(t.style.getPropertyValue)},La=function(t,n,r){if(!D(r))throw e.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",t),new Error("CSS value must be a string: "+r);Fa(t)&&t.style.setProperty(n,r)},Ha=function(t,e){Fa(t)&&t.style.removeProperty(e)},za=function(t,e,n){var r=t.dom();La(r,e,n)},ja=function(t,e){var n=t.dom();ft(e,(function(t,e){La(n,e,t)}))},Va=function(t,e){var n=t.dom();ft(e,(function(t,e){t.fold((function(){Ha(n,e)}),(function(t){La(n,e,t)}))}))},Ua=function(t,n){var r=t.dom(),o=e.window.getComputedStyle(r),i=o.getPropertyValue(n),u=""!==i||vi(t)?i:Wa(r,n);return null===u?void 0:u},Wa=function(t,e){return Fa(t)?t.style.getPropertyValue(e):""},Ga=function(t,e){var n=t.dom(),r=Wa(n,e);return x.from(r).filter((function(t){return t.length>0}))},qa=function(t,e,n){var r=Kn.fromTag(t);za(r,e,n);var o=Ga(r,e);return o.isSome()},Xa=function(t,e){var n=t.dom();Ha(n,e),Cu(t,"style")&&""===Mr(xu(t,"style"))&&Su(t,"style")},$a=function(t){return t.dom().offsetWidth},Ya=function(t){return t.dom().value},Ka=function(t,e){if(void 0===e)throw new Error("Value.set was undefined");t.dom().value=e},Ja=function(t){var e=Kn.fromTag(t.tag);wu(e,t.attributes),Pa(e,t.classes),ja(e,t.styles),t.innerHtml.each((function(t){return hu(e,t)}));var n=t.domChildren;return fu(e,n),t.value.each((function(t){Ka(e,t)})),t.uid,Lu(e,t.uid),e},Qa=function(t){var e=Gt("behaviours",{})(t),n=$(st(e),(function(t){return void 0!==e[t]}));return W(n,(function(t){return e[t].me}))},Za=function(t,e){return ta(t,e)},tc=function(t){var e=Qa(t);return Za(t,e)},ec=function(t,e,n){var r=xa(t),o=Ca(t),i={"alloy.base.modification":o},u=e.length>0?ua(n,i,e,r):o;return ia(r,u)},nc=function(t,e,n){var r={"alloy.base.behaviour":Sa(t)};return pa(n,t.eventOrder,e,r).getOrDie()},rc=function(t){var e=function(){return y},n=Wn(Uu),r=Ze(wa(t)),o=tc(t),u=ea(o),a=na(o),c=ec(r,u,a),s=Ja(c),l=nc(r,u,a),f=Wn(r.components),d=function(t){n.set(t)},m=function(){n.set(Vu(e))},g=function(){var t=eu(s),e=tt(t,(function(t){return n.get().getByDom(t).fold((function(){return[]}),(function(t){return[t]}))}));f.set(e)},p=function(e){var n=a,r=B(n[e.name()])?n[e.name()]:function(){throw new Error("Could not find "+e.name()+" in "+JSON.stringify(t,null,2))};return r()},h=function(t){return B(a[t.name()])},v=function(){return r.apis},b=function(t){return a[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},y={getSystem:n.get,config:p,hasConfigured:h,spec:i(t),readState:b,getApis:v,connect:d,disconnect:m,element:i(s),syncComponents:g,components:f.get,events:i(l)};return y},oc=function(t){var e=Gt("components",[])(t);return W(e,sc)},ic=function(t){var e=ju(t),n=e.events,r=g(e,["events"]),o=oc(r),i=m(m({},r),{events:m(m({},_u),n),components:o});return O.value(rc(i))},uc=function(t){var e=Kn.fromText(t);return ac({element:e})},ac=function(t){var e=tn("external.component",Pe([gn("element"),On("uid")]),t),r=Wn(Vu()),o=function(t){r.set(t)},u=function(){r.set(Vu((function(){return a})))};e.uid.each((function(t){Lu(e.element,t)}));var a={getSystem:r.get,config:x.none,hasConfigured:i(!1),connect:o,disconnect:u,getApis:function(){return{}},element:i(e.element),spec:i(t),readState:i("No state"),syncComponents:n,components:i([]),events:i({})};return Yu(a)},cc=zu,sc=function(t){return Ku(t).fold((function(){var e=t.hasOwnProperty("uid")?t:m({uid:cc("")},t);return ic(e).getOrDie()}),(function(t){return t}))},lc=Yu;function fc(t,e){var n=function(e,n){if(!I(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();Fa(r)&&(r.style[t]=n+"px")},r=function(n){var r=e(n);if(r<=0||null===r){var o=Ua(n,t);return parseFloat(o)||0}return r},o=r,i=function(t,e){return K(e,(function(e,n){var r=Ua(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)},u=function(t,e,n){var r=i(t,n),o=e>r?e-r:0;return o};return{set:n,get:r,getOuter:o,aggregate:i,max:u}}var dc,mc=fc("height",(function(t){var e=t.dom();return vi(t)?e.getBoundingClientRect().height:e.offsetHeight})),gc=function(t){return mc.get(t)},pc=function(t){return mc.getOuter(t)},hc=function(t,e){var n=["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"],r=mc.max(t,e,n);za(t,"max-height",r+"px")},vc=function(t,e){var n=function(n,r){return vc(t+n,e+r)};return{left:i(t),top:i(e),translate:n}},bc=vc,yc=function(t){var e=t.getBoundingClientRect();return bc(e.left,e.top)},wc=function(t,e){return void 0!==t?t:void 0!==e?e:0},xc=function(t){var e=t.dom().ownerDocument,n=e.body,r=e.defaultView,o=e.documentElement;if(n===t.dom())return bc(n.offsetLeft,n.offsetTop);var i=wc(r.pageYOffset,o.scrollTop),u=wc(r.pageXOffset,o.scrollLeft),a=wc(o.clientTop,n.clientTop),c=wc(o.clientLeft,n.clientLeft);return Cc(t).translate(u-c,i-a)},Cc=function(t){var e=t.dom(),n=e.ownerDocument,r=n.body;return r===e?bc(r.offsetLeft,r.offsetTop):vi(t)?yc(e):bc(0,0)},Sc=fc("width",(function(t){return t.dom().offsetWidth})),kc=function(t,e){Sc.set(t,e)},Oc=function(t){return Sc.get(t)},Tc=function(t){return Sc.getOuter(t)},Ec=function(t,e){var n=["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"],r=Sc.max(t,e,n);za(t,"max-width",r+"px")},Dc=(qr().browser.isSafari(),function(t){var n=void 0!==t?t.dom():e.document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return bc(r,o)}),Ac=function(t,e,n,r){return{x:i(t),y:i(e),width:i(n),height:i(r),right:i(t+n),bottom:i(e+r)}},_c=function(t){var n=void 0===t?e.window:t,r=n.document,o=Dc(Kn.fromDom(r)),i=n["visualViewport"];if(void 0!==i)return Ac(Math.max(i.pageLeft,o.left()),Math.max(i.pageTop,o.top()),i.width,i.height);var u=r.documentElement,a=u.clientWidth,c=u.clientHeight;return Ac(o.left(),o.top(),a,c)},Rc=function(t,e){var n=t.view(e);return n.fold(i([]),(function(e){var n=t.owner(e),r=Rc(t,n);return[e].concat(r)}))},Bc=function(t,e){var n=e.owner(t),r=Rc(e,n);return x.some(r)},Ic=function(t){var n=t.dom()===e.document?x.none():x.from(t.dom().defaultView.frameElement);return n.map(Kn.fromDom)},Nc=function(t){return Yi(t)},Pc=Object.freeze({view:Ic,owner:Nc}),Mc=function(t){var n=Kn.fromDom(e.document),r=Dc(n),o=Bc(t,Pc);return o.fold(a(xc,t),(function(e){var n=Cc(t),o=Y(e,(function(t,e){var n=Cc(e);return{left:t.left+n.left(),top:t.top+n.top()}}),{left:0,top:0});return bc(o.left+n.left()+r.left(),o.top+n.top()+r.top())}))},Fc=Vi("point","width","height"),Lc=Vi("x","y","width","height"),Hc=function(t,e,n,r){return{x:i(t),y:i(e),width:i(n),height:i(r),right:i(t+n),bottom:i(e+r)}},zc=function(t){var e=xc(t),n=Tc(t),r=pc(t);return Hc(e.left(),e.top(),n,r)},jc=function(t){var e=Mc(t),n=Tc(t),r=pc(t);return Hc(e.left(),e.top(),n,r)},Vc=function(){return _c(e.window)},Uc=function(t,e,n){return xi(t,e,n).isSome()},Wc=function(t,e,n){return wi(t,(function(t){return Qr(t,e)}),n)},Gc=function(t,e){return eo(e,t)},qc=function(t,e,n){return fi(Qr,Wc,t,e,n)},Xc=function(t){var e=xi(t,(function(t){if(!pi(t))return!1;var e=xu(t,"id");return void 0!==e&&e.indexOf("aria-owns")>-1}));return e.bind((function(t){var e=xu(t,"id"),n=Yi(t);return Gc(n,'[aria-owns="'+e+'"]')}))},$c=function(){var t=Bu("aria-owns"),e=function(e){yu(e,"aria-owns",t)},n=function(t){Su(t,"aria-owns")};return{id:i(t),link:e,unlink:n}},Yc=function(t,e){return Xc(e).exists((function(e){return Kc(t,e)}))},Kc=function(t,e){return Uc(e,(function(e){return no(e,t.element())}),i(!1))||Yc(t,e)},Jc=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},Qc=function(t){for(var e=[],n=0;n<t.length;n++){var r=t[n];if(!r.isSome())return x.none();e.push(r.getOrDie())}return x.some(e)},Zc=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return x.none()},ts=function(t,e,n){return t.isSome()&&e.isSome()?x.some(n(t.getOrDie(),e.getOrDie())):x.none()},es=function(t,e,n,r){return t.isSome()&&e.isSome()&&n.isSome()?x.some(r(t.getOrDie(),e.getOrDie(),n.getOrDie())):x.none()},ns="unknown";(function(t){t[t["STOP"]=0]="STOP",t[t["NORMAL"]=1]="NORMAL",t[t["LOGGING"]=2]="LOGGING"})(dc||(dc={}));var rs=Wn({}),os=function(t,n){var r=[],o=(new Date).getTime();return{logEventCut:function(t,e,n){r.push({outcome:"cut",target:e,purpose:n})},logEventStopped:function(t,e,n){r.push({outcome:"stopped",target:e,purpose:n})},logNoParent:function(t,e,n){r.push({outcome:"no-parent",target:e,purpose:n})},logEventNoHandlers:function(t,e){r.push({outcome:"no-handlers-left",target:e})},logEventResponse:function(t,e,n){r.push({outcome:"response",purpose:n,target:e})},write:function(){var i=(new Date).getTime();z(["mousemove","mouseover","mouseout",Wo()],t)||e.console.log(t,{event:t,time:i-o,target:n.dom(),sequence:W(r,(function(t){return z(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Eu(t.target)+")":t.outcome}))})}}},is=function(t,e,n){var r=qt(rs.get(),t).orThunk((function(){var e=st(rs.get());return Zc(e,(function(e){return t.indexOf(e)>-1?x.some(rs.get()[e]):x.none()}))})).getOr(dc.NORMAL);switch(r){case dc.NORMAL:return n(ls());case dc.LOGGING:var o=os(t,e),i=n(o);return o.write(),i;case dc.STOP:return!0}},us=["alloy/data/Fields","alloy/debugging/Debugging"],as=function(){var t=new Error;if(void 0!==t.stack){var e=t.stack.split("\n");return J(e,(function(t){return t.indexOf("alloy")>0&&!j(us,(function(e){return t.indexOf(e)>-1}))})).getOr(ns)}return ns},cs={logEventCut:n,logEventStopped:n,logNoParent:n,logEventNoHandlers:n,logEventResponse:n,write:n},ss=function(t,e,n){return is(t,e,n)},ls=i(cs),fs=i([gn("menu"),gn("selectedMenu")]),ds=i([gn("item"),gn("selectedItem")]),ms=(i(Me(ds().concat(fs()))),i(Me(ds()))),gs=Cn("initSize",[gn("numColumns"),gn("numRows")]),ps=function(){return pn("markers",ms())},hs=function(){return Cn("markers",[gn("backgroundMenu")].concat(fs()).concat(ds()))},vs=function(t){return Cn("markers",W(t,gn))},bs=function(t,e,n){as();return Ve(e,e,n,Ye((function(t){return O.value((function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(void 0,e)}))})))},ys=function(t){return bs("onHandler",t,At(n))},ws=function(t){return bs("onKeyboardHandler",t,At(x.none))},xs=function(t){return bs("onHandler",t,Rt())},Cs=function(t){return bs("onKeyboardHandler",t,Rt())},Ss=function(t,e){return Un(t,i(e))},ks=function(t){return Un(t,u)},Os=i(gs),Ts=Vi("x","y","bubble","direction","label"),Es=wt.generate([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Ds=function(t,e,n,r,o,i,u,a,c){return t.fold(e,n,r,o,i,u,a,c)},As=function(t,e,n,r){return t.fold(e,e,r,r,e,r,n,n)},_s=function(t,e,n,r){return t.fold(e,r,e,r,n,n,e,r)},Rs=Es.southeast,Bs=Es.southwest,Is=Es.northeast,Ns=Es.northwest,Ps=Es.south,Ms=Es.north,Fs=Es.east,Ls=Es.west,Hs=function(t){return t.x()},zs=function(t,e){return t.x()+t.width()/2-e.width()/2},js=function(t,e){return t.x()+t.width()-e.width()},Vs=function(t,e){return t.y()-e.height()},Us=function(t){return t.y()+t.height()},Ws=function(t,e){return t.y()+t.height()/2-e.height()/2},Gs=function(t){return t.x()+t.width()},qs=function(t,e){return t.x()-e.width()},Xs=function(t,e,n){return Ts(Hs(t),Us(t),n.southeast(),Rs(),"layout-se")},$s=function(t,e,n){return Ts(js(t,e),Us(t),n.southwest(),Bs(),"layout-sw")},Ys=function(t,e,n){return Ts(Hs(t),Vs(t,e),n.northeast(),Is(),"layout-ne")},Ks=function(t,e,n){return Ts(js(t,e),Vs(t,e),n.northwest(),Ns(),"layout-nw")},Js=function(t,e,n){return Ts(zs(t,e),Vs(t,e),n.north(),Ms(),"layout-n")},Qs=function(t,e,n){return Ts(zs(t,e),Us(t),n.south(),Ps(),"layout-s")},Zs=function(t,e,n){return Ts(Gs(t),Ws(t,e),n.east(),Fs(),"layout-e")},tl=function(t,e,n){return Ts(qs(t,e),Ws(t,e),n.west(),Ls(),"layout-w")},el=function(){return[Xs,$s,Ys,Ks,Qs,Js,Zs,tl]},nl=function(){return[$s,Xs,Ks,Ys,Qs,Js,Zs,tl]},rl=function(){return[Xs,$s,Ys,Ks,Qs,Js]},ol=function(){return[$s,Xs,Ks,Ys,Qs,Js]},il=function(t,e,n){return ji((function(r){n(r,t,e)}))},ul=function(t,e,n){return zi((function(r,o){n(r,t,e)}))},al=function(t,e,n,r,o,i){var u=Pe(t),a=Rn(e,[Bn("config",t)]);return fl(u,a,e,n,r,o,i)},cl=function(t,e,n,r,o,i){var u=t,a=Rn(e,[Tn("config",t)]);return fl(u,a,e,n,r,o,i)},sl=function(t,e,n){var r=function(r){for(var o=[],u=1;u<arguments.length;u++)o[u-1]=arguments[u];var a=[r].concat(o);return r.config({name:i(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+n)}),(function(t){var n=Array.prototype.slice.call(a,1);return e.apply(void 0,[r,t.config,t.state].concat(n))}))};return Wu(r,n,e)},ll=function(t){return{key:t,value:void 0}},fl=function(t,e,n,r,o,i,u){var c=function(t){return Qt(t,n)?t[n]():x.none()},s=dt(o,(function(t,e){return sl(n,t,e)})),l=dt(i,(function(t,e){return qu(t,e)})),f=m(m(m({},l),s),{revoke:a(ll,n),config:function(e){var r=tn(n+"-config",t,e);return{key:n,value:{config:r,me:f,configAsRaw:Et((function(){return tn(n+"-config",t,e)})),initialConfig:e,state:u}}},schema:function(){return e},exhibit:function(t,e){return c(t).bind((function(t){return qt(r,"exhibit").map((function(n){return n(e,t.config,t.state)}))})).getOr(oa({}))},name:function(){return n},handlers:function(t){return c(t).map((function(t){var e=Gt("events",(function(t,e){return{}}))(r);return e(t.config,t.state)})).getOr({})}});return f},dl=function(t){return $t(t)},ml=Pe([gn("fields"),gn("name"),In("active",{}),In("apis",{}),In("state",Qu),In("extra",{})]),gl=function(t){var e=tn("Creating behaviour: "+t.name,ml,t);return al(e.fields,e.name,e.active,e.apis,e.extra,e.state)},pl=Pe([gn("branchKey"),gn("branches"),gn("name"),In("active",{}),In("apis",{}),In("state",Qu),In("extra",{})]),hl=function(t){var e=tn("Creating behaviour: "+t.name,pl,t);return cl(rn(e.branchKey,e.branches),e.name,e.active,e.apis,e.extra,e.state)},vl=i(void 0),bl=function(t,e){return e.universal()?t:$(t,(function(t){return z(e.channels(),t)}))},yl=function(t){return ki([Di(Mo(),(function(e,n){var r=t.channels,o=st(r),i=bl(o,n);G(i,(function(t){var o=r[t],i=o.schema,u=tn("channel["+t+"] data\nReceiver: "+Eu(e.element()),i,n.data());o.onReceive(e,u)}))}))])},wl=Object.freeze({events:yl}),xl=[pn("channels",Ke(O.value,Pe([xs("onReceive"),In("schema",on())])))],Cl=gl({fields:xl,name:"receiving",active:wl}),Sl=function(t,e){return oa({classes:[],styles:e.useFixed()?{}:{position:"relative"}})},kl=Object.freeze({exhibit:Sl}),Ol=function(t){t.dom().focus()},Tl=function(t){t.dom().blur()},El=function(t){var e=Yi(t).dom();return t.dom()===e.activeElement},Dl=function(t){var n=void 0!==t?t.dom():e.document;return x.from(n.activeElement).map(Kn.fromDom)},Al=function(t){return Dl(Yi(t)).filter((function(e){return t.dom().contains(e.dom())}))},_l=function(t,e){var r=Yi(e),o=Dl(r).bind((function(t){var n=function(e){return no(t,e)};return n(e)?x.some(e):Ci(e,n)})),i=t(e);return o.each((function(t){Dl(r).filter((function(e){return no(e,t)})).fold((function(){Ol(t)}),n)})),i},Rl=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Bl=function(t,e,n){var r=function(t){return qt(n,t).getOr([])},o=function(t,e,n){var o=rt(Rl,n);return{offset:function(){return bc(t,e)},classesOn:function(){return tt(n,r)},classesOff:function(){return tt(o,r)}}};return{southeast:function(){return o(-t,e,["top","alignLeft"])},southwest:function(){return o(t,e,["top","alignRight"])},south:function(){return o(-t/2,e,["top","alignCentre"])},northeast:function(){return o(-t,-e,["bottom","alignLeft"])},northwest:function(){return o(t,-e,["bottom","alignRight"])},north:function(){return o(-t/2,-e,["bottom","alignCentre"])},east:function(){return o(t,-e/2,["valignCentre","left"])},west:function(){return o(-t,-e/2,["valignCentre","right"])},innerNorthwest:function(){return o(-t,e,["top","alignRight"])},innerNortheast:function(){return o(t,e,["top","alignLeft"])},innerNorth:function(){return o(-t/2,e,["top","alignCentre"])},innerSouthwest:function(){return o(-t,-e,["bottom","alignRight"])},innerSoutheast:function(){return o(t,-e,["bottom","alignLeft"])},innerSouth:function(){return o(-t/2,-e,["bottom","alignCentre"])},innerWest:function(){return o(t,-e/2,["valignCentre","right"])},innerEast:function(){return o(-t,-e/2,["valignCentre","left"])}}},Il=function(){return Bl(0,0,{})},Nl=$i(["x","y","width","height","maxHeight","maxWidth","direction","classes","label","candidateYforTest"],[]),Pl=Vi("position","left","top","right","bottom"),Ml=wt.generate([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Fl=function(t,e,n,r,o,i){var u=e.x()-n,a=e.y()-r,c=e.width(),s=e.height(),l=o-(u+c),f=i-(a+s),d=x.some(u),m=x.some(a),g=x.some(l),p=x.some(f),h=x.none();return Ds(e.direction(),(function(){return Pl(t,d,m,h,h)}),(function(){return Pl(t,h,m,g,h)}),(function(){return Pl(t,d,h,h,p)}),(function(){return Pl(t,h,h,g,p)}),(function(){return Pl(t,d,m,h,h)}),(function(){return Pl(t,d,h,h,p)}),(function(){return Pl(t,d,m,h,h)}),(function(){return Pl(t,h,m,g,h)}))},Ll=function(t,e){return t.fold((function(){return Pl("absolute",x.some(e.x()),x.some(e.y()),x.none(),x.none())}),(function(t,n,r,o){return Fl("absolute",e,t,n,r,o)}),(function(t,n,r,o){return Fl("fixed",e,t,n,r,o)}))},Hl=function(t,e){var n=a(Mc,e),r=t.fold(n,n,(function(){var t=Dc();return Mc(e).translate(-t.left(),-t.top())})),o=Tc(e),i=pc(e);return Hc(r.left(),r.top(),o,i)},zl=function(t,e){return e.fold((function(){return t.fold(Vc,Vc,Hc)}),(function(e){return t.fold(e,e,(function(){var n=e(),r=jl(t,n.x(),n.y());return Hc(r.left(),r.top(),n.width(),n.height())}))}))},jl=function(t,e,n){var r=bc(e,n),o=function(){var t=Dc();return r.translate(-t.left(),-t.top())};return t.fold(i(r),i(r),o)},Vl=function(t,e,n,r){return t.fold(e,n,r)},Ul=Ml.relative,Wl=Ml.fixed,Gl=function(t){return t},ql=function(t,e){return function(n){return"rtl"===Xl(n)?e:t}},Xl=function(t){return"rtl"===Ua(t,"direction")?"rtl":"ltr"},$l=function(){return Rn("layouts",[gn("onLtr"),gn("onRtl")])},Yl=function(t,e,n,r){var o=e.layouts.map((function(e){return e.onLtr(t)})).getOr(n),i=e.layouts.map((function(e){return e.onRtl(t)})).getOr(r),u=ql(o,i);return u(t)},Kl=function(t,e,n){var r=e.hotspot,o=Hl(n,r.element()),i=Yl(t.element(),e,rl(),ol());return x.some(Gl({anchorBox:o,bubble:e.bubble.getOr(Il()),overrides:e.overrides,layouts:i,placer:x.none()}))},Jl=[gn("hotspot"),On("bubble"),In("overrides",{}),$l(),Ss("placement",Kl)],Ql=function(t,e,n){var r=jl(n,e.x,e.y),o=Hc(r.left(),r.top(),e.width,e.height),i=Yl(t.element(),e,el(),nl());return x.some(Gl({anchorBox:o,bubble:e.bubble,overrides:e.overrides,layouts:i,placer:x.none()}))},Zl=[gn("x"),gn("y"),In("height",0),In("width",0),In("bubble",Il()),In("overrides",{}),$l(),Ss("placement",Ql)],tf=function(){return"\ufeff"},ef=Vi("start","soffset","finish","foffset"),nf={create:ef},rf=wt.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),of=function(t,e,n,r){return t.fold(e,n,r)},uf=function(t){return t.fold(u,u,u)},af=rf.before,cf=rf.on,sf=rf.after,lf={before:af,on:cf,after:sf,cata:of,getStart:uf},ff=wt.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),df=function(t){return ff.exact(t.start(),t.soffset(),t.finish(),t.foffset())},mf=function(t){return t.match({domRange:function(t){return Kn.fromDom(t.startContainer)},relative:function(t,e){return lf.getStart(t)},exact:function(t,e,n,r){return t}})},gf=ff.domRange,pf=ff.relative,hf=ff.exact,vf=function(t){var e=mf(t);return Ji(e)},bf=nf.create,yf={domRange:gf,relative:pf,exact:hf,exactFromRange:df,getWin:vf,range:bf},wf=function(t,e){e.fold((function(e){t.setStartBefore(e.dom())}),(function(e,n){t.setStart(e.dom(),n)}),(function(e){t.setStartAfter(e.dom())}))},xf=function(t,e){e.fold((function(e){t.setEndBefore(e.dom())}),(function(e,n){t.setEnd(e.dom(),n)}),(function(e){t.setEndAfter(e.dom())}))},Cf=function(t,e,n){var r=t.document.createRange();return wf(r,e),xf(r,n),r},Sf=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},kf=function(t){return{left:i(t.left),top:i(t.top),right:i(t.right),bottom:i(t.bottom),width:i(t.width),height:i(t.height)}},Of=function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?x.some(n).map(kf):x.none()},Tf=wt.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ef=function(t,e,n){return e(Kn.fromDom(n.startContainer),n.startOffset,Kn.fromDom(n.endContainer),n.endOffset)},Df=function(t,e){return e.match({domRange:function(t){return{ltr:i(t),rtl:x.none}},relative:function(e,n){return{ltr:Et((function(){return Cf(t,e,n)})),rtl:Et((function(){return x.some(Cf(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:Et((function(){return Sf(t,e,n,r,o)})),rtl:Et((function(){return x.some(Sf(t,r,o,e,n))}))}}})},Af=function(t,e){var n=e.ltr();if(n.collapsed){var r=e.rtl().filter((function(t){return!1===t.collapsed}));return r.map((function(t){return Tf.rtl(Kn.fromDom(t.endContainer),t.endOffset,Kn.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ef(t,Tf.ltr,n)}))}return Ef(t,Tf.ltr,n)},_f=function(t,e){var n=Df(t,e);return Af(t,n)},Rf=function(t,e){var n=_f(t,e);return n.match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},Bf=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n<=a.bottom){if(n<a.top||c>i)return u-1;i=c}}return 0},If=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom};function Nf(t,e){var n=function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return r(n).getOr("")},r=function(e){return t(e)?x.from(e.dom().nodeValue):x.none()},o=function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r};return{get:n,getOption:r,set:o}}var Pf=Nf(hi,"text"),Mf=function(t){return Pf.get(t)},Ff=function(t){return Pf.getOption(t)},Lf=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=function(t){var e=i(t);return e.getBoundingClientRect()},a=Mf(e).length,c=Bf(u,n,r,o.right,a);return i(c)},Hf=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects(),u=Zc(i,(function(t){return If(t,n,r)?x.some(t):x.none()}));return u.map((function(o){return Lf(t,e,n,r,o)}))},zf=function(t,e,n,r){var o=t.dom().createRange(),i=eu(e);return Zc(i,(function(e){return o.selectNode(e.dom()),If(o.getBoundingClientRect(),n,r)?jf(t,e,n,r):x.none()}))},jf=function(t,e,n,r){return hi(e)?Hf(t,e,n,r):zf(t,e,n,r)},Vf=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return jf(t,e,u,a)},Uf=function(t){return"img"===di(t)?1:Ff(t).fold((function(){return eu(t).length}),(function(t){return t.length}))},Wf=" ",Gf=function(t){return Ff(t).filter((function(t){return 0!==t.trim().length||t.indexOf(Wf)>-1})).isSome()},qf=["img","br"],Xf=function(t){var e=Gf(t);return e||z(qf,di(t))},$f=function(t){return Ci(t,Xf)},Yf=function(t){return Kf(t,Xf)},Kf=function(t,e){var n=function(t){for(var r=eu(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return x.some(i);var u=n(i);if(u.isSome())return u}return x.none()};return n(t)},Jf=!0,Qf=!1,Zf=function(t,e){return e-t.left<t.right-e?Jf:Qf},td=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},ed=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Zf(o,n),u=i===Jf?$f:Yf;return u(e).map((function(e){return td(t,e,i)}))},nd=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=Zf(r,n);return x.some(td(t,e,o))},rd=function(t,e,n){var r=0===eu(e).length?nd:ed;return r(t,e,n)},od=function(t,e,n){return x.from(t.dom().caretPositionFromPoint(e,n)).bind((function(e){if(null===e.offsetNode)return x.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),x.some(n)}))},id=function(t,e,n){return x.from(t.dom().caretRangeFromPoint(e,n))},ud=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Vf(t,e,u,a)},ad=function(t,e,n){return Kn.fromPoint(t,e,n).bind((function(r){var o=function(){return rd(t,r,e)};return 0===eu(r).length?o():ud(t,r,e,n).orThunk(o)}))},cd=(document.caretPositionFromPoint||document.caretRangeFromPoint,function(t,e){return to(e,t)}),sd=function(t,e,n,r){var o=Yi(t),i=o.dom().createRange();return i.setStart(t.dom(),e),i.setEnd(n.dom(),r),i},ld=function(t,e,n,r){var o=sd(t,e,n,r),i=no(t,n)&&e===r;return o.collapsed&&!i},fd=function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return x.some(nf.create(Kn.fromDom(e.startContainer),e.startOffset,Kn.fromDom(n.endContainer),n.endOffset))}return x.none()},dd=function(t){var e=Kn.fromDom(t.anchorNode),n=Kn.fromDom(t.focusNode);return ld(e,t.anchorOffset,n,t.focusOffset)?x.some(nf.create(e,t.anchorOffset,n,t.focusOffset)):fd(t)},md=function(t){return x.from(t.getSelection()).filter((function(t){return t.rangeCount>0})).bind(dd)},gd=function(t,e){var n=Rf(t,e);return Of(n)},pd=Vi("element","offset"),hd=function(t,e){var n=eu(t);if(0===n.length)return pd(t,e);if(e<n.length)return pd(n[e],0);var r=n[n.length-1],o=hi(r)?Mf(r).length:eu(r).length;return pd(r,o)},vd=wt.generate([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),bd=function(t){return t.fold((function(t){return t}),(function(t,e,n){return t.translate(-e,-n)}))},yd=function(t){return t.fold((function(t){return t}),(function(t,e,n){return t}))},wd=function(t){return K(t,(function(t,e){return t.translate(e.left(),e.top())}),bc(0,0))},xd=function(t){var e=W(t,bd);return wd(e)},Cd=function(t){var e=W(t,yd);return wd(e)},Sd=vd.screen,kd=vd.absolute,Od=function(t,e,n){var r=Ji(n.root).dom(),o=function(e){var n=Yi(e),r=Yi(t.element());return no(n,r)};return x.from(r.frameElement).map(Kn.fromDom).filter(o).map(xc)},Td=function(t,e,n){var r=Yi(t.element()),o=Dc(r),i=Od(t,e,n).getOr(o);return kd(i,o.left(),o.top())},Ed=function(t,e,n,r){var o=t,i=e,u=n,a=r;t<0&&(o=0,u=n+t),e<0&&(i=0,a=r+e);var c=Sd(bc(o,i));return x.some(Fc(c,u,a))},Dd=function(t,e,n,r,o){return t.map((function(t){var i=[e,t.point()],u=Vl(r,(function(){return Cd(i)}),(function(){return Cd(i)}),(function(){return xd(i)})),a=Lc(u.left(),u.top(),t.width(),t.height()),c=function(){return n.showAbove?[Ys,Ks,Xs,$s,Js,Qs]:[Xs,$s,Ys,Ks,Qs,Qs]},s=function(){return n.showAbove?[Ks,Ys,$s,Xs,Js,Qs]:[$s,Xs,Ks,Ys,Qs,Js]},l=Yl(o,n,c(),s());return Gl({anchorBox:a,bubble:n.bubble.getOr(Il()),overrides:n.overrides,layouts:l,placer:x.none()})}))},Ad={capRect:Ed,calcNewAnchor:Dd},_d=Vi("element","offset"),Rd=function(t,e){return hi(t)?_d(t,e):hd(t,e)},Bd=function(t,e){var n=e.getSelection.getOrThunk((function(){return function(){return md(t)}}));return n().map((function(t){var e=Rd(t.start(),t.soffset()),n=Rd(t.finish(),t.foffset());return yf.range(e.element(),e.offset(),n.element(),n.offset())}))},Id=function(t,e,n){var r=Ji(e.root).dom(),o=Td(t,n,e),i=Bd(r,e).bind((function(t){var e=gd(r,yf.exactFromRange(t)).orThunk((function(){var e=Kn.fromText(tf());return iu(t.start(),e),gd(r,yf.exact(e,0,e,1)).map((function(t){return mu(e),t}))}));return e.bind((function(t){return Ad.capRect(t.left(),t.top(),t.width(),t.height())}))})),u=Bd(r,e).bind((function(t){return pi(t.start())?x.some(t.start()):Qi(t.start())})),a=u.getOr(t.element());return Ad.calcNewAnchor(i,o,e,n,a)},Nd=[On("getSelection"),gn("root"),On("bubble"),$l(),In("overrides",{}),In("showAbove",!1),Ss("placement",Id)],Pd=function(t,e,n){var r=Td(t,n,e);return e.node.bind((function(o){var i=o.dom().getBoundingClientRect(),u=Ad.capRect(i.left,i.top,i.width,i.height),a=e.node.getOr(t.element());return Ad.calcNewAnchor(u,r,e,n,a)}))},Md=[gn("node"),gn("root"),On("bubble"),$l(),In("overrides",{}),In("showAbove",!1),Ss("placement",Pd)],Fd=function(t){return t.x()+t.width()},Ld=function(t,e){return t.x()-e.width()},Hd=function(t,e){return t.y()-e.height()+t.height()},zd=function(t){return t.y()},jd=function(t,e,n){return Ts(Fd(t),zd(t),n.southeast(),Rs(),"link-layout-se")},Vd=function(t,e,n){return Ts(Ld(t,e),zd(t),n.southwest(),Bs(),"link-layout-sw")},Ud=function(t,e,n){return Ts(Fd(t),Hd(t,e),n.northeast(),Is(),"link-layout-ne")},Wd=function(t,e,n){return Ts(Ld(t,e),Hd(t,e),n.northwest(),Ns(),"link-layout-nw")},Gd=function(){return[jd,Vd,Ud,Wd]},qd=function(){return[Vd,jd,Wd,Ud]},Xd=function(t,e,n){var r=Hl(n,e.item.element()),o=Yl(t.element(),e,Gd(),qd());return x.some(Gl({anchorBox:r,bubble:Il(),overrides:e.overrides,layouts:o,placer:x.none()}))},$d=[gn("item"),$l(),In("overrides",{}),Ss("placement",Xd)],Yd=rn("anchor",{selection:Nd,node:Md,hotspot:Jl,submenu:$d,makeshift:Zl}),Kd=Vi("anchorBox","origin"),Jd=function(t,e){return Kd(t,e)},Qd=function(t,e,n,r){var o=t+e;return o>r?n:o<n?r:o},Zd=function(t,e,n){return t<=e?e:t>=n?n:t},tm=wt.generate([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),em=function(t,e,n,r,o){var i=o.x(),u=o.y(),a=o.width(),c=o.height(),s=t>=i,l=e>=u,f=s&&l,d=t+n<=i+a,m=e+r<=u+c,g=d&&m,p=Math.abs(Math.min(n,s?i+a-t:i-(t+n))),h=Math.abs(Math.min(r,l?u+c-e:u-(e+r))),v=Zd(t,o.x(),o.right()),b=Zd(e,o.y(),o.bottom());return{originInBounds:f,sizeInBounds:g,limitX:v,limitY:b,deltaW:p,deltaH:h}},nm=function(t,e,n,r){var o=t.x(),u=t.y(),a=t.bubble().offset().left(),c=t.bubble().offset().top(),s=r.y(),l=r.bottom(),f=r.x(),d=r.right(),m=o+a,g=u+c,p=em(m,g,e,n,r),h=p.originInBounds,v=p.sizeInBounds,b=p.limitX,y=p.limitY,w=p.deltaW,x=p.deltaH,C=i(y+x-s),S=i(l-y),k=As(t.direction(),S,S,C),O=i(b+w-f),T=i(d-b),E=_s(t.direction(),T,T,O),D=Nl({x:b,y:y,width:w,height:x,maxHeight:k,maxWidth:E,direction:t.direction(),classes:{on:t.bubble().classesOn(),off:t.bubble().classesOff()},label:t.label(),candidateYforTest:g});return h&&v?tm.fit(D):tm.nofit(D,w,x)},rm=function(t,e,n,r,o){var i=n.width(),c=n.height(),s=function(t,u,a,s){var l=t(e,n,r),f=nm(l,i,c,o);return f.fold(tm.fit,(function(t,e,n){var r=n>s||e>a;return r?tm.nofit(t,e,n):tm.nofit(u,a,s)}))},l=K(t,(function(t,e){var n=a(s,e);return t.fold(tm.fit,n)}),tm.nofit(Nl({x:e.x(),y:e.y(),width:n.width(),height:n.height(),maxHeight:n.height(),maxWidth:n.width(),direction:Rs(),classes:{on:[],off:[]},label:"none",candidateYforTest:e.y()}),-1,-1));return l.fold(u,u)},om=function(t){return{width:i(Tc(t)),height:i(pc(t))}},im=function(t,e,n,r){Xa(e,"max-height"),Xa(e,"max-width");var o=om(e);return rm(r.preference(),t,o,n,r.bounds())},um=function(t,e){var n=e.classes();Ma(t,n.off),Pa(t,n.on)},am=function(t,e,n){var r=n.maxHeightFunction();r(t,e.maxHeight())},cm=function(t,e,n){var r=n.maxWidthFunction();r(t,e.maxWidth())},sm=function(t,e,n){var r=function(t){return t+"px"},o=Ll(n.origin(),e);Va(t,{position:x.some(o.position()),left:o.left().map(r),top:o.top().map(r),right:o.right().map(r),bottom:o.bottom().map(r)})},lm=function(t,e){hc(t,Math.floor(e))},fm=i((function(t,e){lm(t,e),ja(t,{"overflow-x":"hidden","overflow-y":"auto"})})),dm=i((function(t,e){lm(t,e)})),mm=$i(["bounds","origin","preference","maxHeightFunction","maxWidthFunction"],[]),gm=function(t,e,n){return void 0===t[e]?n:t[e]},pm=function(t,e,r,o,i,u){var a=gm(u,"maxHeightFunction",fm()),c=gm(u,"maxWidthFunction",n),s=t.anchorBox(),l=t.origin(),f=mm({bounds:zl(l,i),origin:l,preference:o,maxHeightFunction:a,maxWidthFunction:c});hm(s,e,r,f)},hm=function(t,e,n,r){var o=im(t,e,n,r);sm(e,o,r),um(e,o),am(e,o,r),cm(e,o,r)},vm=function(){var t=e.document.documentElement;return Wl(0,0,t.clientWidth,t.clientHeight)},bm=function(t){var e=xc(t.element()),n=t.element().dom().getBoundingClientRect();return Ul(e.left(),e.top(),n.width,n.height)},ym=function(t,e,n,r,o){var i=Jd(n.anchorBox,e);pm(i,o.element(),n.bubble,n.layouts,r,n.overrides)},wm=function(t,e,n,r,o){xm(t,e,n,r,o,x.none())},xm=function(t,e,n,r,o,i){var u=i.map(zc);return Cm(t,e,n,r,o,u)},Cm=function(t,e,n,r,o,u){var a=tn("positioning anchor.info",Yd,r);_l((function(){za(o.element(),"position","fixed");var n=Ga(o.element(),"visibility");za(o.element(),"visibility","hidden");var r=e.useFixed()?vm():bm(t),c=a.placement,s=u.map(i).or(e.getBounds);c(t,a,r).each((function(e){var n=e.placer.getOr(ym);n(t,r,e,s,o)})),n.fold((function(){Xa(o.element(),"visibility")}),(function(t){za(o.element(),"visibility",t)})),Ga(o.element(),"left").isNone()&&Ga(o.element(),"top").isNone()&&Ga(o.element(),"right").isNone()&&Ga(o.element(),"bottom").isNone()&&Ga(o.element(),"position").is("fixed")&&Xa(o.element(),"position")}),o.element())},Sm=function(t,e,n){return e.useFixed()?"fixed":"absolute"},km=Object.freeze({position:wm,positionWithin:xm,positionWithinBounds:Cm,getMode:Sm}),Om=[In("useFixed",l),On("getBounds")],Tm=gl({fields:Om,name:"positioning",active:kl,apis:km}),Em=function(t){ii(t,Ko());var e=t.components();G(e,Em)},Dm=function(t){var e=t.components();G(e,Dm),ii(t,Yo())},Am=function(t,e){cu(t.element(),e.element())},_m=function(t){G(t.components(),(function(t){return mu(t.element())})),du(t.element()),t.syncComponents()},Rm=function(t,e){var n=t.components();_m(t);var r=rt(n,e);G(r,(function(e){Em(e),t.getSystem().removeFromWorld(e)})),G(e,(function(e){e.getSystem().isConnected()?Am(t,e):(t.getSystem().addToWorld(e),Am(t,e),vi(t.element())&&Dm(e)),t.syncComponents()}))},Bm=function(t,e){Im(t,e,cu)},Im=function(t,e,n){t.getSystem().addToWorld(e),n(t.element(),e.element()),vi(t.element())&&Dm(e),t.syncComponents()},Nm=function(t){Em(t),mu(t.element()),t.getSystem().removeFromWorld(t)},Pm=function(t){var e=Qi(t.element()).bind((function(e){return t.getSystem().getByDom(e).toOption()}));Nm(t),e.each((function(t){t.syncComponents()}))},Mm=function(t){var e=t.components();G(e,Nm),du(t.element()),t.syncComponents()},Fm=function(t,e){Hm(t,e,cu)},Lm=function(t,e){Hm(t,e,uu)},Hm=function(t,e,n){n(t,e.element());var r=eu(e.element());G(r,(function(t){e.getByDom(t).each(Dm)}))},zm=function(t){var e=eu(t.element());G(e,(function(e){t.getByDom(e).each(Em)})),mu(t.element())},jm=function(t,e,n,r){n.get().each((function(e){Mm(t)}));var o=e.getAttachPoint(t);Bm(o,t);var i=t.getSystem().build(r);return Bm(t,i),n.set(i),i},Vm=function(t,e,n,r){var o=jm(t,e,n,r);return e.onOpen(t,o),o},Um=function(t,e,n,r){return n.get().map((function(){return jm(t,e,n,r)}))},Wm=function(t,e,n,r,o){Jm(t,e),Vm(t,e,n,r),o(),Zm(t,e)},Gm=function(t,e,n){n.get().each((function(r){Mm(t),Pm(t),e.onClose(t,r),n.clear()}))},qm=function(t,e,n){return n.isOpen()},Xm=function(t,e,n,r){return qm(t,e,n)&&n.get().exists((function(n){return e.isPartOf(t,n,r)}))},$m=function(t,e,n){return n.get()},Ym=function(t,e,n,r){Ga(t.element(),e).fold((function(){Su(t.element(),n)}),(function(e){yu(t.element(),n,e)})),za(t.element(),e,r)},Km=function(t,e,n){if(Cu(t.element(),n)){var r=xu(t.element(),n);za(t.element(),e,r)}else Xa(t.element(),e)},Jm=function(t,e,n){var r=e.getAttachPoint(t);za(t.element(),"position",Tm.getMode(r)),Ym(t,"visibility",e.cloakVisibilityAttr,"hidden")},Qm=function(t){return j(["top","left","right","bottom"],(function(e){return Ga(t,e).isSome()}))},Zm=function(t,e,n){Qm(t.element())||Xa(t.element(),"position"),Km(t,"visibility",e.cloakVisibilityAttr)},tg=Object.freeze({cloak:Jm,decloak:Zm,open:Vm,openWhileCloaked:Wm,close:Gm,isOpen:qm,isPartOf:Xm,getState:$m,setContent:Um}),eg=function(t,e){return ki([Di(Vo(),(function(n,r){Gm(n,t,e)}))])},ng=Object.freeze({events:eg}),rg=[ys("onOpen"),ys("onClose"),gn("isPartOf"),gn("getAttachPoint"),In("cloakVisibilityAttr","data-precloak-visibility")],og=function(){var t=Wn(x.none()),e=i("not-implemented"),n=function(){return t.get().isSome()},r=function(e){t.set(x.some(e))},o=function(e){return t.get()},u=function(){t.set(x.none())};return Zu({readState:e,isOpen:n,clear:u,set:r,get:o})},ig=Object.freeze({init:og}),ug=gl({fields:rg,name:"sandboxing",active:ng,apis:tg,state:ig}),ag=i("dismiss.popups"),cg=i("reposition.popups"),sg=i("mouse.released"),lg=Pe([In("isExtraPart",i(!1)),Rn("fireEventInstead",[In("event",Jo())])]),fg=function(t){var e,n=tn("Dismissal",lg,t);return e={},e[ag()]={schema:Pe([gn("target")]),onReceive:function(t,e){if(ug.isOpen(t)){var r=ug.isPartOf(t,e.target)||n.isExtraPart(t,e.target);r||n.fireEventInstead.fold((function(){return ug.close(t)}),(function(e){return ii(t,e.event)}))}}},e},dg=Pe([In("isExtraPart",i(!1)),Rn("fireEventInstead",[In("event",Qo())]),wn("doReposition")]),mg=function(t){var e,n=tn("Reposition",dg,t);return e={},e[cg()]={onReceive:function(t){ug.isOpen(t)&&n.fireEventInstead.fold((function(){return n.doReposition(t)}),(function(e){return ii(t,e.event)}))}},e},gg=function(t,e,n){e.store.manager.onLoad(t,e,n)},pg=function(t,e,n){e.store.manager.onUnload(t,e,n)},hg=function(t,e,n,r){e.store.manager.setValue(t,e,n,r)},vg=function(t,e,n){return e.store.manager.getValue(t,e,n)},bg=function(t,e,n){return n},yg=Object.freeze({onLoad:gg,onUnload:pg,setValue:hg,getValue:vg,getState:bg}),wg=function(t,e){var n=t.resetOnDom?[Li((function(n,r){gg(n,t,e)})),Hi((function(n,r){pg(n,t,e)}))]:[ul(t,e,gg)];return ki(n)},xg=Object.freeze({events:wg}),Cg=function(){var t=Wn(null),e=function(){return{mode:"memory",value:t.get()}},n=function(){return null===t.get()},r=function(){t.set(null)};return Zu({set:t.set,get:t.get,isNotSet:n,clear:r,readState:e})},Sg=function(){var t=function(){};return Zu({readState:t})},kg=function(){var t=Wn({}),e=Wn({}),n=function(){return{mode:"dataset",dataByValue:t.get(),dataByText:e.get()}},r=function(){t.set({}),e.set({})},o=function(n){return qt(t.get(),n).orThunk((function(){return qt(e.get(),n)}))},i=function(n){var r=t.get(),o=e.get(),i={},u={};G(n,(function(t){i[t.value]=t,qt(t,"meta").each((function(e){qt(e,"text").each((function(e){u[e]=t}))}))})),t.set(m(m({},r),i)),e.set(m(m({},o),u))};return Zu({readState:n,lookup:o,update:i,clear:r})},Og=function(t){return t.store.manager.state(t)},Tg=Object.freeze({memory:Cg,dataset:kg,manual:Sg,init:Og}),Eg=function(t,e,n,r){var o=e.store;n.update([r]),o.setValue(t,r),e.onSetValue(t,r)},Dg=function(t,e,n){var r=e.store,o=r.getDataKey(t);return n.lookup(o).fold((function(){return r.getFallbackEntry(o)}),(function(t){return t}))},Ag=function(t,e,n){var r=e.store;r.initialValue.each((function(r){Eg(t,e,n,r)}))},_g=function(t,e,n){n.clear()},Rg=[On("initialValue"),gn("getFallbackEntry"),gn("getDataKey"),gn("setValue"),Ss("manager",{setValue:Eg,getValue:Dg,onLoad:Ag,onUnload:_g,state:kg})],Bg=function(t,e,n){return e.store.getValue(t)},Ig=function(t,e,n,r){e.store.setValue(t,r),e.onSetValue(t,r)},Ng=function(t,e,n){e.store.initialValue.each((function(n){e.store.setValue(t,n)}))},Pg=[gn("getValue"),In("setValue",n),On("initialValue"),Ss("manager",{setValue:Ig,getValue:Bg,onLoad:Ng,onUnload:n,state:Qu.init})],Mg=function(t,e,n,r){n.set(r),e.onSetValue(t,r)},Fg=function(t,e,n){return n.get()},Lg=function(t,e,n){e.store.initialValue.each((function(t){n.isNotSet()&&n.set(t)}))},Hg=function(t,e,n){n.clear()},zg=[On("initialValue"),Ss("manager",{setValue:Mg,getValue:Fg,onLoad:Lg,onUnload:Hg,state:Cg})],jg=[Nn("store",{mode:"memory"},rn("mode",{memory:zg,manual:Pg,dataset:Rg})),ys("onSetValue"),In("resetOnDom",!1)],Vg=gl({fields:jg,name:"representing",active:xg,apis:yg,extra:{setValueFrom:function(t,e){var n=Vg.getValue(e);Vg.setValue(t,n)}},state:Tg}),Ug=function(t,e){return Vn(t,{},W(e,(function(e){return xn(e.name(),"Cannot configure "+e.name()+" for "+t)})).concat([Un("dump",u)]))},Wg=function(t){return t.dump},Gg=function(t,e){return m(m({},t.dump),dl(e))},qg={field:Ug,augment:Gg,get:Wg},Xg="placeholder",$g=wt.generate([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Yg=function(t,e,n,r){return t.exists((function(t){return t!==n.owner}))?$g.single(!0,i(n)):qt(r,n.name).fold((function(){throw new Error("Unknown placeholder component: "+n.name+"\nKnown: ["+st(r)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(n,null,2))}),(function(t){return t.replace()}))},Kg=function(t,e,n,r){return n.uiType===Xg?Yg(t,e,n,r):$g.single(!1,i(n))},Jg=function(t,e,n,r){var o=Kg(t,e,n,r);return o.fold((function(o,i){var u=i(e,n.config,n.validated),a=qt(u,"components").getOr([]),c=tt(a,(function(n){return Jg(t,e,n,r)}));return[m(m({},u),{components:c})]}),(function(t,r){var o=r(e,n.config,n.validated),i=n.validated.preprocess.getOr(u);return i(o)}))},Qg=function(t,e,n,r){return tt(n,(function(n){return Jg(t,e,n,r)}))},Zg=function(t,e){var n=!1,r=function(){return n},o=function(){if(!0===n)throw new Error("Trying to use the same placeholder more than once: "+t);return n=!0,e},u=function(){return e.fold((function(t,e){return t}),(function(t,e){return t}))};return{name:i(t),required:u,used:r,replace:o}},tp=function(t,e,n,r){var o=dt(r,(function(t,e){return Zg(e,t)})),i=Qg(t,e,n,o);return ft(o,(function(n){if(!1===n.used()&&n.required())throw new Error("Placeholder: "+n.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(e.components,null,2))})),i},ep=$g.single,np=$g.multiple,rp=i(Xg),op=wt.generate([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),ip=In("factory",{sketch:u}),up=In("schema",[]),ap=gn("name"),cp=Ve("pname","pname",It((function(t){return"<alloy."+Bu(t.name)+">"})),on()),sp=Un("schema",(function(){return[On("preprocess")]})),lp=In("defaults",i({})),fp=In("overrides",i({})),dp=Me([ip,up,ap,cp,lp,fp]),mp=Me([ip,up,ap,lp,fp]),gp=Me([ip,up,ap,cp,lp,fp]),pp=Me([ip,sp,ap,gn("unit"),cp,lp,fp]),hp=function(t){return t.fold(x.some,x.none,x.some,x.some)},vp=function(t){var e=function(t){return t.name};return t.fold(e,e,e,e)},bp=function(t){return t.fold(u,u,u,u)},yp=function(t,e){return function(n){var r=tn("Converting part type",e,n);return t(r)}},wp=yp(op.required,dp),xp=yp(op.external,mp),Cp=yp(op.optional,gp),Sp=yp(op.group,pp),kp=i("entirety"),Op=Object.freeze({required:wp,external:xp,optional:Cp,group:Sp,asNamedPart:hp,name:vp,asCommon:bp,original:kp}),Tp=function(t,e,n,r){return Ot(e.defaults(t,n,r),n,{uid:t.partUids[e.name]},e.overrides(t,n,r))},Ep=function(t,e,n){var r={},o={};return G(n,(function(t){t.fold((function(t){r[t.pname]=ep(!0,(function(e,n,r){return t.factory.sketch(Tp(e,t,n,r))}))}),(function(t){var n=e.parts[t.name];o[t.name]=i(t.factory.sketch(Tp(e,t,n[kp()]),n))}),(function(t){r[t.pname]=ep(!1,(function(e,n,r){return t.factory.sketch(Tp(e,t,n,r))}))}),(function(t){r[t.pname]=np(!0,(function(e,n,r){var o=e[t.name];return W(o,(function(n){return t.factory.sketch(Ot(t.defaults(e,n,r),n,t.overrides(e,n)))}))}))}))})),{internals:i(r),externals:i(o)}},Dp=function(t,e){var n={};return G(e,(function(e){hp(e).each((function(e){var r=Ap(t,e.pname);n[e.name]=function(n){var o=tn("Part: "+e.name+" in "+t,Me(e.schema),n);return m(m({},r),{config:n,validated:o})}}))})),n},Ap=function(t,e){return{uiType:rp(),owner:t,name:e}},_p=function(t,e,n){return{uiType:rp(),owner:t,name:e,config:n,validated:{}}},Rp=function(t){return tt(t,(function(t){return t.fold(x.none,x.some,x.none,x.none).map((function(t){return Cn(t.name,t.schema.concat([ks(kp())]))})).toArray()}))},Bp=function(t){return W(t,vp)},Ip=function(t,e,n){return Ep(t,e,n)},Np=function(t,e,n){return tp(x.some(t),e,e.components,n)},Pp=function(t,e,n){var r=e.partUids[n];return t.getSystem().getByUid(r).toOption()},Mp=function(t,e,n){return Pp(t,e,n).getOrDie("Could not find part: "+n)},Fp=function(t,e,n){var r={},o=e.partUids,u=t.getSystem();return G(n,(function(t){r[t]=i(u.getByUid(o[t]))})),r},Lp=function(t,e){var n=t.getSystem();return dt(e.partUids,(function(t,e){return i(n.getByUid(t))}))},Hp=function(t){return st(t.partUids)},zp=function(t,e,n){var r={},o=e.partUids,u=t.getSystem();return G(n,(function(t){r[t]=i(u.getByUid(o[t]).getOrDie())})),r},jp=function(t,e){var n=Bp(e);return $t(W(n,(function(e){return{key:e,value:t+"-"+e}})))},Vp=function(t){return Ve("partUids","partUids",Nt((function(e){return jp(e.uid,t)})),on())},Up=Object.freeze({generate:Dp,generateOne:_p,schemas:Rp,names:Bp,substitutes:Ip,components:Np,defaultUids:jp,defaultUidsSchema:Vp,getAllParts:Lp,getAllPartNames:Hp,getPart:Pp,getPartOrDie:Mp,getParts:Fp,getPartsOrDie:zp}),Wp=function(t,e){var n=t.length>0?[Cn("parts",t)]:[];return n.concat([gn("uid"),In("dom",{}),In("components",[]),ks("originalSpec"),In("debug.sketcher",{})]).concat(e)},Gp=function(t,e,n,r,o){var i=Wp(r,o);return tn(t+" [SpecSchema]",Pe(i.concat(e)),n)},qp=function(t,e,n,r){var o=$p(r),i=Gp(t,e,o,[],[]);return n(i,o)},Xp=function(t,e,n,r,o){var i=$p(o),u=Rp(n),a=Vp(n),c=Gp(t,e,i,u,[a]),s=Ip(t,c,n),l=Np(t,c,s.internals());return r(c,l,i,s.externals())},$p=function(t){return t.hasOwnProperty("uid")?t:m(m({},t),{uid:zu("uid")})};function Yp(t){return void 0!==t.uid}var Kp,Jp=Pe([gn("name"),gn("factory"),gn("configFields"),In("apis",{}),In("extraApis",{})]),Qp=Pe([gn("name"),gn("factory"),gn("configFields"),gn("partFields"),In("apis",{}),In("extraApis",{})]),Zp=function(t){var e=tn("Sketcher for "+t.name,Jp,t),n=function(t){return qp(e.name,e.configFields,e.factory,t)},r=dt(e.apis,Ju),o=dt(e.extraApis,(function(t,e){return qu(t,e)}));return m(m({name:i(e.name),partFields:i([]),configFields:i(e.configFields),sketch:n},r),o)},th=function(t){var e=tn("Sketcher for "+t.name,Qp,t),n=function(t){return Xp(e.name,e.configFields,e.partFields,e.factory,t)},r=Dp(e.name,e.partFields),o=dt(e.apis,Ju),u=dt(e.extraApis,(function(t,e){return qu(t,e)}));return m(m({name:i(e.name),partFields:i(e.partFields),configFields:i(e.configFields),sketch:n,parts:i(r)},o),u)},eh=function(t){return"input"===di(t)&&"radio"!==xu(t,"type")||"textarea"===di(t)},nh=function(t,e,n){return e.find(t)},rh=Object.freeze({getCurrent:nh}),oh=[gn("find")],ih=gl({fields:oh,name:"composing",apis:rh}),uh=function(t,e,n,r){var o=cd(t.element(),"."+e.highlightClass);G(o,(function(n){j(r,(function(t){return t.element()===n}))||(Ia(n,e.highlightClass),t.getSystem().getByDom(n).each((function(n){e.onDehighlight(t,n),ii(n,oi())})))}))},ah=function(t,e,n){return uh(t,e,n,[])},ch=function(t,e,n,r){gh(t,e,n,r)&&(Ia(r.element(),e.highlightClass),e.onDehighlight(t,r),ii(r,oi()))},sh=function(t,e,n,r){uh(t,e,n,[r]),gh(t,e,n,r)||(Ra(r.element(),e.highlightClass),e.onHighlight(t,r),ii(r,ri()))},lh=function(t,e,n){vh(t,e).each((function(r){sh(t,e,n,r)}))},fh=function(t,e,n){bh(t,e).each((function(r){sh(t,e,n,r)}))},dh=function(t,e,n,r){hh(t,e,n,r).fold((function(t){throw new Error(t)}),(function(r){sh(t,e,n,r)}))},mh=function(t,e,n,r){var o=Ch(t,e),i=J(o,r);i.each((function(r){sh(t,e,n,r)}))},gh=function(t,e,n,r){return Na(r.element(),e.highlightClass)},ph=function(t,e,n){return Gc(t.element(),"."+e.highlightClass).bind((function(e){return t.getSystem().getByDom(e).toOption()}))},hh=function(t,e,n,r){var o=cd(t.element(),"."+e.itemClass);return x.from(o[r]).fold((function(){return O.error("No element found with index "+r)}),t.getSystem().getByDom)},vh=function(t,e,n){return Gc(t.element(),"."+e.itemClass).bind((function(e){return t.getSystem().getByDom(e).toOption()}))},bh=function(t,e,n){var r=cd(t.element(),"."+e.itemClass),o=r.length>0?x.some(r[r.length-1]):x.none();return o.bind((function(e){return t.getSystem().getByDom(e).toOption()}))},yh=function(t,e,n,r){var o=cd(t.element(),"."+e.itemClass),i=Q(o,(function(t){return Na(t,e.highlightClass)}));return i.bind((function(e){var n=Qd(e,r,0,o.length-1);return t.getSystem().getByDom(o[n]).toOption()}))},wh=function(t,e,n){return yh(t,e,n,-1)},xh=function(t,e,n){return yh(t,e,n,1)},Ch=function(t,e,n){var r=cd(t.element(),"."+e.itemClass);return Jc(W(r,(function(e){return t.getSystem().getByDom(e).toOption()})))},Sh=Object.freeze({dehighlightAll:ah,dehighlight:ch,highlight:sh,highlightFirst:lh,highlightLast:fh,highlightAt:dh,highlightBy:mh,isHighlighted:gh,getHighlighted:ph,getFirst:vh,getLast:bh,getPrevious:wh,getNext:xh,getCandidates:Ch}),kh=[gn("highlightClass"),gn("itemClass"),ys("onHighlight"),ys("onDehighlight")],Oh=gl({fields:kh,name:"highlighting",apis:Sh}),Th=function(){return[8]},Eh=function(){return[9]},Dh=function(){return[13]},Ah=function(){return[27]},_h=function(){return[32]},Rh=function(){return[37]},Bh=function(){return[38]},Ih=function(){return[39]},Nh=function(){return[40]},Ph=function(t,e,n){var r=nt(t.slice(0,e)),o=nt(t.slice(e+1));return J(r.concat(o),n)},Mh=function(t,e,n){var r=nt(t.slice(0,e));return J(r,n)},Fh=function(t,e,n){var r=t.slice(0,e),o=t.slice(e+1);return J(o.concat(r),n)},Lh=function(t,e,n){var r=t.slice(e+1);return J(r,n)},Hh=function(t){return function(e){var n=e.raw();return z(t,n.which)}},zh=function(t){return function(e){return et(t,(function(t){return t(e)}))}},jh=function(t){var e=t.raw();return!0===e.shiftKey},Vh=function(t){var e=t.raw();return!0===e.ctrlKey},Uh=c(jh),Wh=function(t,e){return{matches:t,classification:e}},Gh=function(t,e){var n=J(t,(function(t){return t.matches(e)}));return n.map((function(t){return t.classification}))},qh=function(t,e,n){var r=e.exists((function(t){return n.exists((function(e){return no(e,t)}))}));r||ui(t,Zo(),{prevFocus:e,newFocus:n})},Xh=function(){var t=function(t){return Al(t.element())},e=function(e,n){var r=t(e);e.getSystem().triggerFocus(n,e.element());var o=t(e);qh(e,r,o)};return{get:t,set:e}},$h=function(){var t=function(t){return Oh.getHighlighted(t).map((function(t){return t.element()}))},e=function(e,r){var o=t(e);e.getSystem().getByDom(r).fold(n,(function(t){Oh.highlight(e,t)}));var i=t(e);qh(e,o,i)};return{get:t,set:e}};(function(t){t["OnFocusMode"]="onFocus",t["OnEnterOrSpaceMode"]="onEnterOrSpace",t["OnApiMode"]="onApi"})(Kp||(Kp={}));var Yh=function(t,e,n,r,o){var i=function(){return t.concat([In("focusManager",Xh()),Nn("focusInside","onFocus",Ye((function(t){return z(["onFocus","onEnterOrSpace","onApi"],t)?O.value(t):O.error("Invalid value for focusInside")}))),Ss("handler",c),Ss("state",e),Ss("sendFocusIn",o)])},u=function(t,e,n,r,o){var i=n(t,e,r,o);return Gh(i,e.event()).bind((function(n){return n(t,e,r,o)}))},a=function(t,e){var i=t.focusInside!==Kp.OnFocusMode?x.none():o(t).map((function(n){return Di(Io(),(function(r,o){n(r,t,e),o.stop()}))})),a=function(n,r){var i=Hh(_h().concat(Dh()))(r.event());t.focusInside===Kp.OnEnterOrSpaceMode&&i&&ao(n,r)&&o(t).each((function(o){o(n,t,e),r.stop()}))};return ki(i.toArray().concat([Di(Oo(),(function(r,o){u(r,o,n,t,e).fold((function(){a(r,o)}),(function(t){o.stop()}))})),Di(To(),(function(n,o){u(n,o,r,t,e).each((function(t){o.stop()}))}))]))},c={schema:i,processKey:u,toEvents:a};return c},Kh=function(t){var e=[On("onEscape"),On("onEnter"),In("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),In("firstTabstop",0),In("useTabstopAt",i(!0)),On("visibilitySelector")].concat([t]),n=function(t,e){var n=t.visibilitySelector.bind((function(t){return qc(e,t)})).getOr(e);return gc(n)>0},r=function(t,e){var r=cd(t.element(),e.selector),o=$(r,(function(t){return n(e,t)}));return x.from(o[e.firstTabstop])},o=function(t,e){return e.focusManager.get(t).bind((function(t){return qc(t,e.selector)}))},u=function(t,e){return n(t,e)&&t.useTabstopAt(e)},c=function(t,e){r(t,e).each((function(n){e.focusManager.set(t,n)}))},s=function(t,e,n,r,o){return o(e,n,(function(t){return u(r,t)})).fold((function(){return r.cyclic?x.some(!0):x.none()}),(function(e){return r.focusManager.set(t,e),x.some(!0)}))},l=function(t,e,n,r){var i=cd(t.element(),n.selector);return o(t,n).bind((function(e){var o=Q(i,a(no,e));return o.bind((function(e){return s(t,i,e,n,r)}))}))},f=function(t,e,n,r){var o=n.cyclic?Ph:Mh;return l(t,e,n,o)},d=function(t,e,n,r){var o=n.cyclic?Fh:Lh;return l(t,e,n,o)},m=function(t,e,n,r){return n.onEnter.bind((function(n){return n(t,e)}))},g=function(t,e,n,r){return n.onEscape.bind((function(n){return n(t,e)}))},p=i([Wh(zh([jh,Hh(Eh())]),f),Wh(Hh(Eh()),d),Wh(Hh(Ah()),g),Wh(zh([Uh,Hh(Dh())]),m)]),h=i([]);return Yh(e,Qu.init,p,h,(function(){return x.some(c)}))},Jh=Kh(Un("cyclic",i(!1))),Qh=Kh(Un("cyclic",i(!0))),Zh=function(t,e,n){return ci(t,n,Fo()),x.some(!0)},tv=function(t,e,n){return eh(n)&&Hh(_h())(e.event())?x.none():Zh(t,e,n)},ev=function(t,e){return x.some(!0)},nv=[In("execute",tv),In("useSpace",!1),In("useEnter",!0),In("useControlEnter",!1),In("useDown",!1)],rv=function(t,e,n){return n.execute(t,e,t.element())},ov=function(t,e,n,r){var o=n.useSpace&&!eh(t.element())?_h():[],i=n.useEnter?Dh():[],u=n.useDown?Nh():[],a=o.concat(i).concat(u);return[Wh(Hh(a),rv)].concat(n.useControlEnter?[Wh(zh([Vh,Hh(Dh())]),rv)]:[])},iv=function(t,e,n,r){return n.useSpace&&!eh(t.element())?[Wh(Hh(_h()),ev)]:[]},uv=Yh(nv,Qu.init,ov,iv,(function(){return x.none()})),av=function(t){var e=Wn(x.none()),n=function(t,n){e.set(x.some({numRows:i(t),numColumns:i(n)}))},r=function(){return e.get().map((function(t){return t.numRows()}))},o=function(){return e.get().map((function(t){return t.numColumns()}))};return Zu({readState:function(){return e.get().map((function(t){return{numRows:t.numRows(),numColumns:t.numColumns()}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:n,getNumRows:r,getNumColumns:o})},cv=function(t){return t.state(t)},sv=Object.freeze({flatgrid:av,init:cv}),lv=function(t){return function(e,n,r,o){var i=t(e.element());return gv(i,e,n,r,o)}},fv=function(t,e){var n=ql(t,e);return lv(n)},dv=function(t,e){var n=ql(e,t);return lv(n)},mv=function(t){return function(e,n,r,o){return gv(t,e,n,r,o)}},gv=function(t,e,n,r,o){var i=r.focusManager.get(e).bind((function(n){return t(e.element(),n,r,o)}));return i.map((function(t){return r.focusManager.set(e,t),!0}))},pv=mv,hv=mv,vv=mv,bv=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},yv=function(t){var e=t.dom();return!bv(e)},wv=$i(["index","candidates"],[]),xv=function(t,e){return Q(t,e).map((function(e){return wv({index:e,candidates:t})}))},Cv=function(t,e,n){var r=a(no,e),o=cd(t,n),i=$(o,yv);return xv(i,r)},Sv=function(t,e){return Q(t,(function(t){return no(e,t)}))},kv=function(t,e,n,r){var o=Math.floor(e/n),i=e%n;return r(o,i).bind((function(e){var r=e.row()*n+e.column();return r>=0&&r<t.length?x.some(t[r]):x.none()}))},Ov=function(t,e,n,r,o){return kv(t,e,r,(function(e,u){var a=e===n-1,c=a?t.length-e*r:r,s=Qd(u,o,0,c-1);return x.some({row:i(e),column:i(s)})}))},Tv=function(t,e,n,r,o){return kv(t,e,r,(function(e,u){var a=Qd(e,o,0,n-1),c=a===n-1,s=c?t.length-a*r:r,l=Zd(u,0,s-1);return x.some({row:i(a),column:i(l)})}))},Ev=function(t,e,n,r){return Ov(t,e,n,r,1)},Dv=function(t,e,n,r){return Ov(t,e,n,r,-1)},Av=function(t,e,n,r){return Tv(t,e,n,r,-1)},_v=function(t,e,n,r){return Tv(t,e,n,r,1)},Rv=[gn("selector"),In("execute",tv),ws("onEscape"),In("captureTab",!1),Os()],Bv=function(t,e,n){Gc(t.element(),e.selector).each((function(n){e.focusManager.set(t,n)}))},Iv=function(t,e){return e.focusManager.get(t).bind((function(t){return qc(t,e.selector)}))},Nv=function(t,e,n,r){return Iv(t,n).bind((function(r){return n.execute(t,e,r)}))},Pv=function(t){return function(e,n,r,o){return Cv(e,n,r.selector).bind((function(e){return t(e.candidates(),e.index(),o.getNumRows().getOr(r.initSize.numRows),o.getNumColumns().getOr(r.initSize.numColumns))}))}},Mv=function(t,e,n,r){return n.captureTab?x.some(!0):x.none()},Fv=function(t,e,n,r){return n.onEscape(t,e)},Lv=Pv(Dv),Hv=Pv(Ev),zv=Pv(Av),jv=Pv(_v),Vv=i([Wh(Hh(Rh()),fv(Lv,Hv)),Wh(Hh(Ih()),dv(Lv,Hv)),Wh(Hh(Bh()),pv(zv)),Wh(Hh(Nh()),hv(jv)),Wh(zh([jh,Hh(Eh())]),Mv),Wh(zh([Uh,Hh(Eh())]),Mv),Wh(Hh(Ah()),Fv),Wh(Hh(_h().concat(Dh())),Nv)]),Uv=i([Wh(Hh(_h()),ev)]),Wv=Yh(Rv,av,Vv,Uv,(function(){return x.some(Bv)})),Gv=function(t,e,n,r){var o=function(t){return"button"===di(t)&&"disabled"===xu(t,"disabled")},i=function(t,e,n){var u=Qd(e,r,0,n.length-1);return u===t?x.none():o(n[u])?i(t,u,n):x.from(n[u])};return Cv(t,n,e).bind((function(t){var e=t.index(),n=t.candidates();return i(e,e,n)}))},qv=[gn("selector"),In("getInitial",x.none),In("execute",tv),ws("onEscape"),In("executeOnMove",!1),In("allowVertical",!0)],Xv=function(t,e){return e.focusManager.get(t).bind((function(t){return qc(t,e.selector)}))},$v=function(t,e,n){return Xv(t,n).bind((function(r){return n.execute(t,e,r)}))},Yv=function(t,e){e.getInitial(t).orThunk((function(){return Gc(t.element(),e.selector)})).each((function(n){e.focusManager.set(t,n)}))},Kv=function(t,e,n){return Gv(t,n.selector,e,-1)},Jv=function(t,e,n){return Gv(t,n.selector,e,1)},Qv=function(t){return function(e,n,r){return t(e,n,r).bind((function(){return r.executeOnMove?$v(e,n,r):x.some(!0)}))}},Zv=function(t,e,n,r){return n.onEscape(t,e)},tb=function(t,e,n,r){var o=Rh().concat(n.allowVertical?Bh():[]),i=Ih().concat(n.allowVertical?Nh():[]);return[Wh(Hh(o),Qv(fv(Kv,Jv))),Wh(Hh(i),Qv(dv(Kv,Jv))),Wh(Hh(Dh()),$v),Wh(Hh(_h()),$v),Wh(Hh(Ah()),Zv)]},eb=i([Wh(Hh(_h()),ev)]),nb=Yh(qv,Qu.init,tb,eb,(function(){return x.some(Yv)})),rb=$i(["rowIndex","columnIndex","cell"],[]),ob=function(t,e,n){return x.from(t[e]).bind((function(t){return x.from(t[n]).map((function(t){return rb({rowIndex:e,columnIndex:n,cell:t})}))}))},ib=function(t,e,n,r){var o=t[e],i=o.length,u=Qd(n,r,0,i-1);return ob(t,e,u)},ub=function(t,e,n,r){var o=Qd(n,r,0,t.length-1),i=t[o].length,u=Zd(e,0,i-1);return ob(t,o,u)},ab=function(t,e,n,r){var o=t[e],i=o.length,u=Zd(n+r,0,i-1);return ob(t,e,u)},cb=function(t,e,n,r){var o=Zd(n+r,0,t.length-1),i=t[o].length,u=Zd(e,0,i-1);return ob(t,o,u)},sb=function(t,e,n){return ib(t,e,n,1)},lb=function(t,e,n){return ib(t,e,n,-1)},fb=function(t,e,n){return ub(t,n,e,-1)},db=function(t,e,n){return ub(t,n,e,1)},mb=function(t,e,n){return ab(t,e,n,-1)},gb=function(t,e,n){return ab(t,e,n,1)},pb=function(t,e,n){return cb(t,n,e,-1)},hb=function(t,e,n){return cb(t,n,e,1)},vb=[Cn("selectors",[gn("row"),gn("cell")]),In("cycles",!0),In("previousSelector",x.none),In("execute",tv)],bb=function(t,e){var n=e.previousSelector(t).orThunk((function(){var n=e.selectors;return Gc(t.element(),n.cell)}));n.each((function(n){e.focusManager.set(t,n)}))},yb=function(t,e,n){return Al(t.element()).bind((function(r){return n.execute(t,e,r)}))},wb=function(t,e){return W(t,(function(t){return cd(t,e.selectors.cell)}))},xb=function(t,e){return function(n,r,o){var i=o.cycles?t:e;return qc(r,o.selectors.row).bind((function(t){var e=cd(t,o.selectors.cell);return Sv(e,r).bind((function(e){var r=cd(n,o.selectors.row);return Sv(r,t).bind((function(t){var n=wb(r,o);return i(n,t,e).map((function(t){return t.cell()}))}))}))}))}},Cb=xb(lb,mb),Sb=xb(sb,gb),kb=xb(fb,pb),Ob=xb(db,hb),Tb=i([Wh(Hh(Rh()),fv(Cb,Sb)),Wh(Hh(Ih()),dv(Cb,Sb)),Wh(Hh(Bh()),pv(kb)),Wh(Hh(Nh()),hv(Ob)),Wh(Hh(_h().concat(Dh())),yb)]),Eb=i([Wh(Hh(_h()),ev)]),Db=Yh(vb,Qu.init,Tb,Eb,(function(){return x.some(bb)})),Ab=[gn("selector"),In("execute",tv),In("moveOnTab",!1)],_b=function(t,e,n){return n.focusManager.get(t).bind((function(r){return n.execute(t,e,r)}))},Rb=function(t,e){Gc(t.element(),e.selector).each((function(n){e.focusManager.set(t,n)}))},Bb=function(t,e,n){return Gv(t,n.selector,e,-1)},Ib=function(t,e,n){return Gv(t,n.selector,e,1)},Nb=function(t,e,n){return n.moveOnTab?vv(Bb)(t,e,n):x.none()},Pb=function(t,e,n){return n.moveOnTab?vv(Ib)(t,e,n):x.none()},Mb=i([Wh(Hh(Bh()),vv(Bb)),Wh(Hh(Nh()),vv(Ib)),Wh(zh([jh,Hh(Eh())]),Nb),Wh(zh([Uh,Hh(Eh())]),Pb),Wh(Hh(Dh()),_b),Wh(Hh(_h()),_b)]),Fb=i([Wh(Hh(_h()),ev)]),Lb=Yh(Ab,Qu.init,Mb,Fb,(function(){return x.some(Rb)})),Hb=[ws("onSpace"),ws("onEnter"),ws("onShiftEnter"),ws("onLeft"),ws("onRight"),ws("onTab"),ws("onShiftTab"),ws("onUp"),ws("onDown"),ws("onEscape"),In("stopSpaceKeyup",!1),On("focusIn")],zb=function(t,e,n){return[Wh(Hh(_h()),n.onSpace),Wh(zh([Uh,Hh(Dh())]),n.onEnter),Wh(zh([jh,Hh(Dh())]),n.onShiftEnter),Wh(zh([jh,Hh(Eh())]),n.onShiftTab),Wh(zh([Uh,Hh(Eh())]),n.onTab),Wh(Hh(Bh()),n.onUp),Wh(Hh(Nh()),n.onDown),Wh(Hh(Rh()),n.onLeft),Wh(Hh(Ih()),n.onRight),Wh(Hh(_h()),n.onSpace),Wh(Hh(Ah()),n.onEscape)]},jb=function(t,e,n){return n.stopSpaceKeyup?[Wh(Hh(_h()),ev)]:[]},Vb=Yh(Hb,Qu.init,zb,jb,(function(t){return t.focusIn})),Ub=Jh.schema(),Wb=Qh.schema(),Gb=nb.schema(),qb=Wv.schema(),Xb=Db.schema(),$b=uv.schema(),Yb=Lb.schema(),Kb=Vb.schema(),Jb=Object.freeze({acyclic:Ub,cyclic:Wb,flow:Gb,flatgrid:qb,matrix:Xb,execution:$b,menu:Yb,special:Kb}),Qb=hl({branchKey:"mode",branches:Jb,name:"keying",active:{events:function(t,e){var n=t.handler;return n.toEvents(t,e)}},apis:{focusIn:function(t,e,n){e.sendFocusIn(e).fold((function(){t.getSystem().triggerFocus(t.element(),t.element())}),(function(r){r(t,e,n)}))},setGridSize:function(t,n,r,o,i){Qt(r,"setGridSize")?r.setGridSize(o,i):e.console.error("Layout does not support setGridSize")}},state:sv}),Zb=function(t,e,n,r){_l((function(){var e=W(r,t.getSystem().build);Rm(t,e)}),t.element())},ty=function(t,e,n,r){var o=t.getSystem().build(r);Im(t,o,n)},ey=function(t,e,n,r){ty(t,e,cu,r)},ny=function(t,e,n,r){ty(t,e,au,r)},ry=function(t,e,n,r){var o=oy(t),i=J(o,(function(t){return no(r.element(),t.element())}));i.each(Pm)},oy=function(t,e){return t.components()},iy=function(t,e,n,r,o){var i=oy(t);return x.from(i[r]).map((function(i){return ry(t,e,n,i),o.each((function(n){ty(t,e,(function(t,e){su(t,e,r)}),n)})),i}))},uy=function(t,e,n,r,o){var i=oy(t);return Q(i,r).bind((function(r){return iy(t,e,n,r,o)}))},ay=Object.freeze({append:ey,prepend:ny,remove:ry,replaceAt:iy,replaceBy:uy,set:Zb,contents:oy}),cy=gl({fields:[],name:"replacing",apis:ay}),sy=function(t,e){var n=ki(e);return gl({fields:[gn("enabled")],name:t,active:{events:i(n)}})},ly=function(t,e){var n=sy(t,e);return{key:t,value:{config:{},me:n,configAsRaw:i({}),initialConfig:{},state:Qu}}},fy=function(t,e){e.ignore||(Ol(t.element()),e.onFocus(t))},dy=function(t,e){e.ignore||Tl(t.element())},my=function(t){return El(t.element())},gy=Object.freeze({focus:fy,blur:dy,isFocused:my}),py=function(t,e){var n=e.ignore?{}:{attributes:{tabindex:"-1"}};return oa(n)},hy=function(t){return ki([Di(Io(),(function(e,n){fy(e,t),n.stop()}))].concat(t.stopMousedown?[Di(bo(),(function(t,e){e.event().prevent()}))]:[]))},vy=Object.freeze({exhibit:py,events:hy}),by=[ys("onFocus"),In("stopMousedown",!1),In("ignore",!1)],yy=gl({fields:by,name:"focusing",active:vy,apis:gy}),wy=function(t,e,n){var r=e.aria;r.update(t,r,n.get())},xy=function(t,e,n){e.toggleClass.each((function(e){n.get()?Ra(t.element(),e):Ia(t.element(),e)}))},Cy=function(t,e,n){Oy(t,e,n,!n.get())},Sy=function(t,e,n){n.set(!0),xy(t,e,n),wy(t,e,n)},ky=function(t,e,n){n.set(!1),xy(t,e,n),wy(t,e,n)},Oy=function(t,e,n,r){var o=r?Sy:ky;o(t,e,n)},Ty=function(t,e,n){return n.get()},Ey=function(t,e,n){Oy(t,e,n,e.selected)},Dy=Object.freeze({onLoad:Ey,toggle:Cy,isOn:Ty,on:Sy,off:ky,set:Oy}),Ay=function(t,e,n){return oa({})},_y=function(t,e){var n=il(t,e,Cy),r=ul(t,e,Ey);return ki(Z([t.toggleOnExecute?[n]:[],[r]]))},Ry=Object.freeze({exhibit:Ay,events:_y}),By=function(t){var e=function(){var e=Wn(t),n=function(){return e.get()},r=function(t){return e.set(t)},o=function(){return e.set(t)},i=function(){return e.get()};return{get:n,set:r,clear:o,readState:i}};return{init:e}},Iy=function(t,e,n){yu(t.element(),"aria-pressed",n),e.syncWithExpanded&&My(t,e,n)},Ny=function(t,e,n){yu(t.element(),"aria-selected",n)},Py=function(t,e,n){yu(t.element(),"aria-checked",n)},My=function(t,e,n){yu(t.element(),"aria-expanded",n)},Fy=[In("selected",!1),On("toggleClass"),In("toggleOnExecute",!0),Nn("aria",{mode:"none"},rn("mode",{pressed:[In("syncWithExpanded",!1),Ss("update",Iy)],checked:[Ss("update",Py)],expanded:[Ss("update",My)],selected:[Ss("update",Ny)],none:[Ss("update",n)]}))],Ly=gl({fields:Fy,name:"toggling",active:Ry,apis:Dy,state:By(!1)}),Hy=function(){return[Di(zo(),(function(t,e){e.stop(),ai(t)})),Pi(qr().deviceType.isTouch()?go():bo())]},zy=function(t){var e=function(t){return ji((function(e,n){t(e),n.stop()}))};return ki(Z([t.map(e).toArray(),Hy()]))},jy="alloy.item-hover",Vy="alloy.item-focus",Uy=function(t){(Al(t.element()).isNone()||yy.isFocused(t))&&(yy.isFocused(t)||yy.focus(t),ui(t,jy,{item:t}))},Wy=function(t){ui(t,Vy,{item:t})},Gy=i(jy),qy=i(Vy),Xy=function(t){return{dom:t.dom,domModification:m(m({},t.domModification),{attributes:m(m(m({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:qg.augment(t.itemBehaviours,[t.toggling.fold(Ly.revoke,(function(t){return Ly.config(m({aria:{mode:"checked"}},t))})),yy.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Wy(t)}}),Qb.config({mode:"execution"}),Vg.config({store:{mode:"memory",initialValue:t.data}}),ly("item-type-events",p(Hy(),[Di(Co(),Uy),Di(Lo(),yy.focus)]))]),components:t.components,eventOrder:t.eventOrder}},$y=[gn("data"),gn("components"),gn("dom"),In("hasSubmenu",!1),On("toggling"),qg.field("itemBehaviours",[Ly,yy,Qb,Vg]),In("ignoreFocus",!1),In("domModification",{}),Ss("builder",Xy),In("eventOrder",{})],Yy=function(t){return{dom:t.dom,components:t.components,events:ki([Mi(Lo())])}},Ky=[gn("dom"),gn("components"),Ss("builder",Yy)],Jy=function(){return"item-widget"},Qy=i([wp({name:"widget",overrides:function(t){return{behaviours:dl([Vg.config({store:{mode:"manual",getValue:function(e){return t.data},setValue:function(){}}})])}}})]),Zy=function(t){var e=Ip(Jy(),t,Qy()),n=Np(Jy(),t,e.internals()),r=function(e){return Pp(e,t,"widget").map((function(t){return Qb.focusIn(t),t}))},o=function(e,n){return eh(n.event().target())?x.none():function(){return t.autofocus?(n.setSource(e.element()),x.none()):x.none()}()};return{dom:t.dom,components:n,domModification:t.domModification,events:ki([ji((function(t,e){r(t).each((function(t){e.stop()}))})),Di(Co(),Uy),Di(Lo(),(function(e,n){t.autofocus?r(e):yy.focus(e)}))]),behaviours:qg.augment(t.widgetBehaviours,[Vg.config({store:{mode:"memory",initialValue:t.data}}),yy.config({ignore:t.ignoreFocus,onFocus:function(t){Wy(t)}}),Qb.config({mode:"special",focusIn:t.autofocus?function(t){r(t)}:vl(),onLeft:o,onRight:o,onEscape:function(e,n){return yy.isFocused(e)||t.autofocus?t.autofocus?(n.setSource(e.element()),x.none()):x.none():(yy.focus(e),x.some(!0))}})])}},tw=[gn("uid"),gn("data"),gn("components"),gn("dom"),In("autofocus",!1),In("ignoreFocus",!1),qg.field("widgetBehaviours",[Vg,yy,Qb]),In("domModification",{}),Vp(Qy()),Ss("builder",Zy)],ew=rn("type",{widget:tw,item:$y,separator:Ky}),nw=function(t,e){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:e.initSize.numColumns,numRows:e.initSize.numRows},focusManager:t.focusManager}},rw=function(t,e){return{mode:"matrix",selectors:{row:e.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}},ow=function(t,e){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:e.moveOnTab,focusManager:t.focusManager}},iw=i([Sp({factory:{sketch:function(t){var e=tn("menu.spec item",ew,t);return e.builder(e)}},name:"items",unit:"item",defaults:function(t,e){return e.hasOwnProperty("uid")?e:m(m({},e),{uid:zu("item")})},overrides:function(t,e){return{type:e.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),uw=i([gn("value"),gn("items"),gn("dom"),gn("components"),In("eventOrder",{}),Ug("menuBehaviours",[Oh,Vg,ih,Qb]),Nn("movement",{mode:"menu",moveOnTab:!0},rn("mode",{grid:[Os(),Ss("config",nw)],matrix:[Ss("config",rw),gn("rowSelector")],menu:[In("moveOnTab",!0),Ss("config",ow)]})),ps(),In("fakeFocus",!1),In("focusManager",Xh()),ys("onHighlight")]),aw=i("alloy.menu-focus"),cw=function(t,e,n,r){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Gg(t.menuBehaviours,[Oh.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Vg.config({store:{mode:"memory",initialValue:t.value}}),ih.config({find:x.some}),Qb.config(t.movement.config(t,t.movement))]),events:ki([Di(qy(),(function(t,e){var n=e.event();t.getSystem().getByDom(n.target()).each((function(n){Oh.highlight(t,n),e.stop(),ui(t,aw(),{menu:t,item:n})}))})),Di(Gy(),(function(t,e){var n=e.event().item();Oh.highlight(t,n)}))]),components:e,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}},sw=th({name:"Menu",configFields:uw(),partFields:iw(),factory:cw}),lw=function(t){return mt(t,(function(t,e){return{k:t,v:e}}))},fw=function(t,e,n,r){return qt(n,r).bind((function(r){return qt(t,r).bind((function(r){var o=fw(t,e,n,r);return x.some([r].concat(o))}))})).getOr([])},dw=function(t,e){var n={};ft(t,(function(t,e){G(t,(function(t){n[t]=e}))}));var r=e,o=lw(e),i=dt(o,(function(t,e){return[e].concat(fw(n,r,o,e))}));return dt(n,(function(t){return qt(i,t).getOr([t])}))},mw=function(){var t=Wn({}),e=Wn({}),n=Wn({}),r=Wn(x.none()),o=Wn({}),i=function(){t.set({}),e.set({}),n.set({}),r.set(x.none())},u=function(){return r.get().isNone()},a=function(t,n){var r;e.set(m(m({},e.get()),(r={},r[t]={type:"prepared",menu:n},r)))},c=function(i,u,a,c){r.set(x.some(i)),t.set(a),e.set(u),o.set(c);var s=dw(c,a);n.set(s)},s=function(e){return pt(t.get(),(function(t,n){return t===e}))},l=function(t,e,n){return h(t).bind((function(r){return s(t).bind((function(t){return e(t).map((function(t){return{triggeredMenu:r,triggeringItem:t,triggeringPath:n}}))}))}))},f=function(t,e){var o=$(b(t).toArray(),(function(t){return h(t).isSome()}));return qt(n.get(),t).bind((function(t){var n=nt(o.concat(t)),i=tt(n,(function(t,o){return l(t,e,n.slice(0,o+1)).fold((function(){return r.get().is(t)?[]:[x.none()]}),(function(t){return[x.some(t)]}))}));return Qc(i)}))},d=function(e){return qt(t.get(),e).map((function(t){var r=qt(n.get(),e).getOr([]);return[t].concat(r)}))},g=function(t){return qt(n.get(),t).bind((function(t){return t.length>1?x.some(t.slice(1)):x.none()}))},p=function(t){return qt(n.get(),t)},h=function(t){return v(t).bind(gw)},v=function(t){return qt(e.get(),t)},b=function(e){return qt(t.get(),e)},y=function(t){var e=o.get();return rt(st(e),t)},w=function(){return r.get().bind(h)},C=function(){return e.get()};return{setMenuBuilt:a,setContents:c,expand:d,refresh:p,collapse:g,lookupMenu:v,lookupItem:b,otherMenus:y,getPrimary:w,getMenus:C,clear:i,isClear:u,getTriggeringPath:f}},gw=function(t){return"prepared"===t.type?x.some(t.menu):x.none()},pw={init:mw,extractPreparedMenu:gw},hw=function(t,e){var n,r=Wn(x.none()),o=function(e,n,r){return dt(r,(function(r,o){var i=function(){return sw.sketch(m(m({dom:r.dom},r),{value:o,items:r.items,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?$h():Xh()}))};return o===n?{type:"prepared",menu:e.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))},i=pw.init(),u=function(e){var n=o(e,t.data.primary,t.data.menus),r=s();return i.setContents(t.data.primary,n,t.data.expansions,r),i.getPrimary()},a=function(t){return Vg.getValue(t).value},c=function(t,e,n){return Zc(e,(function(t){if(!t.getSystem().isConnected())return x.none();var e=Oh.getCandidates(t);return J(e,(function(t){return a(t)===n}))}))},s=function(e){return dt(t.data.menus,(function(t,e){return tt(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},l=function(t,e){Oh.highlight(t,e),Oh.getHighlighted(e).orThunk((function(){return Oh.getFirst(e)})).each((function(e){ci(t,e.element(),Lo())}))},f=function(t,e){return Jc(W(e,(function(e){return t.lookupMenu(e).bind((function(t){return"prepared"===t.type?x.some(t.menu):x.none()}))})))},d=function(e,n,r){var o=f(n,n.otherMenus(r));G(o,(function(n){Ma(n.element(),[t.markers.backgroundMenu]),t.stayInDom||cy.remove(e,n)}))},g=function(e){return r.get().getOrThunk((function(){var n={},o=cd(e.element(),"."+t.markers.item),i=$(o,(function(t){return"true"===xu(t,"aria-haspopup")}));return G(i,(function(t){e.getSystem().getByDom(t).each((function(t){var e=a(t);n[e]=t}))})),r.set(x.some(n)),n}))},p=function(t,e){var n=g(t);ft(n,(function(t,n){var r=z(e,n);yu(t.element(),"aria-expanded",r)}))},h=function(e,n,r){return x.from(r[0]).bind((function(o){return n.lookupMenu(o).bind((function(o){if("notbuilt"===o.type)return x.none();var i=o.menu,u=f(n,r.slice(1));return G(u,(function(e){Ra(e.element(),t.markers.backgroundMenu)})),vi(i.element())||cy.append(e,lc(i)),Ma(i.element(),[t.markers.backgroundMenu]),l(e,i),d(e,n,r),x.some(i)}))}))};(function(t){t[t["HighlightSubmenu"]=0]="HighlightSubmenu",t[t["HighlightParent"]=1]="HighlightParent"})(n||(n={}));var v=function(t,e,n){if("notbuilt"===n.type){var r=t.getSystem().build(n.nbMenu());return i.setMenuBuilt(e,r),r}return n.menu},b=function(e,r,o){void 0===o&&(o=n.HighlightSubmenu);var u=a(r);return i.expand(u).bind((function(u){return p(e,u),x.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=v(e,a,c);return vi(s.element())||cy.append(e,lc(s)),t.onOpenSubmenu(e,r,s,nt(u)),o===n.HighlightSubmenu?(Oh.highlightFirst(s),h(e,i,u)):(Oh.dehighlightAll(s),x.some(r))}))}))}))},y=function(e,n){var r=a(n);return i.collapse(r).bind((function(r){return p(e,r),h(e,i,r).map((function(r){return t.onCollapseMenu(e,n,r),r}))}))},w=function(t,e){var n=a(e);return i.refresh(n).bind((function(e){return p(t,e),h(t,i,e)}))},C=function(t,e){return eh(e.element())?x.none():b(t,e,n.HighlightSubmenu)},S=function(t,e){return eh(e.element())?x.none():y(t,e)},k=function(e,n){return y(e,n).orThunk((function(){return t.onEscape(e,n).map((function(){return e}))}))},O=function(e){return function(n,r){return qc(r.getSource(),"."+t.markers.item).bind((function(t){return n.getSystem().getByDom(t).toOption().bind((function(t){return e(n,t).map((function(){return!0}))}))}))}},T=ki([Di(aw(),(function(t,e){var n=e.event().item();i.lookupItem(a(n)).each((function(){var n=e.event().menu();Oh.highlight(t,n);var r=a(e.event().item());i.refresh(r).each((function(e){return d(t,i,e)}))}))})),ji((function(e,r){var o=r.event().target();e.getSystem().getByDom(o).each((function(r){var o=a(r);0===o.indexOf("collapse-item")&&y(e,r),b(e,r,n.HighlightSubmenu).fold((function(){t.onExecute(e,r)}),(function(){}))}))})),Li((function(e,n){u(e).each((function(n){cy.append(e,lc(n)),t.onOpenMenu(e,n),t.highlightImmediately&&l(e,n)}))}))].concat(t.navigateOnHover?[Di(Gy(),(function(e,r){var o=r.event().item();w(e,o),b(e,o,n.HighlightParent),t.onHover(e,o)}))]:[])),E=function(t){return Oh.getHighlighted(t).bind(Oh.getHighlighted)},D=function(t){E(t).each((function(e){y(t,e)}))},A=function(t){i.getPrimary().each((function(e){l(t,e)}))},_=function(t){return x.from(t.components()[0]).filter((function(t){return"menu"===xu(t.element(),"role")}))},R=function(e){var n=i.getPrimary().bind((function(t){return E(e).bind((function(t){var n=a(t),r=ht(i.getMenus()),o=Jc(W(r,pw.extractPreparedMenu));return i.getTriggeringPath(n,(function(t){return c(e,o,t)}))})).map((function(e){return{primary:t,triggeringPath:e}}))}));n.fold((function(){_(e).each((function(n){t.onRepositionMenu(e,n,[])}))}),(function(n){var r=n.primary,o=n.triggeringPath;t.onRepositionMenu(e,r,o)}))},B={collapseMenu:D,highlightPrimary:A,repositionMenus:R};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Gg(t.tmenuBehaviours,[Qb.config({mode:"special",onRight:O(C),onLeft:O(S),onEscape:O(k),focusIn:function(t,e){i.getPrimary().each((function(e){ci(t,e.element(),Lo())}))}}),Oh.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),ih.config({find:function(t){return Oh.getHighlighted(t)}}),cy.config({})]),eventOrder:t.eventOrder,apis:B,events:T}},vw=i("collapse-item"),bw=function(t,e,n){return{primary:t,menus:e,expansions:n}},yw=function(t,e){return{primary:t,menus:Xt(t,e),expansions:{}}},ww=function(t){return{value:Bu(vw()),meta:{text:t}}},xw=Zp({name:"TieredMenu",configFields:[Cs("onExecute"),Cs("onEscape"),xs("onOpenMenu"),xs("onOpenSubmenu"),xs("onRepositionMenu"),ys("onCollapseMenu"),In("highlightImmediately",!0),Cn("data",[gn("primary"),gn("menus"),gn("expansions")]),In("fakeFocus",!1),ys("onHighlight"),ys("onHover"),hs(),gn("dom"),In("navigateOnHover",!0),In("stayInDom",!1),Ug("tmenuBehaviours",[Qb,Oh,ih,cy]),In("eventOrder",{})],apis:{collapseMenu:function(t,e){t.collapseMenu(e)},highlightPrimary:function(t,e){t.highlightPrimary(e)},repositionMenus:function(t,e){t.repositionMenus(e)}},factory:hw,extraApis:{tieredData:bw,singleData:yw,collapseItem:ww}}),Cw=function(t,e,n,r,o){var i=function(){return t.lazySink(e)},u="horizontal"===r.type?{layouts:{onLtr:function(){return rl()},onRtl:function(){return ol()}}}:{},a=function(t){return 2===t.length},c=function(t){return a(t)?u:{}};return xw.sketch({dom:{tag:"div"},data:r.data,markers:r.menu.markers,onEscape:function(){return ug.close(e),t.onEscape.map((function(t){return t(e)})),x.some(!0)},onExecute:function(){return x.some(!0)},onOpenMenu:function(t,e){Tm.positionWithinBounds(i().getOrDie(),n,e,o())},onOpenSubmenu:function(t,e,n,r){var o=i().getOrDie();Tm.position(o,m({anchor:"submenu",item:e},c(r)),n)},onRepositionMenu:function(t,e,r){var u=i().getOrDie();Tm.positionWithinBounds(u,n,e,o()),G(r,(function(t){var e=c(t.triggeringPath);Tm.position(u,m({anchor:"submenu",item:t.triggeringItem},e),t.triggeredMenu)}))}})},Sw=function(t,e){var n=function(e,n){var r=t.getRelated(e);return r.exists((function(t){return Kc(t,n)}))},r=function(t,e){ug.setContent(t,e)},o=function(t,e,n){u(t,e,n,x.none())},u=function(t,e,n,r){a(t,e,n,(function(){return r.map((function(t){return zc(t)}))}))},a=function(e,n,r,o){var i=t.lazySink(e).getOrDie();ug.openWhileCloaked(e,r,(function(){return Tm.positionWithinBounds(i,n,e,o())})),Vg.setValue(e,x.some({mode:"position",anchor:n,getBounds:o}))},c=function(t,e,n){s(t,e,n,(function(){return x.none()}))},s=function(e,n,r,o){var i=Cw(t,e,n,r,o);ug.open(e,i),Vg.setValue(e,x.some({mode:"menu",menu:i}))},l=function(t){Vg.setValue(t,x.none()),ug.close(t)},f=function(t){return ug.getState(t)},d=function(e){ug.isOpen(e)&&Vg.getValue(e).each((function(n){switch(n.mode){case"menu":ug.getState(e).each((function(t){xw.repositionMenus(t)}));break;case"position":var r=t.lazySink(e).getOrDie();Tm.positionWithinBounds(r,n.anchor,e,n.getBounds());break}}))},g={setContent:r,showAt:o,showWithin:u,showWithinBounds:a,showMenuAt:c,showMenuWithinBounds:s,hide:l,getContent:f,reposition:d,isOpen:ug.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Gg(t.inlineBehaviours,[ug.config({isPartOf:function(t,e,r){return Kc(e,r)||n(t,r)},getAttachPoint:function(e){return t.lazySink(e).getOrDie()},onOpen:function(e){t.onShow(e)},onClose:function(e){t.onHide(e)}}),Vg.config({store:{mode:"memory",initialValue:x.none()}}),Cl.config({channels:m(m({},fg(m({isExtraPart:i(!1)},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),mg(m(m({isExtraPart:i(!1)},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:d})))})]),eventOrder:t.eventOrder,apis:g}},kw=Zp({name:"InlineView",configFields:[gn("lazySink"),ys("onShow"),ys("onHide"),An("onEscape"),Ug("inlineBehaviours",[ug,Vg,Cl]),Rn("fireDismissalEventInstead",[In("event",Jo())]),Rn("fireRepositionEventInstead",[In("event",Qo())]),In("getRelated",x.none),In("eventOrder",x.none)],factory:Sw,apis:{showAt:function(t,e,n,r){t.showAt(e,n,r)},showWithin:function(t,e,n,r,o){t.showWithin(e,n,r,o)},showWithinBounds:function(t,e,n,r,o){t.showWithinBounds(e,n,r,o)},showMenuAt:function(t,e,n,r){t.showMenuAt(e,n,r)},showMenuWithinBounds:function(t,e,n,r,o){t.showMenuWithinBounds(e,n,r,o)},hide:function(t,e){t.hide(e)},isOpen:function(t,e){return t.isOpen(e)},getContent:function(t,e){return t.getContent(e)},setContent:function(t,e,n){t.setContent(e,n)},reposition:function(t,e){t.reposition(e)}}}),Ow=function(t){return t.x()},Tw=function(t,e){return t.x()+t.width()/2-e.width()/2},Ew=function(t,e){return t.x()+t.width()-e.width()},Dw=function(t){return t.y()},Aw=function(t,e){return t.y()+t.height()-e.height()},_w=function(t,e,n){return Ts(Ow(t),Aw(t,e),n.innerSoutheast(),Rs(),"layout-se")},Rw=function(t,e,n){return Ts(Ew(t,e),Aw(t,e),n.innerSouthwest(),Bs(),"layout-sw")},Bw=function(t,e,n){return Ts(Ow(t),Dw(t),n.innerNortheast(),Is(),"layout-ne")},Iw=function(t,e,n){return Ts(Ew(t,e),Dw(t),n.innerNorthwest(),Ns(),"layout-nw")},Nw=function(t,e,n){return Ts(Tw(t,e),Dw(t),n.innerNorth(),Ms(),"layout-n")},Pw=function(t,e,n){return Ts(Tw(t,e),Aw(t,e),n.innerSouth(),Ps(),"layout-s")},Mw=function(t){var e=zy(t.action),n=t.dom.tag,r=function(e){return qt(t.dom,"attributes").bind((function(t){return qt(t,e)}))},o=function(){if("button"===n){var t=r("type").getOr("button"),e=r("role").map((function(t){return{role:t}})).getOr({});return m({type:t},e)}var o=r("role").getOr("button");return{role:o}};return{uid:t.uid,dom:t.dom,components:t.components,events:e,behaviours:qg.augment(t.buttonBehaviours,[yy.config({}),Qb.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:o()},eventOrder:t.eventOrder}},Fw=Zp({name:"Button",factory:Mw,configFields:[In("uid",void 0),gn("dom"),In("components",[]),qg.field("buttonBehaviours",[yy,Qb]),On("action"),On("role"),In("eventOrder",{})]}),Lw=function(t){var e=Yp(t)&&Qt(t,"uid")?t.uid:zu("memento"),n=function(t){return t.getSystem().getByUid(e).getOrDie()},r=function(t){return t.getSystem().getByUid(e).toOption()},o=function(){return m(m({},t),{uid:e})};return{get:n,getOpt:r,asSpec:o}},Hw=function(t){return x.from(t()["temporary-placeholder"]).getOr("!not found!")},zw=function(t,e){return x.from(e()[t]).getOrThunk((function(){return Hw(e)}))},jw=function(t,e,n){return x.from(e()[t]).or(n).getOrThunk((function(){return Hw(e)}))},Vw=function(t,e){return Zc(t,(function(t){return x.from(e()[t])})).getOrThunk((function(){return Hw(e)}))},Uw={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Ww=function(t){var e=Lw({dom:{tag:"p",innerHtml:t.translationProvider(t.text)},behaviours:dl([cy.config({})])}),n=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},r=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},o=Lw({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(0)]},r(0)],behaviours:dl([cy.config({})])}),i=function(t,e){t.getSystem().isConnected()&&o.getOpt(t).each((function(t){cy.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[n(e)]},r(e)])}))},u=function(t,n){if(t.getSystem().isConnected()){var r=e.get(t);cy.set(r,[uc(n)])}},a={updateProgress:i,updateText:u},c=Z([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return x.from(Uw[t])})).toArray()]);return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},components:[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:Vw(c,t.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[e.asSpec()],behaviours:dl([cy.config({})])}].concat(t.progress?[o.asSpec()]:[]).concat(Fw.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:zw("close",t.iconProvider),attributes:{"aria-label":t.translationProvider("Close")}}}],action:function(e){t.onAction(e)}})),apis:a}},Gw=Zp({name:"Notification",factory:Ww,configFields:[On("level"),gn("progress"),gn("icon"),gn("onAction"),gn("text"),gn("iconProvider"),gn("translationProvider")],apis:{updateProgress:function(t,e,n){t.updateProgress(e,n)},updateText:function(t,e,n){t.updateText(e,n)}}}),qw=tinymce.util.Tools.resolve("tinymce.util.Delay");function Xw(t,e,n){var r=e.backstage,o=function(t){switch(t){case"bc-bc":return Pw;case"tc-tc":return Nw;case"tc-bc":return Js;case"bc-tc":default:return Qs}},i=function(t){G(t,(function(t){return t.moveTo(0,0)}))},u=function(t){t.length>0&&(ut(t).each((function(t){return t.moveRel(null,"banner")})),G(t,(function(e,n){n>0&&e.moveRel(t[n-1].getEl(),"bc-tc")})))},a=function(t){i(t),u(t)},c=function(t,i){var u=function(){i(),kw.hide(c)},a=sc(Gw.sketch({text:t.text,level:z(["success","error","warning","warn","info"],t.type)?t.type:void 0,progress:!0===t.progressBar,icon:x.from(t.icon),onAction:u,iconProvider:r.shared.providers.icons,translationProvider:r.shared.providers.translate})),c=sc(kw.sketch({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:e.backstage.shared.getSink,fireDismissalEventInstead:{}}));return n.add(c),t.timeout>0&&qw.setTimeout((function(){u()}),t.timeout),{close:u,moveTo:function(t,e){kw.showAt(c,{anchor:"makeshift",x:t,y:e},lc(a))},moveRel:function(t,n){if("banner"!==n){var r=o(n),i={anchor:"node",root:bi(),node:x.some(Kn.fromDom(t)),layouts:{onRtl:function(){return[r]},onLtr:function(){return[r]}}};kw.showAt(c,i,lc(a))}else kw.showAt(c,e.backstage.shared.anchors.banner(),lc(a))},text:function(t){Gw.updateText(a,t)},settings:t,getEl:function(){return a.element().dom()},progressBar:{value:function(t){Gw.updateProgress(a,t)}}}},s=function(t){t.close()},l=function(t){return t.settings};return{open:c,close:s,reposition:a,getArgs:l}}var $w,Yw=function(t,n){var r=null,o=function(){null!==r&&(e.clearTimeout(r),r=null)},i=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null===r&&(r=e.setTimeout((function(){t.apply(null,o),r=null}),n))};return{cancel:o,throttle:i}},Kw=function(t,n){var r=null,o=function(){null!==r&&(e.clearTimeout(r),r=null)},i=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&e.clearTimeout(r),r=e.setTimeout((function(){t.apply(null,o),r=null}),n)};return{cancel:o,throttle:i}},Jw=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Qw=function(t){return t.nodeType===e.Node.TEXT_NODE},Zw=function(t,e){return t.isBlock(e)||z(["BR","IMG","HR","INPUT"],e.nodeName)||"false"===t.getContentEditable(e)},tx=wt.generate([{aborted:[]},{edge:["element"]},{success:["info"]}]),ex=wt.generate([{abort:[]},{kontinue:[]},{finish:["info"]}]),nx=function(t,e,n,r,o,i){var u=function(){return i.fold(tx.aborted,tx.edge)},a=function(){var n=o();return n?nx(t,n,x.none(),r,o,x.some(e)):u()};if(Zw(t,e))return u();if(Qw(e)){var c=e.textContent;return r(ex,e,c,n).fold(tx.aborted,(function(){return a()}),tx.success)}return a()},rx=function(t,e,n,r,o){var i=new Jw(e,o||t.getRoot());return nx(t,e,x.some(n),r,i.prev,x.none())},ox="[data-mce-autocompleter]",ix=function(t,e){return ux(Kn.fromDom(t.selection.getNode())).getOrThunk((function(){var n=Kn.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return cu(n,Kn.fromDom(e.extractContents())),e.insertNode(n.dom()),Qi(n).each((function(t){return t.dom().normalize()})),Yf(n).map((function(e){t.selection.setCursorLocation(e.dom(),Uf(e))})),n}))},ux=function(t){return qc(t,ox)},ax=function(t){return t.collapsed&&3===t.startContainer.nodeType},cx=/[\u00a0 \t\r\n]/,sx=function(t,e,n,r){var o;for(o=e-1;o>=0;o--){var i=t.charAt(o);if(cx.test(i))return x.none();if(i===n)break}return-1===o||e-o<r?x.none():x.some(t.substring(o+1,e))},lx=function(t,e){var n=t.toString().substring(e.length);return n.replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},fx=function(t,e,n,r){if(void 0===r&&(r=0),!ax(e))return x.none();var o=function(t,o,i,u){var a=u.getOr(i.length);return sx(i,a,n,1).fold((function(){return i.match(cx)?t.abort():t.kontinue()}),(function(u){var c=e.cloneRange();return c.setStart(o,a-u.length-1),c.setEnd(e.endContainer,e.endOffset),i.length<r?t.abort():t.finish({text:lx(c,n),range:c,triggerChar:n})}))};return rx(t,e.startContainer,e.startOffset,o).fold(x.none,x.none,x.some)},dx=function(t,e,n,r){return void 0===r&&(r=0),ux(Kn.fromDom(e.startContainer)).fold((function(){return fx(t,e,n,r)}),(function(e){var r=t.createRng();return r.selectNode(e.dom()),x.some({range:r,text:lx(r,n),triggerChar:n})}))},mx=function(t,e){e.on("keypress compositionend",t.onKeypress.throttle),e.on("remove",t.onKeypress.cancel);var n=function(t,e){ui(t,Oo(),{raw:e})};e.on("keydown",(function(e){var r=function(){return t.getView().bind(Oh.getHighlighted)};8===e.which&&t.onKeypress.throttle(e),t.isActive()&&(27===e.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===e.which?(r().each(ai),e.preventDefault()):40===e.which?(r().fold((function(){t.getView().each(Oh.highlightFirst)}),(function(t){n(t,e)})),e.preventDefault(),e.stopImmediatePropagation()):37!==e.which&&38!==e.which&&39!==e.which||r().each((function(t){n(t,e),e.preventDefault(),e.stopImmediatePropagation()})):13!==e.which&&38!==e.which&&40!==e.which||t.cancelIfNecessary())})),e.on("NodeChange",(function(e){t.isActive()&&!t.isProcessingAction()&&ux(Kn.fromDom(e.element)).isNone()&&t.cancelIfNecessary()}))},gx={setup:mx},px=tinymce.util.Tools.resolve("tinymce.util.Promise"),hx=function(t,e){return{element:t,offset:e}},vx=function(t){return t.nodeType===e.Node.TEXT_NODE},bx=function(t){return t.nodeType===e.Node.ELEMENT_NODE},yx=function(t){if(vx(t))return hx(t,t.data.length);var e=t.childNodes;return e.length>0?yx(e[e.length-1]):hx(t,e.length)},wx=function(t,e){var n=t.childNodes;return n.length>0&&e<n.length?wx(n[e],0):n.length>0&&bx(t)&&n.length===e?yx(n[n.length-1]):hx(t,e)},xx=function(t){var e=function(t,e,n,r){var o=r.getOr(n.length);return 0===o?t.kontinue():t.finish(/\s/.test(n.charAt(o-1)))};return function(n){var r=wx(n.startContainer,n.startOffset);return rx(t,r.element,r.offset,e).fold(i(!0),i(!0),u)}},Cx=function(t,e,n){return Zc(n.triggerChars,(function(n){return dx(t,e,n)}))},Sx=function(t,e){var n=e(),r=t.selection.getRng();return Cx(t.dom,r,n).bind((function(n){return kx(t,e,n)}))},kx=function(t,e,n,r){void 0===r&&(r={});var o=e(),i=t.selection.getRng(),u=i.startContainer.nodeValue,a=$(o.lookupByChar(n.triggerChar),(function(e){return n.text.length>=e.minChars&&e.matches.getOrThunk((function(){return xx(t.dom)}))(n.range,u,n.text)}));if(0===a.length)return x.none();var c=px.all(W(a,(function(t){var e=t.fetch(n.text,t.maxResults,r);return e.then((function(e){return{matchText:n.text,items:e,columns:t.columns,onAction:t.onAction}}))})));return x.some({lookupData:c,context:n})},Ox=Me([vn("type"),Dn("text")]),Tx=function(t){return Qe("separatormenuitem",Ox,t)},Ex=Me([Un("type",(function(){return"autocompleteitem"})),Un("active",(function(){return!1})),Un("disabled",(function(){return!1})),In("meta",{}),vn("value"),Dn("text"),Dn("icon")]),Dx=Me([vn("type"),vn("ch"),Pn("minChars",1),In("columns",1),Pn("maxResults",10),An("matches"),wn("fetch"),wn("onAction")]),Ax=function(t){return Qe("Autocompleter.Separator",Ox,t)},_x=function(t){return Qe("Autocompleter.Item",Ex,t)},Rx=function(t){return Qe("Autocompleter",Dx,t)},Bx=function(t){var e={};return G(t,(function(t){e[t]={}})),st(e)},Ix=function(t){var e=t.ui.registry.getAll().popups,n=dt(e,(function(t){return Rx(t).fold((function(t){throw new Error(en(t))}),(function(t){return t}))})),r=Bx(gt(n,(function(t){return t.ch}))),o=ht(n),i=function(t){return $(o,(function(e){return e.ch===t}))};return{dataset:n,triggerChars:r,lookupByChar:i}},Nx=[Ln("disabled",!1),Dn("text"),Dn("shortcut"),Ve("value","value",It((function(){return Bu("menuitem-value")})),on()),In("meta",{})],Px=Me([vn("type"),Hn("onSetup",(function(){return n})),Hn("onAction",n),Dn("icon")].concat(Nx)),Mx=function(t){return Qe("menuitem",Px,t)},Fx=Me([vn("type"),wn("getSubmenuItems"),Hn("onSetup",(function(){return n})),Dn("icon")].concat(Nx)),Lx=function(t){return Qe("nestedmenuitem",Fx,t)},Hx=Me([vn("type"),Ln("active",!1),Hn("onSetup",(function(){return n})),wn("onAction")].concat(Nx)),zx=function(t){return Qe("togglemenuitem",Hx,t)},jx=Me([vn("type"),Ln("active",!1),Dn("icon")].concat(Nx)),Vx=function(t){return Qe("choicemenuitem",jx,t)},Ux=["inserttable","colorswatch"],Wx=Me([vn("type"),bn("fancytype",Ux),Hn("onAction",n)]),Gx=function(t){return Qe("fancymenuitem",Wx,t)},qx=function(t,e,n){var r=cd(t.element(),"."+n);if(r.length>0){var o=Q(r,(function(t){var n=t.dom().getBoundingClientRect().top,o=r[0].dom().getBoundingClientRect().top;return Math.abs(n-o)>e})).getOr(r.length);return x.some({numColumns:o,numRows:Math.ceil(r.length/o)})}return x.none()},Xx=function(t,e){return dl([ly(t,e)])},$x=function(t){return Xx(Bu("unnamed-events"),t)},Yx={namedEvents:Xx,unnamedEvents:$x},Kx=[gn("lazySink"),gn("tooltipDom"),In("exclusive",!0),In("tooltipComponents",[]),In("delay",300),Fn("mode","normal",["normal","follow-highlight"]),In("anchor",(function(t){return{anchor:"hotspot",hotspot:t,layouts:{onLtr:i([Qs,Js,Xs,Ys,$s,Ks]),onRtl:i([Qs,Js,Xs,Ys,$s,Ks])}}})),ys("onHide"),ys("onShow")],Jx=function(){var t=Wn(x.none()),n=Wn(x.none()),r=function(){return n.get()},o=function(t){n.set(x.some(t))},u=function(){n.set(x.none())},a=function(){t.get().each((function(t){e.clearTimeout(t)}))},c=function(n,r){a(),t.set(x.some(e.setTimeout((function(){n()}),r)))},s=function(){return n.get().isSome()},l=i("not-implemented");return Zu({getTooltip:r,isShowing:s,setTooltip:o,clearTooltip:u,clearTimer:a,resetTimer:c,readState:l})},Qx=Object.freeze({init:Jx}),Zx=Bu("tooltip.exclusive"),tC=Bu("tooltip.show"),eC=Bu("tooltip.hide"),nC=function(t,e,n){t.getSystem().broadcastOn([Zx],{})},rC=function(t,e,n,r){n.getTooltip().each((function(t){t.getSystem().isConnected()&&cy.set(t,r)}))},oC=Object.freeze({hideAllExclusive:nC,setComponents:rC}),iC=function(t,e){var n=function(n){e.getTooltip().each((function(r){Pm(r),t.onHide(n,r),e.clearTooltip()})),e.clearTimer()},r=function(n){if(!e.isShowing()){nC(n);var r=t.lazySink(n).getOrDie(),o=n.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:ki("normal"===t.mode?[Di(Co(),(function(t){ii(n,tC)})),Di(wo(),(function(t){ii(n,eC)}))]:[]),behaviours:dl([cy.config({})])});e.setTooltip(o),Bm(r,o),t.onShow(n,o),Tm.position(r,t.anchor(n),o)}};return ki(Z([[Di(tC,(function(n){e.resetTimer((function(){r(n)}),t.delay)})),Di(eC,(function(r){e.resetTimer((function(){n(r)}),t.delay)})),Di(Mo(),(function(t,e){var r=e;z(r.channels(),Zx)&&n(t)})),Hi((function(t){n(t)}))],"normal"===t.mode?[Di(So(),(function(t){ii(t,tC)})),Di(No(),(function(t){ii(t,eC)})),Di(Co(),(function(t){ii(t,tC)})),Di(wo(),(function(t){ii(t,eC)}))]:[Di(ri(),(function(t,e){ii(t,tC)})),Di(oi(),(function(t){ii(t,eC)}))]]))},uC=Object.freeze({events:iC}),aC=gl({fields:Kx,name:"tooltipping",active:uC,state:Qx,apis:oC}),cC=function(t){var e=void 0!==t.dom().attributes?t.dom().attributes:[];return K(e,(function(t,e){var n;return"class"===e.name?t:m(m({},t),(n={},n[e.name]=e.value,n))}),{})},sC=function(t){return Array.prototype.slice.call(t.dom().classList,0)},lC=function(t){var e=Kn.fromHtml(t),n=eu(e),r=cC(e),o=sC(e),i=0===n.length?{}:{innerHtml:pu(e)};return m({tag:di(e),classes:o,attributes:r},i)},fC=tinymce.util.Tools.resolve("tinymce.util.I18n"),dC="tox-menu-nav__js",mC="tox-collection__item",gC="tox-swatch",pC={normal:dC,color:gC},hC="tox-collection__item--enabled",vC="tox-collection__group-heading",bC="tox-collection__item-icon",yC="tox-collection__item-label",wC="tox-collection__item-accessory",xC="tox-collection__item-caret",CC="tox-collection__item-checkmark",SC="tox-collection__item--active",kC="tox-collection__item-icon-rtl",OC=function(t){return qt(pC,t).getOr(dC)},TC=tinymce.util.Tools.resolve("tinymce.Env"),EC=function(t){var e={alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"},n={meta:"Ctrl",access:"Shift+Alt"},r=TC.mac?e:n,o=t.split("+"),i=W(o,(function(t){var e=t.toLowerCase().trim();return bt(r,e)?r[e]:t}));return TC.mac?i.join(""):i.join("+")},DC={convertText:EC},AC=function(t){return{dom:{tag:"div",classes:[bC],innerHtml:t}}},_C=function(t){return{dom:{tag:"div",classes:[yC]},components:[uc(fC.translate(t))]}},RC=function(t){return{dom:{tag:"div",classes:[yC],innerHtml:t}}},BC=function(t,e){return{dom:{tag:"div",classes:[yC]},components:[{dom:{tag:t.tag,attributes:{style:t.styleAttr}},components:[uc(fC.translate(e))]}]}},IC=function(t){return{dom:{tag:"div",classes:[wC],innerHtml:DC.convertText(t)}}},NC=function(t){return{dom:{tag:"div",classes:[bC,CC],innerHtml:zw("checkmark",t)}}},PC=function(t){return{dom:{tag:"div",classes:[xC],innerHtml:zw("chevron-right",t)}}},MC=function(t){return{dom:{tag:"div",classes:[xC],innerHtml:zw("chevron-down",t)}}},FC=function(t,e,n,r){var o="custom",i="remove",u=function(){var u=gC,a=n.getOr(""),c=t.map((function(t){return' title="'+r.translate(t)+'"'})).getOr("");return lC(e===o?'<button class="'+u+' tox-swatches__picker-btn"'+c+">"+a+"</button>":e===i?'<div class="'+u+' tox-swatch--remove"'+c+">"+a+"</div>":'<div class="'+u+'" style="background-color: '+e+'" data-mce-color="'+e+'"'+c+"></div>")};return{dom:u(),optComponents:[]}},LC=function(t,e,n,r,o){var i=n?t.checkMark.orThunk((function(){return e.or(x.some("")).map(AC)})):x.none(),u=t.ariaLabel.map((function(t){return{attributes:{title:fC.translate(t)}}})).getOr({}),a=Tt({tag:"div",classes:[dC,mC].concat(o?[kC]:[])},u),c=t.htmlContent.fold((function(){return t.textContent.map(r)}),(function(t){return x.some(RC(t))})),s={dom:a,optComponents:[i,c,t.shortcutContent.map(IC),t.caret]};return s},HC=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],zC=["list-bull-circle","list-bull-default","list-bull-square"],jC=function(t,e,n,r){void 0===r&&(r=x.none());var o=function(t){return t.map((function(t){return fC.isRtl()&&z(HC,t)?t+"-rtl":t}))},i=fC.isRtl()&&t.iconContent.exists((function(t){return z(zC,t)})),u=o(t.iconContent).map((function(t){return jw(t,e.icons,r)})),c=x.from(t.meta).fold((function(){return _C}),(function(t){return bt(t,"style")?a(BC,t.style):_C}));return"color"===t.presets?FC(t.ariaLabel,t.value,u,e):LC(t,u,n,c,i)},VC=["input","button","textarea","select"],UC=function(t,e,n){e.disabled&&JC(t,e)},WC=function(t,e){return!0===e.useNative&&z(VC,di(t.element()))},GC=function(t){return Cu(t.element(),"disabled")},qC=function(t){yu(t.element(),"disabled","disabled")},XC=function(t){Su(t.element(),"disabled")},$C=function(t){return"true"===xu(t.element(),"aria-disabled")},YC=function(t){yu(t.element(),"aria-disabled","true")},KC=function(t){yu(t.element(),"aria-disabled","false")},JC=function(t,e,n){e.disableClass.each((function(e){Ra(t.element(),e)}));var r=WC(t,e)?qC:YC;r(t),e.onDisabled(t)},QC=function(t,e,n){e.disableClass.each((function(e){Ia(t.element(),e)}));var r=WC(t,e)?XC:KC;r(t),e.onEnabled(t)},ZC=function(t,e){return WC(t,e)?GC(t):$C(t)},tS=function(t,e,n,r){var o=r?JC:QC;o(t,e,n)},eS=Object.freeze({enable:QC,disable:JC,isDisabled:ZC,onLoad:UC,set:tS}),nS=function(t,e,n){return oa({classes:e.disabled?e.disableClass.map(ot).getOr([]):[]})},rS=function(t,e){return ki([Oi(Fo(),(function(e,n){return ZC(e,t)})),ul(t,e,UC)])},oS=Object.freeze({exhibit:nS,events:rS}),iS=[In("disabled",!1),In("useNative",!0),On("disableClass"),ys("onDisabled"),ys("onEnabled")],uS=gl({fields:iS,name:"disabling",active:oS,apis:eS}),aS=function(t){return uS.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},cS=function(t){return uS.config({disabled:t})},sS=function(t){return uS.config({disabled:t,disableClass:"tox-tbtn--disabled"})},lS=function(t){return uS.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},fS={item:aS,button:cS,splitButton:sS,toolbarButton:lS},dS=function(t,e){var n=t.getApi(e);return function(t){t(n)}},mS=function(t,e){return Li((function(n){var r=dS(t,n);r((function(n){var r=t.onSetup(n);null!==r&&void 0!==r&&e.set(r)}))}))},gS=function(t,e){return Hi((function(n){return dS(t,n)(e.get())}))};(function(t){t[t["CLOSE_ON_EXECUTE"]=0]="CLOSE_ON_EXECUTE",t[t["BUBBLE_TO_SANDBOX"]=1]="BUBBLE_TO_SANDBOX"})($w||($w={}));var pS=$w,hS=function(t,e){return ji((function(n,r){dS(t,n)(t.onAction),t.triggersSubmenu||e!==pS.CLOSE_ON_EXECUTE||(ii(n,Vo()),r.stop())}))},vS={"alloy.execute":["disabling","alloy.base.behaviour","toggling","item-events"]},bS=function(t){return tt(t,(function(t){return t.toArray()}))},yS=function(t,e,r){var o=Wn(n);return{type:"item",dom:e.dom,components:bS(e.optComponents),data:t.data,eventOrder:vS,hasSubmenu:t.triggersSubmenu,itemBehaviours:dl([ly("item-events",[hS(t,r),mS(t,o),gS(t,o)]),fS.item(t.disabled),cy.config({})].concat(t.itemBehaviours))}},wS=function(t){return{value:t.value,meta:Tt({text:t.text.getOr("")},t.meta)}},xS=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),CS=function(t,e){return vt(t,"tooltipWorker").map((function(t){return[aC.config({lazySink:e.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{anchor:"submenu",item:t,overrides:{maxHeightFunction:dm}}},mode:"follow-highlight",onShow:function(e,n){t((function(t){aC.setComponents(e,[ac({element:Kn.fromDom(t)})])}))}})]})).getOr([])},SS=function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")},kS=function(t){return xS.DOM.encode(t)},OS=function(t,e){var n=fC.translate(t),r=kS(n);if(e.length>0){var o=new RegExp(SS(e),"gi");return r.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return r},TS=function(t,e,n,r,o,i,u,a){void 0===a&&(a=!0);var c=jC({presets:r,textContent:x.none(),htmlContent:n?t.text.map((function(t){return OS(t,e)})):x.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:x.none(),checkMark:x.none(),caret:x.none(),value:t.value},u.providers,a,t.icon);return yS({data:wS(t),disabled:t.disabled,getApi:function(){return{}},onAction:function(e){return o(t.value,t.meta)},onSetup:function(){return function(){}},triggersSubmenu:!1,itemBehaviours:CS(t.meta,u)},c,i)},ES=function(t,e,n,r,o,i,u){var a=function(t){return{setActive:function(e){Ly.set(t,e)},isActive:function(){return Ly.isOn(t)},isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)}}},c=jC({presets:n,textContent:e?t.text:x.none(),htmlContent:x.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:e?t.shortcut:x.none(),checkMark:e?x.some(NC(u.icons)):x.none(),caret:x.none(),value:t.value},u,!0);return Ot(yS({data:wS(t),disabled:t.disabled,getApi:a,onAction:function(e){return r(t.value)},onSetup:function(t){return t.setActive(o),function(){}},triggersSubmenu:!1,itemBehaviours:[]},c,i),{toggling:{toggleClass:hC,toggleOnExecute:!1,selected:t.active}})},DS=i(Dp(Jy(),Qy())),AS=Bu("cell-over"),_S=Bu("cell-execute"),RS=function(t,e,n){var r,o=function(n){return ui(n,AS,{row:t,col:e})},i=function(n){return ui(n,_S,{row:t,col:e})};return sc({dom:{tag:"div",attributes:(r={role:"button"},r["aria-labelledby"]=n,r)},behaviours:dl([ly("insert-table-picker-cell",[Di(Co(),yy.focus),Di(Fo(),i),Di(zo(),(function(t,e){e.stop(),i(t)}))]),Ly.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),yy.config({onFocus:o})])})},BS=function(t,e,n){for(var r=[],o=0;o<e;o++){for(var i=[],u=0;u<n;u++)i.push(RS(o,u,t));r.push(i)}return r},IS=function(t,e,n,r,o){for(var i=0;i<r;i++)for(var u=0;u<o;u++)Ly.set(t[i][u],i<=e&&u<=n)},NS=function(t){return tt(t,(function(t){return W(t,lc)}))},PS=function(t,e){return uc(e+1+"x"+(t+1))};function MS(t){var e=10,n=10,r=Bu("size-label"),o=BS(r,e,n),i=Lw({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:r}},components:[uc("0x0")],behaviours:dl([cy.config({})])});return{type:"widget",data:{value:Bu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[DS().widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:NS(o).concat(i.asSpec()),behaviours:dl([ly("insert-table-picker",[Ni(AS,(function(t,r,u){var a=u.event().row(),c=u.event().col();IS(o,a,c,e,n),cy.set(i.get(t),[PS(a,c)])})),Ni(_S,(function(e,n,r){t.onAction({numRows:r.event().row()+1,numColumns:r.event().col()+1}),ii(e,Vo())}))]),Qb.config({initSize:{numRows:e,numColumns:n},mode:"flatgrid",selector:'[role="button"]'})])})]}}var FS=function(t){return{value:i(t)}},LS=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,HS=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,zS=function(t){return LS.test(t)||HS.test(t)},jS=function(t){var e=t.value().replace(LS,(function(t,e,n,r){return e+e+n+n+r+r}));return{value:i(e)}},VS=function(t){var e=jS(t),n=HS.exec(e.value());return null===n?["FFFFFF","FF","FF","FF"]:n},US=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},WS=function(t){var e=US(t.red())+US(t.green())+US(t.blue());return FS(e)},GS=Math.min,qS=Math.max,XS=Math.round,$S=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,YS=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,KS=function(t,e,n,r){return{red:i(t),green:i(e),blue:i(n),alpha:i(r)}},JS=function(t){var e=parseInt(t,10);return e.toString()===t&&e>=0&&e<=255},QS=function(t){var e,n,r,o=(t.hue()||0)%360,i=t.saturation()/100,u=t.value()/100;if(i=qS(0,GS(i,1)),u=qS(0,GS(u,1)),0===i)return e=n=r=XS(255*u),KS(e,n,r,1);var a=o/60,c=u*i,s=c*(1-Math.abs(a%2-1)),l=u-c;switch(Math.floor(a)){case 0:e=c,n=s,r=0;break;case 1:e=s,n=c,r=0;break;case 2:e=0,n=c,r=s;break;case 3:e=0,n=s,r=c;break;case 4:e=s,n=0,r=c;break;case 5:e=c,n=0,r=s;break;default:e=n=r=0}return e=XS(255*(e+l)),n=XS(255*(n+l)),r=XS(255*(r+l)),KS(e,n,r,1)},ZS=function(t){var e=VS(t),n=parseInt(e[1],16),r=parseInt(e[2],16),o=parseInt(e[3],16);return KS(n,r,o,1)},tk=function(t,e,n,r){var o=parseInt(t,10),i=parseInt(e,10),u=parseInt(n,10),a=parseFloat(r);return KS(o,i,u,a)},ek=function(t){if("transparent"===t)return x.some(KS(0,0,0,0));var e=$S.exec(t);if(null!==e)return x.some(tk(e[1],e[2],e[3],"1"));var n=YS.exec(t);return null!==n?x.some(tk(n[1],n[2],n[3],n[4])):x.none()},nk=function(t){return"rgba("+t.red()+","+t.green()+","+t.blue()+","+t.alpha()+")"},rk=i(KS(255,0,0,1)),ok=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),ik="tinymce-custom-colors";function uk(t){void 0===t&&(t=10);var e=ok.getItem(ik),n=D(e)?JSON.parse(e):[],r=function(e){var n=t-e.length;return n<0?e.slice(0,t):e},o=r(n),i=function(e){H(o,e).each(u),o.unshift(e),o.length>t&&o.pop(),ok.setItem(ik,JSON.stringify(o))},u=function(t){o.splice(t,1)},a=function(){return o.slice(0)};return{add:i,state:a}}var ak="choiceitem",ck=[{type:ak,text:"Light Green",value:"#BFEDD2"},{type:ak,text:"Light Yellow",value:"#FBEEB8"},{type:ak,text:"Light Red",value:"#F8CAC6"},{type:ak,text:"Light Purple",value:"#ECCAFA"},{type:ak,text:"Light Blue",value:"#C2E0F4"},{type:ak,text:"Green",value:"#2DC26B"},{type:ak,text:"Yellow",value:"#F1C40F"},{type:ak,text:"Red",value:"#E03E2D"},{type:ak,text:"Purple",value:"#B96AD9"},{type:ak,text:"Blue",value:"#3598DB"},{type:ak,text:"Dark Turquoise",value:"#169179"},{type:ak,text:"Orange",value:"#E67E23"},{type:ak,text:"Dark Red",value:"#BA372A"},{type:ak,text:"Dark Purple",value:"#843FA1"},{type:ak,text:"Dark Blue",value:"#236FA1"},{type:ak,text:"Light Gray",value:"#ECF0F1"},{type:ak,text:"Medium Gray",value:"#CED4D9"},{type:ak,text:"Gray",value:"#95A5A6"},{type:ak,text:"Dark Gray",value:"#7E8C8D"},{type:ak,text:"Navy Blue",value:"#34495E"},{type:ak,text:"Black",value:"#000000"},{type:ak,text:"White",value:"#ffffff"}],sk=uk(10),lk=function(t){var n=[],r=e.document.createElement("canvas");r.height=1,r.width=1;for(var o=r.getContext("2d"),i=function(t,e){var n=255,r=e/255,o=Math.round(t*r+n*(1-r));return("0"+o.toString(16)).slice(-2).toUpperCase()},u=function(t){if(/^[0-9A-Fa-f]{6}$/.test(t))return"#"+t.toUpperCase();o.clearRect(0,0,r.width,r.height),o.fillStyle="#FFFFFF",o.fillStyle=t,o.fillRect(0,0,1,1);var e=o.getImageData(0,0,1,1).data,n=e[0],u=e[1],a=e[2],c=e[3];return"#"+i(n,c)+i(u,c)+i(a,c)},a=0;a<t.length;a+=2)n.push({text:t[a+1],value:u(t[a]),type:"choiceitem"});return n},fk=function(t,e){return t.getParam("color_cols",e,"number")},dk=function(t){return!1!==t.getParam("custom_colors")},mk=function(t){return t.getParam("color_map")},gk=function(t){var e=mk(t);return void 0!==e?lk(e):ck},pk=function(){return W(sk.state(),(function(t){return{type:ak,text:t,value:t}}))},hk=function(t){sk.add(t)},vk={mapColors:lk,getColorCols:fk,hasCustomColors:dk,getColorMap:mk,getColors:gk,getCurrentColors:pk,addColor:hk},bk=function(t){return t.fire("SkinLoaded")},yk=function(t){return t.fire("ResizeEditor")},wk=function(t){return t.fire("BeforeRenderUI")},xk=function(t,e){return t.fire("ResizeContent",e)},Ck=function(t,e){return t.fire("ScrollContent",e)},Sk=function(t,e){return t.fire("TextColorChange",e)},kk={fireSkinLoaded:bk,fireResizeEditor:yk,fireScrollContent:Ck,fireBeforeRenderUI:wk,fireResizeContent:xk,fireTextColorChange:Sk},Ok=function(t,e){var n;return t.dom.getParents(t.selection.getStart(),(function(t){var r;(r=t.style["forecolor"===e?"color":"background-color"])&&(n=n||r)})),n},Tk=function(t,e,n){t.undoManager.transact((function(){t.focus(),t.formatter.apply(e,{value:n}),t.nodeChanged()}))},Ek=function(t,e){t.undoManager.transact((function(){t.focus(),t.formatter.remove(e,{value:null},null,!0),t.nodeChanged()}))},Dk=function(t){t.addCommand("mceApplyTextcolor",(function(e,n){Tk(t,e,n)})),t.addCommand("mceRemoveTextcolor",(function(e){Ek(t,e)}))},Ak=function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))},_k=function(t){var e=vk.getColors(t),n=Ak(e.length);return vk.getColorCols(t,n)},Rk=function(t){var e="choiceitem",n={type:e,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"},r={type:e,text:"Custom color",icon:"color-picker",value:"custom"};return t?[n,r]:[n]},Bk=function(t,e,n,r){if("custom"===n){var o=Lk(t);o((function(n){n.each((function(n){vk.addColor(n),t.execCommand("mceApplyTextcolor",e,n),r(n)}))}),"#000000")}else"remove"===n?(r(""),t.execCommand("mceRemoveTextcolor",e)):(r(n),t.execCommand("mceApplyTextcolor",e,n))},Ik=function(t,e){return t.concat(vk.getCurrentColors().concat(Rk(e)))},Nk=function(t,e){return function(n){n(Ik(t,e))}},Pk=function(t,e,n){var r=function(e,n){t.setIconFill(e,n),t.setIconStroke(e,n)},o="forecolor"===e?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";r(o,n)},Mk=function(t,e,n,r,o){t.ui.registry.addSplitButton(e,{tooltip:r,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(e){var r=x.from(Ok(t,n));return r.bind((function(t){return ek(t).map((function(t){var n=WS(t).value();return Nr(e.toLowerCase(),n)}))})).getOr(!1)},columns:_k(t),fetch:Nk(vk.getColors(t),vk.hasCustomColors(t)),onAction:function(e){null!==o.get()&&Bk(t,n,o.get(),(function(){}))},onItemAction:function(r,i){Bk(t,n,i,(function(n){o.set(n),kk.fireTextColorChange(t,{name:e,color:n})}))},onSetup:function(n){null!==o.get()&&Pk(n,e,o.get());var r=function(t){t.name===e&&Pk(n,t.name,t.color)};return t.on("TextColorChange",r),function(){t.off("TextColorChange",r)}}})},Fk=function(t,e,r,o){t.ui.registry.addNestedMenuItem(e,{text:o,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Bk(t,r,e.value,n)}}]}})},Lk=function(t){return function(e,n){var r=function(t){return function(e){var n=e.getData();t(x.from(n.colorpicker)),e.close()}},o=function(t,e){"hex-valid"===e.name&&(e.value?t.enable("ok"):t.disable("ok"))},i={colorpicker:n},u=r(e);t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:i,onAction:o,onSubmit:u,onClose:function(){},onCancel:function(){e(x.none())}})}},Hk=function(t){Dk(t);var e=Wn(null),n=Wn(null);Mk(t,"forecolor","forecolor","Text color",e),Mk(t,"backcolor","hilitecolor","Background color",n),Fk(t,"forecolor","forecolor","Text color"),Fk(t,"backcolor","hilitecolor","Background color")},zk={register:Hk,getColors:Ik,getFetch:Nk,colorPickerDialog:Lk,getCurrentColor:Ok,getColorCols:_k,calcCols:Ak},jk=function(t,e){return function(n){var r=U(n,e);return W(r,(function(e){return{dom:t,components:e}}))}},Vk=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[sw.parts().items({preprocess:"auto"!==t?jk({tag:"div",classes:["tox-swatches__row"]},t):u})]}]}},Uk=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[sw.parts().items({preprocess:jk({tag:"div",classes:["tox-collection__group"]},t)})]}},Wk=function(t,e){var n=[],r=[];return G(t,(function(t,o){e(t,o)?(r.length>0&&n.push(r),r=[],bt(t.dom,"innerHtml")&&r.push(t)):r.push(t)})),r.length>0&&n.push(r),W(n,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Gk=function(t,e,n){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[sw.parts().items({preprocess:function(n){return"auto"!==t&&t>1?jk({tag:"div",classes:["tox-collection__group"]},t)(n):Wk(n,(function(t,n){return"separator"===e[n].type}))}})]}},qk=function(t,e){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[sw.parts().items({preprocess:function(e){return Wk(e,(function(e,n){return"separator"===t[n].type}))}})]}},Xk=function(t){return"color"===t?"tox-swatches":"tox-menu"},$k=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Xk(t),tieredMenu:"tox-tiered-menu"}},Yk=function(t){var e=$k(t);return{backgroundMenu:e.backgroundMenu,selectedMenu:e.selectedMenu,menu:e.menu,selectedItem:e.selectedItem,item:OC(t)}},Kk=function(t,e,n){var r=$k(n);return{tag:"div",classes:Z([[r.menu,"tox-menu-"+e+"-column"],t?[r.hasIcons]:[]])}},Jk=[sw.parts().items({})],Qk=function(t,e,n){var r=$k(n),o={tag:"div",classes:Z([[r.tieredMenu]])};return{dom:o,markers:Yk(n)}},Zk=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},tO=function(t){return j(t,Zk)},eO=function(t){return e.console.error(en(t)),e.console.log(t),x.none()},nO=function(t,e,n,r,o){var i=qk(n);return{value:t,dom:i.dom,components:i.components,items:n}},rO=function(t,e,n,r,o){if("color"===o){var i=Vk(r);return{value:t,dom:i.dom,components:i.components,items:n}}if("normal"===o&&"auto"===r){i=Gk(r,n);return{value:t,dom:i.dom,components:i.components,items:n}}if("normal"===o&&1===r){i=Gk(1,n);return{value:t,dom:i.dom,components:i.components,items:n}}if("normal"===o){i=Gk(r,n);return{value:t,dom:i.dom,components:i.components,items:n}}if("listpreview"===o&&"auto"!==r){i=Uk(r);return{value:t,dom:i.dom,components:i.components,items:n}}return{value:t,dom:Kk(e,r,o),components:Jk,items:n}},oO=function(t,e,n,r,o,i,u,a){var c=tO(e),s="color"!==o?"normal":"color",l=iO(e,n,r,s,i,u,a);return rO(t,c,l,r,o)},iO=function(t,e,n,r,o,i,u){return Jc(W(t,(function(t){return"choiceitem"===t.type?Vx(t).fold(eO,(function(a){return x.some(ES(a,1===n,r,e,i(t.value),o,u))})):x.none()})))},uO=function(t,e){var n=Yk(e);if(1===t)return{mode:"menu",moveOnTab:!0};if("auto"===t)return{mode:"grid",selector:"."+n.item,initSize:{numColumns:1,numRows:1}};var r="color"===e?"tox-swatches__row":"tox-collection__group";return{mode:"matrix",rowSelector:"."+r}},aO=function(t,e){return 1===t?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===e?".tox-swatches__row":".tox-collection__group",cell:"color"===e?"."+gC:"."+mC}}};function cO(t,e){var n=zk.getColors(e.colorinput.getColors(),e.colorinput.hasCustomColors()),r=e.colorinput.getColorCols(),o="color",i=oO(Bu("menu-value"),n,(function(e){t.onAction({value:e})}),r,o,pS.CLOSE_ON_EXECUTE,(function(){return!1}),e.shared.providers),u=Ot(m(m({},i),{markers:Yk(o),movement:uO(r,o)}));return{type:"widget",data:{value:Bu("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[DS().widget(sw.sketch(u))]}}var sO,lO={inserttable:MS,colorswatch:cO},fO=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)?x.some(t[e]):x.none()},dO=function(t,e){return fO(lO,t.fancytype).map((function(n){return n(t,e)}))},mO=function(t,e,n,r){void 0===r&&(r=!0);var o=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)}}},i=jC({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:x.none(),ariaLabel:t.text,caret:x.none(),checkMark:x.none(),shortcutContent:t.shortcut},n,r);return yS({data:wS(t),getApi:o,disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},i,e)},gO=function(t,e,r,o,i){void 0===o&&(o=!0),void 0===i&&(i=!1);var u=i?MC(r.icons):PC(r.icons),a=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)}}},c=jC({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:x.none(),ariaLabel:t.text,caret:x.some(u),checkMark:x.none(),shortcutContent:t.shortcut},r,o);return yS({data:wS(t),getApi:a,disabled:t.disabled,onAction:n,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,e)},pO=function(t){var e=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:m({tag:"div",classes:[mC,vC]},e),components:[]}},hO=function(t,e,n){var r=function(t){return{setActive:function(e){Ly.set(t,e)},isActive:function(){return Ly.isOn(t)},isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)}}},o=jC({iconContent:x.none(),textContent:t.text,htmlContent:x.none(),ariaLabel:t.text,checkMark:x.some(NC(n.icons)),caret:x.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},n,!0);return Ot(yS({data:wS(t),disabled:t.disabled,getApi:r,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},o,e),{toggling:{toggleClass:hC,toggleOnExecute:!1,selected:t.active}})},vO=TS,bO=pO,yO=mO,wO=gO,xO=hO,CO=dO;(function(t){t[t["ContentFocus"]=0]="ContentFocus",t[t["UiFocus"]=1]="UiFocus"})(sO||(sO={}));var SO=function(t){return void 0!==t.icon||"togglemenuitem"===t.type||"choicemenuitem"===t.type},kO=function(t){return j(t,SO)},OO=function(t,n,r,o,i){var u=r.shared.providers,a=function(t){return i?m(m({},t),{shortcut:x.none(),icon:t.text.isSome()?x.none():t.icon}):t};switch(t.type){case"menuitem":return Mx(t).fold(eO,(function(t){return x.some(yO(a(t),n,u,o))}));case"nestedmenuitem":return Lx(t).fold(eO,(function(t){return x.some(wO(a(t),n,u,o,i))}));case"togglemenuitem":return zx(t).fold(eO,(function(t){return x.some(xO(a(t),n,u))}));case"separator":return Tx(t).fold(eO,(function(t){return x.some(bO(t))}));case"fancymenuitem":return Gx(t).fold(eO,(function(t){return CO(a(t),r)}));default:return e.console.error("Unknown item in general menu",t),x.none()}},TO=function(t,e,n,r,o,i){var u=1===r,a=!u||kO(t);return Jc(W(t,(function(t){return"separator"===t.type?Ax(t).fold(eO,(function(t){return x.some(bO(t))})):_x(t).fold(eO,(function(t){return x.some(vO(t,e,u,"normal",n,o,i,a))}))})))},EO=function(t,e,n,r,o){var i=kO(e),u=Jc(W(e,(function(t){var e=function(t){return o?!t.hasOwnProperty("text"):i},u=function(t){return OO(t,n,r,e(t),o)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?u(Tt(t,{disabled:!0})):u(t)}))),a=o?nO:rO;return a(t,i,u,1,"normal")},DO=function(t){return xw.singleData(t.value,t)},AO=function(t,e,n,r){var o=n===sO.ContentFocus?$h():Xh(),i=uO(e,r),u=Yk(r);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:n===sO.ContentFocus,focusManager:o,menuBehaviours:Yx.unnamedEvents("auto"!==e?[]:[Li((function(t,e){qx(t,4,u.item).each((function(e){var n=e.numColumns,r=e.numRows;Qb.setGridSize(t,r,n)}))}))])}},_O=function(t,n){var r=Wn(x.none()),o=Wn(!1),i=sc(kw.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:dl([ly("dismissAutocompleter",[Di(Jo(),(function(){return s()}))])]),lazySink:n.getSink})),u=function(){return kw.isOpen(i)},a=function(){return r.get().isSome()},c=function(){a()&&kw.hide(i)},s=function(){if(a()){var e=r.get().map((function(t){return t.element}));ux(e.getOr(Kn.fromDom(t.selection.getNode()))).each(gu),c(),r.set(x.none()),o.set(!1)}},l=Et((function(){return Ix(t)})),f=function(r,i){var u=Zc(i,(function(t){return x.from(t.columns)})).getOr(1);return tt(i,(function(i){var a=i.items;return TO(a,i.matchText,(function(n,u){var a=t.selection.getRng();dx(t.dom,a,r).fold((function(){return e.console.error("Lost context. Cursor probably moved")}),(function(t){var e=t.range,r={hide:function(){s()},reload:function(t){c(),p(t)}};o.set(!0),i.onAction(r,e,n,u),o.set(!1)}))}),u,pS.BUBBLE_TO_SANDBOX,n)}))},d=function(e){if(!a()){var n=ix(t,e.range);r.set(x.some({triggerChar:e.triggerChar,element:n,matchLength:e.text.length})),o.set(!1)}},m=function(e,n,r,o){e.matchLength=n.text.length;var u=Zc(r,(function(t){return x.from(t.columns)})).getOr(1);kw.showAt(i,{anchor:"node",root:Kn.fromDom(t.getBody()),node:x.from(e.element)},sw.sketch(AO(rO("autocompleter-value",!0,o,u,"normal"),u,sO.ContentFocus,"normal"))),kw.getContent(i).each(Oh.highlightFirst)},g=function(e){return r.get().map((function(n){return dx(t.dom,t.selection.getRng(),n.triggerChar).bind((function(n){return kx(t,l,n,e)}))})).getOrThunk((function(){return Sx(t,l)}))},p=function(t){g(t).fold(s,(function(t){d(t.context),t.lookupData.then((function(e){r.get().map((function(n){var r=t.context;if(n.triggerChar===r.triggerChar){var o=f(r.triggerChar,e);o.length>0?m(n,r,e,o):r.text.length-n.matchLength>=10?s():c()}}))}))}))},h=Kw((function(t){27!==t.which&&p()}),50),v={onKeypress:h,cancelIfNecessary:s,isMenuOpen:u,isActive:a,isProcessingAction:o.get,getView:function(){return kw.getContent(i)}};gx.setup(v,t)},RO={register:_O},BO=function(t,e,n,r,o,u,a){return{target:i(t),x:i(e),y:i(n),stop:r,prevent:o,kill:u,raw:i(a)}},IO=function(t){var e=Kn.fromDom(t.target),n=function(){t.stopPropagation()},r=function(){t.preventDefault()},i=o(r,n);return BO(e,t.clientX,t.clientY,n,r,i,t)},NO=function(t,e){return function(n){t(n)&&e(IO(n))}},PO=function(t,e,n,r,o){var i=NO(n,r);return t.dom().addEventListener(e,i,o),{unbind:a(LO,t,e,i,o)}},MO=function(t,e,n,r){return PO(t,e,n,r,!1)},FO=function(t,e,n,r){return PO(t,e,n,r,!0)},LO=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},HO=i(!0),zO=function(t,e,n){return MO(t,e,HO,n)},jO=function(t,e,n){return FO(t,e,HO,n)},VO=IO,UO=function(t,e,n){return qc(t,e,n).isSome()};function WO(t,n){var r=null,o=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];r=e.setTimeout((function(){t.apply(null,o),r=null}),n)},i=function(){null!==r&&(e.clearTimeout(r),r=null)};return{cancel:i,schedule:o}}var GO=5,qO=400,XO=function(t){var e=t.raw();return void 0===e.touches||1!==e.touches.length?x.none():x.some(e.touches[0])},$O=function(t,e){var n=Math.abs(t.clientX-e.x()),r=Math.abs(t.clientY-e.y());return n>GO||r>GO},YO=function(t){var e=Wn(x.none()),n=Wn(!1),r=WO((function(e){t.triggerEvent(jo(),e),n.set(!0)}),qO),o=function(t){return XO(t).each((function(o){r.cancel();var u={x:i(o.clientX),y:i(o.clientY),target:t.target};r.schedule(t),n.set(!1),e.set(x.some(u))})),x.none()},u=function(t){return r.cancel(),XO(t).each((function(t){e.get().each((function(n){$O(t,n)&&e.set(x.none())}))})),x.none()},a=function(o){r.cancel();var i=function(t){return no(t.target(),o.target())};return e.get().filter(i).map((function(e){return n.get()?(o.prevent(),!1):t.triggerEvent(Ho(),o)}))},c=$t([{key:go(),value:o},{key:po(),value:u},{key:ho(),value:a}]),s=function(t,e){return qt(c,e).bind((function(e){return e(t)}))};return{fireIfReady:s}},KO=function(t){var e=t.raw();return e.which===Th()[0]&&!z(["input","textarea"],di(t.target()))&&!UO(t.target(),'[contenteditable="true"]')},JO=qr().browser.isFirefox(),QO=Pe([wn("triggerEvent"),In("stopBackspace",!0)]),ZO=function(t,e){return JO?jO(t,"focus",e):zO(t,"focusin",e)},tT=function(t,e){return JO?jO(t,"blur",e):zO(t,"focusout",e)},eT=function(t,n){var r=tn("Getting GUI events settings",QO,n),o=qr().deviceType.isTouch()?["touchstart","touchmove","touchend","touchcancel","gesturestart"]:["mousedown","mouseup","mouseover","mousemove","mouseout","click"],i=YO(r),u=W(o.concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(e){return zO(t,e,(function(t){i.fireIfReady(t,e).each((function(e){e&&t.kill()}));var n=r.triggerEvent(e,t);n&&t.kill()}))})),a=Wn(x.none()),c=zO(t,"paste",(function(t){i.fireIfReady(t,"paste").each((function(e){e&&t.kill()}));var n=r.triggerEvent("paste",t);n&&t.kill(),a.set(x.some(e.setTimeout((function(){r.triggerEvent(Po(),t)}),0)))})),s=zO(t,"keydown",(function(t){var e=r.triggerEvent("keydown",t);e?t.kill():!0===r.stopBackspace&&KO(t)&&t.prevent()})),l=ZO(t,(function(t){var e=r.triggerEvent("focusin",t);e&&t.kill()})),f=Wn(x.none()),d=tT(t,(function(t){var n=r.triggerEvent("focusout",t);n&&t.kill(),f.set(x.some(e.setTimeout((function(){r.triggerEvent(No(),t)}),0)))})),m=function(){G(u,(function(t){t.unbind()})),s.unbind(),l.unbind(),d.unbind(),c.unbind(),a.get().each(e.clearTimeout),f.get().each(e.clearTimeout)};return{unbind:m}},nT=function(t,e){var n=qt(t,"target").map((function(t){return t()})).getOr(e);return Wn(n)},rT=function(t,e){var n=Wn(!1),r=Wn(!1),o=function(){n.set(!0)},u=function(){r.set(!0)};return{stop:o,cut:u,isStopped:n.get,isCut:r.get,event:i(t),setSource:e.set,getSource:e.get}},oT=function(t){var e=Wn(!1),r=function(){e.set(!0)};return{stop:r,cut:n,isStopped:e.get,isCut:i(!1),event:i(t),setSource:s("Cannot set source of a broadcasted event"),getSource:s("Cannot get source of a broadcasted event")}},iT=wt.generate([{stopped:[]},{resume:["element"]},{complete:[]}]),uT=function(t,e,n,r,o,i){var u=t(e,r),a=rT(n,o);return u.fold((function(){return i.logEventNoHandlers(e,r),iT.complete()}),(function(t){var n=t.descHandler(),r=fa(n);return r(a),a.isStopped()?(i.logEventStopped(e,t.element(),n.purpose()),iT.stopped()):a.isCut()?(i.logEventCut(e,t.element(),n.purpose()),iT.complete()):Qi(t.element()).fold((function(){return i.logNoParent(e,t.element(),n.purpose()),iT.complete()}),(function(r){return i.logEventResponse(e,t.element(),n.purpose()),iT.resume(r)}))}))},aT=function(t,e,n,r,o,i){return uT(t,e,n,r,o,i).fold((function(){return!0}),(function(r){return aT(t,e,n,r,o,i)}),(function(){return!1}))},cT=function(t,e,n,r,o){var i=nT(n,r);return uT(t,e,n,r,i,o)},sT=function(t,e,n){var r=oT(e);return G(t,(function(t){var e=t.descHandler(),n=fa(e);n(r)})),r.isStopped()},lT=function(t,e,n,r){var o=n.target();return fT(t,e,n,o,r)},fT=function(t,e,n,r,o){var i=nT(n,r);return aT(t,e,n,r,i,o)},dT=Vi("element","descHandler"),mT=function(t,e){return{id:i(t),descHandler:i(e)}};function gT(){var t={},e=function(e,n,r){ft(r,(function(r,o){var i=void 0!==t[o]?t[o]:{};i[n]=la(r,e),t[o]=i}))},n=function(t,e){return Hu(e).fold((function(){return x.none()}),(function(n){var r=Wt(n);return t.bind(r).map((function(t){return dT(e,t)}))}))},r=function(e){return qt(t,e).map((function(t){return gt(t,(function(t,e){return mT(e,t)}))})).getOr([])},o=function(e,r,o){var i=Wt(r),u=i(t);return Si(o,(function(t){return n(u,t)}),e)},i=function(e){ft(t,(function(t,n){t.hasOwnProperty(e)&&delete t[e]}))};return{registerId:e,unregisterId:i,filterByType:r,find:o}}function pT(){var t=gT(),e={},n=function(t){var e=t.element();return Hu(e).fold((function(){return Fu("uid-",t.element())}),(function(t){return t}))},r=function(t,n){var r=e[n];if(r!==t)throw new Error('The tagId "'+n+'" is already used by: '+Eu(r.element())+"\nCannot use it for: "+Eu(t.element())+"\nThe conflicting element is"+(vi(r.element())?" ":" not ")+"already in the DOM");i(t)},o=function(o){var i=n(o);Qt(e,i)&&r(o,i);var u=[o];t.registerId(u,i,o.events()),e[i]=o},i=function(n){Hu(n.element()).each((function(n){delete e[n],t.unregisterId(n)}))},u=function(e){return t.filterByType(e)},a=function(e,n,r){return t.find(e,n,r)},c=function(t){return Wt(t)(e)};return{find:a,filter:u,register:o,unregister:i,getById:c}}var hT,vT=function(t){var e=t.dom,n=e.attributes,r=g(e,["attributes"]);return{uid:t.uid,dom:m({tag:"div",attributes:m({role:"presentation"},n)},r),components:t.components,behaviours:Wg(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},bT=Zp({name:"Container",factory:vT,configFields:[In("components",[]),Ug("containerBehaviours",[]),In("events",{}),In("domModification",{}),In("eventOrder",{})]}),yT=function(t){var e=function(e){return Qi(t.element()).fold((function(){return!0}),(function(t){return no(e,t)}))},r=pT(),o=function(t,n){return r.find(e,t,n)},u=eT(t.element(),{triggerEvent:function(t,e){return ss(t,e.target(),(function(n){return lT(o,t,e,n)}))}}),a={debugInfo:i("real"),triggerEvent:function(t,e,n){ss(t,e,(function(r){fT(o,t,n,e,r)}))},triggerFocus:function(t,e){Hu(t).fold((function(){Ol(t)}),(function(r){ss(Io(),t,(function(r){cT(o,Io(),{originator:i(e),kill:n,prevent:n,target:i(t)},t,r)}))}))},triggerEscape:function(t,e){a.triggerEvent("keydown",t.element(),e.event())},getByUid:function(t){return v(t)},getByDom:function(t){return b(t)},build:sc,addToGui:function(t){l(t)},removeFromGui:function(t){f(t)},addToWorld:function(t){c(t)},removeFromWorld:function(t){s(t)},broadcast:function(t){g(t)},broadcastOn:function(t,e){p(t,e)},broadcastEvent:function(t,e){h(t,e)},isConnected:i(!0)},c=function(t){t.connect(a),hi(t.element())||(r.register(t),G(t.components(),c),a.triggerEvent(Wo(),t.element(),{target:i(t.element())}))},s=function(t){hi(t.element())||(G(t.components(),s),r.unregister(t)),t.disconnect()},l=function(e){Bm(t,e)},f=function(t){Pm(t)},d=function(){u.unbind(),mu(t.element())},m=function(t){var e=r.filter(Mo());G(e,(function(e){var n=e.descHandler(),r=fa(n);r(t)}))},g=function(t){m({universal:i(!0),data:i(t)})},p=function(t,e){m({universal:i(!1),channels:i(t),data:i(e)})},h=function(t,e){var n=r.filter(t);return sT(n,e)},v=function(t){return r.getById(t).fold((function(){return O.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),O.value)},b=function(t){var e=Hu(t).getOr("not found");return v(e)};return c(t),{root:i(t),element:t.element,destroy:d,add:l,remove:f,getByUid:v,getByDom:b,addToWorld:c,removeFromWorld:s,broadcast:g,broadcastOn:p,broadcastEvent:h}},wT=tinymce.util.Tools.resolve("tinymce.EditorManager"),xT=function(t){var e=t.settings,n=e.skin,r=e.skin_url;if(!1!==n){var o=n||"oxide";r=r?t.documentBaseURI.toAbsolute(r):wT.baseURL+"/skins/ui/"+o}return r},CT=function(t){return t.getParam("readonly",!1,"boolean")},ST=function(t){return!1===t.getParam("skin")},kT=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},OT=function(t){return t.getParam("width",xS.DOM.getStyle(t.getElement(),"width"))},TT=function(t){return x.from(t.settings.min_width).filter(I)},ET=function(t){return x.from(t.settings.min_height).filter(I)},DT=function(t){return x.from(t.getParam("max_width")).filter(I)},AT=function(t){return x.from(t.getParam("max_height")).filter(I)},_T=function(t){return x.from(t.getParam("style_formats")).filter(_)},RT=function(t){return t.getParam("style_formats_merge",!1,"boolean")},BT=function(t){return t.getParam("removed_menuitems","")},IT=function(t){return!1!==t.getParam("menubar",!0,"boolean")},NT=function(t){var e=t.getParam("toolbar",!0),n=!0===e,r=D(e),o=_(e)&&e.length>0;return!MT(t)&&(o||r||n)},PT=function(t){var e=st(t.settings),n=$(e,(function(t){return/^toolbar([1-9])$/.test(t)})),r=W(n,(function(e){return t.getParam(e,!1,"string")})),o=$(r,(function(t){return"string"===typeof t}));return o.length>0?x.some(o):x.none()},MT=function(t){return PT(t).fold((function(){var e=t.getParam("toolbar",[],"string[]");return e.length>0}),(function(){return!0}))};(function(t){t["default"]="",t["floating"]="floating",t["sliding"]="sliding",t["scrolling"]="scrolling"})(hT||(hT={}));var FT=function(t){return t.getParam("toolbar_drawer","","string")},LT=function(t){return t.getParam("fixed_toolbar_container","","string")},HT=function(t){var e=LT(t);return e.length>0&&t.inline?Gc(bi(),e):x.none()},zT=function(t){return t.inline&&HT(t).isSome()},jT=function(t){var e=HT(t);return e.getOr(bi())},VT=function(t){return t.inline&&!IT(t)&&!NT(t)&&!MT(t)},UT=function(t){var e=t.getParam("toolbar_sticky",!1,"boolean");return(e||t.inline)&&!zT(t)&&!VT(t)},WT=function(t){return t.getParam("draggable_modal",!1,"boolean")},GT=5,qT=400,XT=function(t){return void 0===t.touches||1!==t.touches.length?x.none():x.some(t.touches[0])},$T=function(t,e){var n=Math.abs(t.clientX-e.x()),r=Math.abs(t.clientY-e.y());return n>GT||r>GT},YT=function(t){var e=Wn(x.none()),n=Wn(!1),r=Kw((function(e){t.fire("longpress",m(m({},e),{type:"longpress"})),n.set(!0)}),qT);t.on("touchstart",(function(t){XT(t).each((function(o){r.cancel();var u={x:i(o.clientX),y:i(o.clientY),target:i(t.target)};r.throttle(t),n.set(!1),e.set(x.some(u))}))}),!0),t.on("touchmove",(function(o){r.cancel(),XT(o).each((function(r){e.get().each((function(o){$T(r,o)&&(e.set(x.none()),n.set(!1),t.fire("longpresscancel"))}))}))}),!0),t.on("touchend touchcancel",(function(o){r.cancel(),"touchcancel"!==o.type&&e.get().filter((function(t){return t.target().isEqualNode(o.target)})).each((function(){if(n.get())o.preventDefault();else{var e=t.fire("tap");e.isDefaultPrevented()&&o.preventDefault()}}))}),!0)},KT={setup:YT},JT=Bu("form-component-change"),QT=Bu("form-close"),ZT=Bu("form-cancel"),tE=Bu("form-action"),eE=Bu("form-submit"),nE=Bu("form-block"),rE=Bu("form-unblock"),oE=Bu("form-tabchange"),iE=Bu("form-resize"),uE=function(t,e){return bT.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[Fw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:zw(t.icon,e.icons),attributes:{title:e.translate(t.iconTooltip)}},action:function(e){ui(e,tE,{name:"alert-banner",value:t.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:e.translate(t.text)}}]})},aE=function(t,e){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:W(t.items,e.interpreter)}},cE=i([In("prefix","form-field"),Ug("fieldBehaviours",[ih,Vg])]),sE=i([Cp({schema:[gn("dom")],name:"label"}),Cp({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[gn("text")],name:"aria-descriptor"}),wp({factory:{sketch:function(t){var e=Ut(t,["factory"]);return t.factory.sketch(e)}},schema:[gn("factory")],name:"field"})]),lE=function(t,e,n,r){var o=Gg(t.fieldBehaviours,[ih.config({find:function(e){return Pp(e,t,"field")}}),Vg.config({store:{mode:"manual",getValue:function(t){return ih.getCurrent(t).bind(Vg.getValue)},setValue:function(t,e){ih.getCurrent(t).each((function(t){Vg.setValue(t,e)}))}}})]),i=ki([Li((function(e,n){var r=Fp(e,t,["label","field","aria-descriptor"]);r.field().each((function(e){var n=Bu(t.prefix);r.label().each((function(t){yu(t.element(),"for",n),yu(e.element(),"id",n)})),r["aria-descriptor"]().each((function(n){var r=Bu(t.prefix);yu(n.element(),"id",r),yu(e.element(),"aria-describedby",r)}))}))}))]),u={getField:function(e){return Pp(e,t,"field")},getLabel:function(e){return Pp(e,t,"label")}};return{uid:t.uid,dom:t.dom,components:e,behaviours:o,events:i,apis:u}},fE=th({name:"FormField",configFields:cE(),partFields:sE(),factory:lE,apis:{getField:function(t,e){return t.getField(e)},getLabel:function(t,e){return t.getLabel(e)}}}),dE=i([On("data"),In("inputAttributes",{}),In("inputStyles",{}),In("tag","input"),In("inputClasses",[]),ys("onSetValue"),In("styles",{}),In("eventOrder",{}),Ug("inputBehaviours",[Vg,yy]),In("selectOnFocus",!0)]),mE=function(t){return dl([yy.config({onFocus:!1===t.selectOnFocus?n:function(t){var e=t.element(),n=Ya(e);e.dom().setSelectionRange(0,n.length)}})])},gE=function(t){return m(m({},mE(t)),Gg(t.inputBehaviours,[Vg.config({store:{mode:"manual",initialValue:t.data.getOr(void 0),getValue:function(t){return Ya(t.element())},setValue:function(t,e){var n=Ya(t.element());n!==e&&Ka(t.element(),e)}},onSetValue:t.onSetValue})]))},pE=function(t){return{tag:t.tag,attributes:m({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},hE=function(t,e){return{uid:t.uid,dom:pE(t),components:[],behaviours:gE(t),eventOrder:t.eventOrder}},vE=Zp({name:"Input",configFields:dE(),factory:hE}),bE={},yE={exports:bE};(function(e,n,r,o){(function(o){if("object"===typeof n&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof e&&e.amd)e([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(e,n,r){function i(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[a]={exports:{}};e[a][0].call(f.exports,(function(t){var n=e[a][1][t];return i(n||t)}),f,f.exports,t,e,n,r)}return n[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,e,n){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var l,f=[],d=!1,m=-1;function g(){d&&l&&(d=!1,l.length?f=l.concat(f):m=-1,f.length&&p())}function p(){if(!d){var t=c(g);d=!0;var e=f.length;while(e){l=f,f=[];while(++m<e)l&&l[m].run();m=-1,e=f.length}l=null,d=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new h(t,e)),1!==f.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){(function(n){var r=setTimeout;function o(){}function i(t,e){return function(){t.apply(e,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,e){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(o){return void s(e.promise,o)}c(e.promise,r)}else(1===t._state?c:s)(e.promise,t._value)}))):t._deferreds.push(e)}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof u)return t._state=3,t._value=e,void l(t);if("function"===typeof n)return void d(i(n,e),t)}t._state=1,t._value=e,l(t)}catch(r){s(t,r)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t((function(t){n||(n=!0,c(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(r){if(n)return;n=!0,s(e,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,e){var n=new this.constructor(o);return a(this,new f(t,e,n)),n},u.all=function(t){var e=Array.prototype.slice.call(t);return new u((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),n)}e[i]=u,0===--r&&t(e)}catch(c){n(c)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(e){e(t)}))},u.reject=function(t){return new u((function(e,n){n(t)}))},u.race=function(t){return new u((function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)}))},u._immediateFn="function"===typeof t?function(e){t(e)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof e&&e.exports?e.exports=u:n.Promise||(n.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(e,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n.setImmediate="function"===typeof e?e:function(t){var e=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[e]=!0,o((function(){a[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))})),e},n.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,bE,yE,void 0);var wE,xE=yE.exports.boltExport,CE=function(t){var n=x.none(),r=[],o=function(t){return CE((function(e){i((function(n){e(t(n))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){n=x.some(t),c(r),r=[]},a=function(){return n.isSome()},c=function(t){G(t,s)},s=function(t){n.each((function(n){e.setTimeout((function(){t(n)}),0)}))};return t(u),{get:i,map:o,isReady:a}},SE=function(t){return CE((function(e){e(t)}))},kE={nu:CE,pure:SE},OE=function(t){e.setTimeout((function(){throw t}),0)},TE=function(t){var e=function(e){t().then(e,OE)},n=function(e){return TE((function(){return t().then(e)}))},r=function(e){return TE((function(){return t().then((function(t){return e(t).toPromise()}))}))},o=function(e){return TE((function(){return t().then((function(){return e.toPromise()}))}))},i=function(){return kE.nu(e)},u=function(){var e=null;return TE((function(){return null===e&&(e=t()),e}))},a=t;return{map:n,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:e}},EE=function(t){return TE((function(){return new xE(t)}))},DE=function(t){return TE((function(){return xE.resolve(t)}))},AE={nu:EE,pure:DE},_E=["input","textarea"],RE=function(t){var e=di(t);return z(_E,e)},BE=function(t,e){var n=e.getRoot(t).getOr(t.element());Ia(n,e.invalidClass),e.notify.each((function(e){RE(t.element())&&yu(t.element(),"aria-invalid",!1),e.getContainer(t).each((function(t){hu(t,e.validHtml)})),e.onValid(t)}))},IE=function(t,e,n,r){var o=e.getRoot(t).getOr(t.element());Ra(o,e.invalidClass),e.notify.each((function(e){RE(t.element())&&yu(t.element(),"aria-invalid",!0),e.getContainer(t).each((function(t){hu(t,r)})),e.onInvalid(t,r)}))},NE=function(t,e,n){return e.validator.fold((function(){return AE.pure(O.value(!0))}),(function(e){return e.validate(t)}))},PE=function(t,e,n){return e.notify.each((function(e){e.onValidate(t)})),NE(t,e).map((function(r){return t.getSystem().isConnected()?r.fold((function(r){return IE(t,e,n,r),O.error(r)}),(function(n){return BE(t,e),O.value(n)})):O.error("No longer in system")}))},ME=function(t,e){var n=e.getRoot(t).getOr(t.element());return Na(n,e.invalidClass)},FE=Object.freeze({markValid:BE,markInvalid:IE,query:NE,run:PE,isInvalid:ME}),LE=function(t,e){return t.validator.map((function(r){return ki([Di(r.onEvent,(function(n){PE(n,t,e).get(u)}))].concat(r.validateOnLoad?[Li((function(r){PE(r,t,e).get(n)}))]:[]))})).getOr({})},HE=Object.freeze({events:LE}),zE=[gn("invalidClass"),In("getRoot",x.none),Rn("notify",[In("aria","alert"),In("getContainer",x.none),In("validHtml",""),ys("onValid"),ys("onInvalid"),ys("onValidate")]),Rn("validator",[gn("validate"),In("onEvent","input"),In("validateOnLoad",!0)])],jE=gl({fields:zE,name:"invalidating",active:HE,apis:FE,extra:{validation:function(t){return function(e){var n=Vg.getValue(e);return AE.pure(t(n))}}}}),VE=function(t,e){return oa({attributes:$t([{key:e.tabAttr,value:"true"}])})},UE=Object.freeze({exhibit:VE}),WE=[In("tabAttr","data-alloy-tabstop")],GE=gl({fields:WE,name:"tabstopping",active:UE}),qE=function(t,e,n,r){var o=$E(t,e,n,r);return fE.sketch(o)},XE=function(t,e){return qE(t,e,[],[])},$E=function(t,e,n,r){return{dom:KE(n),components:t.toArray().concat([e]),fieldBehaviours:dl(r)}},YE=function(){return KE([])},KE=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},JE=function(t,e){return fE.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}})},QE=function(t,e,n,r){return n.getOrCreate(t,e,r)},ZE=Object.freeze({getCoupled:QE}),tD=[pn("others",Ke(O.value,on()))],eD=function(t){var e={},n=function(t,n,r){var o=st(n.others);if(o)return qt(e,r).getOrThunk((function(){var o=qt(n.others,r).getOrDie("No information found for coupled component: "+r),i=o(t),u=t.getSystem().build(i);return e[r]=u,u}));throw new Error("Cannot find coupled component: "+r+". Known coupled components: "+JSON.stringify(o,null,2))},r=i({});return Zu({readState:r,getOrCreate:n})},nD=Object.freeze({init:eD}),rD=gl({fields:tD,name:"coupling",apis:ZE,state:nD}),oD=i("sink"),iD=i(Cp({name:oD(),overrides:i({dom:{tag:"div"},behaviours:dl([Tm.config({useFixed:f})]),events:ki([Pi(Oo()),Pi(bo()),Pi(Ao())])})}));(function(t){t[t["HighlightFirst"]=0]="HighlightFirst",t[t["HighlightNone"]=1]="HighlightNone"})(wE||(wE={}));var uD=function(t,e){var n=t.getHotspot(e).getOr(e),r="hotspot",o=t.getAnchorOverrides();return t.layouts.fold((function(){return{anchor:r,hotspot:n,overrides:o}}),(function(t){return{anchor:r,hotspot:n,overrides:o,layouts:t}}))},aD=function(t,e,n){var r=t.fetch;return r(n).map(e)},cD=function(t,e,n,r,o,i,u){var a=aD(t,e,r),c=mD(r,t);return a.map((function(t){return t.bind((function(t){return x.from(xw.sketch(m(m({},i.menu()),{uid:zu(""),data:t,highlightImmediately:u===wE.HighlightFirst,onOpenMenu:function(t,e){var r=c().getOrDie();Tm.position(r,n,e),ug.decloak(o)},onOpenSubmenu:function(t,e,n){var r=c().getOrDie();Tm.position(r,{anchor:"submenu",item:e},n),ug.decloak(o)},onRepositionMenu:function(t,e,r){var o=c().getOrDie();Tm.position(o,n,e),G(r,(function(t){Tm.position(o,{anchor:"submenu",item:t.triggeringItem},t.triggeredMenu)}))},onEscape:function(){return yy.focus(r),ug.close(o),x.some(!0)}})))}))}))},sD=function(t,e,n,r,o,i,u){var a=uD(t,n),c=cD(t,e,a,n,r,o,u);return c.map((function(t){return t.fold((function(){ug.isOpen(r)&&ug.close(r)}),(function(t){ug.cloak(r),ug.open(r,t),i(r)})),r}))},lD=function(t,e,n,r,o,i,u){return ug.close(r),AE.pure(r)},fD=function(t,e,n,r,o,i){var u=rD.getCoupled(n,"sandbox"),a=ug.isOpen(u),c=a?lD:sD;return c(t,e,n,u,r,o,i)},dD=function(t,e,n){var r=ih.getCurrent(e).getOr(e),o=Oc(t.element());n?za(r.element(),"min-width",o+"px"):kc(r.element(),o)},mD=function(t,e){return t.getSystem().getByUid(e.uid+"-"+oD()).map((function(t){return function(){return O.value(t)}})).getOrThunk((function(){return e.lazySink.fold((function(){return function(){return O.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(e){return function(){return e(t)}}))}))},gD=function(t){ug.getState(t).each((function(t){xw.repositionMenus(t)}))},pD=function(t,e,n){var r=$c(),o=function(o,i){var u=uD(t,e);r.link(e.element()),t.matchWidth&&dD(u.hotspot,i,t.useMinWidth),t.onOpen(u,o,i),void 0!==n&&void 0!==n.onOpen&&n.onOpen(o,i)},u=function(t,o){r.unlink(e.element()),void 0!==n&&void 0!==n.onClose&&n.onClose(t,o)},a=mD(e,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:r.id(),role:"listbox"}},behaviours:qg.augment(t.sandboxBehaviours,[Vg.config({store:{mode:"memory",initialValue:e}}),ug.config({onOpen:o,onClose:u,isPartOf:function(t,n,r){return Kc(n,r)||Kc(e,r)},getAttachPoint:function(){return a().getOrDie()}}),ih.config({find:function(t){return ug.getState(t).bind((function(t){return ih.getCurrent(t)}))}}),Cl.config({channels:m(m({},fg({isExtraPart:i(!1)})),mg({isExtraPart:i(!1),doReposition:gD}))})])}},hD=function(t){var e=rD.getCoupled(t,"sandbox");gD(e)},vD=function(){return[In("sandboxClasses",[]),qg.field("sandboxBehaviours",[ih,Cl,ug,Vg])]},bD=i([gn("dom"),gn("fetch"),ys("onOpen"),ws("onExecute"),In("getHotspot",x.some),In("getAnchorOverrides",i({})),In("layouts",x.none()),Ug("dropdownBehaviours",[Ly,rD,Qb,yy]),gn("toggleClass"),In("eventOrder",{}),On("lazySink"),In("matchWidth",!1),In("useMinWidth",!1),On("role")].concat(vD())),yD=i([xp({schema:[hs()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),iD()]),wD=function(t,e,r,o){var i,u=function(e){return qt(t.dom,"attributes").bind((function(t){return qt(t,e)}))},a=function(t){ug.getState(t).each((function(t){xw.highlightPrimary(t)}))},c=function(e){var r=a;fD(t,(function(t){return t}),e,o,r,wE.HighlightFirst).get(n)},s={expand:function(e){Ly.isOn(e)||fD(t,(function(t){return t}),e,o,n,wE.HighlightNone).get(n)},open:function(e){Ly.isOn(e)||fD(t,(function(t){return t}),e,o,n,wE.HighlightFirst).get(n)},isOpen:Ly.isOn,close:function(e){Ly.isOn(e)&&fD(t,(function(t){return t}),e,o,n,wE.HighlightFirst).get(n)},repositionMenus:function(t){Ly.isOn(t)&&hD(t)}},l=function(t,e){return ai(t),x.some(!0)};return{uid:t.uid,dom:t.dom,components:e,behaviours:Gg(t.dropdownBehaviours,[Ly.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),rD.config({others:{sandbox:function(e){return pD(t,e,{onOpen:function(){Ly.on(e)},onClose:function(){Ly.off(e)}})}}}),Qb.config({mode:"special",onSpace:l,onEnter:l,onDown:function(t,e){if(xD.isOpen(t)){var n=rD.getCoupled(t,"sandbox");a(n)}else xD.open(t);return x.some(!0)},onEscape:function(t,e){return xD.isOpen(t)?(xD.close(t),x.some(!0)):x.none()}}),yy.config({})]),events:zy(x.some(c)),eventOrder:m(m({},t.eventOrder),(i={},i[Fo()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:s,domModification:{attributes:m(m({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:u("type").getOr("button")}:{})}}},xD=th({name:"Dropdown",configFields:bD(),partFields:yD(),factory:wD,apis:{open:function(t,e){return t.open(e)},expand:function(t,e){return t.expand(e)},close:function(t,e){return t.close(e)},isOpen:function(t,e){return t.isOpen(e)},repositionMenus:function(t,e){return t.repositionMenus(e)}}}),CD=function(t,e){return oa({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})},SD=function(t){return ki([Oi(Ro(),i(!0))])},kD=Object.freeze({events:SD,exhibit:CD}),OD=gl({fields:[],name:"unselecting",active:kD}),TD=function(t,e){return xD.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:dl([OD.config({}),GE.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:e.getSink,fetch:function(n){return AE.nu((function(e){return t.fetch(e)})).map((function(r){return x.from(DO(Ot(oO(Bu("menu-value"),r,(function(e){t.onItemAction(n,e)}),t.columns,t.presets,pS.CLOSE_ON_EXECUTE,(function(){return!1}),e.providers),{movement:uO(t.columns,t.presets)})))}))},parts:{menu:Qk(!1,1,t.presets)}})},ED=Bu("color-input-change"),DD=Bu("color-swatch-change"),AD=Bu("color-picker-cancel"),_D=function(t,e,n){var r=fE.parts().field({factory:vE,inputClasses:["tox-textfield"],onSetValue:function(t){return jE.run(t).get((function(){}))},inputBehaviours:dl([GE.config({}),jE.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return Qi(t.element())},notify:{onValid:function(t){var e=Vg.getValue(t);ui(t,ED,{color:e})}},validator:{validateOnLoad:!1,validate:function(t){var e=Vg.getValue(t);if(0===e.length)return AE.pure(O.value(!0));var n=Kn.fromTag("span");za(n,"background-color",e);var r=Ga(n,"background-color").fold((function(){return O.error("blah")}),(function(t){return O.value(e)}));return AE.pure(r)}}})]),selectOnFocus:!1}),o=t.label.map((function(t){return JE(t,e.providers)})),i=function(t,e){ui(t,DD,{value:e})},u=function(t,e){a.getOpt(t).each((function(t){"custom"===e?n.colorPicker((function(e){e.fold((function(){return ii(t,AD)}),(function(e){i(t,e),vk.addColor(e)}))}),"#ffffff"):i(t,"remove"===e?"":e)}))},a=Lw(TD({dom:{tag:"span",attributes:{"aria-label":e.providers.translate("Color swatch")}},layouts:x.some({onRtl:function(){return[Xs]},onLtr:function(){return[$s]}}),components:[],fetch:zk.getFetch(n.getColors(),n.hasCustomColors()),columns:n.getColorCols(),presets:"color",onItemAction:u},e));return fE.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:o.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,a.asSpec()]}]),fieldBehaviours:dl([ly("form-field-events",[Di(ED,(function(e,n){a.getOpt(e).each((function(t){za(t.element(),"background-color",n.event().color())})),ui(e,JT,{name:t.name})})),Di(DD,(function(t,e){fE.getField(t).each((function(n){Vg.setValue(n,e.event().value()),ih.getCurrent(t).each(yy.focus)}))})),Di(AD,(function(t,e){fE.getField(t).each((function(e){ih.getCurrent(t).each(yy.focus)}))}))])])})},RD=function(t,e,n){return{hue:i(t),saturation:i(e),value:i(n)}},BD=function(t){var e=0,n=0,r=0,o=t.red()/255,i=t.green()/255,u=t.blue()/255,a=Math.min(o,Math.min(i,u)),c=Math.max(o,Math.max(i,u));if(a===c)return r=a,RD(0,0,100*r);var s=o===a?i-u:u===a?o-i:u-o;return e=o===a?3:u===a?1:5,e=60*(e-s/(c-a)),n=(c-a)/c,r=c,RD(Math.round(e),Math.round(100*n),Math.round(100*r))},ID=function(t){var e=(100-t)/100*360,n=RD(e,100,100),r=QS(n);return WS(r)},ND=i(Bu("rgb-hex-update")),PD=i(Bu("slider-update")),MD=i(Bu("palette-update")),FD=qr(),LD=FD.deviceType.isTouch(),HD=Cp({schema:[gn("dom")],name:"label"}),zD=function(t){return Cp({name:t+"-edge",overrides:function(e){var n=e.model.manager.edgeActions[t];return n.fold((function(){return{}}),(function(t){var n=ki([Ai(go(),t,[e])]),r=ki([Ai(bo(),t,[e]),Ai(yo(),(function(e,n){n.mouseIsDown.get()&&t(e,n)}),[e])]);return{events:LD?n:r}}))}})},jD=zD("top-left"),VD=zD("top"),UD=zD("top-right"),WD=zD("right"),GD=zD("bottom-right"),qD=zD("bottom"),XD=zD("bottom-left"),$D=zD("left"),YD=wp({name:"thumb",defaults:i({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:ki([Ii(go(),t,"spectrum"),Ii(po(),t,"spectrum"),Ii(ho(),t,"spectrum"),Ii(bo(),t,"spectrum"),Ii(yo(),t,"spectrum"),Ii(xo(),t,"spectrum")])}}}),KD=wp({schema:[Un("mouseIsDown",(function(){return Wn(!1)}))],name:"spectrum",overrides:function(t){var e=t.model,n=e.manager,r=function(e,r){return n.getValueFromEvent(r).map((function(r){return n.setValueFrom(e,t,r)}))},o=ki([Di(go(),r),Di(po(),r)]),i=ki([Di(bo(),r),Di(yo(),(function(e,n){t.mouseIsDown.get()&&r(e,n)}))]);return{behaviours:dl(LD?[]:[Qb.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),yy.config({})]),events:LD?o:i}}}),JD=[HD,$D,WD,VD,qD,jD,UD,XD,GD,YD,KD],QD=qr().deviceType.isTouch(),ZD="slider.change.value",tA=i(ZD),eA=function(t){var e=t.event().raw();if(QD){var n=e;return void 0!==n.touches&&1===n.touches.length?x.some(n.touches[0]).map((function(t){return bc(t.clientX,t.clientY)})):x.none()}var r=e;return void 0!==r.clientX?x.some(r).map((function(t){return bc(t.clientX,t.clientY)})):x.none()},nA="top",rA="right",oA="bottom",iA="left",uA=function(t){return t.model.minX},aA=function(t){return t.model.minY},cA=function(t){return t.model.minX-1},sA=function(t){return t.model.minY-1},lA=function(t){return t.model.maxX},fA=function(t){return t.model.maxY},dA=function(t){return t.model.maxX+1},mA=function(t){return t.model.maxY+1},gA=function(t,e,n){return e(t)-n(t)},pA=function(t){return gA(t,lA,uA)},hA=function(t){return gA(t,fA,aA)},vA=function(t){return pA(t)/2},bA=function(t){return hA(t)/2},yA=function(t){return t.stepSize},wA=function(t){return t.snapToGrid},xA=function(t){return t.snapStart},CA=function(t){return t.rounded},SA=function(t,e){return void 0!==t[e+"-edge"]},kA=function(t){return SA(t,iA)},OA=function(t){return SA(t,rA)},TA=function(t){return SA(t,nA)},EA=function(t){return SA(t,oA)},DA=function(t){return t.model.value.get()},AA=function(t){return{x:i(t)}},_A=function(t){return{y:i(t)}},RA=function(t,e){return{x:i(t),y:i(e)}},BA=function(t,e){ui(t,tA(),{value:e})},IA=function(t,e){BA(t,RA(cA(e),sA(e)))},NA=function(t,e){BA(t,_A(sA(e)))},PA=function(t,e){BA(t,RA(vA(e),sA(e)))},MA=function(t,e){BA(t,RA(dA(e),sA(e)))},FA=function(t,e){BA(t,AA(dA(e)))},LA=function(t,e){BA(t,RA(dA(e),bA(e)))},HA=function(t,e){BA(t,RA(dA(e),mA(e)))},zA=function(t,e){BA(t,_A(mA(e)))},jA=function(t,e){BA(t,RA(vA(e),mA(e)))},VA=function(t,e){BA(t,RA(cA(e),mA(e)))},UA=function(t,e){BA(t,AA(cA(e)))},WA=function(t,e){BA(t,RA(cA(e),bA(e)))},GA=function(t,e,n,r){return t<e?t:t>n?n:t===e?e-1:Math.max(e,t-r)},qA=function(t,e,n,r){return t>n?t:t<e?e:t===n?n+1:Math.min(n,t+r)},XA=function(t,e,n){return Math.max(e,Math.min(n,t))},$A=function(t,e,n,r,o){return o.fold((function(){var o=t-e,i=Math.round(o/r)*r;return XA(e+i,e-1,n+1)}),(function(e){var o=(t-e)%r,i=Math.round(o/r),u=Math.floor((t-e)/r),a=Math.floor((n-e)/r),c=Math.min(a,u+i),s=e+c*r;return Math.max(e,s)}))},YA=function(t,e,n){return Math.min(n,Math.max(t,e))-e},KA=function(t){var e=t.min,n=t.max,r=t.range,o=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,l=t.hasMaxEdge,f=t.minBound,d=t.maxBound,m=t.screenRange,g=s?e-1:e,p=l?n+1:n;if(o<f)return g;if(o>d)return p;var h=YA(o,f,d),v=XA(h/m*r+e,g,p);return u&&v>=e&&v<=n?$A(v,e,n,i,a):c?Math.round(v):v},JA=function(t){var e=t.min,n=t.max,r=t.range,o=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,l=t.centerMaxEdge;return o<e?i?0:s:o>n?u?a:l:(o-e)/r*c},QA="top",ZA="right",t_="bottom",e_="left",n_="width",r_="height",o_=function(t){return t.element().dom().getBoundingClientRect()},i_=function(t,e){return t[e]},u_=function(t){var e=o_(t);return i_(e,e_)},a_=function(t){var e=o_(t);return i_(e,ZA)},c_=function(t){var e=o_(t);return i_(e,QA)},s_=function(t){var e=o_(t);return i_(e,t_)},l_=function(t){var e=o_(t);return i_(e,n_)},f_=function(t){var e=o_(t);return i_(e,r_)},d_=function(t,e,n){return(t+e)/2-n},m_=function(t,e){var n=o_(t),r=o_(e),o=i_(n,e_),i=i_(n,ZA),u=i_(r,e_);return d_(o,i,u)},g_=function(t,e){var n=o_(t),r=o_(e),o=i_(n,QA),i=i_(n,t_),u=i_(r,QA);return d_(o,i,u)},p_=function(t,e){ui(t,tA(),{value:e})},h_=function(t){return{x:i(t)}},v_=function(t,e,n){var r={min:uA(e),max:lA(e),range:pA(e),value:n,step:yA(e),snap:wA(e),snapStart:xA(e),rounded:CA(e),hasMinEdge:kA(e),hasMaxEdge:OA(e),minBound:u_(t),maxBound:a_(t),screenRange:l_(t)};return KA(r)},b_=function(t,e,n){var r=v_(t,e,n),o=h_(r);return p_(t,o),r},y_=function(t,e){var n=uA(e);p_(t,h_(n))},w_=function(t,e){var n=lA(e);p_(t,h_(n))},x_=function(t,e,n){var r=t>0?qA:GA,o=r(DA(n).x(),uA(n),lA(n),yA(n));return p_(e,h_(o)),x.some(o)},C_=function(t){return function(e,n){return x_(t,e,n).map((function(){return!0}))}},S_=function(t){var e=eA(t);return e.map((function(t){return t.left()}))},k_=function(t,e,n,r,o){var i=0,u=l_(t),a=r.bind((function(e){return x.some(m_(e,t))})).getOr(i),c=o.bind((function(e){return x.some(m_(e,t))})).getOr(u),s={min:uA(e),max:lA(e),range:pA(e),value:n,hasMinEdge:kA(e),hasMaxEdge:OA(e),minBound:u_(t),minOffset:i,maxBound:a_(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return JA(s)},O_=function(t,e,n,r,o,i){var u=k_(e,i,n,r,o);return u_(e)-u_(t)+u},T_=function(t,e,n,r){var o=DA(n),i=O_(t,r.getSpectrum(t),o.x(),r.getLeftEdge(t),r.getRightEdge(t),n),u=Oc(e.element())/2;za(e.element(),"left",i-u+"px")},E_=C_(-1),D_=C_(1),A_=x.none,__=x.none,R_={"top-left":x.none(),top:x.none(),"top-right":x.none(),right:x.some(FA),"bottom-right":x.none(),bottom:x.none(),"bottom-left":x.none(),left:x.some(UA)},B_=Object.freeze({setValueFrom:b_,setToMin:y_,setToMax:w_,findValueOfOffset:v_,getValueFromEvent:S_,findPositionOfValue:O_,setPositionFromValue:T_,onLeft:E_,onRight:D_,onUp:A_,onDown:__,edgeActions:R_}),I_=function(t,e){ui(t,tA(),{value:e})},N_=function(t){return{y:i(t)}},P_=function(t,e,n){var r={min:aA(e),max:fA(e),range:hA(e),value:n,step:yA(e),snap:wA(e),snapStart:xA(e),rounded:CA(e),hasMinEdge:TA(e),hasMaxEdge:EA(e),minBound:c_(t),maxBound:s_(t),screenRange:f_(t)};return KA(r)},M_=function(t,e,n){var r=P_(t,e,n),o=N_(r);return I_(t,o),r},F_=function(t,e){var n=aA(e);I_(t,N_(n))},L_=function(t,e){var n=fA(e);I_(t,N_(n))},H_=function(t,e,n){var r=t>0?qA:GA,o=r(DA(n).y(),aA(n),fA(n),yA(n));return I_(e,N_(o)),x.some(o)},z_=function(t){return function(e,n){return H_(t,e,n).map((function(){return!0}))}},j_=function(t){var e=eA(t);return e.map((function(t){return t.top()}))},V_=function(t,e,n,r,o){var i=0,u=f_(t),a=r.bind((function(e){return x.some(g_(e,t))})).getOr(i),c=o.bind((function(e){return x.some(g_(e,t))})).getOr(u),s={min:aA(e),max:fA(e),range:hA(e),value:n,hasMinEdge:TA(e),hasMaxEdge:EA(e),minBound:c_(t),minOffset:i,maxBound:s_(t),maxOffset:u,centerMinEdge:a,centerMaxEdge:c};return JA(s)},U_=function(t,e,n,r,o,i){var u=V_(e,i,n,r,o);return c_(e)-c_(t)+u},W_=function(t,e,n,r){var o=DA(n),i=U_(t,r.getSpectrum(t),o.y(),r.getTopEdge(t),r.getBottomEdge(t),n),u=gc(e.element())/2;za(e.element(),"top",i-u+"px")},G_=x.none,q_=x.none,X_=z_(-1),$_=z_(1),Y_={"top-left":x.none(),top:x.some(NA),"top-right":x.none(),right:x.none(),"bottom-right":x.none(),bottom:x.some(zA),"bottom-left":x.none(),left:x.none()},K_=Object.freeze({setValueFrom:M_,setToMin:F_,setToMax:L_,findValueOfOffset:P_,getValueFromEvent:j_,findPositionOfValue:U_,setPositionFromValue:W_,onLeft:G_,onRight:q_,onUp:X_,onDown:$_,edgeActions:Y_}),J_=function(t,e){ui(t,tA(),{value:e})},Q_=function(t,e){return{x:i(t),y:i(e)}},Z_=function(t,e,n){var r=v_(t,e,n.left()),o=P_(t,e,n.top()),i=Q_(r,o);return J_(t,i),i},tR=function(t,e,n,r){var o=t>0?qA:GA,i=e?DA(r).x():o(DA(r).x(),uA(r),lA(r),yA(r)),u=e?o(DA(r).y(),aA(r),fA(r),yA(r)):DA(r).y();return J_(n,Q_(i,u)),x.some(i)},eR=function(t,e){return function(n,r){return tR(t,e,n,r).map((function(){return!0}))}},nR=function(t,e){var n=uA(e),r=aA(e);J_(t,Q_(n,r))},rR=function(t,e){var n=lA(e),r=fA(e);J_(t,Q_(n,r))},oR=function(t){return eA(t)},iR=function(t,e,n,r){var o=DA(n),i=O_(t,r.getSpectrum(t),o.x(),r.getLeftEdge(t),r.getRightEdge(t),n),u=U_(t,r.getSpectrum(t),o.y(),r.getTopEdge(t),r.getBottomEdge(t),n),a=Oc(e.element())/2,c=gc(e.element())/2;za(e.element(),"left",i-a+"px"),za(e.element(),"top",u-c+"px")},uR=eR(-1,!1),aR=eR(1,!1),cR=eR(-1,!0),sR=eR(1,!0),lR={"top-left":x.some(IA),top:x.some(PA),"top-right":x.some(MA),right:x.some(LA),"bottom-right":x.some(HA),bottom:x.some(jA),"bottom-left":x.some(VA),left:x.some(WA)},fR=Object.freeze({setValueFrom:Z_,setToMin:nR,setToMax:rR,getValueFromEvent:oR,setPositionFromValue:iR,onLeft:uR,onRight:aR,onUp:cR,onDown:sR,edgeActions:lR}),dR=qr().deviceType.isTouch(),mR=[In("stepSize",1),In("onChange",n),In("onChoose",n),In("onInit",n),In("onDragStart",n),In("onDragEnd",n),In("snapToGrid",!1),In("rounded",!0),On("snapStart"),pn("model",rn("mode",{x:[In("minX",0),In("maxX",100),Un("value",(function(t){return Wn(t.mode.minX)})),gn("getInitialValue"),Ss("manager",B_)],y:[In("minY",0),In("maxY",100),Un("value",(function(t){return Wn(t.mode.minY)})),gn("getInitialValue"),Ss("manager",K_)],xy:[In("minX",0),In("maxX",100),In("minY",0),In("maxY",100),Un("value",(function(t){return Wn({x:i(t.mode.minX),y:i(t.mode.minY)})})),gn("getInitialValue"),Ss("manager",fR)]})),Ug("sliderBehaviours",[Qb,Vg])].concat(dR?[]:[Un("mouseIsDown",(function(){return Wn(!1)}))]),gR=qr().deviceType.isTouch(),pR=function(t,e,n,r){var o=function(e){return Mp(e,t,"thumb")},u=function(e){return Mp(e,t,"spectrum")},a=function(e){return Pp(e,t,"left-edge")},c=function(e){return Pp(e,t,"right-edge")},s=function(e){return Pp(e,t,"top-edge")},l=function(e){return Pp(e,t,"bottom-edge")},f=t.model,d=f.manager,m=function(e,n){d.setPositionFromValue(e,n,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:l,getSpectrum:u})},g=function(e,n){f.value.set(n);var r=o(e);return m(e,r),t.onChange(e,r,n),x.some(!0)},p=function(e){d.setToMin(e,t)},h=function(e){d.setToMax(e,t)},v=[Di(go(),(function(e,n){t.onDragStart(e,o(e))})),Di(ho(),(function(e,n){t.onDragEnd(e,o(e))}))],b=[Di(bo(),(function(e,n){n.stop(),t.onDragStart(e,o(e)),t.mouseIsDown.set(!0)})),Di(xo(),(function(e,n){t.onDragEnd(e,o(e))}))],y=gR?v:b;return{uid:t.uid,dom:t.dom,components:e,behaviours:Gg(t.sliderBehaviours,Z([gR?[]:[Qb.config({mode:"special",focusIn:function(e){return Pp(e,t,"spectrum").map(Qb.focusIn).map(i(!0))}})],[Vg.config({store:{mode:"manual",getValue:function(t){return f.value.get()}}}),Cl.config({channels:{"mouse.released":{onReceive:function(e,n){var r=function(){Pp(e,t,"thumb").each((function(n){var r=f.value.get();t.onChoose(e,n,r)}))};if(gR)r();else{var o=t.mouseIsDown.get();t.mouseIsDown.set(!1),o&&r()}}}}})]])),events:ki([Di(tA(),(function(t,e){g(t,e.event().value())})),Li((function(e,n){var r=f.getInitialValue();f.value.set(r);var i=o(e);m(e,i);var a=u(e);t.onInit(e,i,a,f.value.get())}))].concat(y)),apis:{resetToMin:p,resetToMax:h,changeValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},hR=th({name:"Slider",configFields:mR,partFields:JD,factory:pR,apis:{resetToMin:function(t,e){t.resetToMin(e)},resetToMax:function(t,e){t.resetToMax(e)},refresh:function(t,e){t.refresh(e)}}}),vR=function(t,e){var n=hR.parts().spectrum({dom:{tag:"div",classes:[e("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=hR.parts().thumb({dom:{tag:"div",classes:[e("hue-slider-thumb")],attributes:{role:"presentation"}}});return hR.sketch({dom:{tag:"div",classes:[e("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:i({y:i(0)})},components:[n,r],sliderBehaviours:dl([yy.config({})]),onChange:function(t,e,n){ui(t,PD(),{value:n})}})},bR={sliderFactory:vR},yR="form",wR=[Ug("formBehaviours",[Vg])],xR=function(t){return"<alloy.field."+t+">"},CR=function(t){var e=function(){var t=[],e=function(e,n){return t.push(e),_p(yR,xR(e),n)};return{field:e,record:function(){return t}}}(),n=t(e),r=e.record(),o=W(r,(function(t){return wp({name:t,pname:xR(t)})}));return Xp(yR,wR,o,kR,n)},SR=function(t,e){return t.fold((function(){return O.error(e)}),O.value)},kR=function(t,e,n){return{uid:t.uid,dom:t.dom,components:e,behaviours:Gg(t.formBehaviours,[Vg.config({store:{mode:"manual",getValue:function(e){var n=Lp(e,t);return dt(n,(function(t,e){return t().bind((function(t){var e=ih.getCurrent(t);return SR(e,"missing current")})).map(Vg.getValue)}))},setValue:function(e,n){ft(n,(function(n,r){Pp(e,t,r).each((function(t){ih.getCurrent(t).each((function(t){Vg.setValue(t,n)}))}))}))}}})]),apis:{getField:function(e,n){return Pp(e,t,n).bind(ih.getCurrent)}}}},OR={getField:Ju((function(t,e,n){return t.getField(e,n)})),sketch:CR},TR=Bu("valid-input"),ER=Bu("invalid-input"),DR=Bu("validating-input"),AR="colorcustom.rgb.",_R=function(t,e,r,o){var u=function(n,r){return jE.config({invalidClass:e("invalid"),notify:{onValidate:function(t){ui(t,DR,{type:n})},onValid:function(t){ui(t,TR,{type:n,value:Vg.getValue(t)})},onInvalid:function(t){ui(t,ER,{type:n,value:Vg.getValue(t)})}},validator:{validate:function(e){var n=Vg.getValue(e),o=r(n)?O.value(!0):O.error(t("aria.input.invalid"));return AE.pure(o)},validateOnLoad:!1}})},a=function(r,o,i,a,c){var s=t(AR+"range"),l=fE.parts().label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":a}}}),f=fE.parts().field({data:c,factory:vE,inputAttributes:m({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:dl([u(o,r),GE.config({})]),onSetValue:function(t){if(jE.isInvalid(t)){var e=jE.run(t);e.get(n)}}}),d=[l,f],g="hex"!==o?[fE.parts()["aria-descriptor"]({text:s})]:[],p=d.concat(g);return{dom:{tag:"div",attributes:{role:"presentation"}},components:p}},c=function(t,e){var n=WS(e);return OR.getField(t,"hex").each((function(e){yy.isFocused(e)||Vg.setValue(t,{hex:n.value()})})),n},s=function(t,e){var n=e.red(),r=e.green(),o=e.blue();Vg.setValue(t,{red:n,green:r,blue:o})},l=Lw({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),f=function(t,e){l.getOpt(t).each((function(t){za(t.element(),"background-color","#"+e.value())}))},d=function(){var n={red:i(Wn(x.some(255))),green:i(Wn(x.some(255))),blue:i(Wn(x.some(255))),hex:i(Wn(x.some("ffffff")))},u=function(t,e){var n=ZS(e);s(t,n),p(n)},d=function(t){return n[t]().get()},m=function(t,e){n[t]().set(e)},g=function(){return d("red").bind((function(t){return d("green").bind((function(e){return d("blue").map((function(n){return KS(t,e,n,1)}))}))}))},p=function(t){var e=t.red(),n=t.green(),r=t.blue();m("red",x.some(e)),m("green",x.some(n)),m("blue",x.some(r))},h=function(t,e){var n=e.event();"hex"!==n.type()?m(n.type(),x.none()):o(t)},v=function(t,e){r(t);var n=FS(e);m("hex",x.some(e));var o=ZS(n);s(t,o),p(o),ui(t,ND(),{hex:n}),f(t,n)},b=function(t,e,n){var r=parseInt(n,10);m(e,x.some(r)),g().each((function(e){var n=c(t,e);f(t,n)}))},y=function(t){return"hex"===t.type()},w=function(t,e){var n=e.event();y(n)?v(t,n.value()):b(t,n.type(),n.value())},C=function(e){return{label:t(AR+e+".label"),description:t(AR+e+".description")}},S=C("red"),k=C("green"),O=C("blue"),T=C("hex");return Ot(OR.sketch((function(n){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[n.field("red",fE.sketch(a(JS,"red",S.label,S.description,255))),n.field("green",fE.sketch(a(JS,"green",k.label,k.description,255))),n.field("blue",fE.sketch(a(JS,"blue",O.label,O.description,255))),n.field("hex",fE.sketch(a(zS,"hex",T.label,T.description,"ffffff"))),l.asSpec()],formBehaviours:dl([jE.config({invalidClass:e("form-invalid")}),ly("rgb-form-events",[Di(TR,w),Di(ER,h),Di(DR,h)])])}})),{apis:{updateHex:function(t,e){Vg.setValue(t,{hex:e.value()}),u(t,e),f(t,e)}}})},g=Zp({factory:d,name:"RgbForm",configFields:[],apis:{updateHex:function(t,e,n){t.updateHex(e,n)}},extraApis:{}});return g},RR={rgbFormFactory:_R},BR=function(t,e){var n=hR.parts().spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[e("sv-palette-spectrum")]}}),r=hR.parts().thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[e("sv-palette-thumb")],innerHtml:"<div class="+e("sv-palette-inner-thumb")+' role="presentation"></div>'}}),o=function(t,e){var n=t.width,r=t.height,o=t.getContext("2d");if(null!==o){o.fillStyle=e,o.fillRect(0,0,n,r);var i=o.createLinearGradient(0,0,n,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),o.fillStyle=i,o.fillRect(0,0,n,r);var u=o.createLinearGradient(0,0,0,r);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),o.fillStyle=u,o.fillRect(0,0,n,r)}},u=function(t,e){var n=t.components()[0].element().dom();o(n,nk(e))},a=function(t){var u=i({x:i(0),y:i(0)}),a=function(t,e,n){ui(t,MD(),{value:n})},c=function(t,e,n,r){o(n.element().dom(),nk(rk()))},s=dl([ih.config({find:x.some}),yy.config({})]);return hR.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[e("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[n,r],onChange:a,onInit:c,sliderBehaviours:s})},c=Zp({factory:a,name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(t,e,n){u(e,n)}},extraApis:{}});return c},IR={paletteFactory:BR},NR=function(t,e){var r=function(n){var r=RR.rgbFormFactory(t,e,n.onValidHex,n.onInvalidHex),o=IR.paletteFactory(t,e),u={paletteRgba:i(Wn(rk()))},a=Lw(o.sketch({})),c=Lw(r.sketch({})),s=function(t,e){a.getOpt(t).each((function(t){var n=ZS(e);u.paletteRgba().set(n),o.setRgba(t,n)}))},l=function(t,e){c.getOpt(t).each((function(t){r.updateHex(t,e)}))},f=function(t,e,n){G(n,(function(n){n(t,e)}))},d=function(){var t=[l];return function(e,n){var r=n.event().value(),o=u.paletteRgba().get(),i=BD(o),a=RD(i.hue(),r.x(),100-r.y()),c=QS(a),s=WS(c);f(e,s,t)}},m=function(){var t=[s,l];return function(e,n){var r=n.event().value(),o=ID(r.y());f(e,o,t)}};return{uid:n.uid,dom:n.dom,components:[a.asSpec(),bR.sliderFactory(t,e),c.asSpec()],behaviours:dl([ly("colour-picker-events",[Di(MD(),d()),Di(PD(),m())]),ih.config({find:function(t){return c.getOpt(t)}}),Qb.config({mode:"acyclic"})])}},o=Zp({name:"ColourPicker",configFields:[gn("dom"),In("onValidHex",n),In("onInvalidHex",n)],factory:r});return o},PR={makeFactory:NR},MR=function(){return ih.config({find:x.some})},FR=function(t){return ih.config({find:t.getOpt})},LR=function(t){return ih.config({find:function(e){return nu(e.element(),t).bind((function(t){return e.getSystem().getByDom(t).toOption()}))}})},HR={self:MR,memento:FR,childAt:LR},zR={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},jR=function(t){return zR[t]},VR=function(t){return jR(t)},UR=function(t){var n=function(t){return"tox-"+t},r=PR.makeFactory(VR,n),o=function(t){ui(t,tE,{name:"hex-valid",value:!0})},i=function(t){ui(t,tE,{name:"hex-valid",value:!1})},u=Lw(r.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:o,onInvalidHex:i}));return{dom:{tag:"div"},components:[u.asSpec()],behaviours:dl([Vg.config({store:{mode:"manual",getValue:function(t){var e=u.get(t),n=ih.getCurrent(e),r=n.bind((function(t){var e=Vg.getValue(t);return e.hex}));return r.map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var r=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/,o=r.exec(n),i=u.get(t),a=ih.getCurrent(i);a.fold((function(){e.console.log("Can not find form")}),(function(t){Vg.setValue(t,{hex:x.from(o[1]).getOr("")}),OR.getField(t,"hex").each((function(t){ii(t,Eo())}))}))}}}),HR.self()])}},WR=tinymce.util.Tools.resolve("tinymce.Resource"),GR=function(t){return Object.prototype.hasOwnProperty.call(t,"init")},qR=function(t){var e=Wn(x.none()),n=Lw({dom:{tag:t.tag}}),r=Wn(x.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:dl([ly("editor-foo-events",[Li((function(o){n.getOpt(o).each((function(n){(GR(t)?t.init(n.element().dom()):WR.load(t.scriptId,t.scriptUrl).then((function(e){return e(n.element().dom(),t.settings)}))).then((function(t){r.get().each((function(e){t.setValue(e)})),r.set(x.none()),e.set(x.some(t))}))}))}))]),Vg.config({store:{mode:"manual",getValue:function(){return e.get().fold((function(){return r.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,n){e.get().fold((function(){r.set(x.some(n))}),(function(t){return t.setValue(n)}))}}}),HR.self()]),components:[n.asSpec()]}},XR=Me([In("preprocess",u),In("postprocess",u)]),$R=function(t,e){var n=tn("RepresentingConfigs.memento processors",XR,e);return Vg.config({store:{mode:"manual",getValue:function(e){var r=t.get(e),o=Vg.getValue(r);return n.postprocess(o)},setValue:function(e,r){var o=n.preprocess(r),i=t.get(e);Vg.setValue(i,o)}}})},YR=function(t,e,n){return Vg.config(Ot({store:{mode:"manual",getValue:e,setValue:n}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},KR=function(t,e,n){return YR(t,(function(t){return e(t.element())}),(function(t,e){return n(t.element(),e)}))},JR=function(t){return KR(t,Ya,Ka)},QR=function(t){return KR(t,pu,hu)},ZR=function(t){return Vg.config({store:{mode:"memory",initialValue:t}})},tB={memento:$R,withElement:KR,withComp:YR,domValue:JR,domHtml:QR,memory:ZR},eB=".jpg,.jpeg,.png,.gif",nB=function(t){var e=new RegExp("("+eB.split(/\s*,\s*/).join("|")+")$","i");return $(ct(t),(function(t){return e.test(t.name)}))},rB=function(t,e){var n=function(t,e){e.stop()},r=function(t){return function(e,n){G(t,(function(t){t(e,n)}))}},o=function(t,e){if(!uS.isDisabled(t)){var n=e.event().raw();u(t,n.dataTransfer.files)}},i=function(t,e){var n=e.event().raw().target.files;u(t,n)},u=function(e,n){Vg.setValue(e,nB(n)),ui(e,JT,{name:t.name})},a=Lw({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:dl([ly("input-file-events",[Pi(zo())])])}),c=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:dl([tB.memory([]),HR.self(),uS.config({}),Ly.config({toggleClass:"dragenter",toggleOnExecute:!1}),ly("dropzone-events",[Di("dragenter",r([n,Ly.toggle])),Di("dragleave",r([n,Ly.toggle])),Di("dragover",n),Di("drop",r([n,o])),Di(Do(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:e.translate("Drop an image here")}},Fw.sketch({dom:{tag:"button",innerHtml:e.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){var e=a.get(t);e.element().dom().click()},buttonBehaviours:dl([GE.config({})])})]}]}},s=t.label.map((function(t){return JE(t,e)})),l=fE.parts().field({factory:{sketch:c}});return qE(s,l,["tox-form__group--stretched"],[])},oB=function(t,e){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:W(t.items,e.interpreter)}},iB=Bu("alloy-fake-before-tabstop"),uB=Bu("alloy-fake-after-tabstop"),aB=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:dl([yy.config({ignore:!0}),GE.config({})])}},cB=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[aB([iB]),t,aB([uB])],behaviours:dl([HR.childAt(1)])}},sB=function(t,e){ui(t,Oo(),{raw:{which:9,shiftKey:e}})},lB=function(t,e){var n=e.element();Na(n,iB)?sB(t,!0):Na(n,uB)&&sB(t,!1)},fB=function(t){return UO(t,["."+iB,"."+uB].join(","),i(!1))},dB={isPseudoStop:fB,onFocus:lB,craft:cB},mB=!(qr().browser.isIE()||qr().browser.isEdge()),gB=function(t){var e=Wn("");return{getValue:function(t){return e.get()},setValue:function(n,r){if(t)yu(n.element(),"srcdoc",r);else{yu(n.element(),"src","javascript:''");var o=n.element().dom().contentWindow.document;o.open(),o.write(r),o.close()}e.set(r)}}},pB=function(t,e){var n=mB&&t.sandboxed,r=m(m({},t.label.map((function(t){return{title:t}})).getOr({})),n?{sandbox:"allow-scripts allow-same-origin"}:{}),o=gB(n),i=t.label.map((function(t){return JE(t,e)})),u=function(t){return dB.craft({uid:t.uid,dom:{tag:"iframe",attributes:r},behaviours:dl([GE.config({}),yy.config({}),tB.withComp(x.none(),o.getValue,o.setValue)])})},a=fE.parts().field({factory:{sketch:u}});return qE(i,a,["tox-form__group--stretched"],[])};function hB(t,n){return yB(e.document.createElement("canvas"),t,n)}function vB(t){var e=hB(t.width,t.height),n=bB(e);return n.drawImage(t,0,0),e}function bB(t){return t.getContext("2d")}function yB(t,e,n){return t.width=e,t.height=n,t}function wB(t){return t.naturalWidth||t.width}function xB(t){return t.naturalHeight||t.height}var CB=function(){var t=function(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],l(t,r(u,this),r(a,this))},n=t.immediateFn||"function"===typeof window.setImmediate&&window.setImmediate||function(t){e.setTimeout(t,1)};function r(t,e){return function(){return t.apply(e,arguments)}}var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function i(t){var e=this;null!==this._state?n((function(){var n=e._state?t.onFulfilled:t.onRejected;if(null!==n){var r;try{r=n(e._value)}catch(o){return void t.reject(o)}t.resolve(r)}else(e._state?t.resolve:t.reject)(e._value)})):this._deferreds.push(t)}function u(t){try{if(t===this)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"===typeof t||"function"===typeof t)){var e=t.then;if("function"===typeof e)return void l(r(e,t),r(u,this),r(a,this))}this._state=!0,this._value=t,c.call(this)}catch(n){a.call(this,n)}}function a(t){this._state=!1,this._value=t,c.call(this)}function c(){for(var t=0,e=this._deferreds;t<e.length;t++){var n=e[t];i.call(this,n)}this._deferreds=[]}function s(t,e,n,r){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.resolve=n,this.reject=r}function l(t,e,n){var r=!1;try{t((function(t){r||(r=!0,e(t))}),(function(t){r||(r=!0,n(t))}))}catch(o){if(r)return;r=!0,n(o)}}return t.prototype.catch=function(t){return this.then(null,t)},t.prototype.then=function(e,n){var r=this;return new t((function(t,o){i.call(r,new s(e,n,t,o))}))},t.all=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=Array.prototype.slice.call(1===e.length&&o(e[0])?e[0]:e);return new t((function(t,e){if(0===r.length)return t([]);var n=r.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),e)}r[i]=u,0===--n&&t(r)}catch(c){e(c)}}for(var i=0;i<r.length;i++)o(i,r[i])}))},t.resolve=function(e){return e&&"object"===typeof e&&e.constructor===t?e:new t((function(t){t(e)}))},t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var r=0,o=e;r<o.length;r++){var i=o[r];i.then(t,n)}}))},t},SB=window.Promise?window.Promise:CB();function kB(t){return new SB((function(n,r){var o=e.URL.createObjectURL(t),i=new e.Image,u=function(){i.removeEventListener("load",a),i.removeEventListener("error",c)};function a(){u(),n(i)}function c(){u(),r("Unable to load data of type "+t.type+": "+o)}i.addEventListener("load",a),i.addEventListener("error",c),i.src=o,i.complete&&a()}))}function OB(t){var n=t.split(","),r=/data:([^;]+)/.exec(n[0]);if(!r)return x.none();for(var o=r[1],i=n[1],u=1024,a=e.atob(i),c=a.length,s=Math.ceil(c/u),l=new Array(s),f=0;f<s;++f){for(var d=f*u,m=Math.min(d+u,c),g=new Array(m-d),p=d,h=0;p<m;++h,++p)g[h]=a[p].charCodeAt(0);l[f]=new Uint8Array(g)}return x.some(new e.Blob(l,{type:o}))}function TB(t){return new SB((function(e,n){OB(t).fold((function(){n("uri is not base64: "+t)}),e)}))}function EB(t,n,r){return n=n||"image/png",e.HTMLCanvasElement.prototype.toBlob?new SB((function(e,o){t.toBlob((function(t){t?e(t):o()}),n,r)})):TB(t.toDataURL(n,r))}function DB(t,e,n){return e=e||"image/png",t.toDataURL(e,n)}function AB(t){return kB(t).then((function(t){RB(t);var e=hB(wB(t),xB(t)),n=bB(e);return n.drawImage(t,0,0),e}))}function _B(t){return new SB((function(n){var r=new e.FileReader;r.onloadend=function(){n(r.result)},r.readAsDataURL(t)}))}function RB(t){e.URL.revokeObjectURL(t.src)}function BB(t,e,n){var r=e.type,o=i(r);function u(){return SB.resolve(e)}function a(){return n}function c(){return n.split(",")[1]}function s(e,n){return t.then((function(t){return EB(t,e,n)}))}function l(e,n){return t.then((function(t){return DB(t,e,n)}))}function f(t,e){return l(t,e).then((function(t){return t.split(",")[1]}))}function d(){return t.then(vB)}return{getType:o,toBlob:u,toDataURL:a,toBase64:c,toAdjustedBlob:s,toAdjustedDataURL:l,toAdjustedBase64:f,toCanvas:d}}function IB(t){return _B(t).then((function(e){return BB(AB(t),t,e)}))}function NB(t,e){return EB(t,e).then((function(e){return BB(SB.resolve(t),e,t.toDataURL())}))}var PB=function(t){return IB(t)};function MB(t,e,n){var r="string"===typeof t?parseFloat(t):t;return r>n?r=n:r<e&&(r=e),r}function FB(){return[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1]}var LB=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10];function HB(t,e){for(var n,r=[],o=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)r[u]=e[u+5*i];for(u=0;u<5;u++){n=0;for(var a=0;a<5;a++)n+=t[u+5*a]*r[a];o[u+5*i]=n}}return o}function zB(t,e){var n;return e=MB(e,-1,1),e*=100,e<0?n=127+e/100*127:(n=e%1,n=0===n?LB[e]:LB[Math.floor(e)]*(1-n)+LB[Math.floor(e)+1]*n,n=127*n+127),HB(t,[n/127,0,0,0,.5*(127-n),0,n/127,0,0,.5*(127-n),0,0,n/127,0,.5*(127-n),0,0,0,1,0,0,0,0,0,1])}function jB(t,e){return e=MB(255*e,-255,255),HB(t,[1,0,0,0,e,0,1,0,0,e,0,0,1,0,e,0,0,0,1,0,0,0,0,0,1])}function VB(t,e,n,r){return e=MB(e,0,2),n=MB(n,0,2),r=MB(r,0,2),HB(t,[e,0,0,0,0,0,n,0,0,0,0,0,r,0,0,0,0,0,1,0,0,0,0,0,1])}function UB(t,e){return t.toCanvas().then((function(n){return WB(n,t.getType(),e)}))}function WB(t,e,n){var r=bB(t);function o(t,e){for(var n,r,o,i,u=t.data,a=e[0],c=e[1],s=e[2],l=e[3],f=e[4],d=e[5],m=e[6],g=e[7],p=e[8],h=e[9],v=e[10],b=e[11],y=e[12],w=e[13],x=e[14],C=e[15],S=e[16],k=e[17],O=e[18],T=e[19],E=0;E<u.length;E+=4)n=u[E],r=u[E+1],o=u[E+2],i=u[E+3],u[E]=n*a+r*c+o*s+i*l+f,u[E+1]=n*d+r*m+o*g+i*p+h,u[E+2]=n*v+r*b+o*y+i*w+x,u[E+3]=n*C+r*S+o*k+i*O+T;return t}var i=o(r.getImageData(0,0,t.width,t.height),n);return r.putImageData(i,0,0),NB(t,e)}function GB(t,e){return t.toCanvas().then((function(n){return qB(n,t.getType(),e)}))}function qB(t,e,n){var r=bB(t);function o(t,e,n){function r(t,e,n){return t>n?t=n:t<e&&(t=e),t}for(var o=Math.round(Math.sqrt(n.length)),i=Math.floor(o/2),u=t.data,a=e.data,c=t.width,s=t.height,l=0;l<s;l++)for(var f=0;f<c;f++){for(var d=0,m=0,g=0,p=0;p<o;p++)for(var h=0;h<o;h++){var v=r(f+h-i,0,c-1),b=r(l+p-i,0,s-1),y=4*(b*c+v),w=n[p*o+h];d+=u[y]*w,m+=u[y+1]*w,g+=u[y+2]*w}var x=4*(l*c+f);a[x]=r(d,0,255),a[x+1]=r(m,0,255),a[x+2]=r(g,0,255)}return e}var i=r.getImageData(0,0,t.width,t.height),u=r.getImageData(0,0,t.width,t.height);return u=o(i,u,n),r.putImageData(u,0,0),NB(t,e)}function XB(t){var e=function(e,n,r){var o=bB(e),i=new Array(256);function u(t,e){for(var n=t.data,r=0;r<n.length;r+=4)n[r]=e[n[r]],n[r+1]=e[n[r+1]],n[r+2]=e[n[r+2]];return t}for(var a=0;a<i.length;a++)i[a]=t(a,r);var c=u(o.getImageData(0,0,e.width,e.height),i);return o.putImageData(c,0,0),NB(e,n)};return function(t,n){return t.toCanvas().then((function(r){return e(r,t.getType(),n)}))}}function $B(t){return function(e,n){return UB(e,t(FB(),n))}}function YB(t){return function(e){return UB(e,t)}}function KB(t){return function(e){return GB(e,t)}}var JB=YB([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),QB=$B(jB),ZB=$B(zB),tI=function(t,e,n,r){return UB(t,VB(FB(),e,n,r))},eI=KB([0,-1,0,-1,5,-1,0,-1,0]),nI=XB((function(t,e){return 255*Math.pow(t/255,1-e)}));function rI(t,e,n){var r=wB(t),o=xB(t),i=e/r,u=n/o,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=oI(t,i,u);return a?c.then((function(t){return rI(t,e,n)})):c}function oI(t,e,n){return new SB((function(r){var o=wB(t),i=xB(t),u=Math.floor(o*e),a=Math.floor(i*n),c=hB(u,a),s=bB(c);s.drawImage(t,0,0,o,i,0,0,u,a),r(c)}))}function iI(t,e){return t.toCanvas().then((function(n){return uI(n,t.getType(),e)}))}function uI(t,e,n){var r=hB(t.width,t.height),o=bB(r),i=0,u=0;return n=n<0?360+n:n,90!==n&&270!==n||yB(r,r.height,r.width),90!==n&&180!==n||(i=r.width),270!==n&&180!==n||(u=r.height),o.translate(i,u),o.rotate(n*Math.PI/180),o.drawImage(t,0,0),NB(r,e)}function aI(t,e){return t.toCanvas().then((function(n){return cI(n,t.getType(),e)}))}function cI(t,e,n){var r=hB(t.width,t.height),o=bB(r);return"v"===n?(o.scale(1,-1),o.drawImage(t,0,-r.height)):(o.scale(-1,1),o.drawImage(t,-r.width,0)),NB(r,e)}function sI(t,e,n,r,o){return t.toCanvas().then((function(i){return lI(i,t.getType(),e,n,r,o)}))}function lI(t,e,n,r,o,i){var u=hB(o,i),a=bB(u);return a.drawImage(t,-n,-r),NB(u,e)}function fI(t,e,n){return t.toCanvas().then((function(r){return rI(r,e,n).then((function(e){return NB(e,t.getType())}))}))}var dI=function(t){return JB(t)},mI=function(t){return eI(t)},gI=function(t,e){return nI(t,e)},pI=function(t,e,n,r){return tI(t,e,n,r)},hI=function(t,e){return QB(t,e)},vI=function(t,e){return ZB(t,e)},bI=function(t,e){return aI(t,e)},yI=function(t,e,n,r,o){return sI(t,e,n,r,o)},wI=function(t,e,n){return fI(t,e,n)},xI=function(t,e){return iI(t,e)},CI=function(t,e){return m({dom:{tag:"span",innerHtml:t,classes:["tox-icon","tox-tbtn__icon-wrap"]}},e)},SI=function(t,e){return CI(zw(t,e),{})},kI=function(t,e){return CI(zw(t,e),{behaviours:dl([cy.config({})])})},OI=function(t,e,n){return{dom:{tag:"span",innerHtml:n.translate(t),classes:[e+"__select-label"]},behaviours:dl([cy.config({})])}},TI=Bu("toolbar.button.execute"),EI=function(t){return ji((function(e,n){dS(t,e)((function(n){ui(e,TI,{buttonApi:n}),t.onAction(n)}))}))},DI={"alloy.execute":["disabling","alloy.base.behaviour","toggling","toolbar-button-events"]},AI=Bu("update-menu-text"),_I=Bu("update-menu-icon"),RI=function(t,e,r){var o=Wn(n),i=t.text.map((function(t){return Lw(OI(t,e,r.providers))})),u=t.icon.map((function(t){return Lw(kI(t,r.providers.icons))})),a=function(t,e){var n=Vg.getValue(t);return yy.focus(n),ui(n,"keydown",{raw:e.event().raw()}),xD.close(n),x.some(!0)},c=t.role.fold((function(){return{}}),(function(t){return{role:t}})),s=t.tooltip.fold((function(){return{}}),(function(t){var e=r.providers.translate(t);return{title:e,"aria-label":e}})),l=Lw(xD.sketch(m(m({},c),{dom:{tag:"button",classes:[e,e+"--select"].concat(W(t.classes,(function(t){return e+"--"+t}))),attributes:m({},s)},components:bS([u.map((function(t){return t.asSpec()})),i.map((function(t){return t.asSpec()})),x.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:zw("chevron-down",r.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:dl(p(t.dropdownBehaviours,[fS.button(t.disabled),OD.config({}),cy.config({}),ly("dropdown-events",[mS(t,o),gS(t,o)]),ly("menubutton-update-display-text",[Di(AI,(function(t,e){i.bind((function(e){return e.getOpt(t)})).each((function(t){cy.set(t,[uc(r.providers.translate(e.event().text()))])}))})),Di(_I,(function(t,e){u.bind((function(e){return e.getOpt(t)})).each((function(t){cy.set(t,[kI(e.event().icon(),r.providers.icons)])}))}))])])),eventOrder:Ot(DI,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:dl([Qb.config({mode:"special",onLeft:a,onRight:a})]),lazySink:r.getSink,toggleClass:e+"--active",parts:{menu:Qk(!1,t.columns,t.presets)},fetch:function(){return AE.nu(t.fetch)}})));return l.asSpec()},BI=function(t){return D(t)},II=function(t){return"separator"===t.type},NI=function(t){return bt(t,"getSubmenuItems")},PI={type:"separator"},MI=function(t,e){var n=K(t,(function(t,n){return BI(n)?""===n?t:"|"===n?t.length>0&&!II(t[t.length-1])?t.concat([PI]):t:bt(e,n.toLowerCase())?t.concat([e[n.toLowerCase()]]):t:t.concat([n])}),[]);return n.length>0&&II(n[n.length-1])&&n.pop(),n},FI=function(t,e){var n=t.getSubmenuItems(),r=zI(n,e),o=Ot(r.menus,Xt(t.value,r.items)),i=Ot(r.expansions,Xt(t.value,t.value));return{item:t,menus:o,expansions:i}},LI=function(t,e){return NI(t)?FI(t,e):{item:t,menus:{},expansions:{}}},HI=function(t){if(II(t))return t;var e=qt(t,"value").getOrThunk((function(){return Bu("generated-menu-item")}));return Ot({value:e},t)},zI=function(t,e){var n=MI(D(t)?t.split(" "):t,e);return Y(n,(function(t,n){var r=HI(n),o=LI(r,e);return{menus:Ot(t.menus,o.menus),items:[o.item].concat(t.items),expansions:Ot(t.expansions,o.expansions)}}),{menus:{},expansions:{},items:[]})},jI=function(t,e,n,r){var o=Bu("primary-menu"),i=zI(t,n.shared.providers.menuItems());if(0===i.items.length)return x.none();var u=EO(o,i.items,e,n,r),a=dt(i.menus,(function(t,r){return EO(r,t,e,n,!1)})),c=Ot(a,Xt(o,u));return x.from(xw.tieredData(o,c,i.expansions))},VI=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)},setActive:function(e){var n=t.element();e?(Ra(n,"tox-tbtn--enabled"),yu(n,"aria-pressed",!0)):(Ia(n,"tox-tbtn--enabled"),Su(n,"aria-pressed"))},isActive:function(){return Na(t.element(),"tox-tbtn--enabled")}}},UI=function(t,e,n,r){return RI({text:t.text,icon:t.icon,tooltip:t.tooltip,role:r,fetch:function(e){t.fetch((function(t){e(jI(t,pS.CLOSE_ON_EXECUTE,n,!1))}))},onSetup:t.onSetup,getApi:VI,columns:1,presets:"normal",classes:[],dropdownBehaviours:[GE.config({})]},e,n.shared)},WI=function(t,e,n){var r=function(t){return function(r){var o=!r.isActive();r.setActive(o),t.storage.set(o),n.shared.getSink().each((function(n){e().getOpt(n).each((function(e){Ol(e.element()),ui(e,tE,{name:t.name,value:t.storage.get()})}))}))}},o=function(t){return function(e){e.setActive(t.storage.get())}};return function(e){e(W(t,(function(t){var e=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return m(m({type:t.type},e),{onAction:r(t),onSetup:o(t)})})))}},GI=function(t,e,n,r,o){void 0===n&&(n=[]);var i=e.fold((function(){return{}}),(function(t){return{action:t}})),u=m({buttonBehaviours:dl([fS.button(t.disabled),GE.config({}),ly("button press",[Ei("click"),Ei("mousedown")])].concat(n)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},i),a=Ot(u,{dom:r});return Ot(a,{components:o})},qI=function(t,e,n,r){void 0===r&&(r=[]);var o=t.tooltip.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({}),i={tag:"button",classes:["tox-tbtn"],attributes:o},u=t.icon.map((function(t){return SI(t,n.icons)})),a=bS([u]);return GI(t,e,r,i,a)},XI=function(t,e,n,r){void 0===r&&(r=[]);var o=qI(t,x.some(e),n,r);return Fw.sketch(o)},$I=function(t,e,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=n.translate(t.text),u=t.icon?t.icon.map((function(t){return SI(t,n.icons)})):x.none(),a=u.isSome()?bS([u]):[],c=u.isSome()?{}:{innerHtml:i},s=p(t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],t.borderless?["tox-button--naked"]:[],o),l=m(m({tag:"button",classes:s},c),{attributes:{title:i}});return GI(t,e,r,l,a)},YI=function(t,e,n,r,o){void 0===r&&(r=[]),void 0===o&&(o=[]);var i=$I(t,x.some(e),n,r,o);return Fw.sketch(i)},KI=function(t,n){return function(r){"custom"===n?ui(r,tE,{name:t,value:{}}):"submit"===n?ii(r,eE):"cancel"===n?ii(r,ZT):e.console.error("Unknown button type: ",n)}},JI=function(t,e){return"menu"===e},QI=function(t,e){return"custom"===e||"cancel"===e||"submit"===e},ZI=function(t,n,r){if(JI(t,n)){var o=function(){return a},i=t,u=m(m({},t),{fetch:WI(i.items,o,r)}),a=Lw(UI(u,"tox-tbtn",r,x.none()));return a.asSpec()}if(QI(t,n)){var c=KI(t.name,n),s=m(m({},t),{borderless:!1});return YI(s,c,r.shared.providers,[])}e.console.error("Unknown footer button type: ",n)},tN=function(t,e){var n=KI(t.name,"custom");return XE(x.none(),fE.parts().field(m({factory:Fw},$I(t,x.some(n),e,[tB.memory(""),HR.self()]))))},eN=i([In("field1Name","field1"),In("field2Name","field2"),xs("onLockedChange"),vs(["lockClass"]),In("locked",!1),qg.field("coupledFieldBehaviours",[ih,Vg])]),nN=function(t,e,n){return Pp(t,e,n).bind(ih.getCurrent)},rN=function(t,e){return wp({factory:fE,name:t,overrides:function(t){return{fieldBehaviours:dl([ly("coupled-input-behaviour",[Di(Eo(),(function(n){nN(n,t,e).each((function(e){Pp(n,t,"lock").each((function(r){Ly.isOn(r)&&t.onLockedChange(n,e,r)}))}))}))])])}}})},oN=i([rN("field1","field2"),rN("field2","field1"),wp({factory:Fw,schema:[gn("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:dl([Ly.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),iN=function(t,e,n,r){return{uid:t.uid,dom:t.dom,components:e,behaviours:qg.augment(t.coupledFieldBehaviours,[ih.config({find:x.some}),Vg.config({store:{mode:"manual",getValue:function(e){var n,r=zp(e,t,["field1","field2"]);return n={},n[t.field1Name]=Vg.getValue(r.field1()),n[t.field2Name]=Vg.getValue(r.field2()),n},setValue:function(e,n){var r=zp(e,t,["field1","field2"]);Qt(n,t.field1Name)&&Vg.setValue(r.field1(),n[t.field1Name]),Qt(n,t.field2Name)&&Vg.setValue(r.field2(),n[t.field2Name])}}})]),apis:{getField1:function(e){return Pp(e,t,"field1")},getField2:function(e){return Pp(e,t,"field2")},getLock:function(e){return Pp(e,t,"lock")}}}},uN=th({name:"FormCoupledInputs",configFields:eN(),partFields:oN(),factory:iN,apis:{getField1:function(t,e){return t.getField1(e)},getField2:function(t,e){return t.getField2(e)},getLock:function(t,e){return t.getLock(e)}}}),aN=function(t){var e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},n=function(t){return t in e?e[t]:1},r=t.value.toFixed(n(t.unit));return-1!==r.indexOf(".")&&(r=r.replace(/\.?0*$/,"")),r+t.unit},cN=function(t){var e=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/,n=e.exec(t);if(null!==n){var r=parseFloat(n[1]),o=n[2];return O.value({value:r,unit:o})}return O.error(t)},sN=function(t,e){var n={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},r=function(t){return Object.prototype.hasOwnProperty.call(n,t)};return t.unit===e?x.some(t.value):r(t.unit)&&r(e)?n[t.unit]===n[e]?x.some(t.value):x.some(t.value/n[t.unit]*n[e]):x.none()},lN=function(t){return x.none()},fN=function(t,e){return function(n){return sN(n,e).map((function(n){return{value:n*t,unit:e}}))}},dN=function(t,e){var n=cN(t).toOption(),r=cN(e).toOption();return ts(n,r,(function(t,e){return sN(t,e.unit).map((function(t){return e.value/t})).map((function(t){return fN(t,e.unit)})).getOr(lN)})).getOr(lN)},mN=function(t,e){var n=lN,r=Bu("ratio-event"),o=uN.parts().lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:e.translate(t.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:zw("lock",e.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:zw("unlock",e.icons)}}],buttonBehaviours:dl([fS.button(t.disabled),GE.config({})])}),i=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},u=function(e){return fE.parts().field({factory:vE,inputClasses:["tox-textfield"],inputBehaviours:dl([uS.config({disabled:t.disabled}),GE.config({}),ly("size-input-events",[Di(So(),(function(t,n){ui(t,r,{isField1:e})})),Di(Do(),(function(e,n){ui(e,JT,{name:t.name})}))])]),selectOnFocus:!1})},a=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}}},c=uN.parts().field1(i([fE.parts().label(a("Width")),u(!0)])),s=uN.parts().field2(i([fE.parts().label(a("Height")),u(!1)]));return uN.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),o])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,e,r){cN(Vg.getValue(t)).each((function(t){n(t).each((function(t){Vg.setValue(e,aN(t))}))}))},coupledFieldBehaviours:dl([uS.config({disabled:t.disabled,onDisabled:function(t){uN.getField1(t).bind(fE.getField).each(uS.disable),uN.getField2(t).bind(fE.getField).each(uS.disable),uN.getLock(t).each(uS.disable)},onEnabled:function(t){uN.getField1(t).bind(fE.getField).each(uS.enable),uN.getField2(t).bind(fE.getField).each(uS.enable),uN.getLock(t).each(uS.enable)}}),ly("size-input-events2",[Di(r,(function(t,e){var r=e.event().isField1(),o=r?uN.getField1(t):uN.getField2(t),i=r?uN.getField2(t):uN.getField1(t),u=o.map(Vg.getValue).getOr(""),a=i.map(Vg.getValue).getOr("");n=dN(u,a)}))])])})},gN=i(Bu("undo")),pN=i(Bu("redo")),hN=i(Bu("zoom")),vN=i(Bu("back")),bN=i(Bu("apply")),yN=i(Bu("swap")),wN=i(Bu("transform")),xN=i(Bu("temp-transform")),CN=i(Bu("transform-apply")),SN={undo:gN,redo:pN,zoom:hN,back:vN,apply:bN,swap:yN,transform:wN,tempTransform:xN,transformApply:CN},kN=i("save-state"),ON=i("disable"),TN=i("enable"),EN={formActionEvent:tE,saveState:kN,disable:ON,enable:TN},DN=function(t,e){var r=function(t,n,r,o){return Lw(YI({name:t,text:t,disabled:r,primary:o,icon:x.none(),borderless:!1},n,e))},o=function(t,n,r,o){return Lw(XI({name:t,icon:x.some(t),tooltip:x.some(n),disabled:o,primary:!1,borderless:!1},r,e))},u=function(t,e){t.map((function(t){var n=t.get(e);n.hasConfigured(uS)&&uS.disable(n)}))},a=function(t,e){t.map((function(t){var n=t.get(e);n.hasConfigured(uS)&&uS.enable(n)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=n,l=function(t,e,n){ui(t,e,n)},f=function(t){return ii(t,EN.disable())},d=function(t){return ii(t,EN.enable())},m=function(t,e){f(t),l(t,SN.transform(),{transform:e}),d(t)},g=function(t,e){f(t),l(t,SN.tempTransform(),{transform:e}),d(t)},p=function(t){return function(){ut.getOpt(t).each((function(t){cy.set(t,[ot])}))}},h=function(t,e){f(t),l(t,SN.transformApply(),{transform:e,swap:p(t)}),d(t)},v=function(){return r("Back",(function(t){return l(t,SN.back(),{swap:p(t)})}),!1,!1)},b=function(){return Lw({dom:{tag:"div",classes:["tox-spacer"]},behaviours:dl([uS.config({})])})},y=function(){return r("Apply",(function(t){return l(t,SN.apply(),{swap:p(t)})}),!0,!0)},w=function(){return function(e){var n=t.getRect();return yI(e,n.x,n.y,n.w,n.h)}},C=[v(),b(),r("Apply",(function(e){var n=w();h(e,n),t.hideCrop()}),!1,!0)],S=bT.sketch({dom:c,components:C.map((function(t){return t.asSpec()})),containerBehaviours:dl([ly("image-tools-crop-buttons-events",[Di(EN.disable(),(function(t,e){u(C,t)})),Di(EN.enable(),(function(t,e){a(C,t)}))])])}),k=Lw(mN({name:"size",label:x.none(),constrain:!0,disabled:!1},e)),O=function(t,e){return function(n){return wI(n,t,e)}},T=[v(),b(),k,b(),r("Apply",(function(t){k.getOpt(t).each((function(e){var n=Vg.getValue(e),r=parseInt(n.width,10),o=parseInt(n.height,10),i=O(r,o);h(t,i)}))}),!1,!0)],E=bT.sketch({dom:c,components:T.map((function(t){return t.asSpec()})),containerBehaviours:dl([ly("image-tools-resize-buttons-events",[Di(EN.disable(),(function(t,e){u(T,t)})),Di(EN.enable(),(function(t,e){a(T,t)}))])])}),D=function(t,e){return function(n){return t(n,e)}},A=D(bI,"h"),_=D(bI,"v"),R=D(xI,-90),B=D(xI,90),I=function(t,e){g(t,e)},N=[v(),b(),o("flip-horizontally","Flip horizontally",(function(t){I(t,A)}),!1),o("flip-vertically","Flip vertically",(function(t){I(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){I(t,R)}),!1),o("rotate-right","Rotate clockwise",(function(t){I(t,B)}),!1),b(),y()],P=bT.sketch({dom:c,components:N.map((function(t){return t.asSpec()})),containerBehaviours:dl([ly("image-tools-fliprotate-buttons-events",[Di(EN.disable(),(function(t,e){u(N,t)})),Di(EN.enable(),(function(t,e){a(N,t)}))])])}),M=function(t,n,r,o,u){var a=hR.parts().label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(t)}}),c=hR.parts().spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=hR.parts().thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return Lw(hR.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:i({x:i(o)})},components:[a,c,s],sliderBehaviours:dl([yy.config({})]),onChoose:n}))},F=function(t,e,n,r,o){var i=function(t,n,r){var o=D(e,r.x()/100);m(t,o)};return M(t,i,n,r,o)},L=function(t,e,n,r,o){return[v(),F(t,e,n,r,o),y()]},H=function(t,e,n,r,o){var i=L(t,e,n,r,o);return bT.sketch({dom:c,components:i.map((function(t){return t.asSpec()})),containerBehaviours:dl([ly("image-tools-filter-panel-buttons-events",[Di(EN.disable(),(function(t,e){u(i,t)})),Di(EN.enable(),(function(t,e){a(i,t)}))])])})},z=[v(),b(),y()],j=bT.sketch({dom:c,components:z.map((function(t){return t.asSpec()}))}),V=H("Brightness",hI,-100,0,100),U=H("Contrast",vI,-100,0,100),W=H("Gamma",gI,-100,0,100),G=function(t,e,n){return function(r){return pI(r,t,e,n)}},q=function(t){var e=function(t,e,n){var r=X.getOpt(t),o=Y.getOpt(t),i=$.getOpt(t);r.each((function(e){o.each((function(n){i.each((function(r){var o=Vg.getValue(e).x()/100,i=Vg.getValue(r).x()/100,u=Vg.getValue(n).x()/100,a=G(o,i,u);m(t,a)}))}))}))};return M(t,e,0,100,200)},X=q("R"),$=q("G"),Y=q("B"),K=[v(),X,$,Y,y()],J=bT.sketch({dom:c,components:K.map((function(t){return t.asSpec()}))}),Q=function(t,e,n){return function(r){var o=function(){ut.getOpt(r).each((function(e){cy.set(e,[t]),n(e)}))};l(r,SN.swap(),{transform:e,swap:o})}},Z=function(e){t.showCrop()},tt=function(e){k.getOpt(e).each((function(e){var n=t.getMeasurements(),r=n.width,o=n.height;Vg.setValue(e,{width:r,height:o})}))},et=x.some(mI),nt=x.some(dI),rt=[o("crop","Crop",Q(S,x.none(),Z),!1),o("resize","Resize",Q(E,x.none(),tt),!1),o("orientation","Orientation",Q(P,x.none(),s),!1),o("brightness","Brightness",Q(V,x.none(),s),!1),o("sharpen","Sharpen",Q(j,et,s),!1),o("contrast","Contrast",Q(U,x.none(),s),!1),o("color-levels","Color levels",Q(J,x.none(),s),!1),o("gamma","Gamma",Q(W,x.none(),s),!1),o("invert","Invert",Q(j,nt,s),!1)],ot=bT.sketch({dom:c,components:rt.map((function(t){return t.asSpec()}))}),it=bT.sketch({dom:{tag:"div"},components:[ot],containerBehaviours:dl([cy.config({})])}),ut=Lw(it),at=function(t){return ut.getOpt(t).map((function(t){var e=t.components()[0];return e.components()[e.components().length-1]}))};return{memContainer:ut,getApplyButton:at}},AN=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),_N=tinymce.util.Tools.resolve("tinymce.geom.Rect"),RN=tinymce.util.Tools.resolve("tinymce.util.Observable"),BN=tinymce.util.Tools.resolve("tinymce.util.Tools"),IN=tinymce.util.Tools.resolve("tinymce.util.VK");function NN(t){var e,n,r,o,i,u,a,c,s=Math.max;return e=t.documentElement,n=t.body,r=s(e.scrollWidth,n.scrollWidth),o=s(e.clientWidth,n.clientWidth),i=s(e.offsetWidth,n.offsetWidth),u=s(e.scrollHeight,n.scrollHeight),a=s(e.clientHeight,n.clientHeight),c=s(e.offsetHeight,n.offsetHeight),{width:r<i?o:r,height:u<c?a:u}}function PN(t){var e,n;if(t.changedTouches)for(e="screenX screenY pageX pageY clientX clientY".split(" "),n=0;n<e.length;n++)t[e[n]]=t.changedTouches[0][e[n]]}function MN(t,n){var r,o,i,u,a,c,s,l=n.document||e.document;n=n||{};var f=l.getElementById(n.handle||t);i=function(t){var i,d,m=NN(l);PN(t),t.preventDefault(),o=t.button,i=f,c=t.screenX,s=t.screenY,d=e.window.getComputedStyle?e.window.getComputedStyle(i,null).getPropertyValue("cursor"):i.runtimeStyle.cursor,r=AN("<div></div>").css({position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}).appendTo(l.body),AN(l).on("mousemove touchmove",a).on("mouseup touchend",u),n.start(t)},a=function(t){if(PN(t),t.button!==o)return u(t);t.deltaX=t.screenX-c,t.deltaY=t.screenY-s,t.preventDefault(),n.drag(t)},u=function(t){PN(t),AN(l).off("mousemove touchmove",a).off("mouseup touchend",u),r.remove(),n.stop&&n.stop(t)},this.destroy=function(){AN(f).off()},AN(f).on("mousedown touchstart",i)}var FN=0,LN=function(t,e,n,r,o){var i,u,a,c="tox-",s=c+"crid-"+FN++,l=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}];a=["top","right","bottom","left"];var f=function(t,e){return{x:e.x+t.x,y:e.y+t.y,w:e.w,h:e.h}},d=function(t,e){return{x:e.x-t.x,y:e.y-t.y,w:e.w,h:e.h}},m=function(){return d(n,t)};function g(e,r,o,u){var a,c,s,l,f;a=r.x,c=r.y,s=r.w,l=r.h,a+=o*e.deltaX,c+=u*e.deltaY,s+=o*e.deltaW,l+=u*e.deltaH,s<20&&(s=20),l<20&&(l=20),f=t=_N.clamp({x:a,y:c,w:s,h:l},n,"move"===e.name),f=d(n,f),i.fire("updateRect",{rect:f}),w(f)}function p(){function e(e){var n;return new MN(s,{document:r.ownerDocument,handle:s+"-"+e.name,start:function(){n=t},drag:function(t){g(e,n,t.deltaX,t.deltaY)}})}AN('<div id="'+s+'" class="'+c+'croprect-container" role="grid" aria-dropeffect="execute">').appendTo(r),BN.each(a,(function(t){AN("#"+s,r).append('<div id="'+s+"-"+t+'"class="'+c+'croprect-block" style="display: none" data-mce-bogus="all">')})),BN.each(l,(function(t){AN("#"+s,r).append('<div id="'+s+"-"+t.name+'" class="'+c+"croprect-handle "+c+"croprect-handle-"+t.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+t.label+'" aria-grabbed="false" title="'+t.label+'">')})),u=BN.map(l,e),v(t),AN(r).on("focusin focusout",(function(t){AN(t.target).attr("aria-grabbed","focus"===t.type?"true":"false")})),AN(r).on("keydown",(function(e){var n;function r(t,e,r,o,i){t.stopPropagation(),t.preventDefault(),g(n,r,o,i)}switch(BN.each(l,(function(t){if(e.target.id===s+"-"+t.name)return n=t,!1})),e.keyCode){case IN.LEFT:r(e,n,t,-10,0);break;case IN.RIGHT:r(e,n,t,10,0);break;case IN.UP:r(e,n,t,0,-10);break;case IN.DOWN:r(e,n,t,0,10);break;case IN.ENTER:case IN.SPACEBAR:e.preventDefault(),o();break}}))}function h(t){var e;e=BN.map(l,(function(t){return"#"+s+"-"+t.name})).concat(BN.map(a,(function(t){return"#"+s+"-"+t}))).join(","),t?AN(e,r).show():AN(e,r).hide()}function v(t){function n(t,e){e.h<0&&(e.h=0),e.w<0&&(e.w=0),AN("#"+s+"-"+t,r).css({left:e.x,top:e.y,width:e.w,height:e.h})}BN.each(l,(function(e){AN("#"+s+"-"+e.name,r).css({left:t.w*e.xMul+t.x,top:t.h*e.yMul+t.y})})),n("top",{x:e.x,y:e.y,w:e.w,h:t.y-e.y}),n("right",{x:t.x+t.w,y:t.y,w:e.w-t.x-t.w+e.x,h:t.h}),n("bottom",{x:e.x,y:t.y+t.h,w:e.w,h:e.h-t.y-t.h+e.y}),n("left",{x:e.x,y:t.y,w:t.x-e.x,h:t.h}),n("move",t)}function b(e){t=e,v(t)}function y(n){e=n,v(t)}function w(t){b(f(n,t))}function x(e){n=e,v(t)}function C(){BN.each(u,(function(t){t.destroy()})),u=[]}return p(),i=BN.extend({toggleVisibility:h,setClampRect:x,setRect:b,getInnerRect:m,setInnerRect:w,setViewPortRect:y,destroy:C},RN),i},HN={create:LN},zN=function(t){return new px((function(e){var n=function(){t.removeEventListener("load",n),e(t)};t.complete?e(t):t.addEventListener("load",n)}))},jN=function(t){var e=Lw({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),n=Wn(1),r=Wn(x.none()),o=Wn({x:0,y:0,w:1,h:1}),i=Wn({x:0,y:0,w:1,h:1}),u=function(t,i){g.getOpt(t).each((function(t){var u=n.get(),a=Oc(t.element()),c=gc(t.element()),s=i.dom().naturalWidth*u,l=i.dom().naturalHeight*u,f=Math.max(0,a/2-s/2),d=Math.max(0,c/2-l/2),m={left:f.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:l.toString()+"px",position:"absolute"};ja(i,m),e.getOpt(t).each((function(t){ja(t.element(),m)})),r.get().each((function(t){var e=o.get();t.setRect({x:e.x*u+f,y:e.y*u+d,w:e.w*u,h:e.h*u}),t.setClampRect({x:f,y:d,w:s,h:l}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,e){g.getOpt(t).each((function(t){var r=Oc(t.element()),o=gc(t.element()),i=e.dom().naturalWidth,u=e.dom().naturalHeight,a=Math.min(r/i,o/u);a>=1?n.set(1):n.set(a)}))},c=function(t,e){var n=Kn.fromTag("img");return yu(n,"src",e),zN(n.dom()).then((function(){return g.getOpt(t).map((function(t){var e=ac({element:n});cy.replaceAt(t,1,x.some(e));var r=i.get(),c={x:0,y:0,w:n.dom().naturalWidth,h:n.dom().naturalHeight};i.set(c);var s=_N.inflate(c,-20,-20);return o.set(s),r.w===c.w&&r.h===c.h||a(t,n),u(t,n),n}))}))},s=function(t,e){var r=n.get(),o=e>0?Math.min(2,r+.1):Math.max(.1,r-.1);n.set(o),g.getOpt(t).each((function(t){var e=t.components()[1].element();u(t,e)}))},l=function(){r.get().each((function(t){t.toggleVisibility(!0)}))},f=function(){r.get().each((function(t){t.toggleVisibility(!1)}))},d=function(){return o.get()},m=bT.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[e.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:dl([ly("image-panel-crop-events",[Li((function(t){g.getOpt(t).each((function(t){var e=t.element().dom(),i=HN.create({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},e,(function(){}));i.toggleVisibility(!1),i.on("updateRect",(function(t){var e=t.rect,r=n.get(),i={x:Math.round(e.x/r),y:Math.round(e.y/r),w:Math.round(e.w/r),h:Math.round(e.h/r)};o.set(i)})),r.set(x.some(i))}))}))])])}],containerBehaviours:dl([cy.config({}),ly("image-panel-events",[Li((function(e){c(e,t)}))])])}),g=Lw(m),p=function(){var t=i.get();return{width:t.w,height:t.h}};return{memContainer:g,updateSrc:c,zoom:s,showCrop:l,hideCrop:f,getRect:d,getMeasurements:p}},VN=function(t,e,n,r,o){return XI({name:t,icon:x.some(e),disabled:n,tooltip:x.some(t),primary:!1,borderless:!1},r,o)},UN=function(t,e){e?uS.enable(t):uS.disable(t)},WN=function(t){var e=function(t,e,o){n.getOpt(t).each((function(t){UN(t,e)})),r.getOpt(t).each((function(t){UN(t,o)}))},n=Lw(VN("Undo","undo",!0,(function(t){ui(t,SN.undo(),{direction:1})}),t)),r=Lw(VN("Redo","redo",!0,(function(t){ui(t,SN.redo(),{direction:1})}),t)),o=bT.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),r.asSpec(),VN("Zoom in","zoom-in",!1,(function(t){ui(t,SN.zoom(),{direction:1})}),t),VN("Zoom out","zoom-out",!1,(function(t){ui(t,SN.zoom(),{direction:-1})}),t)]});return{container:o,updateButtonUndoStates:e}};function GN(){var t=[],e=-1;function n(n){var r;return r=t.splice(++e),t.push(n),{state:n,removed:r}}function r(){if(i())return t[--e]}function o(){if(u())return t[++e]}function i(){return e>0}function u(){return-1!==e&&e<t.length-1}return{data:t,add:n,undo:r,redo:o,canUndo:i,canRedo:u}}var qN,XN=function(t){var n=Wn(t),r=Wn(x.none()),o=GN();o.add(t);var i=function(){return n.get()},u=function(t){n.set(t)},a=function(){return r.get().fold((function(){return n.get()}),(function(t){return t}))},c=function(t){var e=s(t);return d(),r.set(x.some(e)),e.url},s=function(t){return{blob:t,url:e.URL.createObjectURL(t)}},l=function(t){e.URL.revokeObjectURL(t.url)},f=function(t){BN.each(t,l)},d=function(){r.get().each(l),r.set(x.none())},m=function(t){var e=s(t);u(e);var n=o.add(e).removed;return f(n),e.url},g=function(t){var e=s(t);return r.set(x.some(e)),e.url},p=function(t){return r.get().fold((function(){}),(function(e){m(e.blob),t()}))},h=function(){var t=o.undo();return u(t),t.url},v=function(){var t=o.redo();return u(t),t.url},b=function(){var t=o.canUndo(),e=o.canRedo();return{undoEnabled:t,redoEnabled:e}};return{getBlobState:i,setBlobState:u,addBlobState:m,getTempState:a,updateTempState:c,addTempState:g,applyTempState:p,destroyTempState:d,undo:h,redo:v,getHistoryStates:b}},$N=function(t,r){var o=XN(t.currentState),i=function(t,e){var n=e.event().direction();O.zoom(t,n)},u=function(t){var e=o.getHistoryStates();T.updateButtonUndoStates(t,e.undoEnabled,e.redoEnabled),ui(t,EN.formActionEvent,{name:EN.saveState(),value:e.undoEnabled})},a=function(t){T.updateButtonUndoStates(t,!1,!1)},c=function(t,e){var n=o.undo();m(t,n).then((function(e){d(t),u(t)}))},s=function(t,e){var n=o.redo();m(t,n).then((function(e){d(t),u(t)}))},l=function(t){return t.toBlob()},f=function(t){ui(t,EN.formActionEvent,{name:EN.disable(),value:{}})},d=function(t){E.getApplyButton(t).each((function(t){uS.enable(t)})),ui(t,EN.formActionEvent,{name:EN.enable(),value:{}})},m=function(t,e){return f(t),O.updateSrc(t,e)},g=function(t,n,r,o,i){return f(t),PB(n).then(r).then(l).then(o).then((function(e){return m(t,e).then((function(e){return u(t),i(),d(t),e}))})).catch((function(n){return e.console.log(n),d(t),n}))},p=function(t,e,n){var r=o.getBlobState().blob,i=function(t){return o.updateTempState(t)};g(t,r,e,i,n)},h=function(t,e){var r=o.getTempState().blob,i=function(t){return o.addTempState(t)};g(t,r,e,i,n)},v=function(t,e,n){var r=o.getBlobState().blob,i=function(e){var n=o.addBlobState(e);return y(t),n};g(t,r,e,i,n)},b=function(t,e){var n=function(){y(t);var n=e.event().swap();n()};o.applyTempState(n)},y=function(t){var e=o.getBlobState().url;return o.destroyTempState(),u(t),e},w=function(t){var e=y(t);m(t,e).then((function(e){d(t)}))},x=function(t,e){w(t);var n=e.event().swap();n(),O.hideCrop()},C=function(t,e){return p(t,e.event().transform(),n)},S=function(t,e){return h(t,e.event().transform())},k=function(t,e){return v(t,e.event().transform(),e.event().swap())},O=jN(t.currentState.url),T=WN(r),E=DN(O,r),D=function(t,e){a(t);var n=e.event().transform(),r=e.event().swap();n.fold((function(){r()}),(function(e){p(t,e,r)}))};return{dom:{tag:"div",attributes:{role:"presentation"}},components:[E.memContainer.asSpec(),O.memContainer.asSpec(),T.container],behaviours:dl([Vg.config({store:{mode:"manual",getValue:function(){return o.getBlobState()}}}),ly("image-tools-events",[Di(SN.undo(),c),Di(SN.redo(),s),Di(SN.zoom(),i),Di(SN.back(),x),Di(SN.apply(),b),Di(SN.transform(),C),Di(SN.tempTransform(),S),Di(SN.transformApply(),k),Di(SN.swap(),D)]),HR.self()])}},YN=function(t,e){var n=W(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),r=t.data.map((function(t){return Xt("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:n,behaviours:Gg(t.selectBehaviours,[yy.config({}),Vg.config({store:m({mode:"manual",getValue:function(t){return Ya(t.element())},setValue:function(e,n){var r=J(t.options,(function(t){return t.value===n}));r.isSome()&&Ka(e.element(),n)}},r)})])}},KN=Zp({name:"HtmlSelect",configFields:[gn("options"),Ug("selectBehaviours",[yy,Vg]),In("selectClasses",[]),In("selectAttributes",{}),On("data")],factory:YN}),JN=function(t,e){var n=W(t.items,(function(t){return{text:e.translate(t.text),value:t.value}})),r=t.label.map((function(t){return JE(t,e)})),o=fE.parts().field({dom:{},selectAttributes:{size:t.size},options:n,factory:KN,selectBehaviours:dl([uS.config({disabled:t.disabled}),GE.config({}),ly("selectbox-change",[Di(Do(),(function(e,n){ui(e,JT,{name:t.name})}))])])}),i=t.size>1?x.none():x.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:zw("chevron-down",e.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:Z([[o],i.toArray()])};return fE.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:Z([r.toArray(),[u]]),fieldBehaviours:dl([uS.config({disabled:t.disabled,onDisabled:function(t){fE.getField(t).each(uS.disable)},onEnabled:function(t){fE.getField(t).each(uS.enable)}})])})},QN=function(t,e){var n=t.label.map((function(t){return JE(t,e)})),r=[uS.config({disabled:t.disabled}),Qb.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return ii(t,eE),x.some(!0)}}),ly("textfield-change",[Di(Eo(),(function(e,n){ui(e,JT,{name:t.name})})),Di(Po(),(function(e,n){ui(e,JT,{name:t.name})}))]),GE.config({})],o=t.validation.map((function(t){return jE.config({getRoot:function(t){return Qi(t.element())},invalidClass:"tox-invalid",validator:{validate:function(e){var n=Vg.getValue(e),r=t.validator(n);return AE.pure(!0===r?O.value(n):O.error(r))},validateOnLoad:t.validateOnLoad}})})).toArray(),u=t.placeholder.fold(i({}),(function(t){return{placeholder:e.translate(t)}})),a=t.inputMode.fold(i({}),(function(t){return{inputmode:t}})),c=m(m({},u),a),s=fE.parts().field({tag:!0===t.multiline?"textarea":"input",inputAttributes:c,inputClasses:[t.classname],inputBehaviours:dl(Z([r,o])),selectOnFocus:!1,factory:vE}),l=t.flex?["tox-form__group--stretched"]:[],f=l.concat(t.maximized?["tox-form-group--maximize"]:[]),d=[uS.config({disabled:t.disabled,onDisabled:function(t){fE.getField(t).each(uS.disable)},onEnabled:function(t){fE.getField(t).each(uS.enable)}})];return qE(n,s,f,d)},ZN=function(t,e){return QN({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:x.none(),maximized:t.maximized},e)},tP=function(t,e){return QN({name:t.name,multiline:!0,label:t.label,inputMode:x.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:x.none(),maximized:t.maximized},e)},eP=function(t,e){var n=t.stream.streams,r=n.setup(t,e);return ki([Di(t.event,r),Hi((function(){return e.cancel()}))].concat(t.cancelEvent.map((function(t){return[Di(t,(function(){return e.cancel()}))]})).getOr([])))},nP=Object.freeze({events:eP}),rP=function(t){var e=Wn(null),n=function(){return{timer:null!==e.get()?"set":"unset"}},r=function(t){e.set(t)},o=function(){var t=e.get();null!==t&&t.cancel()};return Zu({readState:n,setTimer:r,cancel:o})},oP=function(t){return t.stream.streams.state(t)},iP=Object.freeze({throttle:rP,init:oP}),uP=function(t,e){var n=t.stream,r=Kw(t.onStream,n.delay);return e.setTimer(r),function(t,e){r.throttle(t,e),n.stopEvent&&e.stop()}},aP=[pn("stream",rn("mode",{throttle:[gn("delay"),In("stopEvent",!0),Ss("streams",{setup:uP,state:rP})]})),In("event","input"),On("cancelEvent"),xs("onStream")],cP=gl({fields:aP,name:"streaming",active:nP,state:iP}),sP=function(t,e,n){var r=Vg.getValue(n);Vg.setValue(e,r),fP(e)},lP=function(t,e){var n=t.element(),r=Ya(n),o=n.dom();"number"!==xu(n,"type")&&e(o,r)},fP=function(t){lP(t,(function(t,e){return t.setSelectionRange(e.length,e.length)}))},dP=function(t,e){lP(t,(function(t,n){return t.setSelectionRange(e,n.length)}))},mP=function(t,e,n){if(t.selectsOver){var r=Vg.getValue(e),o=t.getDisplayText(r),i=Vg.getValue(n),u=t.getDisplayText(i);return 0===u.indexOf(o)?x.some((function(){sP(t,e,n),dP(e,o.length)})):x.none()}return x.none()},gP=i("alloy.typeahead.itemexecute"),pP=function(t,e,r,o){var i=function(e,r,i){t.previewing.set(!1);var u=rD.getCoupled(e,"sandbox");if(ug.isOpen(u))ih.getCurrent(u).each((function(t){Oh.getHighlighted(t).fold((function(){i(t)}),(function(){li(u,t.element(),"keydown",r)}))}));else{var c=function(t){ih.getCurrent(t).each(i)};sD(t,a(e),e,u,o,c,wE.HighlightFirst).get(n)}},u=mE(t),a=function(t){return function(e){return e.map((function(e){var n=ht(e.menus),r=tt(n,(function(t){return $(t.items,(function(t){return"item"===t.type}))})),o=Vg.getState(t);return o.update(W(r,(function(t){return t.data}))),e}))}},c=[yy.config({}),Vg.config({onSetValue:t.onSetValue,store:m({mode:"dataset",getDataKey:function(t){return Ya(t.element())},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(e,n){Ka(e.element(),t.model.getDisplayText(n))}},t.initialData.map((function(t){return Xt("initialValue",t)})).getOr({}))}),cP.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(e,r){var i=rD.getCoupled(e,"sandbox"),u=yy.isFocused(e);if(u&&Ya(e.element()).length>=t.minChars){var c=ih.getCurrent(i).bind((function(t){return Oh.getHighlighted(t).map(Vg.getValue)}));t.previewing.set(!0);var s=function(e){ih.getCurrent(i).each((function(e){c.fold((function(){t.model.selectsOver&&Oh.highlightFirst(e)}),(function(t){Oh.highlightBy(e,(function(e){var n=Vg.getValue(e);return n.value===t.value})),Oh.getHighlighted(e).orThunk((function(){return Oh.highlightFirst(e),x.none()}))}))}))};sD(t,a(e),e,i,o,s,wE.HighlightFirst).get(n)}},cancelEvent:Uo()}),Qb.config({mode:"special",onDown:function(t,e){return i(t,e,Oh.highlightFirst),x.some(!0)},onEscape:function(t){var e=rD.getCoupled(t,"sandbox");return ug.isOpen(e)?(ug.close(e),x.some(!0)):x.none()},onUp:function(t,e){return i(t,e,Oh.highlightLast),x.some(!0)},onEnter:function(e){var n=rD.getCoupled(e,"sandbox"),r=ug.isOpen(n);if(r&&!t.previewing.get())return ih.getCurrent(n).bind((function(t){return Oh.getHighlighted(t)})).map((function(t){return ui(e,gP(),{item:t}),!0}));var o=Vg.getValue(e);return ii(e,Uo()),t.onExecute(n,e,o),r&&ug.close(n),x.some(!0)}}),Ly.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),rD.config({others:{sandbox:function(e){return pD(t,e,{onOpen:function(){return Ly.on(e)},onClose:function(){return Ly.off(e)}})}}}),ly("typeaheadevents",[ji((function(e){var r=n;fD(t,a(e),e,o,r,wE.HighlightFirst).get(n)})),Di(gP(),(function(e,n){var r=rD.getCoupled(e,"sandbox");sP(t.model,e,n.event().item()),ii(e,Uo()),t.onItemExecute(e,r,n.event().item(),Vg.getValue(e)),ug.close(r),fP(e)}))].concat(t.dismissOnBlur?[Di(No(),(function(t){var e=rD.getCoupled(t,"sandbox");Al(e.element()).isNone()&&ug.close(e)}))]:[]))];return{uid:t.uid,dom:pE(Ot(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:m(m({},u),Gg(t.typeaheadBehaviours,c)),eventOrder:t.eventOrder}},hP=i([On("lazySink"),gn("fetch"),In("minChars",5),In("responseTime",1e3),ys("onOpen"),In("getHotspot",x.some),In("getAnchorOverrides",i({})),In("layouts",x.none()),In("eventOrder",{}),Vn("model",{},[In("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),In("selectsOver",!0),In("populateFromBrowse",!0)]),ys("onSetValue"),ws("onExecute"),ys("onItemExecute"),In("inputClasses",[]),In("inputAttributes",{}),In("inputStyles",{}),In("matchWidth",!0),In("useMinWidth",!1),In("dismissOnBlur",!0),vs(["openClass"]),On("initialData"),Ug("typeaheadBehaviours",[yy,Vg,cP,Qb,Ly,rD]),Un("previewing",(function(){return Wn(!0)}))].concat(dE()).concat(vD())),vP=i([xp({schema:[hs()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(e,n){t.previewing.get()?e.getSystem().getByUid(t.uid).each((function(r){mP(t.model,r,n).fold((function(){return Oh.dehighlight(e,n)}),(function(t){return t()}))})):e.getSystem().getByUid(t.uid).each((function(e){t.model.populateFromBrowse&&sP(t.model,e,n)})),t.previewing.set(!1)},onExecute:function(e,n){return e.getSystem().getByUid(t.uid).toOption().map((function(t){return ui(t,gP(),{item:n}),!0}))},onHover:function(e,n){t.previewing.set(!1),e.getSystem().getByUid(t.uid).each((function(e){t.model.populateFromBrowse&&sP(t.model,e,n)}))}}}})]),bP=th({name:"Typeahead",configFields:hP(),partFields:vP(),factory:pP}),yP=function(t){var n=function(){return yP(t.toCached())},r=function(e){return yP(t.bind((function(t){return t.fold((function(t){return AE.pure(O.error(t))}),(function(t){return e(t)}))})))},o=function(e){return yP(t.map((function(t){return t.bind(e)})))},i=function(e){return yP(t.map((function(t){return t.map(e)})))},u=function(e){return yP(t.map((function(t){return t.mapError(e)})))},a=function(e,n){return t.map((function(t){return t.fold(e,n)}))},c=function(n,r){return yP(AE.nu((function(o){var i=!1,u=e.setTimeout((function(){i=!0,o(O.error(r()))}),n);t.get((function(t){i||(e.clearTimeout(u),o(t))}))})))};return m(m({},t),{toCached:n,bindFuture:r,bindResult:o,mapResult:i,mapError:u,foldResult:a,withTimeout:c})},wP=function(t){return yP(AE.nu(t))},xP=function(t){return yP(AE.pure(O.value(t)))},CP=function(t){return yP(AE.pure(O.error(t)))},SP=function(t){return yP(AE.pure(t))},kP=function(t){return yP(t.map(O.value))},OP=function(t){return wP((function(e){t.then((function(t){e(O.value(t))}),(function(t){e(O.error(t))}))}))},TP={nu:wP,wrap:yP,pure:xP,value:xP,error:CP,fromResult:SP,fromFuture:kP,fromPromise:OP},EP={type:"separator"},DP=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:function(){}}},AP=function(t,e){return{type:"menuitem",value:e,text:t,meta:{attach:void 0},onAction:function(){}}},_P=function(t){return W(t,DP)},RP=function(t,e){return $(e,(function(e){return e.type===t}))},BP=function(t,e){return _P(RP(t,e))},IP=function(t){return BP("header",t.targets)},NP=function(t){return BP("anchor",t.targets)},PP=function(t){return x.from(t.anchorTop).map((function(t){return AP("<top>",t)})).toArray()},MP=function(t){return x.from(t.anchorBottom).map((function(t){return AP("<bottom>",t)})).toArray()},FP=function(t){return W(t,(function(t){return AP(t,t)}))},LP=function(t){return K(t,(function(t,e){var n=0===t.length||0===e.length;return n?t.concat(e):t.concat(EP,e)}),[])},HP=function(t,e){var n=t.toLowerCase();return $(e,(function(t){var e=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return Nr(e.toLowerCase(),n)||Nr(t.value.toLowerCase(),n)}))},zP=function(t,e,n){var r=Vg.getValue(e),o=void 0!==r.meta.text?r.meta.text:r.value,i=n.getLinkInformation();return i.fold((function(){return[]}),(function(e){var r=HP(o,FP(n.getHistory(t)));return"file"===t?LP([r,HP(o,IP(e)),HP(o,Z([PP(e),NP(e),MP(e)]))]):r}))},jP=Bu("aria-invalid"),VP=function(t,e,r){var o,i=e.shared.providers,u=function(e){var n=Vg.getValue(e);r.addToHistory(n.value,t.filetype)},a=fE.parts().field({factory:bP,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":jP,type:"url"},minChars:0,responseTime:0,fetch:function(n){var o=zP(t.filetype,n,r),i=jI(o,pS.BUBBLE_TO_SANDBOX,e,!1);return AE.pure(i)},getHotspot:function(t){return p.getOpt(t)},onSetValue:function(t,e){t.hasConfigured(jE)&&jE.run(t).get(n)},typeaheadBehaviours:dl(Z([r.getValidationHandler().map((function(e){return jE.config({getRoot:function(t){return Qi(t.element())},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,e){l.getOpt(t).each((function(t){yu(t.element(),"title",i.translate(e))}))}},validator:{validate:function(n){var r=Vg.getValue(n);return TP.nu((function(n){e({type:t.filetype,url:r.value},(function(t){if("invalid"===t.status){var e=O.error(t.message);n(e)}else{var r=O.value(t.message);n(r)}}))}))},validateOnLoad:!1}})})).toArray(),[uS.config({disabled:t.disabled}),GE.config({}),ly("urlinput-events",Z(["file"===t.filetype?[Di(Eo(),(function(e){ui(e,JT,{name:t.name})}))]:[],[Di(Do(),(function(e){ui(e,JT,{name:t.name}),u(e)})),Di(Po(),(function(e){ui(e,JT,{name:t.name}),u(e)}))]]))]])),eventOrder:(o={},o[Eo()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:Qk(!1,1,"normal")},onExecute:function(t,e,n){ui(e,eE,{})},onItemExecute:function(e,n,r,o){u(e),ui(e,JT,{name:t.name})}}),c=t.label.map((function(t){return JE(t,i)})),s=function(t,e,n,r){return void 0===n&&(n=t),void 0===r&&(r=t),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],innerHtml:zw(n,i.icons),attributes:m({title:i.translate(r),"aria-live":"polite"},e.fold((function(){return{}}),(function(t){return{id:t}})))}}},l=Lw(s("invalid",x.some(jP),"warning")),f=Lw({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[l.asSpec()]}),d=r.getUrlPicker(t.filetype),g=Bu("browser.url.event"),p=Lw({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,f.asSpec()],behaviours:dl([uS.config({disabled:t.disabled})])}),h=Lw(YI({name:t.name,icon:x.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return ii(t,g)}),i,[],["tox-browse-url"])),v=function(){return{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:Z([[p.asSpec()],d.map((function(){return h.asSpec()})).toArray()])}},b=function(e){ih.getCurrent(e).each((function(n){var r=Vg.getValue(n);d.each((function(o){o(r).get((function(r){Vg.setValue(n,r),ui(e,JT,{name:t.name})}))}))}))};return fE.sketch({dom:YE(),components:c.toArray().concat([v()]),fieldBehaviours:dl([uS.config({disabled:t.disabled,onDisabled:function(t){fE.getField(t).each(uS.disable),h.getOpt(t).each(uS.disable)},onEnabled:function(t){fE.getField(t).each(uS.enable),h.getOpt(t).each(uS.enable)}}),ly("url-input-events",[Di(g,b)])])})},UP=function(t,e){var n=Vg.config({store:{mode:"manual",getValue:function(t){var e=t.element().dom();return e.checked},setValue:function(t,e){var n=t.element().dom();n.checked=e}}}),r=function(t){return t.element().dom().click(),x.some(!0)},o=fE.parts().field({factory:{sketch:u},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:dl([HR.self(),uS.config({disabled:t.disabled}),GE.config({}),yy.config({}),n,Qb.config({mode:"special",onEnter:r,onSpace:r,stopSpaceKeyup:!0}),ly("checkbox-events",[Di(Do(),(function(e,n){ui(e,JT,{name:t.name})}))])])}),i=fE.parts().label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:e.translate(t.label)},behaviours:dl([OD.config({})])}),a=function(t){var n="checked"===t?"selected":"unselected";return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t],innerHtml:zw(n,e.icons)}}},c=Lw({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return fE.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[o,c.asSpec(),i],fieldBehaviours:dl([uS.config({disabled:t.disabled,disableClass:"tox-checkbox--disabled",onDisabled:function(t){fE.getField(t).each(uS.disable)},onEnabled:function(t){fE.getField(t).each(uS.enable)}})])})},WP=function(t){return"presentation"===t.presets?bT.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):bT.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:dl([GE.config({}),yy.config({})])})},GP=function(t,e){var n={dom:{tag:"label",innerHtml:e.providers.translate(t.label),classes:["tox-label"]}},r=W(t.items,e.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[n].concat(r),behaviours:dl([HR.self(),cy.config({}),tB.domHtml(x.none()),Qb.config({mode:"acyclic"})])}},qP=function(t,e){var n=t.label.map((function(t){return JE(t,e)})),r=function(t){return function(e,n){qc(n.event().target(),"[data-collection-item-value]").each((function(r){t(e,n,r,xu(r,"data-collection-item-value"))}))}},o=function(t){return'"'===t?"&quot;":t},i=function(e,n){var r=W(n,(function(e){var n=fC.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+n+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=n.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item" tabindex="-1" data-collection-item-value="'+o(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i=t.columns>1&&"auto"!==t.columns?U(r,t.columns):[r],u=W(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));hu(e.element(),u.join(""))},a=[Di(Co(),r((function(t,e,n){Ol(n)}))),Di(zo(),r((function(e,n,r,o){n.stop(),ui(e,tE,{name:t.name,value:o})}))),Di(So(),r((function(t,e,n){Gc(t.element(),"."+SC).each((function(t){Ia(t,SC)})),Ra(n,SC)}))),Di(ko(),r((function(t){Gc(t.element(),"."+SC).each((function(t){Ia(t,SC)}))}))),ji(r((function(e,n,r,o){ui(e,tE,{name:t.name,value:o})})))],c=fE.parts().field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:u},behaviours:dl([cy.config({}),Vg.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,n){i(e,n),"auto"===t.columns&&qx(e,5,"tox-collection__item").each((function(t){var n=t.numRows,r=t.numColumns;Qb.setGridSize(e,n,r)})),ii(e,iE)}}),GE.config({}),Qb.config(aO(t.columns,"normal")),ly("collection-events",a)])}),s=["tox-form__group--collection"];return qE(n,c,s,[])},XP=function(t,e){var n=function(t){return{dom:{tag:"th",innerHtml:e.translate(t)}}},r=function(t){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:W(t,n)}]}},o=function(t){return{dom:{tag:"td",innerHtml:e.translate(t)}}},i=function(t){return{dom:{tag:"tr"},components:W(t,o)}},u=function(t){return{dom:{tag:"tbody"},components:W(t,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[r(t.header),u(t.cells)],behaviours:dl([GE.config({}),yy.config({})])}},$P=function(t,e){return{dom:{tag:"div",classes:t.classes},components:W(t.items,e.shared.interpreter)}},YP=function(t){return function(e,n,r){return qt(n,"name").fold((function(){return t(n,r)}),(function(o){return e.field(o,t(n,r))}))}},KP=function(t){return function(e,n,r){var o=Ot(n,{source:"dynamic"});return YP(t)(e,o,r)}},JP={bar:YP((function(t,e){return aE(t,e.shared)})),collection:YP((function(t,e){return qP(t,e.shared.providers)})),alertbanner:YP((function(t,e){return uE(t,e.shared.providers)})),input:YP((function(t,e){return ZN(t,e.shared.providers)})),textarea:YP((function(t,e){return tP(t,e.shared.providers)})),label:YP((function(t,e){return GP(t,e.shared)})),iframe:KP((function(t,e){return pB(t,e.shared.providers)})),button:YP((function(t,e){return tN(t,e.shared.providers)})),checkbox:YP((function(t,e){return UP(t,e.shared.providers)})),colorinput:YP((function(t,e){return _D(t,e.shared,e.colorinput)})),colorpicker:YP(UR),dropzone:YP((function(t,e){return rB(t,e.shared.providers)})),grid:YP((function(t,e){return oB(t,e.shared)})),selectbox:YP((function(t,e){return JN(t,e.shared.providers)})),sizeinput:YP((function(t,e){return mN(t,e.shared.providers)})),urlinput:YP((function(t,e){return VP(t,e,e.urlinput)})),customeditor:YP(qR),htmlpanel:YP(WP),imagetools:YP((function(t,e){return $N(t,e.shared.providers)})),table:YP((function(t,e){return XP(t,e.shared.providers)})),panel:YP((function(t,e){return $P(t,e)}))},QP={field:function(t,e){return e}},ZP=function(t,e,n){var r=Ot(n,{shared:{interpreter:function(e){return tM(t,e,r)}}});return tM(t,e,r)},tM=function(t,n,r){return qt(JP,n.type).fold((function(){return e.console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(e){return e(t,n,r)}))},eM=function(t,e){var n=QP;return tM(n,t,e)},nM=i((function(t,e){Ec(t,Math.floor(e))})),rM={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},oM=function(t,e,n){var r=function(){return{anchor:"node",root:t(),node:x.from(t()),bubble:Bl(-12,-12,rM),layouts:{onRtl:function(){return[Bw]},onLtr:function(){return[Iw]}},overrides:{maxHeightFunction:dm()}}},o=function(){return{anchor:"hotspot",hotspot:e(),bubble:Bl(-12,12,rM),layouts:{onRtl:function(){return[Xs]},onLtr:function(){return[$s]}},overrides:{maxHeightFunction:dm()}}};return n?r:o},iM=function(t,e,n){var r=function(){return{anchor:"node",root:t(),node:x.from(t()),layouts:{onRtl:function(){return[Nw]},onLtr:function(){return[Nw]}}}},o=function(){return{anchor:"hotspot",hotspot:e(),layouts:{onRtl:function(){return[Qs]},onLtr:function(){return[Qs]}}}};return n?r:o},uM=function(t){return function(){return{anchor:"hotspot",hotspot:t(),overrides:{maxWidthFunction:nM()},layouts:{onRtl:function(){return[Xs,$s]},onLtr:function(){return[$s,Xs]}}}}},aM=function(t,e){return function(){return{anchor:"selection",root:e(),getSelection:function(){var e=t.selection.getRng();return x.some(yf.range(Kn.fromDom(e.startContainer),e.startOffset,Kn.fromDom(e.endContainer),e.endOffset))}}}},cM=function(t){return function(e){return{anchor:"node",root:t(),node:e}}},sM=function(t,e,n){var r=zT(t),o=function(){return Kn.fromDom(t.getBody())};return{toolbar:oM(o,e,r),toolbarOverflow:uM(n),banner:iM(o,e,r),cursor:aM(t,o),node:cM(o)}},lM={getAnchors:sM},fM=function(t){return function(e,n){var r=zk.colorPickerDialog(t);r(e,n)}},dM=function(t){return function(){return vk.hasCustomColors(t)}},mM=function(t){return function(){return vk.getColors(t)}},gM=function(t){return function(){return zk.getColorCols(t)}},pM=function(t){return{colorPicker:fM(t),hasCustomColors:dM(t),getColors:mM(t),getColorCols:gM(t)}},hM=function(t){return function(){return WT(t)}},vM=function(t){return{isDraggableModal:hM(t)}},bM=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",icon:"bold",format:"bold"},{title:"Italic",icon:"italic",format:"italic"},{title:"Underline",icon:"underline",format:"underline"},{title:"Strikethrough",icon:"strike-through",format:"strikethrough"},{title:"Superscript",icon:"superscript",format:"superscript"},{title:"Subscript",icon:"subscript",format:"subscript"},{title:"Code",icon:"code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}]}],yM=function(t){return bt(t,"items")},wM=function(t){return bt(t,"block")},xM=function(t){return bt(t,"inline")},CM=function(t){return bt(t,"selector")},SM=function(t){return K(t,(function(t,e){if(yM(e)){var n=SM(e.items);return{customFormats:t.customFormats.concat(n.customFormats),formats:t.formats.concat([{title:e.title,items:n.formats}])}}if(xM(e)||wM(e)||CM(e)){var r="custom-"+e.title.toLowerCase();return{customFormats:t.customFormats.concat([{name:r,format:e}]),formats:t.formats.concat([{title:e.title,format:r,icon:e.icon}])}}return m(m({},t),{formats:t.formats.concat(e)})}),{customFormats:[],formats:[]})},kM=function(t,e){var n=SM(e),r=function(e){G(e,(function(e){t.formatter.has(e.name)||t.formatter.register(e.name,e.format)}))};return t.formatter?r(n.customFormats):t.on("init",(function(){r(n.customFormats)})),n.formats},OM=function(t){return _T(t).map((function(e){var n=kM(t,e);return RT(t)?bM.concat(n):n})).getOr(bM)},TM=function(t,e,n){var r={type:"formatter",isSelected:e(t.format),getStylePreview:n(t.format)};return Ot(t,r)},EM=function(t,e,n,r){var o=function(t){return TM(t,n,r)},u=function(t){var e={type:"submenu",isSelected:i(!1),getStylePreview:function(){return x.none()}};return Ot(t,e)},a=function(e){var o=Bu(e.title),i={type:"formatter",format:o,isSelected:n(o),getStylePreview:r(o)},u=Ot(e,i);return t.formatter.register(o,u),u},c=function(t){return W(t,(function(t){var e=st(t);if(Qt(t,"items")){var n=c(t.items);return Ot(u(t),{getStyleItems:function(){return n}})}return Qt(t,"format")?o(t):1===e.length&&z(e,"title")?Ot(t,{type:"separator"}):a(t)}))};return c(e)},DM=function(t){var e=function(e){return function(){return t.formatter.match(e)}},n=function(e){return function(){var n=t.formatter.get(e);return void 0!==n?x.some({tag:n.length>0&&(n[0].inline||n[0].block)||"div",styleAttr:t.formatter.getCssText(e)}):x.none()}},r=function(t){var e=t.items;return void 0!==e&&e.length>0?tt(e,r):[t.format]},o=Wn([]),i=Wn([]),u=Wn([]),a=Wn([]),c=Wn(!1);t.on("init",(function(){var u=OM(t),a=EM(t,u,e,n);o.set(a),i.set(tt(a,r))})),t.on("addStyleModifications",(function(o){var i=EM(t,o.items,e,n);u.set(i),c.set(o.replace),a.set(tt(i,r))}));var s=function(){var t=c.get()?[]:o.get(),e=u.get();return t.concat(e)},l=function(){var t=c.get()?[]:i.get(),e=a.get();return t.concat(e)};return{getData:s,getFlattenedKeys:l}},AM=BN.trim,_M=function(t){return function(e){if(e&&1===e.nodeType){if(e.contentEditable===t)return!0;if(e.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},RM=_M("true"),BM=_M("false"),IM=function(t,e,n,r,o){return{type:t,title:e,url:n,level:r,attach:o}},NM=function(t){while(t=t.parentNode){var e=t.contentEditable;if(e&&"inherit"!==e)return RM(t)}return!1},PM=function(t,e){return W(cd(Kn.fromDom(e),t),(function(t){return t.dom()}))},MM=function(t){return t.innerText||t.textContent},FM=function(t){return t.id?t.id:Bu("h")},LM=function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)},HM=function(t){return LM(t)&&jM(t)},zM=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},jM=function(t){return NM(t)&&!BM(t)},VM=function(t){return zM(t)&&jM(t)},UM=function(t){return zM(t)?parseInt(t.nodeName.substr(1),10):0},WM=function(t){var e=FM(t),n=function(){t.id=e};return IM("header",MM(t),"#"+e,UM(t),n)},GM=function(t){var e=t.id||t.name,r=MM(t);return IM("anchor",r||"#"+e,"#"+e,0,n)},qM=function(t){return W($(t,VM),WM)},XM=function(t){return W($(t,HM),GM)},$M=function(t){var e=PM("h1,h2,h3,h4,h5,h6,a:not([href])",t);return e},YM=function(t){return AM(t.title).length>0},KM=function(t){var e=$M(t);return $(qM(e).concat(XM(e)),YM)},JM={find:KM},QM="tinymce-url-history",ZM=5,tF=function(t){return D(t)&&/^https?/.test(t)},eF=function(t){return _(t)&&t.length<=ZM&&et(t,tF)},nF=function(t){return A(t)&&pt(t,(function(t){return!eF(t)})).isNone()},rF=function(){var t,n=e.localStorage.getItem(QM);if(null===n)return{};try{t=JSON.parse(n)}catch(r){if(r instanceof SyntaxError)return e.console.log("Local storage "+QM+" was not valid JSON",r),{};throw r}return nF(t)?t:(e.console.log("Local storage "+QM+" was not valid format",t),{})},oF=function(t){if(!nF(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));e.localStorage.setItem(QM,JSON.stringify(t))},iF=function(t){var e=rF();return Object.prototype.hasOwnProperty.call(e,t)?e[t]:[]},uF=function(t,e){if(tF(t)){var n=rF(),r=Object.prototype.hasOwnProperty.call(n,e)?n[e]:[],o=$(r,(function(e){return e!==t}));n[e]=[t].concat(o).slice(0,ZM),oF(n)}},aF=Object.prototype.hasOwnProperty,cF=function(t){return!!t},sF=function(t){return dt(BN.makeMap(t,/[, ]/),cF)},lF=function(t,e){return aF.call(t,e)?x.some(t[e]):x.none()},fF=function(t,e,n){var r=lF(t,e).getOr(n);return D(r)?x.some(r):x.none()},dF=function(t){return x.some(t.file_picker_callback).filter(B)},mF=function(t){var e=x.some(t.file_picker_types).filter(cF),n=x.some(t.file_browser_callback_types).filter(cF),r=e.or(n).map(sF);return dF(t).fold((function(){return!1}),(function(t){return r.fold((function(){return!0}),(function(t){return st(t).length>0&&t}))}))},gF=function(t,e){var n=mF(t);return R(n)?n?dF(t):x.none():n[e]?dF(t):x.none()},pF=function(t,e){return gF(t.settings,e).map((function(n){return function(r){return AE.nu((function(o){var i=function(t,e){if(!D(t))throw new Error("Expected value to be string");if(void 0!==e&&!A(e))throw new Error("Expected meta to be a object");var n={value:t,meta:e};o(n)},u=BN.extend({filetype:e},x.from(r.meta).getOr({}));n.call(t,i,r.value,u)}))}}))},hF=function(t){return!1===t.settings.typeahead_urls?x.none():x.some({targets:JM.find(t.getBody()),anchorTop:fF(t.settings,"anchor_top","#top").getOrUndefined(),anchorBottom:fF(t.settings,"anchor_bottom","#bottom").getOrUndefined()})},vF=function(t){var e=x.from(t.settings.file_picker_validator_handler).filter(B);return e.orThunk((function(){return x.from(t.settings.filepicker_validator_handler).filter(B)}))},bF=function(t){return{getHistory:iF,addToHistory:uF,getLinkInformation:function(){return hF(t)},getValidationHandler:function(){return vF(t)},getUrlPicker:function(e){return pF(t,e)}}},yF=function(t,e,n,r){var o=Wn(!1),i={shared:{providers:{icons:function(){return e.ui.registry.getAll().icons},menuItems:function(){return e.ui.registry.getAll().menuItems},translate:fC.translate},interpreter:function(t){return eM(t,i)},anchors:lM.getAnchors(e,n,r),getSink:function(){return O.value(t)}},urlinput:bF(e),styleselect:DM(e),colorinput:pM(e),dialog:vM(e),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i},wF="contexttoolbar-show",xF="contexttoolbar-hide",CF=i([gn("dom"),In("shell",!0),Ug("toolbarBehaviours",[cy])]),SF=function(t){return{behaviours:dl([cy.config({})])}},kF=i([Cp({name:"groups",overrides:SF})]),OF=function(t,n,r,o){var i=function(t,n){u(t).fold((function(){throw e.console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){cy.set(t,n)}))},u=function(e){return t.shell?x.some(e):Pp(e,t,"groups")},a=t.shell?{behaviours:[cy.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:a.components,behaviours:Gg(t.toolbarBehaviours,a.behaviours),apis:{setGroups:i},domModification:{attributes:{role:"group"}}}},TF=th({name:"Toolbar",configFields:CF(),partFields:kF(),factory:OF,apis:{setGroups:function(t,e,n){t.setGroups(e,n)}}}),EF=function(t,e){var n={len:0,list:[]},r=K(t,(function(t,n){var r=e(n,t.len);return r.fold(i(t),(function(e){return{len:e.finish(),list:t.list.concat([e])}}))}),n);return r.list},DF=Vi("within","extra","withinWidth"),AF=function(t,e,n){var r=EF(t,(function(t,e){var r=n(t);return x.some({element:i(t),start:i(e),finish:i(e+r),width:i(r)})})),o=$(r,(function(t){return t.finish()<=e})),u=Y(o,(function(t,e){return t+e.width()}),0),a=r.slice(o.length);return{within:i(o),extra:i(a),withinWidth:i(u)}},_F=function(t){return W(t,(function(t){return t.element()}))},RF=function(t,e,n){var r=_F(t.concat(e));return DF(r,[],n)},BF=function(t,e,n,r){var o=_F(t).concat([n]);return DF(o,_F(e),r)},IF=function(t,e,n){return DF(_F(t),[],n)},NF=function(t,e,n){var r=AF(e,t,n);return 0===r.extra().length?x.some(r):x.none()},PF=function(t,e,n,r){var o=NF(t,e,n).getOrThunk((function(){return AF(e,t-n(r),n)})),i=o.within(),u=o.extra(),a=o.withinWidth();return 1===u.length&&u[0].width()<=n(r)?RF(i,u,a):u.length>=1?BF(i,u,r,a):IF(i,u,a)},MF=function(t,e){var n=W(e,(function(t){return lc(t)}));TF.setGroups(t,n)},FF=function(t,e){return t.bind((function(t){return Al(t.element()).bind((function(e){return t.getSystem().getByDom(e).toOption()}))})).orThunk((function(){return e.filter(yy.isFocused)}))},LF=function(t,e,n,r){var o=Mp(t,e,"primary"),i=Pp(t,e,"overflow-button"),u=rD.getCoupled(t,"overflowGroup");za(o.element(),"visibility","hidden");var a=FF(n,i);n.each((function(t){TF.setGroups(t,[])}));var c=e.builtGroups.get();MF(o,c.concat([u]));var s=Oc(o.element()),l=PF(s,c,(function(t){return Oc(t.element())}),u);0===l.extra().length?(cy.remove(o,u),n.each((function(t){TF.setGroups(t,[])}))):(MF(o,l.within()),n.each((function(t){MF(t,l.extra())}))),Xa(o.element(),"visibility"),$a(o.element()),n.each((function(t){i.each((function(e){return Ly.set(e,r(t))})),a.each(yy.focus)}))},HF=i([gn("items"),vs(["itemSelector"]),Ug("tgroupBehaviours",[Qb])]),zF=i([Sp({name:"items",unit:"item"})]),jF=function(t,e,n,r){return{uid:t.uid,dom:t.dom,components:e,behaviours:Gg(t.tgroupBehaviours,[Qb.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}},VF=th({name:"ToolbarGroup",configFields:HF(),partFields:zF(),factory:jF}),UF=i([Ug("splitToolbarBehaviours",[rD]),Un("builtGroups",(function(){return Wn([])}))]),WF=function(t,e,n,r,o){var i="alloy.toolbar.toggle",u=function(e,n){var r=W(n,e.getSystem().build);t.builtGroups.set(r)},a=function(t,e){u(t,e),o.apis.refresh(t)},c=function(e){return Pp(e,t,"overflow-button")};return{uid:t.uid,dom:t.dom,components:e,behaviours:Gg(t.splitToolbarBehaviours,[rD.config({others:m(m({},o.coupling),{overflowGroup:function(t){return VF.sketch(m(m({},r["overflow-group"]()),{items:[Fw.sketch(m(m({},r["overflow-button"]()),{action:function(e){ii(t,i)}}))]}))}})}),ly("toolbar-toggle-events",[Di(i,(function(t){o.apis.toggle(t)}))])]),apis:m({setGroups:a,getMoreButton:function(t){return c(t)}},o.apis),domModification:{attributes:{role:"group"}}}},GF=i([vs(["overflowToggledClass"]),gn("getAnchor"),An("getOverflowBounds"),gn("lazySink")].concat(UF())),qF=i([wp({factory:TF,schema:CF(),name:"primary"}),xp({factory:TF,schema:CF(),name:"overflow",overrides:function(t){return{toolbarBehaviours:dl([Qb.config({mode:"cyclic",onEscape:function(e){return Pp(e,t,"overflow-button").each(yy.focus),x.none()}})])}}}),xp({name:"overflow-button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:dl([Ly.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),xp({name:"overflow-group"})]),XF=function(t,e,n){var r=rD.getCoupled(t,"sandbox");ug.isOpen(r)?ug.close(r):ug.open(r,n.overflow())},$F=function(t){return t.getSystem().isConnected()},YF=function(t,e,n){var r=e.lazySink(t).getOrDie(),o=e.getAnchor(t),i=e.getOverflowBounds.map((function(t){return t()}));Tm.positionWithinBounds(r,o,n,i)},KF=function(t,e){var n=ug.getState(rD.getCoupled(t,"sandbox"));LF(t,e,n,$F),n.each((function(n){return YF(t,e,n)}))},JF=function(t,e){var n=ug.getState(rD.getCoupled(t,"sandbox"));n.each((function(n){return YF(t,e,n)}))},QF=function(t,e){var n=$c(),r=function(r,o){KF(t,e),Pp(t,e,"overflow-button").each((function(t){Ly.on(t),n.link(t.element())})),Qb.focusIn(o)},o=function(){Pp(t,e,"overflow-button").each((function(t){Ly.off(t),yy.focus(t),n.unlink(t.element())}))};return{dom:{tag:"div",attributes:{id:n.id()}},behaviours:dl([Qb.config({mode:"special",onEscape:function(t){return ug.close(t),x.some(!0)}}),ug.config({onOpen:r,onClose:o,isPartOf:function(e,n,r){return Kc(n,r)||Kc(t,r)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),Cl.config({channels:m({},mg({isExtraPart:i(!1),doReposition:function(){return JF(t,e)}}))})])}},ZF=function(t,e,n,r){return WF(t,e,n,r,{coupling:{sandbox:function(e){return QF(e,t)}},apis:{refresh:function(e){return KF(e,t)},toggle:function(e){return XF(e,t,r)},getOverflow:function(t){return ug.getState(rD.getCoupled(t,"sandbox"))},reposition:function(e){return JF(e,t)}}})},tL=th({name:"SplitFloatingToolbar",configFields:GF(),partFields:qF(),factory:ZF,apis:{setGroups:function(t,e,n){t.setGroups(e,n)},refresh:function(t,e){t.refresh(e)},reposition:function(t,e){t.reposition(e)},getMoreButton:function(t,e){return t.getMoreButton(e)},getOverflow:function(t,e){return t.getOverflow(e)},toggle:function(t,e){t.toggle(e)}}}),eL=function(t,e){return e.getAnimationRoot.fold((function(){return t.element()}),(function(e){return e(t)}))},nL=function(t){return t.dimension.property},rL=function(t,e){return t.dimension.getDimension(e)},oL=function(t,e){var n=eL(t,e);Ma(n,[e.shrinkingClass,e.growingClass])},iL=function(t,e){Ia(t.element(),e.openClass),Ra(t.element(),e.closedClass),za(t.element(),nL(e),"0px"),$a(t.element())},uL=function(t,e){Ia(t.element(),e.closedClass),Ra(t.element(),e.openClass),Xa(t.element(),nL(e))},aL=function(t,e,n,r){n.setCollapsed(),za(t.element(),nL(e),rL(e,t.element())),$a(t.element()),oL(t,e),iL(t,e),e.onStartShrink(t),e.onShrunk(t)},cL=function(t,e,n,r){var o=r.getOrThunk((function(){return rL(e,t.element())}));n.setCollapsed(),za(t.element(),nL(e),o),$a(t.element());var i=eL(t,e);Ia(i,e.growingClass),Ra(i,e.shrinkingClass),iL(t,e),e.onStartShrink(t)},sL=function(t,e,n){var r=rL(e,t.element()),o="0px"===r?aL:cL;o(t,e,n,x.some(r))},lL=function(t,e,n){var r=eL(t,e),o=Na(r,e.shrinkingClass),i=rL(e,t.element());uL(t,e);var u=rL(e,t.element()),a=function(){za(t.element(),nL(e),i),$a(t.element())},c=function(){iL(t,e)},s=o?a:c;s(),Ia(r,e.shrinkingClass),Ra(r,e.growingClass),uL(t,e),za(t.element(),nL(e),u),n.setExpanded(),e.onStartGrow(t)},fL=function(t,e,n){if(n.isExpanded()){Xa(t.element(),nL(e));var r=rL(e,t.element());za(t.element(),nL(e),r)}},dL=function(t,e,n){n.isExpanded()||lL(t,e,n)},mL=function(t,e,n){n.isExpanded()&&sL(t,e,n)},gL=function(t,e,n){n.isExpanded()&&aL(t,e,n)},pL=function(t,e,n){return n.isExpanded()},hL=function(t,e,n){return n.isCollapsed()},vL=function(t,e,n){var r=eL(t,e);return!0===Na(r,e.growingClass)},bL=function(t,e,n){var r=eL(t,e);return!0===Na(r,e.shrinkingClass)},yL=function(t,e,n){return!0===vL(t,e)||!0===bL(t,e)},wL=function(t,e,n){var r=n.isExpanded()?sL:lL;r(t,e,n)},xL=Object.freeze({refresh:fL,grow:dL,shrink:mL,immediateShrink:gL,hasGrown:pL,hasShrunk:hL,isGrowing:vL,isShrinking:bL,isTransitioning:yL,toggleGrow:wL,disableTransitions:oL}),CL=function(t,e){var n=e.expanded;return oa(n?{classes:[e.openClass],styles:{}}:{classes:[e.closedClass],styles:Xt(e.dimension.property,"0px")})},SL=function(t,e){return ki([Fi(_o(),(function(n,r){var o=r.event().raw();if(o.propertyName===t.dimension.property){oL(n,t),e.isExpanded()&&Xa(n.element(),t.dimension.property);var i=e.isExpanded()?t.onGrown:t.onShrunk;i(n)}}))])},kL=Object.freeze({exhibit:CL,events:SL}),OL=[gn("closedClass"),gn("openClass"),gn("shrinkingClass"),gn("growingClass"),On("getAnimationRoot"),ys("onShrunk"),ys("onStartShrink"),ys("onGrown"),ys("onStartGrow"),In("expanded",!1),pn("dimension",rn("property",{width:[Ss("property","width"),Ss("getDimension",(function(t){return Oc(t)+"px"}))],height:[Ss("property","height"),Ss("getDimension",(function(t){return gc(t)+"px"}))]}))],TL=function(t){var e=Wn(t.expanded),n=function(){return"expanded: "+e.get()};return Zu({isExpanded:function(){return!0===e.get()},isCollapsed:function(){return!1===e.get()},setCollapsed:a(e.set,!1),setExpanded:a(e.set,!0),readState:n})},EL=Object.freeze({init:TL}),DL=gl({fields:OL,name:"sliding",active:kL,apis:xL,state:EL}),AL=i([vs(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),ys("onOpened"),ys("onClosed")].concat(UF())),_L=i([wp({factory:TF,schema:CF(),name:"primary"}),wp({factory:TF,schema:CF(),name:"overflow",overrides:function(t){return{toolbarBehaviours:dl([DL.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(e){Pp(e,t,"overflow-button").each((function(t){Ly.off(t),yy.focus(t)})),t.onClosed(e)},onGrown:function(e){Qb.focusIn(e),t.onOpened(e)},onStartGrow:function(e){Pp(e,t,"overflow-button").each(Ly.on)}}),Qb.config({mode:"acyclic",onEscape:function(e){return Pp(e,t,"overflow-button").each(yy.focus),x.some(!0)}})])}}}),xp({name:"overflow-button",overrides:function(t){return{buttonBehaviours:dl([Ly.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),xp({name:"overflow-group"})]),RL=function(t,e){Pp(t,e,"overflow").each((function(n){IL(t,e),DL.toggleGrow(n)}))},BL=function(t){return DL.hasGrown(t)},IL=function(t,e){var n=Pp(t,e,"overflow");LF(t,e,n,BL),n.each(DL.refresh)},NL=function(t,e,n,r){return WF(t,e,n,r,{coupling:{},apis:{refresh:function(e){return IL(e,t)},toggle:function(e){return RL(e,t)},getOverflow:function(e){return Pp(e,t,"overflow")}}})},PL=th({name:"SplitSlidingToolbar",configFields:AL(),partFields:_L(),factory:NL,apis:{setGroups:function(t,e,n){t.setGroups(e,n)},refresh:function(t,e){t.refresh(e)},getMoreButton:function(t,e){return t.getMoreButton(e)},getOverflow:function(t,e){return t.getOverflow(e)},toggle:function(t,e){t.toggle(e)}}}),ML=i(Bu("toolbar-height-change")),FL="silver.readonly",LL=Me([yn("readonly")]),HL=function(t,e){to("*",t.element()).forEach((function(n){t.getSystem().getByDom(n).each((function(t){t.hasConfigured(uS)&&uS.set(t,e)}))}))},zL=function(t,e){var n=t.outerContainer,r=n.element();e&&(t.mothership.broadcastOn([ag()],{target:r}),t.uiMothership.broadcastOn([ag()],{target:r})),t.mothership.broadcastOn([FL],{readonly:e}),t.uiMothership.broadcastOn([FL],{readonly:e})},jL=function(t,e){var n=t.outerContainer;zL(t,e),to("*",n.element()).forEach((function(t){n.getSystem().getByDom(t).each((function(t){t.hasConfigured(uS)&&uS.set(t,e)}))}))},VL=function(t,e){t.on("init",(function(){t.readonly&&jL(e,!0)})),t.on("SwitchMode",(function(){return jL(e,t.readonly)})),CT(t)&&t.setMode("readonly")},UL=function(t){var e;return Cl.config({channels:(e={},e[FL]={schema:LL,onReceive:function(e,n){t(e).each((function(t){HL(t,n.readonly)}))}},e)})},WL=function(t){var e=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:m({tag:"div",classes:["tox-toolbar__group"]},e),components:[VF.parts().items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:dl([GE.config({}),yy.config({})])}},GL=function(t){return VF.sketch(WL(t))},qL=function(t,e,n){var r=Li((function(e){var n=W(t.initGroups,GL);TF.setGroups(e,n)}));return dl([Qb.config({mode:e,onEscape:t.onEscape,selector:".tox-toolbar__group"}),ly("toolbar-events",[r]),UL(n)])},XL=function(t,e){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":WL({title:x.none(),items:[]}),"overflow-button":qI({name:"more",icon:x.some("more-drawer"),disabled:!1,tooltip:x.some("More..."),primary:!1,borderless:!1},x.none(),t.backstage.shared.providers)},splitToolbarBehaviours:qL(t,n,e)}},$L=function(t){var e=XL(t,tL.getOverflow),n=4,r=tL.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return tL.sketch(m(m({},e),{lazySink:t.getSink,getAnchor:function(){return t.backstage.shared.anchors.toolbarOverflow()},getOverflowBounds:function(){var e=t.moreDrawerData.lazyHeader().element(),r=jc(e),o=Ki(e),i=jc(o);return Hc(r.x()+n,i.y(),r.width()-2*n,i.height())},parts:m(m({},e.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"]}}}),components:[r],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},YL=function(t){var e=PL.parts().primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),n=PL.parts().overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),r=XL(t,PL.getOverflow);return PL.sketch(m(m({},r),{components:[e,n],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([ML()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([ML()],{type:"closed"})}}))},KL=function(t){var e=t.cyclicKeying?"cyclic":"acyclic";return TF.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===hT.scrolling?["tox-toolbar--scrolling"]:[])},components:[TF.parts().groups({})],toolbarBehaviours:qL(t,e,i(x.none()))})},JL=[Ln("disabled",!1),Dn("tooltip"),Dn("icon"),Dn("text"),Hn("onSetup",(function(){return n}))],QL=Me([vn("type"),wn("onAction")].concat(JL)),ZL=function(t){return Qe("toolbarbutton",QL,t)},tH=[Dn("text"),Dn("tooltip"),Dn("icon"),wn("fetch"),Hn("onSetup",(function(){return n}))],eH=Me(p([vn("type")],tH)),nH=function(t){return Qe("menubutton",eH,t)},rH=Me([vn("type"),Dn("tooltip"),Dn("icon"),Dn("text"),An("select"),wn("fetch"),Hn("onSetup",(function(){return n})),Fn("presets","normal",["normal","color","listpreview"]),In("columns",1),wn("onAction"),wn("onItemAction")]),oH=function(t){return Qe("SplitButton",rH,t)},iH=[Ln("active",!1)].concat(JL),uH=Me(iH.concat([vn("type"),wn("onAction")])),aH=function(t){return Qe("ToggleButton",uH,t)},cH=[Hn("predicate",(function(){return!1})),Fn("scope","node",["node","editor"]),Fn("position","selection",["node","selection","line"])],sH=JL.concat([In("type","contextformbutton"),In("primary",!1),wn("onAction"),Un("original",u)]),lH=iH.concat([In("type","contextformbutton"),In("primary",!1),wn("onAction"),Un("original",u)]),fH=JL.concat([In("type","contextformbutton")]),dH=iH.concat([In("type","contextformtogglebutton")]),mH=rn("type",{contextformbutton:sH,contextformtogglebutton:lH}),gH=Me([In("type","contextform"),Hn("initValue",(function(){return""})),Dn("label"),kn("commands",mH),Tn("launch",rn("type",{contextformbutton:fH,contextformtogglebutton:dH}))].concat(cH)),pH=Me([In("type","contexttoolbar"),vn("items")].concat(cH)),hH=function(t){return Qe("ContextToolbar",pH,t)},vH=function(t){return Qe("ContextForm",gH,t)},bH=function(t,e,n){return n},yH=Object.freeze({getState:bH}),wH=function(t,e){var n=function(n,r){t.updateState.each((function(t){var o=t(n,r);e.set(o)})),t.renderComponents.each((function(t){var o=t(r,e.get()),i=W(o,n.getSystem().build);Rm(n,i)}))};return ki([Di(Mo(),(function(e,r){var o=t.channel;z(r.channels(),o)&&n(e,r.data())})),Li((function(e,r){t.initialData.each((function(t){n(e,t)}))}))])},xH=Object.freeze({events:wH}),CH=function(t){var e=Wn(x.none()),n=function(t){return e.set(t)},r=function(){return e.set(x.none())},o=function(){return e.get()},i=function(){return e.get().fold((function(){return"none"}),(function(t){return t}))};return{readState:i,get:o,set:n,clear:r}},SH=Object.freeze({init:CH}),kH=[gn("channel"),On("renderComponents"),On("updateState"),On("initialData")],OH=gl({fields:kH,name:"reflecting",active:xH,apis:yH,state:SH}),TH=i([gn("toggleClass"),gn("fetch"),xs("onExecute"),In("getHotspot",x.some),In("getAnchorOverrides",i({})),In("layouts",x.none()),xs("onItemExecute"),On("lazySink"),gn("dom"),ys("onOpen"),Ug("splitDropdownBehaviours",[rD,Qb,yy]),In("matchWidth",!1),In("useMinWidth",!1),In("eventOrder",{}),On("role")].concat(vD())),EH=wp({factory:Fw,schema:[gn("dom")],name:"arrow",defaults:function(t){return{buttonBehaviours:dl([yy.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(e){e.getSystem().getByUid(t.uid).each(ai)},buttonBehaviours:dl([Ly.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),DH=wp({factory:Fw,schema:[gn("dom")],name:"button",defaults:function(t){return{buttonBehaviours:dl([yy.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(e){e.getSystem().getByUid(t.uid).each((function(n){t.onExecute(n,e)}))}}}}),AH=i([EH,DH,Cp({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[gn("text")],name:"aria-descriptor"}),xp({schema:[hs()],name:"menu",defaults:function(t){return{onExecute:function(e,n){e.getSystem().getByUid(t.uid).each((function(r){t.onItemExecute(r,e,n)}))}}}}),iD()]),_H=function(t,e,r,o){var i=function(t){ih.getCurrent(t).each((function(t){Oh.highlightFirst(t),Qb.focusIn(t)}))},u=function(e){var r=i;fD(t,(function(t){return t}),e,o,r,wE.HighlightFirst).get(n)},a=function(t){return u(t),x.some(!0)},c=function(e){var n=Mp(e,t,"button");return ai(n),x.some(!0)},s=Tt(ki([Li((function(e,n){var r=Pp(e,t,"aria-descriptor");r.each((function(t){var n=Bu("aria");yu(t.element(),"id",n),yu(e.element(),"aria-describedby",n)}))}))]),zy(x.some(u))),l={repositionMenus:function(t){Ly.isOn(t)&&hD(t)}};return{uid:t.uid,dom:t.dom,components:e,apis:l,eventOrder:m(m({},t.eventOrder),{"alloy.execute":["disabling","toggling","alloy.base.behaviour"]}),events:s,behaviours:Gg(t.splitDropdownBehaviours,[rD.config({others:{sandbox:function(e){var n=Mp(e,t,"arrow"),r={onOpen:function(){Ly.on(n),Ly.on(e)},onClose:function(){Ly.off(n),Ly.off(e)}};return pD(t,e,r)}}}),Qb.config({mode:"special",onSpace:c,onEnter:c,onDown:a}),yy.config({}),Ly.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},RH=th({name:"SplitDropdown",configFields:TH(),partFields:AH(),factory:_H,apis:{repositionMenus:function(t,e){return t.repositionMenus(e)}}}),BH=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)}}},IH=function(t){return{setActive:function(e){Ly.set(t,e)},isActive:function(){return Ly.isOn(t)},isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)}}},NH=function(t,e){return t.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},PH=Bu("focus-button"),MH=["checklist","ordered-list"],FH=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],LH=function(t,e,n,r,o,i){var u,a=function(t){return fC.isRtl()&&z(MH,t)?t+"-rtl":t},c=fC.isRtl()&&t.exists((function(t){return z(FH,t)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(e.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:NH(n,i)},components:bS([t.map((function(t){return SI(a(t),i.icons)})),e.map((function(t){return OI(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[bo()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:dl([ly("common-button-display-events",[Di(bo(),(function(t,e){e.event().prevent(),ii(t,PH)}))])].concat(r.map((function(n){return OH.config({channel:n,initialData:{icon:t,text:e},renderComponents:function(t,e){return bS([t.icon.map((function(t){return SI(a(t),i.icons)})),t.text.map((function(t){return OI(t,"tox-tbtn",i)}))])}})})).toArray()).concat(o.getOr([])))}},HH=function(t,e,r){var o=Wn(n),i=LH(t.icon,t.text,t.tooltip,x.none(),x.none(),r);return Fw.sketch({dom:i.dom,components:i.components,eventOrder:DI,buttonBehaviours:dl([ly("toolbar-button-events",[EI({onAction:t.onAction,getApi:e.getApi}),mS(e,o),gS(e,o)]),fS.toolbarButton(t.disabled)].concat(e.toolbarButtonBehaviours))})},zH=function(t,e){return jH(t,e,[])},jH=function(t,e,n){return HH(t,{toolbarButtonBehaviours:[].concat(n.length>0?[ly("toolbarButtonWith",n)]:[]),getApi:BH,onSetup:t.onSetup},e)},VH=function(t,e){return UH(t,e,[])},UH=function(t,e,n){return Ot(HH(t,{toolbarButtonBehaviours:[cy.config({}),Ly.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(n.length>0?[ly("toolbarToggleButtonWith",n)]:[]),getApi:IH,onSetup:t.onSetup},e))},WH=function(t,e,n){return function(r){return AE.nu((function(t){return e.fetch(t)})).map((function(o){return x.from(DO(Ot(oO(Bu("menu-value"),o,(function(n){e.onItemAction(t(r),n)}),e.columns,e.presets,pS.CLOSE_ON_EXECUTE,e.select.getOr((function(){return!1})),n),{movement:uO(e.columns,e.presets),menuBehaviours:Yx.unnamedEvents("auto"!==e.columns?[]:[Li((function(t,n){qx(t,4,OC(e.presets)).each((function(e){var n=e.numRows,r=e.numColumns;Qb.setGridSize(t,n,r)}))}))])})))}))}},GH=function(t,e){var r,o=Bu("channel-update-split-dropdown-display"),i=function(t){return{isDisabled:function(){return uS.isDisabled(t)},setDisabled:function(e){return uS.set(t,e)},setIconFill:function(e,n){Gc(t.element(),'svg path[id="'+e+'"], rect[id="'+e+'"]').each((function(t){yu(t,"fill",n)}))},setIconStroke:function(e,n){Gc(t.element(),'svg path[id="'+e+'"], rect[id="'+e+'"]').each((function(t){yu(t,"stroke",n)}))},setActive:function(e){yu(t.element(),"aria-pressed",e),Gc(t.element(),"span").each((function(n){t.getSystem().getByDom(n).each((function(t){return Ly.set(t,e)}))}))},isActive:function(){return Gc(t.element(),"span").exists((function(e){return t.getSystem().getByDom(e).exists(Ly.isOn)}))}}},u=Wn(n),a={getApi:i,onSetup:t.onSetup};return RH.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:Tt({"aria-pressed":!1},NH(t.tooltip,e.providers))},onExecute:function(e){t.onAction(i(e))},onItemExecute:function(t,e,n){},splitDropdownBehaviours:dl([fS.splitButton(!1),ly("split-dropdown-events",[Di(PH,yy.focus),mS(a,u),gS(a,u)]),OD.config({})]),eventOrder:(r={},r[Yo()]=["alloy.base.behaviour","split-dropdown-events"],r),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:WH(i,t,e.providers),parts:{menu:Qk(!1,t.columns,t.presets)},components:[RH.parts().button(LH(t.icon,t.text,x.none(),x.some(o),x.some([Ly.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),RH.parts().arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:zw("chevron-down",e.providers.icons)}}),RH.parts()["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})},qH=function(t){return{hide:function(){return ii(t,Vo())},getValue:function(){return Vg.getValue(t)}}},XH=function(t,e){return Di(TI,(function(n,r){var o=t.get(n),i=qH(o);e.onAction(i,r.event().buttonApi())}))},$H=function(t,e,n){var r=e.original,o=(r.primary,g(r,["primary"])),i=Ze(ZL(m(m({},o),{type:"button",onAction:function(){}})));return jH(i,n.backstage.shared.providers,[XH(t,e)])},YH=function(t,e,n){var r=e.original,o=(r.primary,g(r,["primary"])),i=Ze(aH(m(m({},o),{type:"togglebutton",onAction:function(){}})));return UH(i,n.backstage.shared.providers,[XH(t,e)])},KH=function(t,e,n){var r={backstage:{shared:{providers:n}}};return"contextformtogglebutton"===e.type?YH(t,e,r):$H(t,e,r)},JH=function(t,e,n){var r=W(e,(function(e){return Lw(KH(t,e,n))})),o=function(){return W(r,(function(t){return t.asSpec()}))},i=function(t){return Zc(e,(function(e,n){return e.primary?x.from(r[n]).bind((function(e){return e.getOpt(t)})).filter(c(uS.isDisabled)):x.none()}))};return{asSpecs:o,findPrimary:i}},QH=function(t,e,n){var r=e.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=Lw(vE.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:e.initValue(),inputAttributes:r,selectOnFocus:!0,inputBehaviours:dl([Qb.config({mode:"special",onEnter:function(t){return i.findPrimary(t).map((function(t){return ai(t),!0}))},onLeft:function(t,e){return e.cut(),x.none()},onRight:function(t,e){return e.cut(),x.none()}})])})),i=JH(o,e.commands,n.shared.providers);return KL({type:t,uid:Bu("context-toolbar"),initGroups:[{title:x.none(),items:[o.asSpec()]},{title:x.none(),items:i.asSpecs()}],onEscape:x.none,cyclicKeying:!0,backstage:n,getSink:function(){return O.error("")}})},ZH={renderContextForm:QH},tz=function(t,e){var n=Math.max(e.x(),t.x()),r=t.right()-n,o=e.width()-(n-e.x()),i=Math.min(r,o);return{x:n,width:i}},ez=function(t,e,n){var r=tz(e,n),o=r.x,i=r.width,u=Kn.fromDom(t.getContainer()),a=Gc(u,".tox-editor-header").getOr(u),c=zc(u),s=zc(a),l=Math.max(n.y(),e.y(),s.bottom()),f=c.bottom()-l,d=n.height()-(l-n.y()),m=Math.min(f,d);return Hc(o,l,i,m)},nz=function(t,e,n){var r=tz(e,n),o=r.x,i=r.width,u=Kn.fromDom(t.getContainer()),a=Gc(u,".tox-editor-header").getOr(u),c=zc(a),s=n.height(),l=n.y();if(c.y()>=e.bottom()){var f=Math.min(s+l,c.y()),d=f-l;return Hc(o,l,i,d)}var m=Math.max(l,c.bottom());d=s-(m-l);return Hc(o,m,i,d)},rz=function(t,e,n){var r=tz(e,n),o=r.x,i=r.width;return Hc(o,n.y(),i,n.height())},oz=function(t){var n=IT(t)||NT(t)||MT(t),r=_c(e.window),o=zc(Kn.fromDom(t.getContentAreaContainer()));return t.inline&&!n?rz(t,o,r):t.inline?nz(t,o,r):ez(t,o,r)},iz=function(t,e,n){var r=t.dom(),o=B(n)?n:i(!1);while(r.parentNode){r=r.parentNode;var u=Kn.fromDom(r),a=e(u);if(a.isSome())return a;if(o(u))break}return x.none()},uz=function(t,e){return Zc(e,(function(e){return e.predicate(t.dom())?x.some({toolbarApi:e,elem:t}):x.none()}))},az=function(t,e){var n=function(t){return t.dom()===e.getBody()},r=Kn.fromDom(e.selection.getNode());return uz(r,t.inNodeScope).orThunk((function(){return uz(r,t.inEditorScope).orThunk((function(){return iz(r,(function(e){return uz(e,t.inNodeScope)}),n)}))}))},cz={lookup:az},sz=function(t,e){var n={},r=[],o=[],i={},u={},a=function(t,a){var c=Ze(vH(a));n[t]=c,c.launch.map((function(n){i["form:"+t]=m(m({},a.launch),{type:"contextformtogglebutton"===n.type?"togglebutton":"button",onAction:function(){e(c)}})})),"editor"===c.scope?o.push(c):r.push(c),u[t]=c},c=function(t,e){hH(e).each((function(n){"editor"===e.scope?o.push(n):r.push(n),u[t]=n}))},s=st(t);return G(s,(function(e){var n=t[e];"contextform"===n.type?a(e,n):"contexttoolbar"===n.type&&c(e,n)})),{forms:n,inNodeScope:r,inEditorScope:o,lookupTable:u,formNavigators:i}},lz={categorise:sz},fz=Bu("forward-slide"),dz=Bu("backward-slide"),mz=Bu("change-slide-event"),gz="tox-pop--resizing",pz=function(t){var e=Wn([]);return kw.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){e.set([]),kw.getContent(t).each((function(t){Xa(t.element(),"visibility")})),Ia(t.element(),gz),Xa(t.element(),"width")},inlineBehaviours:dl([ly("context-toolbar-events",[Fi(_o(),(function(t,e){kw.getContent(t).each((function(t){})),Ia(t.element(),gz),Xa(t.element(),"width")})),Di(mz,(function(t,e){Xa(t.element(),"width");var n=Oc(t.element());kw.setContent(t,e.event().contents()),Ra(t.element(),gz);var r=Oc(t.element());za(t.element(),"width",n+"px"),kw.getContent(t).each((function(n){e.event().focus().bind((function(e){return Ol(e),Al(t.element())})).orThunk((function(){return Qb.focusIn(n),Dl()}))})),qw.setTimeout((function(){za(t.element(),"width",r+"px")}),0)})),Di(fz,(function(t,n){kw.getContent(t).each((function(t){e.set(e.get().concat([{bar:t,focus:Dl()}]))})),ui(t,mz,{contents:n.event().forwardContents(),focus:x.none()})})),Di(dz,(function(t,n){at(e.get()).each((function(n){e.set(e.get().slice(0,e.get().length-1)),ui(t,mz,{contents:lc(n.bar),focus:n.focus})}))}))]),Qb.config({mode:"special",onEscape:function(n){return at(e.get()).fold((function(){return t.onEscape()}),(function(t){return ii(n,dz),x.some(!0)}))}})]),lazySink:function(){return O.value(t.sink)}})},hz=function(t,e){return function(n){var r=Wn(x.none()),o=function(){n.setActive(t.formatter.match(e));var o=t.formatter.formatChanged(e,n.setActive).unbind;r.set(x.some(o))};return t.initialized?o():t.on("init",o),function(){return r.get().each((function(t){return t()}))}}},vz=function(t){return function(e){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,e.format)}))}}},bz=function(t,e,n){var r=function(t,r,i,u){var a=e.shared.providers.translate(t.title);if("separator"===t.type)return x.some({type:"separator",text:a});if("submenu"===t.type){var c=tt(t.getStyleItems(),(function(t){return o(t,r,u)}));return 0===r&&c.length<=0?x.none():x.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return tt(t.getStyleItems(),(function(t){return o(t,r,u)}))}})}return x.some(m({type:"togglemenuitem",text:a,active:t.isSelected(u),disabled:i,onAction:n.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},o=function(t,e,o){var i="formatter"===t.type&&n.isInvalid(t);return 0===e?i?[]:r(t,e,!1,o).toArray():r(t,e,i,o).toArray()},i=function(t){var e=n.getCurrentValue(),r=n.shouldHide?0:1;return tt(t,(function(t){return o(t,r,e)}))},u=function(t,e){return function(n){var r=e(),o=i(r),u=jI(o,pS.CLOSE_ON_EXECUTE,t,!1);n(u)}};return{validateItems:i,getFetch:u}},yz=function(t,e,n){var r=n.dataset,o="basic"===r.type?function(){return W(r.data,(function(t){return TM(t,n.isSelectedFor,n.getPreviewFor)}))}:r.getData;return{items:bz(t,e,n),getStyleItems:o}},wz=function(t,e,r){var o=yz(t,e,r),i=o.items,u=o.getStyleItems,a=function(t){return{getComponent:function(){return t}}},c=function(e){return r.setInitialValue.each((function(t){return t(e.getComponent())})),r.nodeChangeHandler.map((function(n){var r=n(e.getComponent());return t.on("NodeChange",r),function(){t.off("NodeChange",r)}})).getOr(n)};return RI({text:r.icon.isSome()?x.none():x.some(""),icon:r.icon,tooltip:x.from(r.tooltip),role:x.none(),fetch:i.getFetch(e,u),onSetup:c,getApi:a,columns:1,presets:"normal",classes:r.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)},xz=function(t){return W(t,(function(t){var e=t,n=t,r=t.split("=");return r.length>1&&(e=r[0],n=r[1]),{title:e,format:n}}))},Cz=function(t){return{type:"basic",data:t}};(function(t){t[t["SemiColon"]=0]="SemiColon",t[t["Space"]=1]="Space"})(qN||(qN={}));var Sz,kz=function(t,e){return e===qN.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")},Oz=function(t,e,n,r){var o=qt(t.settings,e).getOr(n),i=xz(kz(o,r));return{type:"basic",data:i}},Tz=[{title:"Left",icon:"align-left",format:"alignleft"},{title:"Center",icon:"align-center",format:"aligncenter"},{title:"Right",icon:"align-right",format:"alignright"},{title:"Justify",icon:"align-justify",format:"alignjustify"}],Ez=function(t){var e=function(){return J(Tz,(function(e){return t.formatter.match(e.format)}))},n=function(e){return function(){return t.formatter.match(e)}},r=function(t){return function(){return x.none()}},o=function(t){var n=e(),r=n.fold((function(){return"left"}),(function(t){return t.title.toLowerCase()}));ui(t,_I,{icon:"align-"+r})},u=x.some((function(t){return function(){return o(t)}})),a=x.some((function(t){return o(t)})),c=Cz(Tz);return{tooltip:"Align",icon:x.some("align-left"),isSelectedFor:n,getCurrentValue:i(x.none()),getPreviewFor:r,onAction:vz(t),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(e){return!t.formatter.canApply(e.format)}}},Dz=function(t,e){return wz(t,e,Ez(t))},Az=function(t,e){var n=yz(t,e,Ez(t));t.ui.registry.addNestedMenuItem("align",{text:e.shared.providers.translate("Align"),getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},_z="Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",Rz=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],Bz=function(t){var e=t.split(/\s*,\s*/);return W(e,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},Iz=function(t){var e=function(){var e=Bz(t.toLowerCase());return et(Rz,(function(t){return e.indexOf(t.toLowerCase())>-1}))};return 0===t.indexOf("-apple-system")&&e()},Nz=function(t){var e=function(){var e=function(t){return t?Bz(t)[0]:""},n=t.queryCommandValue("FontName"),r=s.data,o=n?n.toLowerCase():"",i=J(r,(function(t){var n=t.format;return n.toLowerCase()===o||e(n).toLowerCase()===e(o).toLowerCase()})).orThunk((function(){return Iz(o)?x.from({title:"System Font",format:o}):x.none()}));return{matchOpt:i,font:n}},n=function(t){return function(e){return e.exists((function(e){return e.format===t}))}},r=function(){var t=e().matchOpt;return t},o=function(t){return function(){return x.some({tag:"div",styleAttr:-1===t.indexOf("dings")?"font-family:"+t:""})}},i=function(e){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,e.format)}))}},u=function(t){var n=e(),r=n.matchOpt,o=n.font,i=r.fold((function(){return o}),(function(t){return t.title}));ui(t,AI,{text:i})},a=x.some((function(t){return function(){return u(t)}})),c=x.some((function(t){return u(t)})),s=Oz(t,"font_formats",_z,qN.SemiColon);return{tooltip:"Fonts",icon:x.none(),isSelectedFor:n,getCurrentValue:r,getPreviewFor:o,onAction:i,setInitialValue:c,nodeChangeHandler:a,dataset:s,shouldHide:!1,isInvalid:function(){return!1}}},Pz=function(t,e){return wz(t,e,Nz(t))},Mz=function(t,e){var n=yz(t,e,Nz(t));t.ui.registry.addNestedMenuItem("fontformats",{text:e.shared.providers.translate("Fonts"),getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},Fz="8pt 10pt 12pt 14pt 18pt 24pt 36pt",Lz={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},Hz=function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},zz=function(t,e){return/[0-9.]+px$/.test(t)?Hz(72*parseInt(t,10)/96,e||0)+"pt":t},jz=function(t){return vt(Lz,t).getOr("")},Vz=function(t){var e=function(){var e=x.none(),n=l.data,r=t.queryCommandValue("FontSize");if(r)for(var o=function(t){var o=zz(r,t),i=jz(o);e=J(n,(function(t){return t.format===r||t.format===o||t.format===i}))},i=3;e.isNone()&&i>=0;i--)o(i);return{matchOpt:e,px:r}},n=function(t){return function(e){return e.exists((function(e){return e.format===t}))}},r=function(){var t=e().matchOpt;return t},o=i(i(x.none())),u=function(e){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,e.format)}))}},a=function(t){var n=e(),r=n.matchOpt,o=n.px,i=r.fold((function(){return o}),(function(t){return t.title}));ui(t,AI,{text:i})},c=x.some((function(t){return function(){return a(t)}})),s=x.some((function(t){return a(t)})),l=Oz(t,"fontsize_formats",Fz,qN.Space);return{tooltip:"Font sizes",icon:x.none(),isSelectedFor:n,getPreviewFor:o,getCurrentValue:r,onAction:u,setInitialValue:s,nodeChangeHandler:c,dataset:l,shouldHide:!1,isInvalid:function(){return!1}}},Uz=function(t,e){return wz(t,e,Vz(t))},Wz=function(t,e){var n=yz(t,e,Vz(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},Gz=function(t,e,n){var r=e();return Zc(n,(function(e){return J(r,(function(n){return t.formatter.matchNode(e,n.format)}))})).orThunk((function(){return t.formatter.match("p")?x.some({title:"Paragraph",format:"p"}):x.none()}))},qz=function(t){var e=t.selection.getStart(!0)||t.getBody();return t.dom.getParents(e,(function(){return!0}),t.getBody())},Xz="Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",$z=function(t){var e=function(e){return Gz(t,(function(){return c.data}),e)},n=function(e){return function(){return t.formatter.match(e)}},r=function(e){return function(){var n=t.formatter.get(e);return x.some({tag:n.length>0&&(n[0].inline||n[0].block)||"div",styleAttr:t.formatter.getCssText(e)})}},o=function(t,n){var r=e(t),o=r.fold((function(){return"Paragraph"}),(function(t){return t.title}));ui(n,AI,{text:o})},u=x.some((function(t){return function(e){return o(e.parents,t)}})),a=x.some((function(e){var n=qz(t);o(n,e)})),c=Oz(t,"block_formats",Xz,qN.SemiColon);return{tooltip:"Blocks",icon:x.none(),isSelectedFor:n,getCurrentValue:i(x.none()),getPreviewFor:r,onAction:vz(t),setInitialValue:a,nodeChangeHandler:u,dataset:c,shouldHide:!1,isInvalid:function(e){return!t.formatter.canApply(e.format)}}},Yz=function(t,e){return wz(t,e,$z(t))},Kz=function(t,e){var n=yz(t,e,$z(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return n.items.validateItems(n.getStyleItems())}})},Jz=function(t,e){var n=function(e){return function(){return t.formatter.match(e)}},r=function(e){return function(){var n=t.formatter.get(e);return void 0!==n?x.some({tag:n.length>0&&(n[0].inline||n[0].block)||"div",styleAttr:t.formatter.getCssText(e)}):x.none()}},o=function(e,n){var r=function(t){var e=t.items;return void 0!==e&&e.length>0?tt(e,r):[{title:t.title,format:t.format}]},o=tt(OM(t),r),i=Gz(t,(function(){return o}),e),u=i.fold((function(){return"Paragraph"}),(function(t){return t.title}));ui(n,AI,{text:u})},u=x.some((function(t){return function(e){return o(e.parents,t)}})),a=x.some((function(e){var n=qz(t);o(n,e)}));return{tooltip:"Formats",icon:x.none(),isSelectedFor:n,getCurrentValue:i(x.none()),getPreviewFor:r,onAction:vz(t),setInitialValue:a,nodeChangeHandler:u,shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(e){return!t.formatter.canApply(e.format)},dataset:e}},Qz=function(t,e){var n=m({type:"advanced"},e.styleselect);return wz(t,e,Jz(t,n))},Zz=function(t,e){var n=m({type:"advanced"},e.styleselect),r=yz(t,e,Jz(t,n));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return r.items.validateItems(r.getStyleItems())}})},tj=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],ej=function(t,e){return function(n,r){var o=t(n).mapError((function(t){return en(t)})).getOrDie();return e(o,r)}},nj={button:ej(ZL,(function(t,e){return zH(t,e.backstage.shared.providers)})),togglebutton:ej(aH,(function(t,e){return VH(t,e.backstage.shared.providers)})),menubutton:ej(nH,(function(t,e){return UI(t,"tox-tbtn",e.backstage,x.none())})),splitbutton:ej(oH,(function(t,e){return GH(t,e.backstage.shared)})),styleSelectButton:function(t,e){return Qz(t,e.backstage)},fontsizeSelectButton:function(t,e){return Uz(t,e.backstage)},fontSelectButton:function(t,e){return Pz(t,e.backstage)},formatButton:function(t,e){return Yz(t,e.backstage)},alignMenuButton:function(t,e){return Dz(t,e.backstage)}},rj=function(t,n){return vt(nj,t.type).fold((function(){return e.console.error("skipping button defined by",t),x.none()}),(function(e){return x.some(e(t,n))}))},oj={styleselect:nj.styleSelectButton,fontsizeselect:nj.fontsizeSelectButton,fontselect:nj.fontSelectButton,formatselect:nj.formatButton,align:nj.alignMenuButton},ij=function(t){var e=W(tj,(function(e){var n=$(e.items,(function(e){return bt(t,e)||bt(oj,e)}));return{name:e.name,items:n}}));return $(e,(function(t){return t.items.length>0}))},uj=function(t){var e=t.split("|");return W(e,(function(t){return{items:t.trim().split(" ")}}))},aj=function(t){return N(t,(function(t){return bt(t,"name")&&bt(t,"items")}))},cj=function(t){var n=t.toolbar,r=t.buttons;return!1===n?[]:void 0===n||!0===n?ij(r):D(n)?uj(n):aj(n)?n:(e.console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},sj=function(t,e,n,r,o){return vt(e,n.toLowerCase()).orThunk((function(){return o.bind((function(t){return Zc(t,(function(t){return vt(e,t+n.toLowerCase())}))}))})).fold((function(){return vt(oj,n.toLowerCase()).map((function(e){return e(t,r)})).orThunk((function(){return x.none()}))}),(function(t){return rj(t,r)}))},lj=function(t,e,n,r){var o=cj(e),i=W(o,(function(o){var i=tt(o.items,(function(o){return 0===o.trim().length?[]:sj(t,e.buttons,o,n,r).toArray()}));return{title:x.from(t.translate(o.name)),items:i}}));return $(i,(function(t){return t.items.length>0}))},fj=12,dj={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},mj={maxHeightFunction:dm(),maxWidthFunction:nM()},gj={onLtr:function(){return[Js,Qs,Ys,Xs,Ks,$s,Nw,Pw,Bw,_w,Iw,Rw]},onRtl:function(){return[Js,Qs,Ks,$s,Ys,Xs,Nw,Pw,Iw,Rw,Bw,_w]}},pj={onLtr:function(){return[Qs,Xs,$s,Ys,Ks,Js,Nw,Pw,Bw,_w,Iw,Rw]},onRtl:function(){return[Qs,$s,Xs,Ks,Ys,Js,Nw,Pw,Iw,Rw,Bw,_w]}},hj=function(t,e){return"line"===t?{bubble:Bl(fj,0,dj),layouts:{onLtr:function(){return[Zs]},onRtl:function(){return[tl]}},overrides:mj}:{bubble:Bl(0,fj,dj),layouts:e?pj:gj,overrides:mj}},vj=function(t,e,n,r){var o=qr().deviceType.isTouch,i=sc(pz({sink:n,onEscape:function(){return t.focus(),x.some(!0)}})),u=function(){return oz(t)},a=function(t,e,n,r){return Math.max(t,n)<=Math.min(e,r)},c=function(){var e=m.get().map((function(t){return t.getBoundingClientRect()})).getOrThunk((function(){return t.selection.getRng().getBoundingClientRect()})),n=t.inline?Dc().top():jc(Kn.fromDom(t.getBody())).y();return{y:e.top+n,bottom:e.bottom+n}},s=function(){if(o()&&r.backstage.isContextMenuOpen())return!0;var t=c(),e=u();return!a(t.y,t.bottom,e.y(),e.bottom())},l=function(){kw.hide(i)},f=function(){d.get().each((function(t){var e=i.element();Xa(e,"display"),s()?za(e,"display","none"):Tm.positionWithinBounds(n,t,i,x.some(u()))}))},d=Wn(x.none()),m=Wn(x.none()),g=Wn(null),p=function(e){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[e],behaviours:dl([Qb.config({mode:"acyclic"}),ly("pop-dialog-wrap-events",[Li((function(e){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Qb.focusIn(e)}))})),Hi((function(e){t.shortcuts.remove("ctrl+F9")}))])])}},h=Et((function(){return lz.categorise(e,(function(t){var e=v(t);ui(i,fz,{forwardContents:p(e)})}))})),v=function(e){var n=t.ui.registry.getAll().buttons,o=FT(t)===hT.scrolling?hT.scrolling:hT.default,i=h();return"contexttoolbar"===e.type?function(){var u=Tt(n,i.formNavigators),a=lj(t,{buttons:u,toolbar:e.items},r,x.some(["form:"]));return KL({type:o,uid:Bu("context-toolbar"),initGroups:a,onEscape:x.none,cyclicKeying:!0,backstage:r.backstage,getSink:function(){return O.error("")}})}():function(){return ZH.renderContextForm(o,e,r.backstage)}()};t.on(wF,(function(e){var n=h();qt(n.lookupTable,e.toolbarKey).each((function(n){y(n,e.target===t?x.none():x.some(e)),kw.getContent(i).each(Qb.focusIn)}))}));var b=function(t,e){var n="node"===t?r.backstage.shared.anchors.node(e):r.backstage.shared.anchors.cursor();return Ot(n,hj(t,o()))},y=function(t,e){if(C(),!o()||!r.backstage.isContextMenuOpen()){var n=v(t),a=e.map(Kn.fromDom),c=b(t.position,a);d.set(x.some(c)),m.set(e);var l=i.element();Xa(l,"display"),kw.showWithinBounds(i,c,p(n),(function(){return x.some(u())})),s()&&za(l,"display","none")}},w=function(){var e=h();cz.lookup(e,t).fold((function(){d.set(x.none()),kw.hide(i)}),(function(t){y(t.toolbarApi,x.some(t.elem.dom()))}))},C=function(){var t=g.get();null!==t&&(qw.clearTimeout(t),g.set(null))},S=function(t){C(),g.set(t)};t.on("init",(function(){t.on(xF,l),t.on("ScrollContent ScrollWindow longpress",f),t.on("click keyup SetContent ObjectResized ResizeEditor",(function(e){S(qw.setEditorTimeout(t,w,0))})),t.on("focusout",(function(e){qw.setEditorTimeout(t,(function(){Al(n.element()).isNone()&&Al(i.element()).isNone()&&(d.set(x.none()),kw.hide(i))}),0)})),t.on("SwitchMode",(function(){t.readonly&&(d.set(x.none()),kw.hide(i))})),t.on("NodeChange",(function(e){Al(i.element()).fold((function(){S(qw.setEditorTimeout(t,w,0))}),(function(t){}))}))}))},bj={register:vj},yj=function(t,n,r){var o=function(t,e){G([n,r],(function(n){n.broadcastEvent(t,e)}))},i=function(t,e){G([n,r],(function(n){n.broadcastOn([t],e)}))},u=function(t){return i(ag(),{target:t.target()})},a=zO(Kn.fromDom(e.document),"touchstart",u),c=zO(Kn.fromDom(e.document),"touchmove",(function(t){return o(Go(),t)})),s=zO(Kn.fromDom(e.document),"touchend",(function(t){return o(qo(),t)})),l=zO(Kn.fromDom(e.document),"mousedown",u),f=zO(Kn.fromDom(e.document),"mouseup",(function(t){0===t.raw().button&&i(sg(),{target:t.target()})})),d=function(t){return i(ag(),{target:Kn.fromDom(t.target)})},m=function(t){0===t.button&&i(sg(),{target:Kn.fromDom(t.target)})},g=function(t){return o(Xo(),VO(t))},p=function(t){i(cg(),{}),o($o(),VO(t))},h=function(){return i(cg(),{})};t.on("PostRender",(function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("ScrollWindow",g),t.on("ResizeWindow",p),t.on("ResizeEditor",h)})),t.on("remove",(function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("ScrollWindow",g),t.off("ResizeWindow",p),t.off("ResizeEditor",h),l.unbind(),a.unbind(),c.unbind(),s.unbind(),f.unbind()})),t.on("detach",(function(){zm(n),zm(r),n.destroy(),r.destroy()}))},wj={setup:yj},xj=Up,Cj=Op,Sj=i([In("shell",!1),gn("makeItem"),In("setupItem",n),qg.field("listBehaviours",[cy])]),kj=function(t){return{behaviours:dl([cy.config({})])}},Oj=Cp({name:"items",overrides:kj}),Tj=i([Oj]),Ej=i("CustomList"),Dj=function(t,n,r,o){var i=function(n,r){a(n).fold((function(){throw e.console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(e){var o=cy.contents(e),i=r.length,u=i-o.length,a=u>0?V(u,(function(){return t.makeItem()})):[],c=o.slice(i);G(c,(function(t){return cy.remove(e,t)})),G(a,(function(t){return cy.append(e,t)}));var s=cy.contents(e);G(s,(function(e,o){t.setupItem(n,e,r[o],o)}))}))},u=t.shell?{behaviours:[cy.config({})],components:[]}:{behaviours:[],components:n},a=function(e){return t.shell?x.some(e):Pp(e,t,"items")};return{uid:t.uid,dom:t.dom,components:u.components,behaviours:Gg(t.listBehaviours,u.behaviours),apis:{setItems:i}}},Aj=th({name:Ej(),configFields:Sj(),partFields:Tj(),factory:Dj,apis:{setItems:function(t,e,n){t.setItems(e,n)}}}),_j=function(t){var e=Ga(t,"position").is("fixed"),n=e?x.none():Zi(t);return n.orThunk((function(){var e=Kn.fromTag("span");iu(t,e);var n=Zi(e);return mu(e),n})).map(xc).getOrThunk((function(){return bc(0,0)}))},Rj=wt.generate([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),Bj=function(t){return function(e){return e.translate(-t.left(),-t.top())}},Ij=function(t){return function(e){return e.translate(t.left(),t.top())}},Nj=function(t){return function(e,n){return K(t,(function(t,e){return e(t)}),bc(e,n))}},Pj=function(t,e,n){return t.fold(Nj([Ij(n),Bj(e)]),Nj([Bj(e)]),Nj([]))},Mj=function(t,e,n){return t.fold(Nj([Ij(n)]),Nj([]),Nj([Ij(e)]))},Fj=function(t,e,n){return t.fold(Nj([]),Nj([Bj(n)]),Nj([Ij(e),Bj(n)]))},Lj=function(t,e,n,r,o,i){var u=Mj(t,o,i),a=Mj(e,o,i);return Math.abs(u.left()-a.left())<=n&&Math.abs(u.top()-a.top())<=r},Hj=function(t,e,n,r,o,i){var u=Mj(t,o,i),a=Mj(e,o,i),c=Math.abs(u.left()-a.left()),s=Math.abs(u.top()-a.top());return bc(c,s)},zj=function(t,e,n){return t.fold((function(t,e){return{position:"absolute",left:t+"px",top:e+"px"}}),(function(t,e){return{position:"absolute",left:t-n.left()+"px",top:e-n.top()+"px"}}),(function(t,e){return{position:"fixed",left:t+"px",top:e+"px"}}))},jj=function(t,e,n){return t.fold((function(t,r){return Rj.offset(t+e,r+n)}),(function(t,r){return Rj.absolute(t+e,r+n)}),(function(t,r){return Rj.fixed(t+e,r+n)}))},Vj=function(t,e,n,r){var o=function(t,o){return function(i,u){var a=t(e,n,r);return o(i.getOr(a.left()),u.getOr(a.top()))}};return t.fold(o(Fj,Rj.offset),o(Mj,Rj.absolute),o(Pj,Rj.fixed))},Uj=Rj.offset,Wj=Rj.absolute,Gj=Rj.fixed,qj=wt.generate([{static:[]},{absolute:["x","y"]},{fixed:["x","y"]}]),Xj=function(t,e){var n=t.element();Ra(n,e.transitionClass),Ia(n,e.fadeOutClass),Ra(n,e.fadeInClass),e.onShow(t)},$j=function(t,e){var n=t.element();Ra(n,e.transitionClass),Ia(n,e.fadeInClass),Ra(n,e.fadeOutClass),e.onHide(t)},Yj=function(t,e){return t.y()<e.bottom()&&t.bottom()>e.y()},Kj=function(t,e){return t.y()>=e.y()},Jj=function(t,e){return t.bottom()<=e.bottom()},Qj=function(t,e,n){return et(t,(function(t){switch(t){case"bottom":return Jj(e,n);case"top":return Kj(e,n)}}))},Zj=function(t,e){return Cu(t,e)?x.some(parseInt(xu(t,e),10)):x.none()},tV=function(t,e){return Zj(t,e.leftAttr).bind((function(n){return Zj(t,e.topAttr).map((function(e){var r=Oc(t),o=gc(t);return Hc(n,e,r,o)}))}))},eV=function(t,e,n,r,o){yu(t,e.leftAttr,n),yu(t,e.topAttr,r),yu(t,e.positionAttr,o)},nV=function(t,e){Su(t,e.leftAttr),Su(t,e.topAttr),Su(t,e.positionAttr)},rV=function(t,e,n){var r=xu(t,e.positionAttr);switch(nV(t,e),r){case"static":return x.some(qj.static());case"absolute":return x.some(qj.absolute(n.x(),n.y()));default:return x.none()}},oV=function(t,e,n){return tV(t,e).filter((function(t){return Qj(e.modes,t,n)})).bind((function(n){return rV(t,e,n)}))},iV=function(t,e,n,r,o){var i=zc(t);if(Qj(e.modes,i,n))return x.none();var u=o(),a=Ua(t,"position");eV(t,e,i.x(),i.y(),a);var c=Wj(i.x(),i.y()),s=Pj(c,r,u),l=Wj(n.x(),n.y()),f=Pj(l,r,u),d=i.y()<=n.y()?f.top():f.top()+n.height()-i.height();return x.some(qj.fixed(s.left(),d))},uV=function(t,e,n,r,o){var i=t.element(),u=Ga(i,"position").is("fixed");return u?oV(i,e,n):iV(i,e,n,r,o)},aV=function(t,e){var n=t.element();return tV(n,e).bind((function(t){return rV(n,e,t)}))},cV=function(t,e){G(["left","top","position"],(function(e){return Xa(t.element(),e)})),e.onUndocked(t)},sV=function(t,e,n,r,o){var i=zj(o,n,r);ja(t.element(),i);var u="fixed"===i.position?e.onDocked:e.onUndocked;u(t)},lV=function(t,e,n,r,o){void 0===o&&(o=!1),e.contextual.each((function(e){e.lazyContext(t).each((function(i){var u=Yj(i,r);if(u!==n.isVisible())if(n.setVisible(u),o&&!u)Pa(t.element(),[e.fadeOutClass]),e.onHide(t);else{var a=u?Xj:$j;a(t,e)}}))}))},fV=function(t,e,n){var r=e.lazyViewport(t),o=t.element(),i=Yi(o),u=Dc(i),a=Et((function(){return _j(o)})),c=n.isDocked();c&&lV(t,e,n,r),uV(t,e,r,u,a).each((function(o){n.setDocked(!c),o.fold((function(){return cV(t,e)}),(function(n,r){return sV(t,e,u,a(),Wj(n,r))}),(function(o,i){lV(t,e,n,r,!0),sV(t,e,u,a(),Gj(o,i))}))}))},dV=function(t,e,r){var o=t.element();r.setDocked(!1),aV(t,e).each((function(r){r.fold((function(){return cV(t,e)}),(function(n,r){var i=Yi(o),u=Dc(i),a=_j(o);sV(t,e,u,a,Wj(n,r))}),n)})),r.setVisible(!0),e.contextual.each((function(e){Ma(o,[e.fadeInClass,e.fadeOutClass,e.transitionClass]),e.onShow(t)})),mV(t,e,r)},mV=function(t,e,n){t.getSystem().isConnected()&&fV(t,e,n)},gV=function(t,e,n){n.isDocked()&&dV(t,e,n)},pV=function(t,e,n){return n.isDocked()},hV=Object.freeze({refresh:mV,reset:gV,isDocked:pV}),vV=function(t,e){return ki([Fi(_o(),(function(n,r){t.contextual.each((function(t){if(Na(n.element(),t.transitionClass)){Ma(n.element(),[t.transitionClass,t.fadeInClass]);var o=e.isVisible()?t.onShown:t.onHidden;o(n)}r.stop()}))})),Di(Xo(),(function(n,r){mV(n,t,e)})),Di($o(),(function(n,r){gV(n,t,e)}))])},bV=Object.freeze({events:vV}),yV=[Rn("contextual",[vn("fadeInClass"),vn("fadeOutClass"),vn("transitionClass"),wn("lazyContext"),ys("onShow"),ys("onShown"),ys("onHide"),ys("onHidden")]),Hn("lazyViewport",Vc),vn("leftAttr"),vn("topAttr"),vn("positionAttr"),jn("modes",["top","bottom"],cn),ys("onDocked"),ys("onUndocked")],wV=function(){var t=Wn(!1),e=Wn(!0),n=function(){return"docked:  "+t.get()+", visible: "+e.get()};return Zu({isDocked:function(){return t.get()},setDocked:function(e){return t.set(e)},isVisible:function(){return e.get()},setVisible:function(t){return e.set(t)},readState:n})},xV=Object.freeze({init:wV}),CV=gl({fields:yV,name:"docking",active:bV,apis:hV,state:xV}),SV={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},kV="tox-tinymce--toolbar-sticky-on",OV="tox-tinymce--toolbar-sticky-off",TV=function(t){var e=t.element();Qi(e).each((function(n){if(CV.isDocked(t)){var r=Oc(n);za(e,"width",r+"px");var o=pc(e);za(n,"padding-top",o+"px")}else Xa(e,"width"),Xa(n,"padding-top")}))},EV=function(t,e){e?(Ia(t,SV.fadeOutClass),Pa(t,[SV.transitionClass,SV.fadeInClass])):(Ia(t,SV.fadeInClass),Pa(t,[SV.fadeOutClass,SV.transitionClass]))},DV=function(t,e){var n=Kn.fromDom(t.getContainer());e?(Ra(n,kV),Ia(n,OV)):(Ra(n,OV),Ia(n,kV))},AV=function(t,e){var n=Yi(e);Dl(n).filter((function(t){return!no(e,t)})).filter((function(e){return no(e,Kn.fromDom(n.dom().body))||uo(t,e)})).each((function(){return Ol(e)}))},_V=function(t,e){return Al(t).orThunk((function(){return e().toOption().bind((function(t){return Al(t.element())}))}))},RV=function(t,e){t.inline||(t.on("ResizeWindow ResizeEditor ResizeContent",(function(){e().each(TV)})),t.on("SkinLoaded",(function(){e().each(CV.reset)})),t.on("FullscreenStateChanged",(function(){e().each(CV.refresh)}))),t.on("PostRender",(function(){DV(t,!1)}))},BV=function(t){return t().map(CV.isDocked).getOr(!1)},IV=function(){var t;return[Cl.config({channels:(t={},t[ML()]={onReceive:TV},t)})]},NV=function(t,e){var n=Wn(x.none()),r=function(t){e().each((function(e){return t(e.element())}))},o=function(n){t.inline||TV(n),DV(t,CV.isDocked(n)),n.getSystem().broadcastOn([cg()],{}),e().each((function(t){return t.getSystem().broadcastOn([cg()],{})}))},i=t.inline?[]:IV();return p([yy.config({}),CV.config({leftAttr:"data-dock-left",topAttr:"data-dock-top",positionAttr:"data-dock-pos",contextual:m({lazyContext:function(e){var n=pc(e.element()),r=t.inline?t.getContentAreaContainer():t.getContainer(),o=zc(Kn.fromDom(r)),i=o.height()-n;return x.some(Hc(o.x(),o.y(),o.width(),i))},onShow:function(){r((function(t){return EV(t,!0)}))},onShown:function(t){r((function(t){return Ma(t,[SV.transitionClass,SV.fadeInClass])})),n.get().each((function(e){AV(t.element(),e),n.set(x.none())}))},onHide:function(t){n.set(_V(t.element(),e)),r((function(t){return EV(t,!1)}))},onHidden:function(){r((function(t){return Ma(t,[SV.transitionClass])}))}},SV),modes:["top"],onDocked:o,onUndocked:o})],i)},PV=Object.freeze({setup:RV,isDocked:BV,getBehaviours:NV}),MV=n,FV=l,LV=i([]),HV=Object.freeze({setup:MV,isDocked:FV,getBehaviours:LV}),zV=function(t){var e=t.editor,n=t.sticky?NV:LV;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:dl(n(e,t.getSink))}},jV=function(t,e){var n=function(t,n){var r=W(n,(function(t){var n={type:"menubutton",text:t.text,fetch:function(e){e(t.getItems())}},r=nH(n).mapError((function(t){return en(t)})).getOrDie();return UI(r,"tox-mbtn",e.backstage,x.some("menuitem"))}));cy.set(t,r)},r={focus:Qb.focusIn,setMenus:n};return{uid:t.uid,dom:t.dom,components:[],behaviours:dl([cy.config({}),ly("menubar-events",[Li((function(e){t.onSetup(e)})),Di(Co(),(function(t,e){Gc(t.element(),".tox-mbtn--active").each((function(n){qc(e.event().target(),".tox-mbtn").each((function(e){no(n,e)||t.getSystem().getByDom(n).each((function(n){t.getSystem().getByDom(e).each((function(t){xD.expand(t),xD.close(n),yy.focus(t)}))}))}))}))})),Di(Zo(),(function(t,e){e.event().prevFocus().bind((function(e){return t.getSystem().getByDom(e).toOption()})).each((function(n){e.event().newFocus().bind((function(e){return t.getSystem().getByDom(e).toOption()})).each((function(t){xD.isOpen(n)&&(xD.expand(t),xD.close(n))}))}))}))]),Qb.config({mode:"flow",selector:".tox-mbtn",onEscape:function(e){return t.onEscape(e),x.some(!0)}}),GE.config({})]),apis:r,domModification:{attributes:{role:"menubar"}}}},VV=Zp({factory:jV,name:"silver.Menubar",configFields:[gn("dom"),gn("uid"),gn("onEscape"),gn("backstage"),In("onSetup",n)],apis:{focus:function(t,e){t.focus(e)},setMenus:function(t,e,n){t.setMenus(e,n)}}}),UV="container",WV=[Ug("slotBehaviours",[])],GV=function(t){return"<alloy.field."+t+">"},qV=function(t){var e=function(){var t=[],e=function(e,n){return t.push(e),_p(UV,GV(e),n)};return{slot:e,record:function(){return t}}}(),n=t(e),r=e.record(),o=W(r,(function(t){return wp({name:t,pname:GV(t)})}));return Xp(UV,WV,o,XV,n)},XV=function(t,e,n){var r=function(e){return Hp(t)},o=function(e,n){return Pp(e,t,n)},i=function(e,n){return void 0===n&&(n=void 0),function(r,o){return Pp(r,t,o).map((function(t){return e(t,o)})).getOr(n)}},u=function(t){return function(e,n){G(n,(function(n){return t(e,n)}))}},a=function(t,e){return"true"!==xu(t.element(),"aria-hidden")},c=function(t,e){if(!a(t)){var n=t.element();Xa(n,"display"),Su(n,"aria-hidden"),ui(t,ti(),{name:e,visible:!0})}},s=function(t,e){if(a(t)){var n=t.element();za(n,"display","none"),yu(n,"aria-hidden","true"),ui(t,ti(),{name:e,visible:!1})}},l=i(a,!1),f=i(s),d=u(f),m=function(t){return d(t,r())},g=i(c),p={getSlotNames:r,getSlot:o,isShowing:l,hideSlot:f,hideAllSlots:m,showSlot:g};return{uid:t.uid,dom:t.dom,components:e,behaviours:Wg(t.slotBehaviours),apis:p}},$V=dt({getSlotNames:function(t,e){return t.getSlotNames(e)},getSlot:function(t,e,n){return t.getSlot(e,n)},isShowing:function(t,e,n){return t.isShowing(e,n)},hideSlot:function(t,e,n){return t.hideSlot(e,n)},hideAllSlots:function(t,e){return t.hideAllSlots(e)},showSlot:function(t,e,n){return t.showSlot(e,n)}},Ju),YV=m(m({},$V),{sketch:qV}),KV=Me([Dn("icon"),Dn("tooltip"),Hn("onShow",n),Hn("onHide",n),Hn("onSetup",(function(){return n}))]),JV=function(t){return Qe("sidebar",KV,t)},QV=function(t){var e=t.ui.registry.getAll().sidebars;G(st(e),(function(n){var r=e[n],o=function(){return x.from(t.queryCommandValue("ToggleSidebar")).is(n)};t.ui.registry.addToggleButton(n,{icon:r.icon,tooltip:r.tooltip,onAction:function(e){t.execCommand("ToggleSidebar",!1,n),e.setActive(o())},onSetup:function(e){var n=function(){return e.setActive(o())};return t.on("ToggleSidebar",n),function(){t.off("ToggleSidebar",n)}}})}))},ZV=function(t){return{element:function(){return t.element().dom()}}},tU=function(t,e){var r=W(st(e),(function(t){var n=e[t],r=Ze(JV(n));return{name:t,getApi:ZV,onSetup:r.onSetup,onShow:r.onShow,onHide:r.onHide}}));return W(r,(function(e){var o=Wn(n);return t.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Yx.unnamedEvents([mS(e,o),gS(e,o),Di(ti(),(function(t,e){var n=e.event(),o=J(r,(function(t){return t.name===n.name()}));o.each((function(e){var r=n.visible()?e.onShow:e.onHide;r(e.getApi(t))}))}))])})}))},eU=function(t){return YV.sketch((function(e){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:tU(e,t),slotBehaviours:Yx.unnamedEvents([Li((function(t){return YV.hideAllSlots(t)}))])}}))},nU=function(t,e){var n=ih.getCurrent(t);n.each((function(t){return cy.set(t,[eU(e)])}))},rU=function(t,e){var n=ih.getCurrent(t);n.each((function(t){var n=ih.getCurrent(t);n.each((function(n){DL.hasGrown(t)?YV.isShowing(n,e)?DL.shrink(t):(YV.hideAllSlots(n),YV.showSlot(n,e)):(YV.hideAllSlots(n),YV.showSlot(n,e),DL.grow(t))}))}))},oU=function(t){var e=ih.getCurrent(t);return e.bind((function(t){var e=DL.isGrowing(t)||DL.hasGrown(t);if(e){var n=ih.getCurrent(t);return n.bind((function(t){return J(YV.getSlotNames(t),(function(e){return YV.isShowing(t,e)}))}))}return x.none()}))},iU=Bu("FixSizeEvent"),uU=Bu("AutoSizeEvent"),aU=function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:dl([GE.config({}),yy.config({}),DL.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){var e=ih.getCurrent(t);e.each(YV.hideAllSlots),ii(t,uU)},onGrown:function(t){ii(t,uU)},onStartGrow:function(t){ui(t,iU,{width:Ga(t.element(),"width").getOr("")})},onStartShrink:function(t){ui(t,iU,{width:Oc(t.element())+"px"})}}),cy.config({}),ih.config({find:function(t){var e=cy.contents(t);return ut(e)}})])}],behaviours:dl([HR.childAt(0),ly("sidebar-sliding-events",[Di(iU,(function(t,e){za(t.element(),"width",e.event().width())})),Di(uU,(function(t,e){Xa(t.element(),"width")}))])])}},cU=function(t){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:lC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:dl([Qb.config({mode:"special",onTab:function(){return x.some(!0)},onShiftTab:function(){return x.some(!0)}}),yy.config({})])}},sU=function(t,e,n){var r=t.element();!0===e?(cy.set(t,[cU(n)]),Xa(r,"display"),Su(r,"aria-hidden")):(cy.set(t,[]),za(r,"display","none"),yu(r,"aria-hidden","true"))},lU=function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:dl([cy.config({})]),components:[]}},fU=function(t,e,n){var r=Wn(!1),o=Wn(x.none()),i=function(t){t!==r.get()&&(sU(e(),t,n.providers),r.set(t))};t.on("ProgressState",(function(e){if(o.get().each(qw.clearTimeout),I(e.time)){var n=qw.setEditorTimeout(t,(function(){return i(e.state)}),e.time);o.set(x.some(n))}else i(e.state),o.set(x.none())}))},dU=function(t,e,n){var r={getSocket:function(e){return xj.getPart(e,t,"socket")},setSidebar:function(e,n){xj.getPart(e,t,"sidebar").each((function(t){return nU(t,n)}))},toggleSidebar:function(e,n){xj.getPart(e,t,"sidebar").each((function(t){return rU(t,n)}))},whichSidebar:function(e){return xj.getPart(e,t,"sidebar").bind(oU).getOrNull()},getHeader:function(e){return xj.getPart(e,t,"header")},getToolbar:function(e){return xj.getPart(e,t,"toolbar")},setToolbar:function(e,n){xj.getPart(e,t,"toolbar").each((function(t){t.getApis().setGroups(t,n)}))},setToolbars:function(e,n){xj.getPart(e,t,"multiple-toolbar").each((function(t){Aj.setItems(t,n)}))},refreshToolbar:function(e){var n=xj.getPart(e,t,"toolbar");n.each((function(t){return t.getApis().refresh(t)}))},getMoreButton:function(e){var n=xj.getPart(e,t,"toolbar");return n.bind((function(t){return t.getApis().getMoreButton(t)}))},getThrobber:function(e){return xj.getPart(e,t,"throbber")},focusToolbar:function(e){var n=xj.getPart(e,t,"toolbar").orThunk((function(){return xj.getPart(e,t,"multiple-toolbar")}));n.each((function(t){Qb.focusIn(t)}))},setMenubar:function(e,n){xj.getPart(e,t,"menubar").each((function(t){VV.setMenus(t,n)}))},focusMenubar:function(e){xj.getPart(e,t,"menubar").each((function(t){VV.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:e,apis:r,behaviours:t.behaviours}},mU=Cj.optional({factory:VV,name:"menubar",schema:[gn("backstage")]}),gU=function(t){return t.split===hT.sliding?YL:t.split===hT.floating?$L:KL},pU=Cj.optional({factory:{sketch:function(t){return Aj.sketch({uid:t.uid,dom:t.dom,listBehaviours:dl([Qb.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return KL({type:t.split,uid:Bu("multiple-toolbar-item"),backstage:t.backstage,cyclicKeying:!1,getSink:t.getSink,initGroups:[],onEscape:function(){return x.none()}})},setupItem:function(t,e,n,r){TF.setGroups(e,n)},shell:!0})}},name:"multiple-toolbar",schema:[gn("dom"),gn("onEscape")]}),hU=Cj.optional({factory:{sketch:function(t){var e=gU(t),n={type:t.split,uid:t.uid,onEscape:function(){return t.onEscape(),x.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,backstage:t.backstage,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader}};return e(n)}},name:"toolbar",schema:[gn("dom"),gn("onEscape"),gn("getSink")]}),vU=Cj.optional({factory:{sketch:zV},name:"header",schema:[gn("dom")]}),bU=Cj.optional({name:"socket",schema:[gn("dom")]}),yU=Cj.optional({factory:{sketch:aU},name:"sidebar",schema:[gn("dom")]}),wU=Cj.optional({factory:{sketch:lU},name:"throbber",schema:[gn("dom")]}),xU=th({name:"OuterContainer",factory:dU,configFields:[gn("dom"),gn("behaviours")],partFields:[vU,mU,hU,pU,bU,yU,wU],apis:{getSocket:function(t,e){return t.getSocket(e)},setSidebar:function(t,e,n){t.setSidebar(e,n)},toggleSidebar:function(t,e,n){t.toggleSidebar(e,n)},whichSidebar:function(t,e){return t.whichSidebar(e)},getHeader:function(t,e){return t.getHeader(e)},getToolbar:function(t,e){return t.getToolbar(e)},setToolbar:function(t,e,n){var r=W(n,(function(t){return GL(t)}));t.setToolbar(e,r)},setToolbars:function(t,e,n){var r=W(n,(function(t){return W(t,GL)}));t.setToolbars(e,r)},getMoreButton:function(t,e){return t.getMoreButton(e)},refreshToolbar:function(t,e){return t.refreshToolbar(e)},getThrobber:function(t,e){return t.getThrobber(e)},setMenubar:function(t,e,n){t.setMenubar(e,n)},focusMenubar:function(t,e){t.focusMenubar(e)},focusToolbar:function(t,e){t.focusToolbar(e)}}}),CU="file edit view insert format tools table help",SU={file:{title:"File",items:"newdocument restoredraft | preview | print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},kU=function(t,e,n){var r=BT(n).split(/[ ,]/);return{text:t.title,getItems:function(){return tt(t.items,(function(t){var n=t.toLowerCase();return 0===n.trim().length||j(r,(function(t){return t===n}))?[]:"separator"===n||"|"===n?[{type:"separator"}]:e.menuItems[n]?[e.menuItems[n]]:[]}))}}},OU=function(t){return"string"===typeof t?t.split(" "):t},TU=function(t,e){var n=Tt(SU,e.menus),r=st(e.menus).length>0,o=void 0===e.menubar||!0===e.menubar?OU(CU):OU(!1===e.menubar?"":e.menubar),i=$(o,(function(t){return r&&e.menus.hasOwnProperty(t)&&e.menus[t].hasOwnProperty("items")||SU.hasOwnProperty(t)})),u=W(i,(function(r){var o=n[r];return kU({title:o.title,items:OU(o.items)},e,t)}));return $(u,(function(t){var e=function(t){return"separator"!==t.type};return t.getItems().length>0&&j(t.getItems(),e)}))},EU=function(t){var e=function(){t._skinLoaded=!0,kk.fireSkinLoaded(t)};return function(){t.initialized?e():t.on("init",e)}},DU={fireSkinLoaded:EU},AU=function(t,e){var n,r=xT(e);r&&(n=r+"/skin.min.css",e.contentCSS.push(r+(t?"/content.inline":"/content")+".min.css")),!1===ST(e)&&n?xS.DOM.styleSheetLoader.load(n,DU.fireSkinLoaded(e)):DU.fireSkinLoaded(e)()},_U=a(AU,!1),RU=a(AU,!0),BU=function(t,e,n,r){var o=e.outerContainer,i=n.toolbar,u=n.buttons;if(N(i,D)){var a=i.map((function(e){var n={toolbar:e,buttons:u};return lj(t,n,{backstage:r},x.none())}));xU.setToolbars(o,a)}else xU.setToolbar(o,lj(t,n,{backstage:r},x.none()))},IU=xS.DOM,NU=qr(),PU=NU.os.isiOS()&&NU.os.version.major<=12,MU=function(t){var e=t.getWin(),n=t.getDoc().documentElement,r=Wn(bc(e.innerWidth,e.innerHeight)),o=Wn(bc(n.offsetWidth,n.offsetHeight)),i=function(n){var i=t.getDoc().documentElement,u=r.get(),a=o.get();u.left()!==e.innerWidth||u.top()!==e.innerHeight?(r.set(bc(e.innerWidth,e.innerHeight)),kk.fireResizeContent(t,n)):a.left()===i.offsetWidth&&a.top()===i.offsetHeight||(o.set(bc(i.offsetWidth,i.offsetHeight)),kk.fireResizeContent(t,n))},u=function(e){return kk.fireScrollContent(t,e)};IU.bind(e,"resize",i),IU.bind(e,"scroll",u);var a=jO(Kn.fromDom(t.getBody()),"load",i);t.on("remove",(function(){a.unbind(),IU.unbind(e,"resize",i),IU.unbind(e,"scroll",u)}))},FU=function(t,e,n,r,o){var i=Wn(0);_U(t),Lm(Kn.fromDom(o.targetNode),e.mothership),Fm(bi(),e.uiMothership),t.on("PostRender",(function(){BU(t,e,n,r),i.set(t.getWin().innerWidth),xU.setMenubar(e.outerContainer,TU(t,n)),xU.setSidebar(e.outerContainer,n.sidebar),MU(t)}));var u=xU.getSocket(e.outerContainer).getOrDie("Could not find expected socket element");if(!0===PU){ja(u.element(),{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var a=Yw((function(){t.fire("ScrollContent")}),20);zO(u.element(),"scroll",a.throttle)}VL(t,e),t.addCommand("ToggleSidebar",(function(n,r){xU.toggleSidebar(e.outerContainer,r),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return xU.whichSidebar(e.outerContainer)}));var c=FT(t),s=function(){xU.refreshToolbar(e.outerContainer)};return c!==hT.sliding&&c!==hT.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=t.getWin().innerWidth;e!==i.get()&&(s(),i.set(e))})),{iframeContainer:u.element().dom(),editorContainer:e.outerContainer.element().dom()}},LU={render:FU},HU=function(t){var e=/^[0-9\.]+(|px)$/i;return e.test(""+t)?x.some(parseInt(""+t,10)):x.none()},zU=function(t){return I(t)?t+"px":t},jU=function(t,e,n){var r=e.filter((function(e){return t<e})),o=n.filter((function(e){return t>e}));return r.or(o).getOr(t)},VU={calcCappedSize:jU,parseToInt:HU,numToPx:zU},UU=function(t){var e=kT(t),n=ET(t),r=AT(t);return VU.parseToInt(e).map((function(t){return VU.calcCappedSize(t,n,r)}))},WU=function(t){var e=UU(t);return e.getOr(kT(t))},GU=function(t){var e=OT(t),n=TT(t),r=DT(t);return VU.parseToInt(e).map((function(t){return VU.calcCappedSize(t,n,r)}))},qU=function(t){var e=GU(t);return e.getOr(OT(t))},XU=function(t,e,n,r,o){var i,u=xS.DOM,a=zT(t),c=UT(t),s=Kn.fromDom(o.targetNode),l=DT(t).or(GU(t)),f=FT(t),d=f===hT.sliding||f===hT.floating;RU(t);var m=function(t){var n=d?t.fold((function(){return 0}),(function(t){return t.components().length>1?gc(t.components()[1].element()):0})):0,r=xc(s),o=r.top()-gc(i.element())+n;ja(e.outerContainer.element(),{position:"absolute",top:Math.round(o)+"px",left:Math.round(r.left())+"px"});var u=l.getOrThunk((function(){var t=VU.parseToInt(Ua(bi(),"margin-left")).getOr(0);return Oc(bi())-r.left()+t}));za(i.element(),"max-width",u+"px")},g=function(t){if(void 0===t&&(t=!1),d&&xU.refreshToolbar(e.outerContainer),!a){var n=xU.getToolbar(e.outerContainer);m(n)}c&&(t?CV.reset(i):CV.refresh(i))},p=function(){za(e.outerContainer.element(),"display","flex"),u.addClass(t.getBody(),"mce-edit-focus"),Xa(e.uiMothership.element(),"display"),g()},h=function(){e.outerContainer&&(za(e.outerContainer.element(),"display","none"),u.removeClass(t.getBody(),"mce-edit-focus")),za(e.uiMothership.element(),"display","none")},v=function(){if(i)p();else{i=xU.getHeader(e.outerContainer).getOrDie();var o=jT(t);Fm(o,e.mothership),Fm(o,e.uiMothership),BU(t,e,n,r),xU.setMenubar(e.outerContainer,TU(t,n)),p(),t.on("activate",p),t.on("deactivate",h),t.on("NodeChange SkinLoaded ResizeWindow",(function(){t.hidden||g(!0)})),t.nodeChanged()}};return t.on("focus",v),t.on("blur hide",h),t.on("init",(function(){t.hasFocus()&&v()})),VL(t,e),{editorContainer:e.outerContainer.element().dom()}},$U={render:XU},YU=function(t){var e=[{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}];BN.each(e,(function(e){t.ui.registry.addToggleButton(e.name,{tooltip:e.text,onAction:function(){return t.execCommand(e.cmd)},icon:e.icon,onSetup:hz(t,e.name)})}));var n={name:"alignnone",text:"No alignment",cmd:"JustifyNone",icon:"align-none"};t.ui.registry.addButton(n.name,{tooltip:n.text,onAction:function(){return t.execCommand(n.cmd)},icon:n.icon})},KU={register:YU},JU=function(t,e){return function(){t.execCommand("mceToggleFormat",!1,e)}},QU=function(t){BN.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(e,n){t.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onSetup:hz(t,e.name),onAction:JU(t,e.name)})}));for(var e=1;e<=6;e++){var n="h"+e;t.ui.registry.addToggleButton(n,{text:n.toUpperCase(),tooltip:"Heading "+e,onSetup:hz(t,n),onAction:JU(t,n)})}},ZU=function(t){BN.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(e){t.ui.registry.addButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return t.execCommand(e.action)}})}))},tW=function(t){BN.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(e){t.ui.registry.addToggleButton(e.name,{tooltip:e.text,icon:e.icon,onAction:function(){return t.execCommand(e.action)},onSetup:hz(t,e.name)})}))},eW=function(t){QU(t),ZU(t),tW(t)},nW=function(t){BN.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(e){t.ui.registry.addMenuItem(e.name,{text:e.text,icon:e.icon,shortcut:e.shortcut,onAction:function(){return t.execCommand(e.action)}})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:JU(t,"code")})},rW=function(t){eW(t),nW(t)},oW={register:rW},iW=function(t,e,n){var r=function(){return!!e.undoManager&&e.undoManager[n]()},o=function(){t.setDisabled(e.readonly||!r())};return t.setDisabled(!r()),e.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o),function(){return e.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",o)}},uW=function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(e){return iW(e,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(e){return iW(e,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})},aW=function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(e){return iW(e,t,"hasUndo")},onAction:function(){return t.execCommand("undo")}}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(e){return iW(e,t,"hasRedo")},onAction:function(){return t.execCommand("redo")}})},cW=function(t){uW(t),aW(t)},sW={register:cW},lW=function(t,e){t.setActive(e.hasVisual);var n=function(e){t.setActive(e.hasVisual)};return e.on("VisualAid",n),function(){return e.off("VisualAid",n)}},fW=function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(e){return lW(e,t)},onAction:function(){t.execCommand("mceToggleVisualAid")}})},dW=function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return t.execCommand("mceToggleVisualAid")}})},mW=function(t){dW(t),fW(t)},gW={register:mW},pW=function(t,e){t.setDisabled(!e.queryCommandState("outdent"));var n=function(){t.setDisabled(!e.queryCommandState("outdent"))};return e.on("NodeChange",n),function(){return e.off("NodeChange",n)}},hW=function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(e){return pW(e,t)},onAction:function(){return t.execCommand("outdent")}}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return t.execCommand("indent")}})},vW=function(t){hW(t)},bW={register:vW},yW=function(t,e){Az(t,e),Mz(t,e),Zz(t,e),Kz(t,e),Wz(t,e)},wW={register:yW},xW=function(t,e){KU.register(t),oW.register(t),wW.register(t,e),sW.register(t),zk.register(t),gW.register(t),bW.register(t)},CW={setup:xW},SW=function(t,e){return{anchor:"makeshift",x:t,y:e}},kW=function(t,e,n){return SW(t.x+e,t.y+n)},OW=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},TW=function(t){if(OW(t)){var e=t.touches[0];return SW(e.pageX,e.pageY)}return SW(t.pageX,t.pageY)},EW=function(t){if(OW(t)){var e=t.touches[0];return SW(e.clientX,e.clientY)}return SW(t.clientX,t.clientY)},DW=function(t,e){var n=xS.DOM.getPos(t);return kW(e,n.x,n.y)},AW=function(t,e){return"contextmenu"===e.type?t.inline?TW(e):DW(t.getContentAreaContainer(),EW(e)):_W(t)},_W=function(t){return{anchor:"selection",root:Kn.fromDom(t.selection.getNode())}},RW=function(t){return{anchor:"node",node:x.some(Kn.fromDom(t.selection.getNode())),root:Kn.fromDom(t.getBody())}},BW=function(t,e,n){return n?RW(t):AW(t,e)},IW=function(t,e,n,r,o,i){var u=n(),a=BW(t,e,i);jI(u,pS.CLOSE_ON_EXECUTE,r,!1).map((function(t){e.preventDefault(),kw.showMenuAt(o,a,{menu:{markers:Yk("normal")},data:t})}))},NW={onLtr:function(){return[Qs,Xs,$s,Ys,Ks,Js,Nw,Pw,Bw,_w,Iw,Rw]},onRtl:function(){return[Qs,$s,Xs,Ks,Ys,Js,Nw,Pw,Iw,Rw,Bw,_w]}},PW=12,MW={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},FW=function(t,e){var n=t.selection;if(n.isCollapsed()||e.touches.length<1)return!1;var r=e.touches[0],o=n.getRng(),i=gd(t.getWin(),yf.domRange(o));return i.exists((function(t){return t.left()<=r.clientX&&t.right()>=r.clientX&&t.top()<=r.clientY&&t.bottom()>=r.clientY}))},LW=function(t,e){var n=e?RW(t):_W(t);return m({bubble:Bl(0,PW,MW),layouts:NW,overrides:{maxWidthFunction:nM(),maxHeightFunction:dm()}},n)},HW=function(t){var e=t.selection.getRng(),n=function(){qw.setEditorTimeout(t,(function(){t.selection.setRng(e)}),10),i()};t.once("touchend",n);var r=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",r,!0);var o=function(){return i()};t.once("longpresscancel",o);var i=function(){t.off("touchend",n),t.off("longpresscancel",o),t.off("mousedown",r)}},zW=function(t,e,n,r,o,i){var u=LW(t,i);jI(n,pS.CLOSE_ON_EXECUTE,r,!0).map((function(n){e.preventDefault(),kw.showMenuWithinBounds(o,u,{menu:{markers:Yk("normal")},data:n,type:"horizontal"},(function(){return x.some(oz(t))})),t.fire(xF)}))},jW=function(t,e,n,r,o,i){var u=qr(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),l=function(){var u=n();zW(t,e,u,r,o,i)};if(!c&&!a||i)s&&!i&&t.selection.setCursorLocation(e.target,0),l();else{var f=function(){HW(t),l()};FW(t,e)?f():(t.once("selectionchange",f),t.once("touchend",(function(){return t.off("selectionchange",f)})))}},VW=function(t){return"string"===typeof t?t.split(/[ ,]/):t},UW=function(t){return t.settings.contextmenu_never_use_native||!1},WW=function(t,e,n){var r=t.ui.registry.getAll().contextMenus;return vt(t.settings,e).map(VW).getOrThunk((function(){return $(VW(n),(function(t){return bt(r,t)}))}))},GW=function(t){return!1===t.getParam("contextmenu")},qW=function(t){return WW(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},XW={shouldNeverUseNative:UW,getContextMenu:qW,isContextMenuDisabled:GW},$W=function(t){return D(t)?"|"===t:"separator"===t.type},YW={type:"separator"},KW=function(t){if(D(t))return t;switch(t.type){case"separator":return YW;case"submenu":return{type:"nestedmenuitem",text:t.text,icon:t.icon,getSubmenuItems:function(){var e=t.getSubmenuItems();return D(e)?e:W(e,KW)}};default:return{type:"menuitem",text:t.text,icon:t.icon,onAction:r(t.onAction)}}},JW=function(t,e){if(0===e.length)return t;var n=at(t).filter((function(t){return!$W(t)})),r=n.fold((function(){return[]}),(function(t){return[YW]}));return t.concat(r).concat(e).concat([YW])},QW=function(t,e,n){var r=K(e,(function(e,r){if(bt(t,r)){var o=t[r].update(n);if(D(o))return JW(e,o.split(" "));if(o.length>0){var i=W(o,KW);return JW(e,i)}return e}return e.concat([r])}),[]);return r.length>0&&$W(r[r.length-1])&&r.pop(),r},ZW=function(t,e){return e.ctrlKey&&!XW.shouldNeverUseNative(t)},tG=function(t,e,n){var r=qr(),o=r.deviceType.isTouch,i=sc(kw.sketch({dom:{tag:"div"},lazySink:e,onEscape:function(){return t.focus()},onShow:function(){return n.setContextMenuState(!0)},onHide:function(){return n.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:dl([ly("dismissContextMenu",[Di(Jo(),(function(e,n){ug.close(e),t.focus()}))])])})),u=function(t){return kw.hide(i)},a=function(e){var r="longpress"===e.type;if(XW.shouldNeverUseNative(t)&&e.preventDefault(),!ZW(t,e)&&!XW.isContextMenuDisabled(t)){var u=!r&&(2!==e.button||e.target===t.getBody()),a=function(){var n=u?t.selection.getStart(!0):e.target,r=t.ui.registry.getAll(),o=XW.getContextMenu(t);return QW(r.contextMenus,o,n)},c=o()?jW:IW;c(t,e,a,n,i,u)}};t.on("init",(function(){var e="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(e,u),t.on(o()?"longpress":"longpress contextmenu",a)}))},eG="data-initial-z-index",nG=function(t){Qi(t.element()).filter(pi).each((function(t){var e=xu(t,eG);Cu(t,eG)?za(t,"z-index",e):Xa(t,"z-index"),Su(t,eG)}))},rG=function(t){Qi(t.element()).filter(pi).each((function(e){Ga(e,"z-index").each((function(t){yu(e,eG,t)})),za(e,"z-index",Ua(t.element(),"z-index"))}))},oG=function(t,e){t.getSystem().addToGui(e),rG(e)},iG=function(t){nG(t),t.getSystem().removeFromGui(t)},uG=function(t,e,n){return t.getSystem().build(bT.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[e]},events:n}))},aG=function(t,e){var n=t.element(),r=parseInt(xu(n,e.leftAttr),10),o=parseInt(xu(n,e.topAttr),10);return isNaN(r)||isNaN(o)?x.none():x.some(bc(r,o))},cG=function(t,e,n){var r=t.element();yu(r,e.leftAttr,n.left()+"px"),yu(r,e.topAttr,n.top()+"px")},sG=function(t,e){var n=t.element();Su(n,e.leftAttr),Su(n,e.topAttr)},lG=function(t,e,n,r){return aG(t,e).fold((function(){return n}),(function(t){return Gj(t.left()+r.left(),t.top()+r.top())}))},fG=function(t,e,n,r,o,i){var u=lG(t,e,n,r),a=e.mustSnap?gG(t,e,u,o,i):pG(t,e,u,o,i),c=Pj(u,o,i);return cG(t,e,c),a.fold((function(){return{coord:Gj(c.left(),c.top()),extra:x.none()}}),(function(t){return{coord:t.output(),extra:t.extra()}}))},dG=function(t,e){sG(t,e)},mG=function(t,e,n,r){return Zc(t,(function(t){var o=t.sensor(),u=Lj(e,o,t.range().left(),t.range().top(),n,r);return u?x.some({output:i(Vj(t.output(),e,n,r)),extra:t.extra}):x.none()}))},gG=function(t,e,n,r,o){var u=e.getSnapPoints(t),a=mG(u,n,r,o);return a.orThunk((function(){var t=K(u,(function(t,e){var i=e.sensor(),u=Hj(n,i,e.range().left(),e.range().top(),r,o);return t.deltas.fold((function(){return{deltas:x.some(u),snap:x.some(e)}}),(function(n){var r=(u.left()+u.top())/2,o=(n.left()+n.top())/2;return r<=o?{deltas:x.some(u),snap:x.some(e)}:t}))}),{deltas:x.none(),snap:x.none()});return t.snap.map((function(t){return{output:i(Vj(t.output(),n,r,o)),extra:t.extra}}))}))},pG=function(t,e,n,r,o){var i=e.getSnapPoints(t);return mG(i,n,r,o)},hG=function(t,e,n){return{coord:Vj(t.output(),t.output(),e,n),extra:t.extra()}},vG=function(t){return es(Ga(t,"left"),Ga(t,"top"),Ga(t,"position"),(function(t,e,n){var r="fixed"===n?Gj:Uj;return r(parseInt(t,10),parseInt(e,10))})).getOrThunk((function(){var e=xc(t);return Wj(e.left(),e.top())}))},bG=function(t,e,n,r,o){var i=o.bounds,u=Mj(e,n,r),a=Zd(u.left(),i.x(),i.x()+i.width()-o.width),c=Zd(u.top(),i.y(),i.y()+i.height()-o.height),s=Wj(a,c);return e.fold((function(){var t=Fj(s,n,r);return Uj(t.left(),t.top())}),(function(){return s}),(function(){var t=Pj(s,n,r);return Gj(t.left(),t.top())}))},yG=function(t,e,n,r,o,i,u){var a=e.fold((function(){var t=jj(n,i.left(),i.top()),e=Pj(t,r,o);return Gj(e.left(),e.top())}),(function(e){var u=fG(t,e,n,i,r,o);return u.extra.each((function(n){e.onSensor(t,n)})),u.coord}));return bG(t,a,r,o,u)},wG=function(t,e,n,r){var o=e.getTarget(t.element());if(e.repositionTarget){var i=Yi(t.element()),u=Dc(i),a=_j(o),c=vG(o),s=yG(t,e.snaps,c,u,a,r,n),l=zj(s,u,a);ja(o,l)}e.onDrag(t,o,r)},xG=function(t,e){return{bounds:t.getBounds(),height:pc(e.element()),width:Tc(e.element())}},CG=function(t,e,n,r,o){var i=n.update(r,o),u=n.getStartData().getOrThunk((function(){return xG(e,t)}));i.each((function(n){wG(t,e,u,n)}))},SG=function(t,e,n,r){e.each(iG),n.snaps.each((function(e){dG(t,e)}));var o=n.getTarget(t.element());r.reset(),n.onDrop(t,o)},kG=Rn("snaps",[gn("getSnapPoints"),ys("onSensor"),gn("leftAttr"),gn("topAttr"),In("lazyViewport",Vc),In("mustSnap",!1)]),OG=function(t){return ki([Di(bo(),t.forceDrop),Di(xo(),t.drop),Di(yo(),(function(e,n){t.move(n.event())})),Di(wo(),t.delayDrop)])},TG=function(t){return x.from(bc(t.x(),t.y()))},EG=function(t,e){return bc(e.left()-t.left(),e.top()-t.top())},DG=Object.freeze({getData:TG,getDelta:EG}),AG=function(t,e){var n=function(n){e.setStartData(xG(t,n))};return ki([Di(Xo(),(function(t){e.getStartData().each((function(){return n(t)}))})),Di(bo(),(function(r,o){var i=o.event().raw();if(0===i.button){o.stop();var u=function(){return SG(r,x.some(s),t,e)},a=WO(u,200),c={drop:u,delayDrop:a.schedule,forceDrop:u,move:function(n){a.cancel(),CG(r,t,e,DG,n)}},s=uG(r,t.blockerClass,OG(c)),l=function(){n(r),oG(r,s)};l()}}))])},_G=[In("useFixed",l),gn("blockerClass"),In("getTarget",u),In("onDrag",n),In("repositionTarget",!0),ys("onDrop"),Hn("getBounds",Vc),kG,Ss("dragger",{handlers:AG})],RG=function(t){return ki([Di(go(),t.forceDrop),Di(ho(),t.drop),Di(vo(),t.drop),Di(po(),(function(e,n){t.move(n.event())}))])},BG=function(t){var e=t[0];return x.some(bc(e.clientX,e.clientY))},IG=function(t){var e=t.raw(),n=e.touches;return 1===n.length?BG(n):x.none()},NG=function(t,e){return bc(e.left()-t.left(),e.top()-t.top())},PG=Object.freeze({getData:IG,getDelta:NG}),MG=function(t,e){var n=Wn(x.none()),r=function(n){e.setStartData(xG(t,n))};return ki([Di(Xo(),(function(t){e.getStartData().each((function(){return r(t)}))})),Di(go(),(function(o,i){i.stop();var u=function(){SG(o,n.get(),t,e),n.set(x.none())},a={drop:u,delayDrop:function(){},forceDrop:u,move:function(n){CG(o,t,e,PG,n)}},c=uG(o,t.blockerClass,RG(a));n.set(x.some(c));var s=function(){r(o),oG(o,c)};s()})),Di(po(),(function(n,r){r.stop(),CG(n,t,e,PG,r.event())})),Di(ho(),(function(r){SG(r,n.get(),t,e),n.set(x.none())})),Di(vo(),(function(r){SG(r,n.get(),t,e),n.set(x.none())}))])},FG=[In("useFixed",l),gn("blockerClass"),In("getTarget",u),In("onDrag",n),In("repositionTarget",!0),In("onDrop",n),Hn("getBounds",Vc),kG,Ss("dragger",{handlers:MG})],LG=_G,HG=FG,zG=Object.freeze({mouse:LG,touch:HG}),jG=function(){var t=x.none(),e=x.none(),n=function(){t=x.none(),e=x.none()},r=function(e,n){var r=t.map((function(t){return e.getDelta(t,n)}));return t=x.some(n),r},o=function(t,e){return t.getData(e).bind((function(e){return r(t,e)}))},u=function(t){e=x.some(t)},a=function(){return e},c=i({});return Zu({readState:c,reset:n,update:o,getStartData:a,setStartData:u})},VG=Object.freeze({init:jG}),UG=function(t,e,n,r){var o=e.getTarget(t.element());if(e.repositionTarget){var i=Yi(t.element()),u=Dc(i),a=_j(o),c=hG(r,u,a),s=zj(c.coord,u,a);ja(o,s)}},WG=Object.freeze({snapTo:UG}),GG=hl({branchKey:"mode",branches:zG,name:"dragging",active:{events:function(t,e){var n=t.dragger;return n.handlers(t,e)}},extra:{snap:$i(["sensor","range","output"],["extra"])},state:VG,apis:WG}),qG=qr(),XG=40,$G=XG/2,YG=function(t,e,n,r,o,i){return t.fold((function(){return GG.snap({sensor:Wj(n-$G,r-$G),range:bc(o,i),output:Wj(x.some(n),x.some(r)),extra:{td:e}})}),(function(t){var o=n-$G,i=r-$G,u=XG,a=XG,c=t.element().dom().getBoundingClientRect();return GG.snap({sensor:Wj(o,i),range:bc(u,a),output:Wj(x.some(n-c.width/2),x.some(r-c.height/2)),extra:{td:e}})}))},KG=function(t,e,n){var r=function(t,e){return t.exists((function(t){return no(t,e)}))};return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var i=o.td;r(e.get(),i)||(e.set(x.some(i)),n(i))},mustSnap:!0}},JG=function(t){return Lw(Fw.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:dl([GG.config({mode:qG.deviceType.isTouch()?"touch":"mouse",blockerClass:"blocker",snaps:t}),OD.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},QG=function(t,e){var n=Wn([]),r=Wn([]),o=Wn(!1),i=Wn(x.none()),u=Wn(x.none()),a=function(t){var n=jc(t);return YG(m.getOpt(e),t,n.x(),n.y(),n.width(),n.height())},c=function(){return W(n.get(),(function(t){return a(t)}))},s=function(t){var n=jc(t);return YG(g.getOpt(e),t,n.right(),n.bottom(),n.width(),n.height())},l=function(){return W(r.get(),(function(t){return s(t)}))},f=KG(c,i,(function(e){u.get().each((function(n){t.fire("TableSelectorChange",{start:e,finish:n})}))})),d=KG(l,u,(function(e){i.get().each((function(n){t.fire("TableSelectorChange",{start:n,finish:e})}))})),m=JG(f),g=JG(d),p=sc(m.asSpec()),h=sc(g.asSpec()),v=function(e,n,r,o){var i=n.dom().getBoundingClientRect();Xa(e.element(),"display");var u=Ji(Kn.fromDom(t.getBody())).dom().innerHeight,a=r(i),c=o(i,u);(a||c)&&za(e.element(),"display","none")},b=function(t,e,n,r){var o=n(e);GG.snapTo(t,o);var i=function(t){return t[r]<0},u=function(t,e){return t[r]>e};v(t,e,i,u)},y=function(t){return b(p,t,a,"top")},w=function(){return i.get().each(y)},C=function(t){return b(h,t,s,"bottom")},S=function(){return u.get().each(C)};qG.deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){o.get()||(Bm(e,p),Bm(e,h),o.set(!0)),i.set(x.some(t.start)),u.set(x.some(t.finish)),t.otherCells.each((function(e){n.set(e.upOrLeftCells),r.set(e.downOrRightCells),y(t.start),C(t.finish)}))})),t.on("resize ScrollContent",(function(){w(),S()})),t.on("TableSelectionClear",(function(){o.get()&&(Pm(p),Pm(h),o.set(!1)),i.set(x.none()),u.set(x.none())})))},ZG={setup:QG};(function(t){t[t["None"]=0]="None",t[t["Both"]=1]="Both",t[t["Vertical"]=2]="Vertical"})(Sz||(Sz={}));var tq=function(t,e,n,r,o){var i={};return i.height=VU.calcCappedSize(r+e.top(),ET(t),AT(t)),n===Sz.Both&&(i.width=VU.calcCappedSize(o+e.left(),TT(t),DT(t))),i},eq=function(t,e,n){var r=Kn.fromDom(t.getContainer()),o=tq(t,e,n,gc(r),Oc(r));ft(o,(function(t,e){return za(r,e,VU.numToPx(t))})),kk.fireResizeEditor(t)},nq=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1},rq=function(t,e){e.delimiter||(e.delimiter="»");var n=function(n){var r=n||[],o=W(r,(function(e,n){return Fw.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":n,"tab-index":-1,"aria-level":n+1},innerHtml:e.name},action:function(n){t.focus(),t.selection.select(e.element),t.nodeChanged()}})})),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+e.delimiter+" "}};return K(o.slice(1),(function(t,e){var n=t;return n.push(i),n.push(e),n}),[o[0]])},r=function(e){var n=[],r=e.length;while(r-- >0){var o=e[r];if(1===o.nodeType&&!nq(o)){var i=t.fire("ResolveName",{name:o.nodeName.toLowerCase(),target:o});if(i.isDefaultPrevented()||n.push({name:i.name,element:o}),i.isPropagationStopped())break}}return n};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:dl([Qb.config({mode:"flow",selector:"div[role=button]"}),GE.config({}),cy.config({}),ly("elementPathEvents",[Li((function(e,o){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Qb.focusIn(e)})),t.on("NodeChange",(function(t){var o=r(t.parents);o.length>0&&cy.set(e,n(o))}))}))])]),components:[]}},oq={renderElementPath:rq},iq=function(t,e){var n,r=function(t,n,r){return cy.set(t,[uc(e.translate(["{0} "+r,n[r]]))])};return Fw.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:dl([GE.config({}),cy.config({}),Vg.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),ly("wordcount-events",[Di(zo(),(function(t){var e=Vg.getValue(t),n="words"===e.mode?"characters":"words";Vg.setValue(t,{mode:n,count:e.count}),r(t,e.count,n)})),Li((function(e){t.on("wordCountUpdate",(function(t){var n=Vg.getValue(e).mode;Vg.setValue(e,{mode:n,count:t.wordCount}),r(e,t.wordCount,n)}))}))])]),eventOrder:(n={},n[zo()]=["wordcount-events","alloy.base.behaviour"],n)})},uq=function(t,e){var n=function(n){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:e.translate("Resize")},innerHtml:zw("resize-handle",e.icons)},behaviours:dl([GG.config({mode:"mouse",repositionTarget:!1,onDrag:function(e,r,o){eq(t,o,n)},blockerClass:"tox-blocker"})])}},r=function(){var t=fC.translate(["Powered by {0}","Tiny"]),e='<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+t+'">'+t+"</a>";return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:e}}},o=function(t){var e=!Nr(t.settings.plugins,"autoresize"),n=t.getParam("resize",e);return!1===n?Sz.None:"both"===n?Sz.Both:Sz.Vertical},i=function(){var n=[];return t.getParam("elementpath",!0,"boolean")&&n.push(oq.renderElementPath(t,{})),Nr(t.settings.plugins,"wordcount")&&n.push(iq(t,e)),t.getParam("branding",!0,"boolean")&&n.push(r()),n.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:n}]:[]},u=function(){var e=i(),r=o(t);return r!==Sz.None&&e.push(n(r)),e};return{dom:{tag:"div",classes:["tox-statusbar"]},components:u()}},aq=function(t){var e=t.inline,n=e?$U:LU,r=UT(t)?PV:HV,o=x.none(),i=qr(),u=i.browser.isIE(),a=u?["tox-platform-ie"]:[],c=i.deviceType.isTouch(),s="tox-platform-touch",l=c?[s]:[],f=fC.isRtl()?{attributes:{dir:"rtl"}}:{},d=function(){return o.bind(xU.getHeader)},g=sc({dom:m({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(l)},f),behaviours:dl([Tm.config({useFixed:function(){return r.isDocked(d)}})])}),p=function(){return O.value(g)},h=Lw({dom:{tag:"div",classes:["tox-anchorbar"]}}),v=function(){return o.bind((function(t){return h.getOpt(t)})).getOrDie("Could not find a anchor bar element")},b=function(){return o.bind((function(t){return xU.getMoreButton(t)})).getOrDie("Could not find more button element")},y=function(){return o.bind((function(t){return xU.getToolbar(t)})).getOrDie("Could not find more toolbar element")},w=function(){return o.bind((function(t){return xU.getThrobber(t)})).getOrDie("Could not find throbber element")},C=yF(g,t,v,b),S=xU.parts().menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:C,onEscape:function(){t.focus()}}),k=FT(t),T=xU.parts().toolbar({dom:{tag:"div",classes:["tox-toolbar"]},getSink:p,backstage:C,onEscape:function(){t.focus()},split:k,lazyToolbar:y,lazyMoreButton:b,lazyHeader:function(){return d().getOrDie("Could not find header element")}}),E=xU.parts()["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},onEscape:function(){},split:k}),D=xU.parts().socket({dom:{tag:"div",classes:["tox-edit-area"]}}),A=xU.parts().sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),_=xU.parts().throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:C}),R=t.getParam("statusbar",!0,"boolean"),B=R&&!e?x.some(uq(t,C.shared.providers)):x.none(),I={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[D,A]},N=MT(t),P=NT(t),M=IT(t),F=function(){return N?[E]:P?[T]:[]},L=xU.parts().header({dom:{tag:"div",classes:["tox-editor-header"]},components:Z([M?[S]:[],F(),zT(t)?[]:[h.asSpec()]]),sticky:UT(t),editor:t,getSink:p}),H=Z([[L],e?[]:[I]]),z={dom:{tag:"div",classes:["tox-editor-container"]},components:H},j=Z([[z],e?[]:B.toArray(),[_]]),V=VT(t),U=m(m({role:"application"},fC.isRtl()?{dir:"rtl"}:{}),V?{"aria-hidden":"true"}:{}),W=sc(xU.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(l).concat(a),styles:m({visibility:"hidden"},V?{opacity:"0",border:"0"}:{}),attributes:U},components:j,behaviours:dl([Qb.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));o=x.some(W),t.shortcuts.add("alt+F9","focus menubar",(function(){xU.focusMenubar(W)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){xU.focusToolbar(W)}));var G=yT(W),q=yT(g);wj.setup(t,G,q),KT.setup(t);var X=function(){var t={broadcastAll:q.broadcast,broadcastOn:q.broadcastOn,register:function(){}};return{channels:t}},$=function(){var e=VU.numToPx(WU(t)),n=VU.numToPx(qU(t));return t.inline||(qa("div","width",n)&&za(W.element(),"width",n),qa("div","height",e)?za(W.element(),"height",e):za(W.element(),"height","200px")),e},Y=function(){r.setup(t,d),CW.setup(t,C),tG(t,p,C),QV(t),fU(t,w,C.shared);var e=t.ui.registry.getAll(),o=e.buttons,i=e.menuItems,u=e.contextToolbars,a=e.sidebars,c=PT(t),s={menuItems:i,menus:t.settings.menu?dt(t.settings.menu,(function(t){return Tt(t,{items:t.items})})):{},menubar:t.settings.menubar,toolbar:c.getOrThunk((function(){return t.getParam("toolbar",!0)})),buttons:o,sidebar:a};bj.register(t,u,g,{backstage:C}),ZG.setup(t,g);var l=t.getElement(),f=$(),m={mothership:G,uiMothership:q,outerContainer:W},h={targetNode:l,height:f};return n.render(t,m,s,C,h)};return{mothership:G,uiMothership:q,backstage:C,renderUI:Y,getUi:X}},cq={setup:aq},sq=function(t,e){var n=x.from(xu(t,"id")).fold((function(){var t=Bu("dialog-describe");return yu(e,"id",t),t}),u);yu(t,"aria-describedby",n)},lq={labelledBy:function(t,e){var n=x.from(xu(t,"id")).fold((function(){var t=Bu("dialog-label");return yu(e,"id",t),t}),u);yu(t,"aria-labelledby",n)}},fq=i([gn("lazySink"),On("dragBlockClass"),Hn("getBounds",Vc),In("useTabstopAt",i(!0)),In("eventOrder",{}),Ug("modalBehaviours",[Qb]),ws("onExecute"),Cs("onEscape")]),dq={sketch:u},mq=i([Cp({name:"draghandle",overrides:function(t,e){return{behaviours:dl([GG.config({mode:"mouse",getTarget:function(t){return Wc(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(e,null,2)).message),getBounds:t.getDragBounds})])}}}),wp({schema:[gn("dom")],name:"title"}),wp({factory:dq,schema:[gn("dom")],name:"close"}),wp({factory:dq,schema:[gn("dom")],name:"body"}),Cp({factory:dq,schema:[gn("dom")],name:"footer"}),xp({factory:{sketch:function(t,e){return m(m({},t),{dom:e.dom,components:e.components})}},schema:[In("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),In("components",[])],name:"blocker"})]),gq=function(t,e,n,r){var o=Bu("alloy.dialog.busy"),i=Bu("alloy.dialog.idle"),u=dl([Qb.config({mode:"special",onTab:function(){return x.some(!0)},onShiftTab:function(){return x.some(!0)}}),yy.config({})]),a=function(e){var n=t.lazySink(e).getOrDie(),a=Wn(x.none()),c=r.blocker(),s=n.getSystem().build(m(m({},c),{components:c.components.concat([lc(e)]),behaviours:dl([yy.config({}),ly("dialog-blocker-events",[Fi(So(),(function(){Qb.focusIn(e)})),Di(i,(function(t,n){Cu(e.element(),"aria-busy")&&(Su(e.element(),"aria-busy"),a.get().each((function(t){return cy.remove(e,t)})))})),Di(o,(function(t,n){yu(e.element(),"aria-busy","true");var r=n.event().getBusySpec();a.get().each((function(t){cy.remove(e,t)}));var o=r(e,u),i=t.getSystem().build(o);a.set(x.some(i)),cy.append(e,lc(i)),i.hasConfigured(Qb)&&Qb.focusIn(i)}))])])}));Bm(n,s),Qb.focusIn(e)},c=function(t){Qi(t.element()).each((function(e){t.getSystem().getByDom(e).each((function(t){Pm(t)}))}))},s=function(e){return Mp(e,t,"body")},l=function(e){return Mp(e,t,"footer")},f=function(t,e){ui(t,o,{getBusySpec:e})},d=function(t){ii(t,i)},g=Bu("modal-events"),p=m(m({},t.eventOrder),{"alloy.system.attached":[g].concat(t.eventOrder["alloy.system.attached"]||[])});return{uid:t.uid,dom:t.dom,components:e,apis:{show:a,hide:c,getBody:s,getFooter:l,setIdle:d,setBusy:f},eventOrder:p,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Gg(t.modalBehaviours,[cy.config({}),Qb.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),ly(g,[Li((function(e){lq.labelledBy(e.element(),Mp(e,t,"title").element()),sq(e.element(),Mp(e,t,"body").element())}))])])}},pq=th({name:"ModalDialog",configFields:fq(),partFields:mq(),factory:gq,apis:{show:function(t,e){t.show(e)},hide:function(t,e){t.hide(e)},getBody:function(t,e){return t.getBody(e)},getFooter:function(t,e){return t.getFooter(e)},setBusy:function(t,e,n){t.setBusy(e,n)},setIdle:function(t,e){t.setIdle(e)}}}),hq=[vn("type"),vn("text"),bn("level",["info","warn","error","success"]),vn("icon"),In("url","")],vq=Me(hq),bq=function(t){return[vn("type"),t]},yq=[vn("type"),vn("text"),Ln("disabled",!1),Ln("primary",!1),Ve("name","name",It((function(){return Bu("button-name")})),cn),Dn("icon"),Ln("borderless",!1)],wq=Me(yq),xq=[vn("type"),vn("name"),vn("label"),Ln("disabled",!1)],Cq=Me(xq),Sq=sn,kq=[vn("type"),vn("name")],Oq=kq.concat([Dn("label")]),Tq=Oq,Eq=Me(Tq),Dq=cn,Aq=Oq,_q=Me(Aq),Rq=cn,Bq=Oq,Iq=Me(Bq),Nq=Xe(),Pq=function(t){return[vn("type"),hn("columns"),t]},Mq=Oq.concat([Ln("sandboxed",!0)]),Fq=Me(Mq),Lq=cn,Hq=Oq.concat([Dn("inputMode"),Dn("placeholder"),Ln("maximized",!1),Ln("disabled",!1)]),zq=Me(Hq),jq=cn,Vq=Oq.concat([Sn("items",[vn("text"),vn("value")]),Pn("size",1),Ln("disabled",!1)]),Uq=Me(Vq),Wq=cn,Gq=Oq.concat([Ln("constrain",!0),Ln("disabled",!1)]),qq=Me(Gq),Xq=Me([vn("width"),vn("height")]),$q=Oq.concat([Dn("placeholder"),Ln("maximized",!1),Ln("disabled",!1)]),Yq=Me($q),Kq=cn,Jq=Oq.concat([Fn("filetype","file",["image","media","file"]),In("disabled",!1)]),Qq=Me(Jq),Zq=Me([vn("value"),In("meta",{})]),tX=kq.concat([Mn("tag","textarea"),vn("scriptId"),vn("scriptUrl"),zn("settings",void 0)]),eX=kq.concat([Mn("tag","textarea"),wn("init")]),nX=Ye((function(t){return Qe("customeditor.old",Pe(eX),t).orThunk((function(){return Qe("customeditor.new",Pe(tX),t)}))})),rX=cn,oX=[vn("type"),vn("html"),Fn("presets","presentation",["presentation","document"])],iX=Me(oX),uX=Oq.concat([pn("currentState",Me([gn("blob"),vn("url")]))]),aX=Me(uX),cX=Oq.concat([In("columns","auto")]),sX=Me(cX),lX=qe([vn("value"),vn("text"),vn("icon")]),fX=function(t){return[vn("type"),vn("label"),t]},dX=[vn("type"),kn("header",cn),kn("cells",Fe(cn))],mX=Me(dX),gX=function(t){return Ve("items","items",Rt(),Fe(Ye((function(e){return Qe("Checking item of "+t,pX,e).fold((function(t){return O.error(en(t))}),(function(t){return O.value(t)}))}))))},pX=$e((function(){return nn("type",{alertbanner:vq,bar:Me(bq(gX("bar"))),button:wq,checkbox:Cq,colorinput:Eq,colorpicker:_q,dropzone:Iq,grid:Me(Pq(gX("grid"))),iframe:Fq,input:zq,selectbox:Uq,sizeinput:qq,textarea:Yq,urlinput:Qq,customeditor:nX,htmlpanel:iX,imagetools:aX,collection:sX,label:Me(fX(gX("label"))),table:mX,panel:vX})})),hX=[vn("type"),In("classes",[]),kn("items",pX)],vX=Me(hX),bX=[Ve("name","name",It((function(){return Bu("tab-name")})),cn),vn("title"),kn("items",pX)],yX=[vn("type"),Sn("tabs",bX)],wX=Me(yX),xX=Me([vn("type"),vn("name"),Ln("active",!1)].concat(Nx)),CX=sn,SX=[Ve("name","name",It((function(){return Bu("button-name")})),cn),Dn("icon"),Fn("align","end",["start","end"]),Ln("primary",!1),Ln("disabled",!1)],kX=p(SX,[vn("text")]),OX=p([bn("type",["submit","cancel","custom"])],kX),TX=p([bn("type",["menu"]),Dn("text"),Dn("tooltip"),Dn("icon"),kn("items",xX),Hn("onSetup",(function(){return n}))],SX),EX=rn("type",{submit:OX,cancel:OX,custom:OX,menu:TX}),DX=kX,AX=EX,_X=Me([vn("title"),pn("body",nn("type",{panel:vX,tabpanel:wX})),Mn("size","normal"),kn("buttons",AX),In("initialData",{}),Hn("onAction",n),Hn("onChange",n),Hn("onSubmit",n),Hn("onClose",n),Hn("onCancel",n),In("onTabChange",n)]),RX=function(t){return Qe("dialog",_X,t)},BX=function(t){return A(t)?[t].concat(tt(ht(t),BX)):_(t)?tt(t,BX):[]},IX=function(t){return D(t.type)&&D(t.name)},NX={checkbox:Sq,colorinput:Dq,colorpicker:Rq,dropzone:Nq,input:jq,iframe:Lq,sizeinput:Xq,selectbox:Wq,size:Xq,textarea:Kq,urlinput:Zq,customeditor:rX,collection:lX,togglemenuitem:CX},PX=function(t){return x.from(NX[t.type])},MX=function(t){return $(BX(t),IX)},FX=function(t){var e=MX(t),n=tt(e,(function(t){return PX(t).fold((function(){return[]}),(function(e){return[pn(t.name,e)]}))}));return Me(n)},LX=Me(p([bn("type",["cancel","custom"])],DX)),HX=Me([vn("title"),vn("url"),En("height"),En("width"),_n("buttons",LX),Hn("onAction",n),Hn("onCancel",n),Hn("onClose",n),Hn("onMessage",n)]),zX=function(t){return Qe("dialog",HX,t)},jX=function(t){var e=Ze(RX(t)),n=FX(t),r=t.initialData;return{internalDialog:e,dataValidator:n,initialData:r}},VX={open:function(t,e){var n=jX(e);return t(n.internalDialog,n.initialData,n.dataValidator)},openUrl:function(t,e){var n=Ze(zX(e));return t(n)},redial:function(t){return jX(t)}},UX=function(){var t=Wn(x.none()),e=function(){t.set(x.none())},n=function(e){t.set(x.some(e))},r=function(e){t.get().each(e)},o=function(){return t.get().isSome()};return{clear:e,set:n,isSet:o,on:r}},WX=function(t){var e=[],n={};return ft(t,(function(t,r){t.fold((function(){e.push(r)}),(function(t){n[r]=t}))})),e.length>0?O.error(e):O.value(n)},GX=function(t,n){var r=Lw(OR.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:W(t.items,(function(t){return ZP(e,t,n)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[r.asSpec()]}],behaviours:dl([Qb.config({mode:"acyclic",useTabstopAt:c(dB.isPseudoStop)}),HR.memento(r),tB.memento(r,{postprocess:function(t){return WX(t).fold((function(t){return e.console.error(t),{}}),(function(t){return t}))}})])}},qX=function(t,e){return{uid:t.uid,dom:t.dom,components:t.components,events:zy(t.action),behaviours:Gg(t.tabButtonBehaviours,[yy.config({}),Qb.config({mode:"execution",useSpace:!0,useEnter:!0}),Vg.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}},XX=Zp({name:"TabButton",configFields:[In("uid",void 0),gn("value"),Ve("dom","dom",Nt((function(t){return{attributes:{role:"tab",id:Bu("aria"),"aria-selected":"false"}}})),on()),On("action"),In("domModification",{}),Ug("tabButtonBehaviours",[yy,Qb,Vg]),gn("view")],factory:qX}),$X=i([gn("tabs"),gn("dom"),In("clickToDismiss",!1),Ug("tabbarBehaviours",[Oh,Qb]),vs(["tabClass","selectedClass"])]),YX=Sp({factory:XX,name:"tabs",unit:"tab",overrides:function(t,e){var r=function(t,e){Oh.dehighlight(t,e),ui(t,ni(),{tabbar:t,button:e})},o=function(t,e){Oh.highlight(t,e),ui(t,ei(),{tabbar:t,button:e})};return{action:function(e){var i=e.getSystem().getByUid(t.uid).getOrDie(),u=Oh.isHighlighted(i,e),a=function(){return u&&t.clickToDismiss?r:u?n:o}();a(i,e)},domModification:{classes:[t.markers.tabClass]}}}}),KX=i([YX]),JX=function(t,e,n,r){return{uid:t.uid,dom:t.dom,components:e,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Gg(t.tabbarBehaviours,[Oh.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,e){yu(e.element(),"aria-selected","true")},onDehighlight:function(t,e){yu(e.element(),"aria-selected","false")}}),Qb.config({mode:"flow",getInitial:function(t){return Oh.getHighlighted(t).map((function(t){return t.element()}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}},QX=th({name:"Tabbar",configFields:$X(),partFields:KX(),factory:JX}),ZX=function(t,e){return{uid:t.uid,dom:t.dom,behaviours:Gg(t.tabviewBehaviours,[cy.config({})]),domModification:{attributes:{role:"tabpanel"}}}},t$=Zp({name:"Tabview",configFields:[Ug("tabviewBehaviours",[cy])],factory:ZX}),e$=i([In("selectFirst",!0),ys("onChangeTab"),ys("onDismissTab"),In("tabs",[]),Ug("tabSectionBehaviours",[])]),n$=wp({factory:QX,schema:[gn("dom"),Cn("markers",[gn("tabClass"),gn("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),r$=wp({factory:t$,name:"tabview"}),o$=i([n$,r$]),i$=function(t,e,n,r){var o=function(e){var n=Vg.getValue(e);Pp(e,t,"tabview").each((function(r){var o=J(t.tabs,(function(t){return t.value===n}));o.each((function(n){var o=n.view();yu(r.element(),"aria-labelledby",xu(e.element(),"id")),cy.set(r,o),t.onChangeTab(r,e,o)}))}))},i=function(e,n){Pp(e,t,"tabbar").each((function(t){n(t).each(ai)}))};return{uid:t.uid,dom:t.dom,components:e,behaviours:Wg(t.tabSectionBehaviours),events:ki(Z([t.selectFirst?[Li((function(t,e){i(t,Oh.getFirst)}))]:[],[Di(ei(),(function(t,e){var n=e.event().button();o(n)})),Di(ni(),(function(e,n){var r=n.event().button();t.onDismissTab(e,r)}))]])),apis:{getViewItems:function(e){return Pp(e,t,"tabview").map((function(t){return cy.contents(t)})).getOr([])},showTab:function(t,e){var n=function(t){var n=Oh.getCandidates(t),r=J(n,(function(t){return Vg.getValue(t)===e}));return r.filter((function(e){return!Oh.isHighlighted(t,e)}))};i(t,n)}}}},u$=th({name:"TabSection",configFields:e$(),partFields:o$(),factory:i$,apis:{getViewItems:function(t,e){return t.getViewItems(e)},showTab:function(t,e,n){t.showTab(e,n)}}}),a$=function(t,e,n){return W(t,(function(r,o){cy.set(n,t[o].view());var i=e.dom().getBoundingClientRect();return cy.set(n,[]),i.height}))},c$=function(t){return ut(it(t,(function(t,e){return t>e?-1:t<e?1:0})))},s$=function(t,n,r){var o,i=Ki(t).dom(),u=Wc(t,".tox-dialog-wrap").getOr(t),a="fixed"===Ua(u,"position");o=a?Math.max(i.clientHeight,e.window.innerHeight):Math.max(i.offsetHeight,i.scrollHeight);var c=gc(n),s=n.dom().offsetLeft>=r.dom().offsetLeft+Oc(r),l=s?Math.max(gc(r),c):c,f=parseInt(Ua(t,"margin-top"),10)||0,d=parseInt(Ua(t,"margin-bottom"),10)||0,m=gc(t)+f+d,g=m-l;return o-g},l$=function(t,e){ut(t).each((function(t){return u$.showTab(e,t.value)}))},f$=function(t,e){za(t,"height",e+"px"),qr().browser.isIE()?Xa(t,"flex-basis"):za(t,"flex-basis",e+"px")},d$=function(t,e,n){Wc(t,'[role="dialog"]').each((function(t){Gc(t,'[role="tablist"]').each((function(r){n.get().map((function(n){return za(e,"height","0"),za(e,"flex-basis","0"),Math.min(n,s$(t,e,r))})).each((function(t){f$(e,t)}))}))}))},m$=function(t){return Gc(t,'[role="tabpanel"]')},g$=function(t){var e=function(){var e=Wn(x.none()),n=[Li((function(n){var r=n.element();m$(r).each((function(o){za(o,"visibility","hidden"),n.getSystem().getByDom(o).toOption().each((function(n){var r=a$(t,o,n),i=c$(r);e.set(i)})),d$(r,o,e),Xa(o,"visibility"),l$(t,n),qw.requestAnimationFrame((function(){d$(r,o,e)}))}))})),Di($o(),(function(t){var n=t.element();m$(n).each((function(t){d$(n,t,e)}))})),Di(iE,(function(t,n){var r=t.element();m$(r).each((function(t){var n=Dl();za(t,"visibility","hidden");var o=Ga(t,"height").map((function(t){return parseInt(t,10)}));Xa(t,"height"),Xa(t,"flex-basis");var i=t.dom().getBoundingClientRect().height,u=o.forall((function(t){return i>t}));u?(e.set(x.from(i)),d$(r,t,e)):o.each((function(e){f$(t,e)})),Xa(t,"visibility"),n.each(Ol)}))}))],r=!1;return{extraEvents:n,selectFirst:r}}(),n=function(){var t=[],e=!0;return{extraEvents:t,selectFirst:e}}();return{smartTabHeight:e,naiveTabHeight:n}},p$="send-data-to-section",h$="send-data-to-view",v$=function(t,e){var n=Wn({}),r=function(t){var e=Vg.getValue(t),r=WX(e).getOr({}),o=n.get(),i=Ot(o,r);n.set(i)},o=function(t){var e=n.get();Vg.setValue(t,e)},i=Wn(null),u=W(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:e.shared.providers.translate(t.title)},view:function(){return[OR.sketch((function(n){return{dom:{tag:"div",classes:["tox-form"]},components:W(t.items,(function(t){return ZP(n,t,e)})),formBehaviours:dl([Qb.config({mode:"acyclic",useTabstopAt:c(dB.isPseudoStop)}),ly("TabView.form.events",[Li(o),Hi(r)]),Cl.config({channels:$t([{key:p$,value:{onReceive:r}},{key:h$,value:{onReceive:o}}])})])}}))]}}})),a=g$(u).smartTabHeight;return u$.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,e,n){var r=Vg.getValue(e);ui(t,oE,{name:r,oldName:i.get()}),i.set(r)},tabs:u,components:[u$.parts().tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[QX.parts().tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:dl([GE.config({})])}),u$.parts().tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:dl([ly("tabpanel",a.extraEvents),Qb.config({mode:"acyclic"}),ih.config({find:function(t){return ut(u$.getViewItems(t))}}),Vg.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([p$],{}),n.get()},setValue:function(t,e){n.set(e),t.getSystem().broadcastOn([h$],{})}}})])})},b$=Bu("update-dialog"),y$=Bu("update-title"),w$=Bu("update-body"),x$=Bu("update-footer"),C$=Bu("body-send-message"),S$=function(t,e,n,r){var o=function(t){switch(t.body.type){case"tabpanel":return[v$(t.body,n)];default:return[GX(t.body,n)]}},i=function(t,e){return x.some({isTabPanel:function(){return"tabpanel"===e.body.type}})},u={"aria-live":"polite"};return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:m(m({},e.map((function(t){return{id:t}})).getOr({})),r?u:{})},components:[],behaviours:dl([HR.childAt(0),OH.config({channel:w$,updateState:i,renderComponents:o,initialData:t})])}},k$=function(t,e,n,r){return S$(t,x.some(e),n,r)},O$=function(t,e){var n=S$(t,x.none(),e,!1);return pq.parts().body(n)},T$=function(t){var e={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[dB.craft({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:dl([GE.config({}),yy.config({})])})]}],behaviours:dl([Qb.config({mode:"acyclic",useTabstopAt:c(dB.isPseudoStop)})])};return pq.parts().body(e)},E$=function(t,e){return[Ni(So(),dB.onFocus),t(QT,(function(t,n){e.onClose(),n.onClose()})),t(ZT,(function(t,e,n,r){e.onCancel(t),ii(r,QT)})),Di(rE,(function(t,n){return e.onUnblock()})),Di(nE,(function(t,n){return e.onBlock(n.event())}))]},D$=function(t,e){var n=function(e,n){return Di(e,(function(e,o){r(e,(function(r,i){n(t(),r,o.event(),e)}))}))},r=function(t,e){OH.getState(t).get().each((function(n){e(n,t)}))};return p(E$(n,e),[n(tE,(function(t,e,n){e.onAction(t,{name:n.name()})}))])},A$=function(t,e){var n=function(e,n){return Di(e,(function(e,o){r(e,(function(r,i){n(t(),r,o.event(),e)}))}))},r=function(t,e){OH.getState(t).get().each((function(n){e(n.internalDialog,t)}))};return p(E$(n,e),[n(eE,(function(t,e){return e.onSubmit(t)})),n(JT,(function(t,e,n){e.onChange(t,{name:n.name()})})),n(tE,(function(t,e,n,r){var o=function(){return Qb.focusIn(r)},i=Dl();e.onAction(t,{name:n.name(),value:n.value()}),Dl().fold((function(){o()}),(function(t){(!uo(r.element(),t)||Cu(t,"disabled")||uo(t,i.getOrNull())&&Cu(i.getOrDie(),"disabled"))&&o()}))})),n(oE,(function(t,e,n){e.onTabChange(t,{newTabName:n.name(),oldTabName:n.oldName()})})),Hi((function(e){var n=t();Vg.setValue(e,n.getData())}))])},_$={initUrlDialog:D$,initDialog:A$},R$=function(t,e){return ZI(t,t.type,e)},B$=function(t,e,n){return J(e,(function(t){return t.name===n})).bind((function(e){return e.memento.getOpt(t)}))},I$=function(t,e){var n=e.map((function(t){return t.footerButtons})).getOr([]),r=X(n,(function(t){return"start"===t.align})),o=function(t,e){return bT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:W(e,(function(t){return t.memento.asSpec()}))})},i=o("start",r.pass),u=o("end",r.fail);return[i,u]},N$=function(t,e){var n=function(t,n){var r=W(n.buttons,(function(t){var n=Lw(R$(t,e));return{name:t.name,align:t.align,memento:n}})),o=function(t,e){return B$(t,r,e)};return x.some({lookupByName:o,footerButtons:r})};return{dom:lC('<div class="tox-dialog__footer"></div>'),components:[],behaviours:dl([OH.config({channel:x$,initialData:t,updateState:n,renderComponents:I$})])}},P$=function(t,e){return N$(t,e)},M$=function(t,e){return pq.parts().footer(N$(t,e))},F$=function(t,e){var n=t.getRoot();if(n.getSystem().isConnected()){var r=ih.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return OR.getField(r,e).fold((function(){var n=t.getFooter(),o=OH.getState(n);return o.get().bind((function(t){return t.lookupByName(r,e)}))}),(function(t){return x.some(t)}))}return x.none()},L$=function(t,e){var n=t.getRoot();return OH.getState(n).get().map((function(t){return Ze(Qe("data",t.dataValidator,e))})).getOr(e)},H$=function(t,e,n){var r=function(e){var n=t.getRoot();n.getSystem().isConnected()&&e(n)},o=function(){var e=t.getRoot(),r=e.getSystem().isConnected()?t.getFormWrapper():e,o=Vg.getValue(r),i=dt(n,(function(t){return t.get()}));return m(m({},o),i)},i=function(e){r((function(r){var o=p.getData(),i=Tt(o,e),u=L$(t,i),a=t.getFormWrapper();Vg.setValue(a,u),ft(n,(function(t,e){bt(i,e)&&t.set(i[e])}))}))},u=function(e){F$(t,e).each(uS.disable)},a=function(e){F$(t,e).each(uS.enable)},c=function(e){F$(t,e).each(yy.focus)},s=function(t){if(!D(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");r((function(e){ui(e,nE,{message:t})}))},l=function(){r((function(t){ii(t,rE)}))},f=function(e){r((function(n){var r=t.getBody(),o=OH.getState(r);o.get().exists((function(t){return t.isTabPanel()}))&&ih.getCurrent(r).each((function(t){u$.showTab(t,e)}))}))},d=function(t){r((function(n){var r=e(t);n.getSystem().broadcastOn([b$],r),n.getSystem().broadcastOn([y$],r.internalDialog),n.getSystem().broadcastOn([w$],r.internalDialog),n.getSystem().broadcastOn([x$],r.internalDialog),p.setData(r.initialData)}))},g=function(){r((function(t){ii(t,QT)}))},p={getData:o,setData:i,disable:u,enable:a,focus:c,block:s,unblock:l,showTab:f,redial:d,close:g};return p},z$=TC.deviceType.isTouch(),j$=function(t,e){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,e]}},V$=function(t,e){return pq.parts().close(Fw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":e.translate("Close")}},action:t,buttonBehaviours:dl([GE.config({})])}))},U$=function(){return pq.parts().title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},W$=function(t,e){return pq.parts().body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:lC("<p>"+e.translate(t)+"</p>")}]}]})},G$=function(t){return pq.parts().footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},q$=function(t,e){return[bT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),bT.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:e})]},X$=function(t){var e,n="tox-dialog",r=n+"-wrap",o=r+"__backdrop",i=n+"__disable-scroll";return pq.sketch({lazySink:t.lazySink,onEscape:function(e){return t.onEscape(e),x.some(!0)},useTabstopAt:function(t){return!dB.isPseudoStop(t)},dom:{tag:"div",classes:[n].concat(t.extraClasses),styles:m({position:"relative"},t.extraStyles)},components:p([t.header,t.body],t.footer.toArray()),parts:{blocker:{dom:lC('<div class="'+r+'"></div>'),components:[{dom:{tag:"div",classes:z$?[o,o+"--opaque"]:[o]}}]}},dragBlockClass:r,modalBehaviours:dl(p([yy.config({}),ly("dialog-events",t.dialogEvents.concat([Fi(So(),(function(t,e){Qb.focusIn(t)}))])),ly("scroll-lock",[Li((function(){Ra(bi(),i)})),Hi((function(){Ia(bi(),i)}))])],t.extraBehaviours)),eventOrder:m((e={},e[Fo()]=["dialog-events"],e[Yo()]=["scroll-lock","dialog-events","alloy.base.behaviour"],e[Ko()]=["alloy.base.behaviour","dialog-events","scroll-lock"],e),t.eventOrder)})},$$=function(t){return Fw.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:'<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg"><path d="M17.953 7.453L13.422 12l4.531 4.547-1.406 1.406L12 13.422l-4.547 4.531-1.406-1.406L10.578 12 6.047 7.453l1.406-1.406L12 10.578l4.547-4.531z" fill-rule="evenodd"></path></svg>'}}],action:function(t){ii(t,ZT)}})},Y$=function(t,e,n){var r=function(t){return[uc(n.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:m({},e.map((function(t){return{id:t}})).getOr({}))},components:r(t),behaviours:dl([OH.config({channel:y$,renderComponents:r})])}},K$=function(){return{dom:lC('<div class="tox-dialog__draghandle"></div>')}},J$=function(t,e,n){return bT.sketch({dom:lC('<div class="tox-dialog__header"></div>'),components:[Y$(t,x.some(e),n),K$(),$$(n)],containerBehaviours:dl([GG.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return qc(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})},Q$=function(t,e){var n=pq.parts().title(Y$(t,x.none(),e)),r=pq.parts().draghandle(K$()),o=pq.parts().close($$(e)),i=[n].concat(t.draggable?[r]:[]).concat([o]);return bT.sketch({dom:lC('<div class="tox-dialog__header"></div>'),components:i})},Z$=function(t,e){return Q$({title:e.shared.providers.translate(t),draggable:e.dialog.isDraggableModal()},e.shared.providers)},tY=function(t,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){pq.setBusy(t(),(function(t,n){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.message()},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:lC('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}))},onUnblock:function(){pq.setIdle(t())}}},eY=function(t,e,n,r){var o,i=function(t,e){return x.some(e)};return sc(X$(m(m({},t),{lazySink:r.shared.getSink,extraBehaviours:p([OH.config({channel:b$,updateState:i,initialData:e}),tB.memory({})],t.extraBehaviours),onEscape:function(t){ii(t,ZT)},dialogEvents:n,eventOrder:(o={},o[Mo()]=["reflecting","receiving"],o[Yo()]=["scroll-lock","reflecting","messages","dialog-events","alloy.base.behaviour"],o[Ko()]=["alloy.base.behaviour","dialog-events","messages","reflecting","scroll-lock"],o)})))},nY=function(t){var e=function(t){var e=W(t.items,(function(t){var e=Wn(!1);return m(m({},t),{storage:e})}));return m(m({},t),{items:e})};return W(t,(function(t){return"menu"===t.type?e(t):t}))},rY=function(t){return K(t,(function(t,e){if("menu"===e.type){var n=e;return K(n.items,(function(t,e){return t[e.name]=e.storage,t}),t)}return t}),{})},oY=function(t,e,n){var r=Z$(t.internalDialog.title,n),o=O$({body:t.internalDialog.body},n),i=nY(t.internalDialog.buttons),u=rY(i),a=M$({buttons:i},n),c=_$.initDialog((function(){return m}),tY((function(){return f}),e)),s="normal"!==t.internalDialog.size?"large"===t.internalDialog.size?["tox-dialog--width-lg"]:["tox-dialog--width-md"]:[],l={header:r,body:o,footer:x.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},f=eY(l,t,c,n),d=function(){var t=function(){var t=pq.getBody(f);return ih.getCurrent(t).getOr(t)};return{getRoot:function(){return f},getBody:function(){return pq.getBody(f)},getFooter:function(){return pq.getFooter(f)},getFormWrapper:t}}(),m=H$(d,e.redial,u);return{dialog:f,instanceApi:m}},iY=function(t,e,n,r){var o,i,u=Bu("dialog-label"),a=Bu("dialog-content"),c=function(t,e){return x.some(e)},s=Lw(J$({title:t.internalDialog.title,draggable:!0},u,n.shared.providers)),l=Lw(k$({body:t.internalDialog.body},a,n,r)),f=nY(t.internalDialog.buttons),d=rY(f),m=Lw(P$({buttons:f},n)),g=_$.initDialog((function(){return h}),{onBlock:function(){},onUnblock:function(){},onClose:function(){return e.closeWindow()}}),p=sc({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(o={role:"dialog"},o["aria-labelledby"]=u,o["aria-describedby"]=""+a,o)},eventOrder:(i={},i[Mo()]=[OH.name(),Cl.name()],i[Fo()]=["execute-on-form"],i[Yo()]=["reflecting","execute-on-form"],i),behaviours:dl([Qb.config({mode:"cyclic",onEscape:function(t){return ii(t,QT),x.some(!0)},useTabstopAt:function(t){return!dB.isPseudoStop(t)&&("button"!==di(t)||"disabled"!==xu(t,"disabled"))}}),OH.config({channel:b$,updateState:c,initialData:t}),yy.config({}),ly("execute-on-form",g.concat([Fi(So(),(function(t,e){Qb.focusIn(t)}))])),tB.memory({})]),components:[s.asSpec(),l.asSpec(),m.asSpec()]}),h=H$({getRoot:function(){return p},getFooter:function(){return m.get(p)},getBody:function(){return l.get(p)},getFormWrapper:function(){var t=l.get(p);return ih.getCurrent(t).getOr(t)}},e.redial,d);return{dialog:p,instanceApi:h}},uY=tinymce.util.Tools.resolve("tinymce.util.URI"),aY=function(t){var e=function(e){t.getSystem().isConnected()&&e(t)},n=function(t){if(!D(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");e((function(e){ui(e,nE,{message:t})}))},r=function(){e((function(t){ii(t,rE)}))},o=function(){e((function(t){ii(t,QT)}))},i=function(t){e((function(e){e.getSystem().broadcastOn([C$],t)}))};return{block:n,unblock:r,close:o,sendMessage:i}},cY=["insertContent","setContent","execCommand","close","block","unblock"],sY=function(t){return A(t)&&-1!==cY.indexOf(t.mceAction)},lY=function(t){return!sY(t)&&A(t)&&bt(t,"mceAction")},fY=function(t,e,n){switch(n.mceAction){case"insertContent":t.insertContent(n.content);break;case"setContent":t.setContent(n.content);break;case"execCommand":var r=!!R(n.ui)&&n.ui;t.execCommand(n.cmd,r,n.value);break;case"close":e.close();break;case"block":e.block(n.message);break;case"unblock":e.unblock();break}},dY=function(t,n,r,o){var i,u=Z$(t.title,o),a=T$(t),c=t.buttons.bind((function(t){return 0===t.length?x.none():x.some(M$({buttons:t},o))})),s=_$.initUrlDialog((function(){return y}),tY((function(){return b}),n)),l=m(m({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),f=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],d=new uY(t.url,{base_uri:new uY(e.window.location.href)}),g=d.protocol+"://"+d.host+(d.port?":"+d.port:""),p=Wn(x.none()),h=[ly("messages",[Li((function(){var n=zO(Kn.fromDom(e.window),"message",(function(e){if(d.isSameOrigin(new uY(e.raw().origin))){var n=e.raw().data;sY(n)?fY(r,y,n):lY(n)&&t.onMessage(y,n)}}));p.set(x.some(n))})),Hi((function(){p.get().each((function(t){return t.unbind()}))}))]),Cl.config({channels:(i={},i[C$]={onReceive:function(t,e){Gc(t.element(),"iframe").each((function(t){var n=t.dom().contentWindow;n.postMessage(e,g)}))}},i)})],v={header:u,body:a,footer:c,extraClasses:f,extraBehaviours:h,extraStyles:l},b=eY(v,t,s,o),y=aY(b);return{dialog:b,instanceApi:y}},mY=function(t){var e=t.backstage.shared,n=function(n,r){var o=function(){pq.hide(c),r()},i=Lw(ZI({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:x.none()},"cancel",t.backstage)),u=U$(),a=V$(o,e.providers),c=sc(X$({lazySink:function(){return e.getSink()},header:j$(u,a),body:W$(n,e.providers),footer:x.some(G$(q$([],[i.asSpec()]))),onEscape:o,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Di(ZT,o)],eventOrder:{}}));pq.show(c);var s=i.get(c);yy.focus(s)};return{open:n}},gY=function(t){var e=t.backstage.shared,n=function(n,r){var o=function(t){pq.hide(s),r(t)},i=Lw(ZI({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:x.none()},"submit",t.backstage)),u=ZI({name:"no",text:"No",primary:!0,align:"end",disabled:!1,icon:x.none()},"cancel",t.backstage),a=U$(),c=V$((function(){return o(!1)}),e.providers),s=sc(X$({lazySink:function(){return e.getSink()},header:j$(a,c),body:W$(n,e.providers),footer:x.some(G$(q$([],[u,i.asSpec()]))),onEscape:function(){return o(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Di(ZT,(function(){return o(!1)})),Di(eE,(function(){return o(!0)}))],eventOrder:{}}));pq.show(s);var l=i.get(s);yy.focus(l)};return{open:n}},pY=function(t,e){return Ze(Qe("data",e,t))},hY=function(t,e){return e?[]:[CV.config({contextual:{lazyContext:function(){return x.some(zc(Kn.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},leftAttr:"data-dock-left",topAttr:"data-dock-top",positionAttr:"data-dock-pos",modes:["top"]})]},vY=function(t){var e=t.backstage,n=t.editor,r=UT(n),o=mY(t),i=gY(t),u=function(t,n,r){return void 0!==n&&"toolbar"===n.inline?l(t,e.shared.anchors.toolbar(),r,n.ariaAttrs):void 0!==n&&"cursor"===n.inline?l(t,e.shared.anchors.cursor(),r,n.ariaAttrs):s(t,r)},a=function(t,e){return c(t,e)},c=function(t,r){var o=function(t){var o=dY(t,{closeWindow:function(){pq.hide(o.dialog),r(o.instanceApi)}},n,e);return pq.show(o.dialog),o.instanceApi};return VX.openUrl(o,t)},s=function(t,n){var r=function(t,r,o){var i=r,u={dataValidator:o,initialData:i,internalDialog:t},a=oY(u,{redial:VX.redial,closeWindow:function(){pq.hide(a.dialog),n(a.instanceApi)}},e);return pq.show(a.dialog),a.instanceApi.setData(i),a.instanceApi};return VX.open(r,t)},l=function(t,o,i,u){var a=function(t,a,c){var s=pY(a,c),l=UX(),f={dataValidator:c,initialData:s,internalDialog:t},d=function(){return l.on((function(t){CV.refresh(t)}))},m=iY(f,{redial:VX.redial,closeWindow:function(){l.on(kw.hide),n.off("ResizeEditor",d),l.clear(),i(m.instanceApi)}},e,u),g=sc(kw.sketch({lazySink:e.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{},inlineBehaviours:dl(p([ly("window-manager-inline-events",[Di(Jo(),(function(t,e){ii(m.dialog,ZT)}))])],hY(n,r)))}));return l.set(g),kw.showWithin(g,o,lc(m.dialog),x.some(bi())),r||(CV.refresh(g),n.on("ResizeEditor",d)),m.instanceApi.setData(s),Qb.focusIn(m.dialog),m.instanceApi};return VX.open(a,t)},f=function(t,e){i.open(t,(function(t){e(t)}))},d=function(t,e){o.open(t,(function(){e()}))},m=function(t){t.close()};return{open:u,openUrl:a,alert:d,close:m,confirm:f}},bY={setup:vY};function yY(){d.add("silver",(function(t){var e=cq.setup(t),n=e.uiMothership,r=e.backstage,o=e.renderUI,u=e.getUi;RO.register(t,r.shared);var a=bY.setup({editor:t,backstage:r});return{renderUI:o,getWindowManagerImpl:i(a),getNotificationManagerImpl:function(){return Xw(t,{backstage:r},n)},ui:u()}}))}yY()})(window)}).call(this,n("c8ba"))},"07d1":function(t,e,n){n("94ce")},"0d68":function(t,e,n){n("030f")},1:function(t,e,n){t.exports=n("f872")},1123:function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return m}));n("99af"),n("4de4"),n("4160"),n("b0c0"),n("d3b7"),n("498a"),n("159b"),n("ddb0");var r=n("11c1"),o=n.n(r),i=n("67c4"),u=n("2ef0"),a=n.n(u),c="Image description";function s(t,e,n,r){var o={onUploadProgress:function(t){r(Math.round(t.loaded/t.total*100))}},u=new FormData;u.append("image",t.blob(),t.filename()),u.append("name",t.name()),i["a"].post("/image/",u,o).then((function(t){e(t.data.location)}),(function(t){return n(t,{remove:!0})}))}function l(t){for(var e=t.getDoc().getElementsByTagName("IMG"),n=0;n<e.length;n++){var r=e[n];if(!r.alt)return r}return null}function f(t){var e=t;t.ui.registry.addToggleButton("checkAlly",{text:"Check Accessibility",classes:"a11y-check",onSetup:function(n){function r(){var e=!!l(t);e?(n.setActive(e),n.setDisabled(!1)):(n.setActive(!1),n.setDisabled(!0))}var o=e.on("Dirty",r),i=e.on("change",r);return function(){e.off("Dirty",o),e.off("change",i)}},onAction:function(){var n=l(t);n&&e.execCommand("mceSelectNode",!1,n)}})}function d(t){function e(t){return"img"===t.nodeName.toLowerCase()}t.ui.registry.addContextForm("image-alt",{launch:{type:"contextformtogglebutton",icon:"accessibility-check"},label:"description",predicate:e,position:"node",initValue:function(e){return t.selection.getNode().alt||c},commands:[{type:"contextformtogglebutton",tooltip:"Save",icon:"save",primary:!0,onAction:function(e){var n=e.getValue();n!==c&&(t.selection.getNode().alt=n,t.setDirty(!1),t.setDirty(!0)),e.hide()}},{type:"contextformtogglebutton",icon:"image",tooltip:"More image options",active:!0,onAction:function(e){e.hide(),t.execCommand("mceImage")}}]})}function m(t){function e(t){return t.classList.contains("footnote")}function n(e){var n=t.dom.get("footnote-".concat(e,"-ref")),r=t.dom.get("footnote-".concat(e));return{refNode:n,bodyNode:r}}function r(){for(var e=t.dom.$(".footnote").filter((function(t,e){return!e.classList.contains("footnote-footer")})),n=[],r=[],o=0;o<e.length;o++){var i=e[o],u=l(i);if(i.classList.contains("footnote-ref")){var c=i.innerText;n.push({id:u,candidate:i,mark:c})}else if(i.classList.contains("footnote-body")){var s=i.getElementsByClassName("footnote-label"),f=void 0;s&&0!=s.length?(f=s[0].innerText,r.push({id:u,candidate:i,mark:f})):""!==i.innerText.trim()&&(f="",r.push({id:u,candidate:i,mark:f}))}}var d=a.a.chain(n).groupBy("id").mapValues((function(t){return t[0]})).value(),m=a.a.chain(r).groupBy("id").mapValues((function(t){return t[0]})).value(),g=a.a.differenceBy(n,r,"id"),p=a.a.differenceBy(r,n,"id");g.forEach((function(e){var n=e.id,r=e.candidate;t.dom.remove(r),a.a.unset(d,n)})),p.forEach((function(e){var n=e.id,r=e.candidate;t.dom.remove(r),a.a.unset(m,n)})),a.a.values(d).forEach((function(e){var n=e.id,r=e.mark,o=(e.candidate,m[n].mark);if(r!==o){var i=m[n].candidate,u=i.getElementsByClassName("footnote-label");u&&0!=u.length?u[0].innerText=r:i.firstChild&&(u=t.dom.createFragment('<span class="footnote-label">'.concat(r,"</span>")),i.firstChild.prepend(u))}}));for(var h=t.dom.$(".footnote-label"),v=[],b=0;b<h.length;b++)v.push(h[b]);v.forEach((function(e){var n=e;while(n){if(n.classList.contains("footnote-footer"))return;n=n.parentElement}t.dom.remove(e)})),h=t.dom.$(".footnote-label"),v=[];for(var y=0;y<h.length;y++)v.push(h[y]);if(v.forEach((function(e){var n=e.parentElement.innerText;if(n.trim()==e.innerText){var r=document.createTextNode(" ");e.parentElement.appendChild(r),t.selection.setCursorLocation(e.parentElement,n.length)}})),t.selection.getStart()==t.selection.getEnd()&&t.selection.getStart().classList.contains("footnote-label")){var w=t.selection.getStart();t.selection.setCursorLocation(w.parentElement,w.innerText.length)}var x=t.dom.$(".footnote-footer");1===x.length&&(x=x[0],x!==x.parentElement.lastElementChild&&x.parentElement.appendChild(x))}function i(){var e=t.dom.$(".footnote-footer");if(1==e.length)return e[0];if(e.length>1)return console.error("Multiple footers present."),null;var n=t.dom.add(t.getBody(),"div",{class:"footnote footnote-footer"},"");return n}function u(e){e.id=o()();var n='<span class="footnote footnote-ref" data-custom-style="Footnote Reference" id="footnote-'.concat(e.id,'-ref">').concat(e.mark,"</span>"),r=t.dom.createFragment('<div class="footnote footnote-body" id="footnote-'.concat(e.id,'"><p><span class="footnote-label" contenteditable="false">').concat(e.mark,"</span>").concat(e.footnote,"</p></div>")),u=i();u.appendChild(r),t.execCommand("mceInsertContent",!1,n)}function c(e){var r=n(e.id),o=r.refNode,i=r.bodyNode;o.innerText=e.mark;var u=t.dom.createFragment('<p><span class="footnote-label" contenteditable="false">'.concat(e.mark,"</span>").concat(e.footnote,"</p>"));while(i.firstChild)i.firstChild.remove();i.appendChild(u)}function s(t){var e=n(t),r=e.refNode,o=e.bodyNode,i=r.innerText,u=o.firstChild.firstChild.innerText,a=o.innerText.substr(u.length).trim();return{mark:i,footnote:a,id:t}}function l(t){var e=t.id||t.parentElement.id;return e?e.substr(9,36):null}function f(){var r=t.selection.getNode(),o=e(r),i=t.dom.$(".footnote-ref").length+1,a={mark:""+i,footnote:""};if(o){var f=l(r);a=s(f)}t.windowManager.open({title:"Footnote",size:"normal",body:{type:"panel",items:[{label:"Mark",type:"input",name:"mark"},{label:"Footnote",type:"textarea",name:"footnote",multiline:!0,minWidth:520,minHeight:100}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0},{type:"custom",name:"delete",text:"Delete"}],initialData:a,onSubmit:function(t){var e=t.getData();o?(e.id=a.id,c(e)):u(e),t.close()},onCancel:function(t){t.close()},onAction:function(t,e){if(e&&"delete"==e.name){var r=n(a.id),o=r.refNode,i=r.bodyNode;o.remove(),i.remove()}t.close()}})}var d={open:f};t.ui.registry.addToggleButton("footnote",{text:"Footnote",tooltip:"Footnote",onAction:function(){return t.execCommand("openFootnote")}}),t.ui.registry.addMenuItem("footnote",{text:"Footnote",onAction:function(){return t.execCommand("openFootnote")}}),t.addCommand("openFootnote",(function(){d.open(t)})),t.on("NodeChange",(function(t){r()}))}},"11c1":function(t,e,n){var r=n("c437"),o=n("c64e"),i=o;i.v1=r,i.v4=o,t.exports=i},2366:function(t,e){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);function o(t,e){var r=e||0,o=n;return[o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],"-",o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]],o[t[r++]]].join("")}t.exports=o},2401:function(t,e){(function(t){"use strict";var e=tinymce.util.Tools.resolve("tinymce.PluginManager"),n=function(){},r=function(t){return function(){return t}},o=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},i=r(!1),u=r(!0),a=function(){return c},c=function(){var t=function(t){return t.isNone()},e=function(t){return t()},o=function(t){return t},c={fold:function(t,e){return t()},is:i,isSome:i,isNone:u,getOr:o,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:o,orThunk:e,map:a,each:n,bind:a,exists:i,forall:u,filter:a,equals:t,equals_:t,toArray:function(){return[]},toString:r("none()")};return Object.freeze&&Object.freeze(c),c}(),s=function(t){var e=r(t),n=function(){return a},o=function(e){return e(t)},a={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:u,isNone:i,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return s(e(t))},each:function(e){e(t)},bind:o,exists:o,forall:o,filter:function(e){return e(t)?a:c},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(i,(function(e){return n(t,e)}))}};return a},l=function(t){return null===t||void 0===t?c:s(t)},f={some:s,none:a,from:l},d=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},m=function(t){return function(e){return d(e)===t}},g=m("string"),p=m("array"),h=m("boolean"),v=m("function"),b=m("number"),y=Array.prototype.slice,w=Array.prototype.push,x=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r},C=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},S=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n},k=function(t,e){if(0===t.length)return[];for(var n=e(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=e(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r},O=function(t,e,n){return C(t,(function(t){n=e(n,t)})),n},T=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return f.some(o)}return f.none()},E=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!p(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);w.apply(e,t[n])}return e},D=function(t,e){var n=x(t,e);return E(n)},A=function(t){var e=y.call(t,0);return e.reverse(),e},_=function(t){return 0===t.length?f.none():f.some(t[0])},R=function(t){return 0===t.length?f.none():f.some(t[t.length-1])},B=(v(Array.from)&&Array.from,function(t,e,n){return 0!==(t.compareDocumentPosition(e)&n)}),I=function(e,n){return B(e,n,t.Node.DOCUMENT_POSITION_PRECEDING)},N=function(e,n){return B(e,n,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},P={documentPositionPreceding:I,documentPositionContainedBy:N},M=function(t){var e=t,n=function(){return e},r=function(t){e=t},o=function(){return M(n())};return{get:n,set:r,clone:o}},F=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}},L=function(t,e){var n=F(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return j(r(1),r(2))},H=function(t,e){var n=String(e).toLowerCase();return 0===t.length?z():L(t,n)},z=function(){return j(0,0)},j=function(t,e){return{major:t,minor:e}},V={nu:j,detect:H,unknown:z},U="Edge",W="Chrome",G="IE",q="Opera",X="Firefox",$="Safari",Y=function(t,e){return function(){return e===t}},K=function(){return J({current:void 0,version:V.unknown()})},J=function(t){var e=t.current,n=t.version;return{current:e,version:n,isEdge:Y(U,e),isChrome:Y(W,e),isIE:Y(G,e),isOpera:Y(q,e),isFirefox:Y(X,e),isSafari:Y($,e)}},Q={unknown:K,nu:J,edge:r(U),chrome:r(W),ie:r(G),opera:r(q),firefox:r(X),safari:r($)},Z="Windows",tt="iOS",et="Android",nt="Linux",rt="OSX",ot="Solaris",it="FreeBSD",ut=function(t,e){return function(){return e===t}},at=function(){return ct({current:void 0,version:V.unknown()})},ct=function(t){var e=t.current,n=t.version;return{current:e,version:n,isWindows:ut(Z,e),isiOS:ut(tt,e),isAndroid:ut(et,e),isOSX:ut(rt,e),isLinux:ut(nt,e),isSolaris:ut(ot,e),isFreeBSD:ut(it,e)}},st={unknown:at,nu:ct,windows:r(Z),ios:r(tt),android:r(et),linux:r(nt),osx:r(rt),solaris:r(ot),freebsd:r(it)},lt=function(t,e,n,o){var i=t.isiOS()&&!0===/ipad/i.test(n),u=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),c=a||o("(pointer:coarse)"),s=i||!u&&a&&o("(min-device-width:768px)"),l=u||a&&!s,f=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n),d=!l&&!s&&!f;return{isiPad:r(i),isiPhone:r(u),isTablet:r(s),isPhone:r(l),isTouch:r(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:r(f),isDesktop:r(d)}},ft=function(t,e){var n=String(e).toLowerCase();return T(t,(function(t){return t.search(n)}))},dt=function(t,e){return ft(t,e).map((function(t){var n=V.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},mt=function(t,e){return ft(t,e).map((function(t){var n=V.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},gt={detectBrowser:dt,detectOs:mt},pt=function(t,e){return-1!==t.indexOf(e)},ht=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,vt=function(t){return function(e){return pt(e,t)}},bt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return pt(t,"edge/")&&pt(t,"chrome")&&pt(t,"safari")&&pt(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,ht],search:function(t){return pt(t,"chrome")&&!pt(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return pt(t,"msie")||pt(t,"trident")}},{name:"Opera",versionRegexes:[ht,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:vt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:vt("firefox")},{name:"Safari",versionRegexes:[ht,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(pt(t,"safari")||pt(t,"mobile/"))&&pt(t,"applewebkit")}}],yt=[{name:"Windows",search:vt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return pt(t,"iphone")||pt(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:vt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:vt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:vt("linux"),versionRegexes:[]},{name:"Solaris",search:vt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:vt("freebsd"),versionRegexes:[]}],wt={browsers:r(bt),oses:r(yt)},xt=function(t,e){var n=wt.browsers(),r=wt.oses(),o=gt.detectBrowser(n,t).fold(Q.unknown,Q.nu),i=gt.detectOs(r,t).fold(st.unknown,st.nu),u=lt(i,o,t,e);return{browser:o,os:i,deviceType:u}},Ct={detect:xt},St=function(e){return t.window.matchMedia(e).matches},kt=M(Ct.detect(t.navigator.userAgent,St)),Ot=function(){return kt.get()},Tt=function(e,n){var r=n||t.document,o=r.createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return At(o.childNodes[0])},Et=function(e,n){var r=n||t.document,o=r.createElement(e);return At(o)},Dt=function(e,n){var r=n||t.document,o=r.createTextNode(e);return At(o)},At=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:r(t)}},_t=function(t,e,n){var r=t.dom();return f.from(r.elementFromPoint(e,n)).map(At)},Rt={fromHtml:Tt,fromTag:Et,fromText:Dt,fromDom:At,fromPoint:_t},Bt=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE,t.Node.DOCUMENT_NODE,t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),It=(t.Node.TEXT_NODE,t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,Bt),Nt=function(t,e){var n=t.dom();if(n.nodeType!==It)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Pt=function(t,e){return t.dom()===e.dom()},Mt=function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Ft=function(t,e){return P.documentPositionContainedBy(t.dom(),e.dom())},Lt=Ot().browser,Ht=Lt.isIE()?Ft:Mt,zt=Nt,jt=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),Vt=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),Ut=tinymce.util.Tools.resolve("tinymce.util.VK"),Wt=function(t,e,n){return t.isSome()&&e.isSome()?f.some(n(t.getOrDie(),e.getOrDie())):f.none()},Gt=function(e,n){var r=n||t.document,o=r.createDocumentFragment();return C(e,(function(t){o.appendChild(t.dom())})),Rt.fromDom(o)},qt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var o={};return C(t,(function(t,n){o[t]=r(e[n])})),o}},Xt=Object.keys,$t=function(t,e){for(var n=Xt(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];e(u,i)}},Yt=function(t){return f.from(t.dom().parentNode).map(Rt.fromDom)},Kt=function(t){return x(t.dom().childNodes,Rt.fromDom)},Jt=function(t,e){var n=t.dom().childNodes;return f.from(n[e]).map(Rt.fromDom)},Qt=function(t){return Jt(t,0)},Zt=function(t){return Jt(t,t.dom().childNodes.length-1)},te=(qt("element","offset"),function(t,e){var n=Yt(t);n.each((function(n){n.dom().insertBefore(e.dom(),t.dom())}))}),ee=function(t,e){t.dom().appendChild(e.dom())},ne=function(t,e){C(e,(function(e){te(t,e)}))},re=function(t,e){C(e,(function(e){ee(t,e)}))},oe=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},ie=function(t,e,n){return t.fire("ListMutation",{action:e,element:n})},ue="undefined"!==typeof t.window?t.window:Function("return this;")(),ae=function(t,e){for(var n=void 0!==e&&null!==e?e:ue,r=0;r<t.length&&void 0!==n&&null!==n;++r)n=n[t[r]];return n},ce=function(t,e){var n=t.split(".");return ae(n,e)},se=function(t,e){return ce(t,e)},le=function(t,e){var n=se(t,e);if(void 0===n||null===n)throw new Error(t+" not available on this browser");return n},fe={getOrDie:le},de=function(t){return fe.getOrDie("HTMLElement",t)},me=function(t){var e=ce("ownerDocument.defaultView",t);return de(e).prototype.isPrototypeOf(t)},ge={isPrototypeOf:me},pe=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),he=tinymce.util.Tools.resolve("tinymce.util.Tools"),ve=function(t){return t&&3===t.nodeType},be=function(t){return t&&/^(OL|UL|DL)$/.test(t.nodeName)},ye=function(t){return t&&/^(OL|UL)$/.test(t.nodeName)},we=function(t){return t&&/^(LI|DT|DD)$/.test(t.nodeName)},xe=function(t){return t&&/^(DT|DD)$/.test(t.nodeName)},Ce=function(t){return t&&/^(TH|TD)$/.test(t.nodeName)},Se=function(t){return t&&"BR"===t.nodeName},ke=function(t){return t.parentNode.firstChild===t},Oe=function(t){return t.parentNode.lastChild===t},Te=function(t,e){return e&&!!t.schema.getTextBlockElements()[e.nodeName]},Ee=function(t,e){return t&&t.nodeName in e},De=function(t,e){return!!Se(e)&&!(!t.isBlock(e.nextSibling)||Se(e.previousSibling))},Ae=function(t,e,n){var r=t.isEmpty(e);return!(n&&t.select("span[data-mce-type=bookmark]",e).length>0)&&r},_e=function(t,e){return t.isChildOf(e,t.getRoot())},Re={isTextNode:ve,isListNode:be,isOlUlNode:ye,isDlItemNode:xe,isListItemNode:we,isTableCellNode:Ce,isBr:Se,isFirstChild:ke,isLastChild:Oe,isTextBlock:Te,isBlock:Ee,isBogusBr:De,isEmpty:Ae,isChildOfBody:_e},Be=function(t){var e=t.selection.getStart(!0);return t.dom.getParent(e,"OL,UL,DL",He(t,e))},Ie=function(t,e){return t&&1===e.length&&e[0]===t},Ne=function(t){return he.grep(t.querySelectorAll("ol,ul,dl"),(function(t){return Re.isListNode(t)}))},Pe=function(t){var e=Be(t),n=t.selection.getSelectedBlocks();return Ie(e,n)?Ne(e):he.grep(n,(function(t){return Re.isListNode(t)&&e!==t}))},Me=function(t,e){var n=he.map(e,(function(e){var n=t.dom.getParent(e,"li,dd,dt",He(t,e));return n||e}));return pe.unique(n)},Fe=function(t){var e=t.selection.getSelectedBlocks();return he.grep(Me(t,e),(function(t){return Re.isListItemNode(t)}))},Le=function(t){return S(Fe(t),Re.isDlItemNode)},He=function(t,e){var n=t.dom.getParents(e,"TD,TH"),r=n.length>0?n[0]:t.getBody();return r},ze=function(t,e){var n=t.dom.getParents(e,"ol,ul",He(t,e));return R(n)},je=function(t){var e=ze(t,t.selection.getStart()),n=S(t.selection.getSelectedBlocks(),Re.isOlUlNode);return e.toArray().concat(n)},Ve=function(t){var e=je(t);return Ue(t,e)},Ue=function(t,e){var n=x(e,(function(e){return ze(t,e).getOr(e)}));return pe.unique(n)},We=function(t){var e=Be(t);return ge.isPrototypeOf(e)},Ge={isList:We,getParentList:Be,getSelectedSubLists:Pe,getSelectedListItems:Fe,getClosestListRootElm:He,getSelectedDlItems:Le,getSelectedListRoots:Ve},qe=function(t,e){var n,r,o,i,u=t.dom,a=t.schema.getBlockElements(),c=u.createFragment();if(t.settings.forced_root_block&&(o=t.settings.forced_root_block),o&&(r=u.create(o),r.tagName===t.settings.forced_root_block&&u.setAttribs(r,t.settings.forced_root_block_attrs),Re.isBlock(e.firstChild,a)||c.appendChild(r)),e)while(n=e.firstChild){var s=n.nodeName;i||"SPAN"===s&&"bookmark"===n.getAttribute("data-mce-type")||(i=!0),Re.isBlock(n,a)?(c.appendChild(n),r=null):o?(r||(r=u.create(o),c.appendChild(r)),r.appendChild(n)):c.appendChild(n)}return t.settings.forced_root_block?i||r.appendChild(u.create("br",{"data-mce-bogus":"1"})):c.appendChild(u.create("br")),c},Xe=function(t){var e=t.dom().nodeName;return e.toLowerCase()},$e=function(t){return t.dom().nodeType},Ye=function(t){return function(e){return $e(e)===t}},Ke=Ye(Bt),Je=function(e,n,r){if(!(g(r)||h(r)||b(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")},Qe=function(t,e){var n=t.dom();$t(e,(function(t,e){Je(n,e,t)}))},Ze=function(t){return O(t.dom().attributes,(function(t,e){return t[e.name]=e.value,t}),{})},tn=function(t){return void 0!==t.style&&v(t.style.getPropertyValue)},en=function(e,n,r){if(!g(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);tn(e)&&e.style.setProperty(n,r)},nn=function(t,e,n){var r=t.dom();en(r,e,n)},rn=function(t,e){return Rt.fromDom(t.dom().cloneNode(e))},on=function(t){return rn(t,!0)},un=function(t,e){var n=Rt.fromTag(e),r=Ze(t);return Qe(n,r),n},an=function(t,e){var n=un(t,e);te(t,n);var r=Kt(t);return re(n,r),oe(t),n},cn=function(t,e){ee(t.item,e.list)},sn=function(t){for(var e=1;e<t.length;e++)cn(t[e-1],t[e])},ln=function(t,e){Wt(R(t),_(e),cn)},fn=function(t,e){var n={list:Rt.fromTag(e,t),item:Rt.fromTag("li",t)};return ee(n.list,n.item),n},dn=function(t,e,n){for(var r=[],o=0;o<n;o++)r.push(fn(t,e.listType));return r},mn=function(t,e){for(var n=0;n<t.length-1;n++)nn(t[n].item,"list-style-type","none");R(t).each((function(t){Qe(t.list,e.listAttributes),Qe(t.item,e.itemAttributes),re(t.item,e.content)}))},gn=function(t,e){Xe(t.list)!==e.listType&&(t.list=an(t.list,e.listType)),Qe(t.list,e.listAttributes)},pn=function(t,e,n){var r=Rt.fromTag("li",t);return Qe(r,e),re(r,n),r},hn=function(t,e){ee(t.list,e),t.item=e},vn=function(t,e,n){var r=e.slice(0,n.depth);return R(r).each((function(e){var r=pn(t,n.itemAttributes,n.content);hn(e,r),gn(e,n)})),r},bn=function(t,e,n){var r=dn(t,n,n.depth-e.length);return sn(r),mn(r,n),ln(e,r),e.concat(r)},yn=function(t,e){var n=O(e,(function(e,n){return n.depth>e.length?bn(t,e,n):vn(t,e,n)}),[]);return _(n).map((function(t){return t.list}))},wn=function(t){return zt(t,"OL,UL")},xn=function(t){return Qt(t).map(wn).getOr(!1)},Cn=function(t){return Zt(t).map(wn).getOr(!1)},Sn=function(t){return t.depth>0},kn=function(t){return t.isSelected},On=function(t){var e=Kt(t),n=Cn(t)?e.slice(0,-1):e;return x(n,on)},Tn=function(t,e,n){return Yt(t).filter(Ke).map((function(r){return{depth:e,isSelected:n,content:On(t),itemAttributes:Ze(t),listAttributes:Ze(r),listType:Xe(r)}}))},En=function(t,e){switch(t){case"Indent":e.depth++;break;case"Outdent":e.depth--;break;case"Flatten":e.depth=0}},Dn=Object.prototype.hasOwnProperty,An=function(t,e){return e},_n=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)Dn.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},Rn=_n(An),Bn=function(t,e){t.listType=e.listType,t.listAttributes=Rn({},e.listAttributes)},In=function(t,e){for(var n=t[e].depth,r=e-1;r>=0;r--){if(t[r].depth===n)return f.some(t[r]);if(t[r].depth<n)break}return f.none()},Nn=function(t){C(t,(function(e,n){In(t,n).each((function(t){Bn(e,t)}))}))},Pn=function(t,e,n,r){return Qt(r).filter(wn).fold((function(){e.each((function(t){Pt(t.start,r)&&n.set(!0)}));var o=Tn(r,t,n.get());e.each((function(t){Pt(t.end,r)&&n.set(!1)}));var i=Zt(r).filter(wn).map((function(r){return Mn(t,e,n,r)})).getOr([]);return o.toArray().concat(i)}),(function(r){return Mn(t,e,n,r)}))},Mn=function(t,e,n,r){return D(Kt(r),(function(r){var o=wn(r)?Mn:Pn,i=t+1;return o(i,e,n,r)}))},Fn=function(t,e){var n=M(!1),r=0;return x(t,(function(t){return{sourceList:t,entries:Mn(r,e,n,t)}}))},Ln=function(t,e){return x(e,(function(e){var n=Gt(e.content);return Rt.fromDom(qe(t,n.dom()))}))},Hn=function(t,e){return Nn(e),yn(t.contentDocument,e).toArray()},zn=function(t,e){return D(k(e,Sn),(function(e){var n=_(e).map(Sn).getOr(!1);return n?Hn(t,e):Ln(t,e)}))},jn=function(t,e){C(S(t,kn),(function(t){return En(e,t)}))},Vn=function(t){var e=x(Ge.getSelectedListItems(t),Rt.fromDom);return Wt(T(e,o(xn)),T(A(e),o(xn)),(function(t,e){return{start:t,end:e}}))},Un=function(t,e,n){var r=Fn(e,Vn(t));C(r,(function(e){jn(e.entries,n);var r=zn(t,e.entries);C(r,(function(e){ie(t,"Indent"===n?"IndentList":"OutdentList",e.dom())})),ne(e.sourceList,r),oe(e.sourceList)}))},Wn=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Gn=Wn.DOM,qn=function(t,e,n){var r,o,i,u,a,c=function(t){he.each(i,(function(e){t.parentNode.insertBefore(e,n.parentNode)})),Gn.remove(t)};for(i=Gn.select('span[data-mce-type="bookmark"]',e),a=qe(t,n),r=Gn.createRng(),r.setStartAfter(n),r.setEndAfter(e),o=r.extractContents(),u=o.firstChild;u;u=u.firstChild)if("LI"===u.nodeName&&t.dom.isEmpty(u)){Gn.remove(u);break}t.dom.isEmpty(o)||Gn.insertAfter(o,e),Gn.insertAfter(a,e),Re.isEmpty(t.dom,n.parentNode)&&c(n.parentNode),Gn.remove(n),Re.isEmpty(t.dom,e)&&Gn.remove(e)},Xn={splitList:qn},$n=function(t,e){zt(e,"dd")?an(e,"dt"):zt(e,"dt")&&Yt(e).each((function(n){return Xn.splitList(t,n.dom(),e.dom())}))},Yn=function(t){zt(t,"dt")&&an(t,"dd")},Kn=function(t,e,n){C(n,"Indent"===e?Yn:function(e){return $n(t,e)})},Jn=function(t,e){if(Re.isTextNode(t))return{container:t,offset:e};var n=jt.getNode(t,e);return Re.isTextNode(n)?{container:n,offset:e>=t.childNodes.length?n.data.length:0}:n.previousSibling&&Re.isTextNode(n.previousSibling)?{container:n.previousSibling,offset:n.previousSibling.data.length}:n.nextSibling&&Re.isTextNode(n.nextSibling)?{container:n.nextSibling,offset:0}:{container:t,offset:e}},Qn=function(t){var e=t.cloneRange(),n=Jn(t.startContainer,t.startOffset);e.setStart(n.container,n.offset);var r=Jn(t.endContainer,t.endOffset);return e.setEnd(r.container,r.offset),e},Zn={getNormalizedPoint:Jn,normalizeRange:Qn},tr=function(t,e){var n=x(Ge.getSelectedListRoots(t),Rt.fromDom),r=x(Ge.getSelectedDlItems(t),Rt.fromDom),o=!1;if(n.length||r.length){var i=t.selection.getBookmark();Un(t,n,e),Kn(t,e,r),t.selection.moveToBookmark(i),t.selection.setRng(Zn.normalizeRange(t.selection.getRng())),t.nodeChanged(),o=!0}return o},er=function(t){return tr(t,"Indent")},nr=function(t){return tr(t,"Outdent")},rr=function(t){return tr(t,"Flatten")},or=tinymce.util.Tools.resolve("tinymce.dom.BookmarkManager"),ir=Wn.DOM,ur=function(t){var e={},n=function(n){var r,o,i;o=t[n?"startContainer":"endContainer"],i=t[n?"startOffset":"endOffset"],1===o.nodeType&&(r=ir.create("span",{"data-mce-type":"bookmark"}),o.hasChildNodes()?(i=Math.min(i,o.childNodes.length-1),n?o.insertBefore(r,o.childNodes[i]):ir.insertAfter(r,o.childNodes[i])):o.appendChild(r),o=r,i=0),e[n?"startContainer":"endContainer"]=o,e[n?"startOffset":"endOffset"]=i};return n(!0),t.collapsed||n(),e},ar=function(t){function e(e){var n,r,o,i=function(t){var e=t.parentNode.firstChild,n=0;while(e){if(e===t)return n;1===e.nodeType&&"bookmark"===e.getAttribute("data-mce-type")||n++,e=e.nextSibling}return-1};n=o=t[e?"startContainer":"endContainer"],r=t[e?"startOffset":"endOffset"],n&&(1===n.nodeType&&(r=i(n),n=n.parentNode,ir.remove(o),!n.hasChildNodes()&&ir.isBlock(n)&&n.appendChild(ir.create("br"))),t[e?"startContainer":"endContainer"]=n,t[e?"startOffset":"endOffset"]=r)}e(!0),e();var n=ir.createRng();return n.setStart(t.startContainer,t.startOffset),t.endContainer&&n.setEnd(t.endContainer,t.endOffset),Zn.normalizeRange(n)},cr={createBookmark:ur,resolveBookmark:ar},sr=function(t){return/\btox\-/.test(t.className)},lr=function(t){switch(t){case"UL":return"ToggleUlList";case"OL":return"ToggleOlList";case"DL":return"ToggleDLList"}},fr=function(t,e,n){var r=n["list-style-type"]?n["list-style-type"]:null;t.setStyle(e,"list-style-type",r)},dr=function(t,e){he.each(e,(function(e,n){t.setAttribute(n,e)}))},mr=function(t,e,n){dr(e,n["list-attributes"]),he.each(t.select("li",e),(function(t){dr(t,n["list-item-attributes"])}))},gr=function(t,e,n){fr(t,e,n),mr(t,e,n)},pr=function(t,e,n){he.each(n,(function(n){var r;return t.setStyle(e,(r={},r[n]="",r))}))},hr=function(t,e,n,r){var o,i;o=e[n?"startContainer":"endContainer"],i=e[n?"startOffset":"endOffset"],1===o.nodeType&&(o=o.childNodes[Math.min(i,o.childNodes.length-1)]||o),!n&&Re.isBr(o.nextSibling)&&(o=o.nextSibling);while(o.parentNode!==r){if(Re.isTextBlock(t,o))return o;if(/^(TD|TH)$/.test(o.parentNode.nodeName))return o;o=o.parentNode}return o},vr=function(t,e,n){for(var r,o=[],i=t.dom,u=hr(t,e,!0,n),a=hr(t,e,!1,n),c=[],s=u;s;s=s.nextSibling)if(c.push(s),s===a)break;return he.each(c,(function(e){if(Re.isTextBlock(t,e))return o.push(e),void(r=null);if(i.isBlock(e)||Re.isBr(e))return Re.isBr(e)&&i.remove(e),void(r=null);var u=e.nextSibling;or.isBookmarkNode(e)&&(Re.isTextBlock(t,u)||!u&&e.parentNode===n)?r=null:(r||(r=i.create("p"),e.parentNode.insertBefore(r,e),o.push(r)),r.appendChild(e))})),o},br=function(t,e,n){var r=t.getStyle(e,"list-style-type"),o=n?n["list-style-type"]:"";return o=null===o?"":o,r===o},yr=function(t,e,n){void 0===n&&(n={});var r,o=t.selection.getRng(!0),i="LI",u=Ge.getClosestListRootElm(t,t.selection.getStart(!0)),a=t.dom;"false"!==a.getContentEditable(t.selection.getNode())&&(e=e.toUpperCase(),"DL"===e&&(i="DT"),r=cr.createBookmark(o),he.each(vr(t,o,u),(function(r){var o,u;u=r.previousSibling,u&&Re.isListNode(u)&&u.nodeName===e&&br(a,u,n)?(o=u,r=a.rename(r,i),u.appendChild(r)):(o=a.create(e),r.parentNode.insertBefore(o,r),o.appendChild(r),r=a.rename(r,i)),pr(a,r,["margin","margin-right","margin-bottom","margin-left","margin-top","padding","padding-right","padding-bottom","padding-left","padding-top"]),gr(a,o,n),kr(t.dom,o)})),t.selection.setRng(cr.resolveBookmark(r)))},wr=function(t,e){return t&&e&&Re.isListNode(t)&&t.nodeName===e.nodeName},xr=function(t,e,n){var r=t.getStyle(e,"list-style-type",!0),o=t.getStyle(n,"list-style-type",!0);return r===o},Cr=function(t,e){return t.className===e.className},Sr=function(t,e,n){return wr(e,n)&&xr(t,e,n)&&Cr(e,n)},kr=function(t,e){var n,r;if(n=e.nextSibling,Sr(t,e,n)){while(r=n.firstChild)e.appendChild(r);t.remove(n)}if(n=e.previousSibling,Sr(t,e,n)){while(r=n.lastChild)e.insertBefore(r,e.firstChild);t.remove(n)}},Or=function(t,e,n,r){if(e.nodeName!==n){var o=t.dom.rename(e,n);gr(t.dom,o,r),ie(t,lr(n),o)}else gr(t.dom,e,r),ie(t,lr(n),e)},Tr=function(t,e,n,r,o){if(e.nodeName!==r||Er(o)){var i=cr.createBookmark(t.selection.getRng(!0));he.each([e].concat(n),(function(e){Or(t,e,r,o)})),t.selection.setRng(cr.resolveBookmark(i))}else rr(t)},Er=function(t){return"list-style-type"in t},Dr=function(t,e,n,r){if(e!==t.getBody())if(e)if(e.nodeName!==n||Er(r)||sr(e)){var o=cr.createBookmark(t.selection.getRng(!0));gr(t.dom,e,r);var i=t.dom.rename(e,n);kr(t.dom,i),t.selection.setRng(cr.resolveBookmark(o)),ie(t,lr(n),i)}else rr(t);else yr(t,n,r),ie(t,lr(n),e)},Ar=function(t,e,n){var r=Ge.getParentList(t),o=Ge.getSelectedSubLists(t);n=n||{},r&&o.length>0?Tr(t,r,o,e,n):Dr(t,r,e,n)},_r={toggleList:Ar,mergeWithAdjacentLists:kr},Rr=Wn.DOM,Br=function(t,e){var n,r=e.parentNode;"LI"===r.nodeName&&r.firstChild===e&&(n=r.previousSibling,n&&"LI"===n.nodeName?(n.appendChild(e),Re.isEmpty(t,r)&&Rr.remove(r)):Rr.setStyle(r,"listStyleType","none")),Re.isListNode(r)&&(n=r.previousSibling,n&&"LI"===n.nodeName&&n.appendChild(e))},Ir=function(t,e){he.each(he.grep(t.select("ol,ul",e)),(function(e){Br(t,e)}))},Nr={normalizeList:Br,normalizeLists:Ir},Pr=function(t,e,n,r){var o=e.startContainer,i=e.startOffset;if(Re.isTextNode(o)&&(n?i<o.data.length:i>0))return o;var u=t.schema.getNonEmptyElements();1===o.nodeType&&(o=jt.getNode(o,i));var a=new Vt(o,r);n&&Re.isBogusBr(t.dom,o)&&a.next();while(o=a[n?"next":"prev2"]()){if("LI"===o.nodeName&&!o.hasChildNodes())return o;if(u[o.nodeName])return o;if(Re.isTextNode(o)&&o.data.length>0)return o}},Mr=function(t,e){var n=e.childNodes;return 1===n.length&&!Re.isListNode(n[0])&&t.isBlock(n[0])},Fr=function(t,e){Mr(t,e)&&t.remove(e.firstChild,!0)},Lr=function(t,e,n){var r,o;if(o=Mr(t,n)?n.firstChild:n,Fr(t,e),!Re.isEmpty(t,e,!0))while(r=e.firstChild)o.appendChild(r)},Hr=function(t,e,n){var r,o,i=e.parentNode;if(Re.isChildOfBody(t,e)&&Re.isChildOfBody(t,n)){Re.isListNode(n.lastChild)&&(o=n.lastChild),i===n.lastChild&&Re.isBr(i.previousSibling)&&t.remove(i.previousSibling),r=n.lastChild,r&&Re.isBr(r)&&e.hasChildNodes()&&t.remove(r),Re.isEmpty(t,n,!0)&&t.$(n).empty(),Lr(t,e,n),o&&n.appendChild(o);var u=Ht(Rt.fromDom(n),Rt.fromDom(e)),a=u?t.getParents(e,Re.isListNode,n):[];t.remove(e),C(a,(function(e){Re.isEmpty(t,e)&&e!==t.getRoot()&&t.remove(e)}))}},zr=function(t,e,n){t.dom.$(n).empty(),Hr(t.dom,e,n),t.selection.setCursorLocation(n)},jr=function(t,e,n,r){var o=t.dom;if(o.isEmpty(r))zr(t,n,r);else{var i=cr.createBookmark(e);Hr(o,n,r),t.selection.setRng(cr.resolveBookmark(i))}},Vr=function(t,e,n,r){var o=cr.createBookmark(e);Hr(t.dom,n,r);var i=cr.resolveBookmark(o);t.selection.setRng(i)},Ur=function(t,e){var n=t.dom,r=t.selection,o=r.getStart(),i=Ge.getClosestListRootElm(t,o),u=n.getParent(r.getStart(),"LI",i);if(u){var a=u.parentNode;if(a===t.getBody()&&Re.isEmpty(n,a))return!0;var c=Zn.normalizeRange(r.getRng()),s=n.getParent(Pr(t,c,e,i),"LI",i);if(s&&s!==u)return t.undoManager.transact((function(){e?jr(t,c,s,u):Re.isFirstChild(u)?nr(t):Vr(t,c,u,s)})),!0;if(!s&&!e&&0===c.startOffset&&0===c.endOffset)return t.undoManager.transact((function(){rr(t)})),!0}return!1},Wr=function(t,e,n){var r=t.getParent(e.parentNode,t.isBlock,n);t.remove(e),r&&t.isEmpty(r)&&t.remove(r)},Gr=function(t,e){var n=t.dom,r=t.selection.getStart(),o=Ge.getClosestListRootElm(t,r),i=n.getParent(r,n.isBlock,o);if(i&&n.isEmpty(i)){var u=Zn.normalizeRange(t.selection.getRng()),a=n.getParent(Pr(t,u,e,o),"LI",o);if(a)return t.undoManager.transact((function(){Wr(n,i,o),_r.mergeWithAdjacentLists(n,a.parentNode),t.selection.select(a,!0),t.selection.collapse(e)})),!0}return!1},qr=function(t,e){return Ur(t,e)||Gr(t,e)},Xr=function(t){var e=t.selection.getStart(),n=Ge.getClosestListRootElm(t,e),r=t.dom.getParent(e,"LI,DT,DD",n);return!!(r||Ge.getSelectedListItems(t).length>0)&&(t.undoManager.transact((function(){t.execCommand("Delete"),Nr.normalizeLists(t.dom,t.getBody())})),!0)},$r=function(t,e){return t.selection.isCollapsed()?qr(t,e):Xr(t)},Yr=function(t){t.on("keydown",(function(e){e.keyCode===Ut.BACKSPACE?$r(t,!1)&&e.preventDefault():e.keyCode===Ut.DELETE&&$r(t,!0)&&e.preventDefault()}))},Kr={setup:Yr,backspaceDelete:$r},Jr=function(t){return{backspaceDelete:function(e){Kr.backspaceDelete(t,e)}}},Qr={get:Jr},Zr=function(t,e){return function(){var n=t.dom.getParent(t.selection.getStart(),"UL,OL,DL");return n&&n.nodeName===e}},to=function(t){t.on("BeforeExecCommand",(function(e){var n=e.command.toLowerCase();"indent"===n?er(t):"outdent"===n&&nr(t)})),t.addCommand("InsertUnorderedList",(function(e,n){_r.toggleList(t,"UL",n)})),t.addCommand("InsertOrderedList",(function(e,n){_r.toggleList(t,"OL",n)})),t.addCommand("InsertDefinitionList",(function(e,n){_r.toggleList(t,"DL",n)})),t.addCommand("RemoveList",(function(){rr(t)})),t.addQueryStateHandler("InsertUnorderedList",Zr(t,"UL")),t.addQueryStateHandler("InsertOrderedList",Zr(t,"OL")),t.addQueryStateHandler("InsertDefinitionList",Zr(t,"DL"))},eo={register:to},no=function(t){return t.getParam("lists_indent_on_tab",!0)},ro={shouldIndentOnTab:no},oo=function(t){t.on("keydown",(function(e){e.keyCode!==Ut.TAB||Ut.metaKeyPressed(e)||t.undoManager.transact((function(){(e.shiftKey?nr(t):er(t))&&e.preventDefault()}))}))},io=function(t){ro.shouldIndentOnTab(t)&&oo(t),Kr.setup(t)},uo={setup:io},ao=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(e(r))return n}return-1},co=function(t,e){return function(n){var r=function(t){var r=ao(t.parents,Re.isTableCellNode),o=-1!==r?t.parents.slice(0,r):t.parents,i=he.grep(o,Re.isListNode);n.setActive(i.length>0&&i[0].nodeName===e&&!sr(i[0]))};return t.on("NodeChange",r),function(){return t.off("NodeChange",r)}}},so=function(t){var e=function(t,e){var n=t.settings.plugins?t.settings.plugins:"";return-1!==he.inArray(n.split(/[ ,]/),e)},n=function(e){return function(){return t.execCommand(e)}};e(t,"advlist")||(t.ui.registry.addToggleButton("numlist",{icon:"ordered-list",active:!1,tooltip:"Numbered list",onAction:n("InsertOrderedList"),onSetup:co(t,"OL")}),t.ui.registry.addToggleButton("bullist",{icon:"unordered-list",active:!1,tooltip:"Bullet list",onAction:n("InsertUnorderedList"),onSetup:co(t,"UL")}))},lo={register:so};function fo(){e.add("lists",(function(t){return uo.setup(t),lo.register(t),eo.register(t),Qr.get(t)}))}fo()})(window)},3699:function(t,e){(function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(){return e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},e.apply(this,arguments)},n=function(){},r=function(t){return function(){return t}},o=r(!1),i=r(!0),u=function(){return a},a=function(){var t=function(t){return t.isNone()},e=function(t){return t()},a=function(t){return t},c={fold:function(t,e){return t()},is:o,isSome:o,isNone:i,getOr:a,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:r(null),getOrUndefined:r(void 0),or:a,orThunk:e,map:u,each:n,bind:u,exists:o,forall:i,filter:u,equals:t,equals_:t,toArray:function(){return[]},toString:r("none()")};return Object.freeze&&Object.freeze(c),c}(),c=function(t){var e=r(t),n=function(){return s},u=function(e){return e(t)},s={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:i,isNone:o,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return c(e(t))},each:function(e){e(t)},bind:u,exists:u,forall:u,filter:function(e){return e(t)?s:a},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(o,(function(e){return n(t,e)}))}};return s},s=function(t){return null===t||void 0===t?a:c(t)},l={some:c,none:u,from:s},f=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},d=function(t){return function(e){return f(e)===t}},m=d("string"),g=d("array"),p=d("function"),h=Array.prototype.slice,v=Array.prototype.push,b=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},y=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!g(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);v.apply(e,t[n])}return e},w=(p(Array.from)&&Array.from,function(t){var e=t,n=function(){return e},r=function(t){e=t},o=function(){return w(n())};return{get:n,set:r,clone:o}}),x=Object.prototype.hasOwnProperty,C=function(t,e){return e},S=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)x.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},k=S(C),O=Object.hasOwnProperty,T=function(t,e){return E(t,e)?l.from(t[e]):l.none()},E=function(t,e){return O.call(t,e)},D=function(t){return t.getParam("media_scripts")},A=function(t){return t.getParam("audio_template_callback")},_=function(t){return t.getParam("video_template_callback")},R=function(t){return t.getParam("media_live_embeds",!0)},B=function(t){return t.getParam("media_filter_html",!0)},I=function(t){return t.getParam("media_url_resolver")},N=function(t){return t.getParam("media_alt_source",!0)},P=function(t){return t.getParam("media_poster",!0)},M=function(t){return t.getParam("media_dimensions",!0)},F={getScripts:D,getAudioTemplateCallback:A,getVideoTemplateCallback:_,hasLiveEmbeds:R,shouldFilterHtml:B,getUrlResolver:I,hasAltSource:N,hasPoster:P,hasDimensions:M},L=tinymce.util.Tools.resolve("tinymce.util.Tools"),H=tinymce.util.Tools.resolve("tinymce.html.SaxParser"),z=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),j=function(t){return t.replace(/px$/,"")},V=function(t){return/^[0-9.]+$/.test(t)?t+"px":t},U=function(t){return function(e){return e?j(e.style[t]):""}},W=function(t){return function(e,n){e&&(e.style[t]=V(n))}},G={getMaxWidth:U("maxWidth"),getMaxHeight:U("maxHeight"),setMaxWidth:W("maxWidth"),setMaxHeight:W("maxHeight")},q=function(t,e){if(t)for(var n=0;n<t.length;n++)if(-1!==e.indexOf(t[n].filter))return t[n]},X=z.DOM,$=function(t){return X.getAttrib(t,"data-ephox-embed-iri")},Y=function(t){var e=X.createFragment(t);return""!==$(e.firstChild)},K=function(t,e){var n={};return H({validate:!1,allow_conditional_comments:!0,start:function(e,r){if(n.source1||"param"!==e||(n.source1=r.map.movie),"iframe"!==e&&"object"!==e&&"embed"!==e&&"video"!==e&&"audio"!==e||(n.type||(n.type=e),n=L.extend(r.map,n)),"script"===e){var o=q(t,r.map.src);if(!o)return;n={type:"script",source1:r.map.src,width:String(o.width),height:String(o.height)}}"source"===e&&(n.source1?n.source2||(n.source2=r.map.src):n.source1=r.map.src),"img"!==e||n.poster||(n.poster=r.map.src)}}).parse(e),n.source1=n.source1||n.src||n.data,n.source2=n.source2||"",n.poster=n.poster||"",n},J=function(t){var e=X.createFragment(t),n=e.firstChild;return{type:"ephox-embed-iri",source1:$(n),source2:"",poster:"",width:G.getMaxWidth(n),height:G.getMaxHeight(n)}},Q=function(t,e){return Y(e)?J(e):K(t,e)},Z=tinymce.util.Tools.resolve("tinymce.util.Promise"),tt=function(t){var e={mp3:"audio/mpeg",m4a:"audio/x-m4a",wav:"audio/wav",mp4:"video/mp4",webm:"video/webm",ogg:"video/ogg",swf:"application/x-shockwave-flash"},n=t.toLowerCase().split(".").pop(),r=e[n];return r||""},et={guess:tt},nt=tinymce.util.Tools.resolve("tinymce.html.Writer"),rt=tinymce.util.Tools.resolve("tinymce.html.Schema"),ot=z.DOM,it=function(t,e){var n,r,o,i;for(n in e)if(o=""+e[n],t.map[n]){r=t.length;while(r--)i=t[r],i.name===n&&(o?(t.map[n]=o,i.value=o):(delete t.map[n],t.splice(r,1)))}else o&&(t.push({name:n,value:o}),t.map[n]=o)},ut=function(t){var e=nt(),n=H(e);return n.parse(t),e.getContent()},at=function(t,e,n){var r,o=nt(),i=0;return H({validate:!1,allow_conditional_comments:!0,comment:function(t){o.comment(t)},cdata:function(t){o.cdata(t)},text:function(t,e){o.text(t,e)},start:function(t,u,a){switch(t){case"video":case"object":case"embed":case"img":case"iframe":void 0!==e.height&&void 0!==e.width&&it(u,{width:e.width,height:e.height});break}if(n)switch(t){case"video":it(u,{poster:e.poster,src:""}),e.source2&&it(u,{src:""});break;case"iframe":it(u,{src:e.source1});break;case"source":if(i++,i<=2&&(it(u,{src:e["source"+i],type:e["source"+i+"mime"]}),!e["source"+i]))return;break;case"img":if(!e.poster)return;r=!0;break}o.start(t,u,a)},end:function(t){if("video"===t&&n)for(var u=1;u<=2;u++)if(e["source"+u]){var a=[];a.map={},i<u&&(it(a,{src:e["source"+u],type:e["source"+u+"mime"]}),o.start("source",a,!0))}if(e.poster&&"object"===t&&n&&!r){var c=[];c.map={},it(c,{src:e.poster,width:e.width,height:e.height}),o.start("img",c,!0)}o.end(t)}},rt({})).parse(t),o.getContent()},ct=function(t){var e=ot.createFragment(t);return""!==ot.getAttrib(e.firstChild,"data-ephox-embed-iri")},st=function(t,e){var n=ot.createFragment(t),r=n.firstChild;return G.setMaxWidth(r,e.width),G.setMaxHeight(r,e.height),ut(r.outerHTML)},lt=function(t,e,n){return ct(t)?st(t,e):at(t,e,n)},ft={updateHtml:lt},dt=[{regex:/youtu\.be\/([\w\-_\?&=.]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/youtube\.com(.+)v=([^&]+)(&([a-z0-9&=\-_]+))?/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$2?$4",allowFullscreen:!0},{regex:/youtube.com\/embed\/([a-z0-9\?&=\-_]+)/i,type:"iframe",w:560,h:314,url:"//www.youtube.com/embed/$1",allowFullscreen:!0},{regex:/vimeo\.com\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$1?title=0&byline=0&portrait=0&color=8dc7dc",allowFullscreen:!0},{regex:/vimeo\.com\/(.*)\/([0-9]+)/,type:"iframe",w:425,h:350,url:"//player.vimeo.com/video/$2?title=0&amp;byline=0",allowFullscreen:!0},{regex:/maps\.google\.([a-z]{2,3})\/maps\/(.+)msid=(.+)/,type:"iframe",w:425,h:350,url:'//maps.google.com/maps/ms?msid=$2&output=embed"',allowFullscreen:!1},{regex:/dailymotion\.com\/video\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0},{regex:/dai\.ly\/([^_]+)/,type:"iframe",w:480,h:270,url:"//www.dailymotion.com/embed/video/$1",allowFullscreen:!0}],mt=function(t,e){for(var n=t.regex.exec(e),r=t.url,o=function(t){r=r.replace("$"+t,(function(){return n[t]?n[t]:""}))},i=0;i<n.length;i++)o(i);return r.replace(/\?$/,"")},gt=function(t){var e=dt.filter((function(e){return e.regex.test(t)}));return e.length>0?L.extend({},e[0],{url:mt(e[0],t)}):null},pt=function(t){var e=t.allowFullscreen?' allowFullscreen="1"':"";return'<iframe src="'+t.source1+'" width="'+t.width+'" height="'+t.height+'"'+e+"></iframe>"},ht=function(t){var e='<object data="'+t.source1+'" width="'+t.width+'" height="'+t.height+'" type="application/x-shockwave-flash">';return t.poster&&(e+='<img src="'+t.poster+'" width="'+t.width+'" height="'+t.height+'" />'),e+="</object>",e},vt=function(t,e){return e?e(t):'<audio controls="controls" src="'+t.source1+'">'+(t.source2?'\n<source src="'+t.source2+'"'+(t.source2mime?' type="'+t.source2mime+'"':"")+" />\n":"")+"</audio>"},bt=function(t,e){return e?e(t):'<video width="'+t.width+'" height="'+t.height+'"'+(t.poster?' poster="'+t.poster+'"':"")+' controls="controls">\n<source src="'+t.source1+'"'+(t.source1mime?' type="'+t.source1mime+'"':"")+" />\n"+(t.source2?'<source src="'+t.source2+'"'+(t.source2mime?' type="'+t.source2mime+'"':"")+" />\n":"")+"</video>"},yt=function(t){return'<script src="'+t.source1+'"><\/script>'},wt=function(t,e){var n=L.extend({},e);if(!n.source1&&(L.extend(n,Q(F.getScripts(t),n.embed)),!n.source1))return"";n.source2||(n.source2=""),n.poster||(n.poster=""),n.source1=t.convertURL(n.source1,"source"),n.source2=t.convertURL(n.source2,"source"),n.source1mime=et.guess(n.source1),n.source2mime=et.guess(n.source2),n.poster=t.convertURL(n.poster,"poster");var r=gt(n.source1);if(r&&(n.source1=r.url,n.type=r.type,n.allowFullscreen=r.allowFullscreen,n.width=n.width||String(r.w),n.height=n.height||String(r.h)),n.embed)return ft.updateHtml(n.embed,n,!0);var o=q(F.getScripts(t),n.source1);o&&(n.type="script",n.width=String(o.width),n.height=String(o.height));var i=F.getAudioTemplateCallback(t),u=F.getVideoTemplateCallback(t);return n.width=n.width||"300",n.height=n.height||"150",L.each(n,(function(e,r){n[r]=t.dom.encode(""+e)})),"iframe"===n.type?pt(n):"application/x-shockwave-flash"===n.source1mime?ht(n):-1!==n.source1mime.indexOf("audio")?vt(n,i):"script"===n.type?yt(n):bt(n,u)},xt={},Ct=function(t,e,n){return new Z((function(r,o){var i=function(n){return n.html&&(xt[t.source1]=n),r({url:t.source1,html:n.html?n.html:e(t)})};xt[t.source1]?i(xt[t.source1]):n({url:t.source1},i,o)}))},St=function(t,e){return new Z((function(n){n({html:e(t),url:t.source1})}))},kt=function(t){return function(e){return wt(t,e)}},Ot=function(t,e){var n=F.getUrlResolver(t);return n?Ct(e,kt(t),n):St(e,kt(t))},Tt=function(t){return xt.hasOwnProperty(t)},Et={getEmbedHtml:Ot,isCached:Tt},Dt=function(t){var e=k(t,{source1:t.source1.value,source2:T(t,"source2").bind((function(t){return T(t,"value")})).getOr(""),poster:T(t,"poster").bind((function(t){return T(t,"value")})).getOr("")});return T(t,"dimensions").each((function(t){b(["width","height"],(function(n){T(t,n).each((function(t){return e[n]=t}))}))})),e},At=function(t){var e=k(t,{source1:{value:T(t,"source1").getOr("")},source2:{value:T(t,"source2").getOr("")},poster:{value:T(t,"poster").getOr("")}});return b(["width","height"],(function(n){T(t,n).each((function(t){var r=e.dimensions||{};r[n]=t,e.dimensions=r}))})),e},_t=function(t){return function(e){var n=e&&e.msg?"Media embed handler error: "+e.msg:"Media embed handler threw unknown error.";t.notificationManager.open({type:"error",text:n})}},Rt=function(t,e){return Q(F.getScripts(t),e)},Bt=function(t){return t.getAttribute("data-mce-object")||t.getAttribute("data-ephox-embed-iri")},It=function(t){var e=t.selection.getNode(),n=Bt(e)?t.serializer.serialize(e,{selection:!0}):"";return k({embed:n},Q(F.getScripts(t),n))},Nt=function(t,n){return function(r){if(m(r.url)&&r.url.trim().length>0){var o=r.html,i=Rt(n,o),u=e(e({},i),{source1:r.url,embed:o});t.setData(At(u))}}},Pt=function(t,e){for(var n=t.dom.select("img[data-mce-object]"),r=0;r<e.length;r++)for(var o=n.length-1;o>=0;o--)e[r]===n[o]&&n.splice(o,1);t.selection.select(n[0])},Mt=function(t,e){var n=t.dom.select("img[data-mce-object]");t.insertContent(e),Pt(t,n),t.nodeChanged()},Ft=function(t,e,n){e.embed=ft.updateHtml(e.embed,e),e.embed&&(t.source1===e.source1||Et.isCached(e.source1))?Mt(n,e.embed):Et.getEmbedHtml(n,e).then((function(t){Mt(n,t.html)})).catch(_t(n))},Lt=function(t){var n=It(t),r=w(n),o=At(n),i=function(t){return Dt(t.getData())},u=function(e,n){var r=i(n);e.source1!==r.source1&&(Nt(b,t)({url:r.source1,html:""}),Et.getEmbedHtml(t,r).then(Nt(b,t)).catch(_t(t)))},a=function(e){var n=Dt(e.getData()),r=Rt(t,n.embed);e.setData(At(r))},c=function(n){var r=i(n),o=wt(t,r);n.setData(At(e(e({},r),{embed:o})))},s=[{name:"source1",type:"urlinput",filetype:"media",label:"Source"}],l=F.hasDimensions(t)?[{type:"sizeinput",name:"dimensions",label:"Constrain proportions",constrain:!0}]:[],f={title:"General",name:"general",items:y([s,l])},d={type:"textarea",name:"embed",label:"Paste your embed code below:"},m={title:"Embed",items:[d]},g=[];F.hasAltSource(t)&&g.push({name:"source2",type:"urlinput",filetype:"media",label:"Alternative source URL"}),F.hasPoster(t)&&g.push({name:"poster",type:"urlinput",filetype:"image",label:"Media poster (Image URL)"});var p={title:"Advanced",name:"advanced",items:g},h=[f,m];g.length>0&&h.push(p);var v={type:"tabpanel",tabs:h},b=t.windowManager.open({title:"Insert/Edit Media",size:"normal",body:v,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],onSubmit:function(e){var n=i(e);Ft(r.get(),n,t),e.close()},onChange:function(t,e){switch(e.name){case"source1":u(r.get(),t);break;case"embed":a(t);break;case"dimensions":case"poster":c(t);break;default:break}r.set(i(t))},initialData:o})},Ht={showDialog:Lt},zt=function(t){var e=function(){Ht.showDialog(t)};return{showDialog:e}},jt={get:zt},Vt=function(t){var e=function(){Ht.showDialog(t)};t.addCommand("mceMedia",e)},Ut={register:Vt},Wt=tinymce.util.Tools.resolve("tinymce.html.Node"),Gt=tinymce.util.Tools.resolve("tinymce.Env"),qt=function(t,e){if(!1===F.shouldFilterHtml(t))return e;var n,r=nt();return H({validate:!1,allow_conditional_comments:!1,comment:function(t){r.comment(t)},cdata:function(t){r.cdata(t)},text:function(t,e){r.text(t,e)},start:function(e,o,i){if(n=!0,"script"!==e&&"noscript"!==e){for(var u=0;u<o.length;u++){if(0===o[u].name.indexOf("on"))return;"style"===o[u].name&&(o[u].value=t.dom.serializeStyle(t.dom.parseStyle(o[u].value),e))}r.start(e,o,i),n=!1}},end:function(t){n||r.end(t)}},rt({})).parse(e),r.getContent()},Xt={sanitize:qt},$t=function(t,e){var n,r=e.name;return n=new Wt("img",1),n.shortEnded=!0,Kt(t,e,n),n.attr({width:e.attr("width")||"300",height:e.attr("height")||("audio"===r?"30":"150"),style:e.attr("style"),src:Gt.transparentSrc,"data-mce-object":r,class:"mce-object mce-object-"+r}),n},Yt=function(t,e){var n,r,o,i=e.name;return n=new Wt("span",1),n.attr({contentEditable:"false",style:e.attr("style"),"data-mce-object":i,class:"mce-preview-object mce-object-"+i}),Kt(t,e,n),r=new Wt(i,1),r.attr({src:e.attr("src"),allowfullscreen:e.attr("allowfullscreen"),style:e.attr("style"),class:e.attr("class"),width:e.attr("width"),height:e.attr("height"),frameborder:"0"}),o=new Wt("span",1),o.attr("class","mce-shim"),n.append(r),n.append(o),n},Kt=function(t,e,n){var r,o,i,u,a;i=e.attributes,u=i.length;while(u--)r=i[u].name,o=i[u].value,"width"!==r&&"height"!==r&&"style"!==r&&("data"!==r&&"src"!==r||(o=t.convertURL(o,r)),n.attr("data-mce-p-"+r,o));a=e.firstChild&&e.firstChild.value,a&&(n.attr("data-mce-html",escape(Xt.sanitize(t,a))),n.firstChild=null)},Jt=function(t){var e=t.attr("class");return e&&/\btiny-pageembed\b/.test(e)},Qt=function(t){while(t=t.parent)if(t.attr("data-ephox-embed-iri")||Jt(t))return!0;return!1},Zt=function(t){return function(e){var n,r,o=e.length;while(o--)n=e[o],n.parent&&(n.parent.attr("data-mce-object")||("script"!==n.name||(r=q(F.getScripts(t),n.attr("src")),r))&&(r&&(r.width&&n.attr("width",r.width.toString()),r.height&&n.attr("height",r.height.toString())),"iframe"===n.name&&F.hasLiveEmbeds(t)&&Gt.ceFalse?Qt(n)||n.replace(Yt(t,n)):Qt(n)||n.replace($t(t,n))))}},te={createPreviewIframeNode:Yt,createPlaceholderNode:$t,placeHolderConverter:Zt},ee=function(t){t.on("preInit",(function(){var e=t.schema.getSpecialElements();L.each("video audio iframe object".split(" "),(function(t){e[t]=new RegExp("</"+t+"[^>]*>","gi")}));var n=t.schema.getBoolAttrs();L.each("webkitallowfullscreen mozallowfullscreen allowfullscreen".split(" "),(function(t){n[t]={}})),t.parser.addNodeFilter("iframe,video,audio,object,embed,script",te.placeHolderConverter(t)),t.serializer.addAttributeFilter("data-mce-object",(function(e,n){var r,o,i,u,a,c,s,l,f=e.length;while(f--)if(r=e[f],r.parent){s=r.attr(n),o=new Wt(s,1),"audio"!==s&&"script"!==s&&(l=r.attr("class"),l&&-1!==l.indexOf("mce-preview-object")?o.attr({width:r.firstChild.attr("width"),height:r.firstChild.attr("height")}):o.attr({width:r.attr("width"),height:r.attr("height")})),o.attr({style:r.attr("style")}),u=r.attributes,i=u.length;while(i--){var d=u[i].name;0===d.indexOf("data-mce-p-")&&o.attr(d.substr(11),u[i].value)}"script"===s&&o.attr("type","text/javascript"),a=r.attr("data-mce-html"),a&&(c=new Wt("#text",3),c.raw=!0,c.value=Xt.sanitize(t,unescape(a)),o.append(c)),r.replace(o)}}))})),t.on("SetContent",(function(){t.$("span.mce-preview-object").each((function(e,n){var r=t.$(n);0===r.find("span.mce-shim").length&&r.append('<span class="mce-shim"></span>')}))}))},ne={setup:ee},re=function(t){t.on("ResolveName",(function(t){var e;1===t.target.nodeType&&(e=t.target.getAttribute("data-mce-object"))&&(t.name=e)}))},oe={setup:re},ie=function(t){t.on("click keyup touchend",(function(){var e=t.selection.getNode();e&&t.dom.hasClass(e,"mce-preview-object")&&t.dom.getAttrib(e,"data-mce-selected")&&e.setAttribute("data-mce-selected","2")})),t.on("ObjectSelected",(function(t){var e=t.target.getAttribute("data-mce-object");"audio"!==e&&"script"!==e||t.preventDefault()})),t.on("ObjectResized",(function(t){var e,n=t.target;n.getAttribute("data-mce-object")&&(e=n.getAttribute("data-mce-html"),e&&(e=unescape(e),n.setAttribute("data-mce-html",escape(ft.updateHtml(e,{width:String(t.width),height:String(t.height)})))))}))},ue={setup:ie},ae=function(t,e){return function(n){return t.selection.selectorChangedWithUnbind(e.join(","),n.setActive).unbind}},ce=function(t){t.ui.registry.addToggleButton("media",{tooltip:"Insert/edit media",icon:"embed",onAction:function(){t.execCommand("mceMedia")},onSetup:ae(t,["img[data-mce-object]","span[data-mce-object]","div[data-ephox-embed-iri]"])}),t.ui.registry.addMenuItem("media",{icon:"embed",text:"Media...",onAction:function(){t.execCommand("mceMedia")}})},se={register:ce};function le(){t.add("media",(function(t){return Ut.register(t),se.register(t),oe.setup(t),ne.setup(t),ue.setup(t),jt.get(t)}))}le()})()},"3aea":function(t,e,n){n("3699")},4237:function(t,e,n){n("be7f")},"43fc":function(t,e){(function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=tinymce.util.Tools.resolve("tinymce.util.Tools"),n=function(t){return t.getParam("noneditable_noneditable_class","mceNonEditable")},r=function(t){return t.getParam("noneditable_editable_class","mceEditable")},o=function(t){var e=t.getParam("noneditable_regexp",[]);return e&&e.constructor===RegExp?[e]:e},i={getNonEditableClass:n,getEditableClass:r,getNonEditableRegExps:o},u=function(t){return function(e){return-1!==(" "+e.attr("class")+" ").indexOf(t)}},a=function(t,e,n){return function(r){var o=arguments,i=o[o.length-2],u=i>0?e.charAt(i-1):"";if('"'===u)return r;if(">"===u){var a=e.lastIndexOf("<",i);if(-1!==a){var c=e.substring(a,i);if(-1!==c.indexOf('contenteditable="false"'))return r}}return'<span class="'+n+'" data-mce-content="'+t.dom.encode(o[0])+'">'+t.dom.encode("string"===typeof o[1]?o[1]:o[0])+"</span>"}},c=function(t,e,n){var r=e.length,o=n.content;if("raw"!==n.format){while(r--)o=o.replace(e[r],a(t,o,i.getNonEditableClass(t)));n.content=o}},s=function(t){var n,r,o="contenteditable";n=" "+e.trim(i.getEditableClass(t))+" ",r=" "+e.trim(i.getNonEditableClass(t))+" ";var a=u(n),s=u(r),l=i.getNonEditableRegExps(t);t.on("PreInit",(function(){l.length>0&&t.on("BeforeSetContent",(function(e){c(t,l,e)})),t.parser.addAttributeFilter("class",(function(t){var e,n=t.length;while(n--)e=t[n],a(e)?e.attr(o,"true"):s(e)&&e.attr(o,"false")})),t.serializer.addAttributeFilter(o,(function(t){var e,n=t.length;while(n--)e=t[n],(a(e)||s(e))&&(l.length>0&&e.attr("data-mce-content")?(e.name="#text",e.type=3,e.raw=!0,e.value=e.attr("data-mce-content")):e.attr(o,null))}))}))},l={setup:s};function f(){t.add("noneditable",(function(t){l.setup(t)}))}f()})()},"4ea8":function(t,e,n){n("cdd9")},"64d8":function(t,e,n){n("ef1f")},"7c4f":function(t,e,n){(function(t){(function(e){"use strict";var n=function(t){var e=t,r=function(){return e},o=function(t){e=t},i=function(){return n(r())};return{get:r,set:o,clone:i}},r=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=function(t){return!(!/(^|[ ,])powerpaste([, ]|$)/.test(t.settings.plugins)||!r.get("powerpaste"))&&("undefined"!==typeof e.window.console&&e.window.console.log&&e.window.console.log("PowerPaste is incompatible with Paste plugin! Remove 'paste' from the 'plugins' option."),!0)},i={hasProPlugin:o},u=function(t,e){return{clipboard:t,quirks:e}},a={get:u},c=function(t,e,n,r){return t.fire("PastePreProcess",{content:e,internal:n,wordContent:r})},s=function(t,e,n,r){return t.fire("PastePostProcess",{node:e,internal:n,wordContent:r})},l=function(t,e){return t.fire("PastePlainTextToggle",{state:e})},f=function(t,e){return t.fire("paste",{ieFake:e})},d={firePastePreProcess:c,firePastePostProcess:s,firePastePlainTextToggle:l,firePaste:f},m=function(t,e){"text"===e.pasteFormat.get()?(e.pasteFormat.set("html"),d.firePastePlainTextToggle(t,!1)):(e.pasteFormat.set("text"),d.firePastePlainTextToggle(t,!0)),t.focus()},g={togglePlainTextPaste:m},p=function(t,e){t.addCommand("mceTogglePlainTextPaste",(function(){g.togglePlainTextPaste(t,e)})),t.addCommand("mceInsertClipboardContent",(function(t,n){n.content&&e.pasteHtml(n.content,n.internal),n.text&&e.pasteText(n.text)}))},h={register:p},v=function(){},b=function(t){return function(){return t}},y=b(!1),w=b(!0),x=function(){return C},C=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},r={fold:function(t,e){return t()},is:y,isSome:y,isNone:w,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:n,orThunk:e,map:x,each:v,bind:x,exists:y,forall:w,filter:x,equals:t,equals_:t,toArray:function(){return[]},toString:b("none()")};return Object.freeze&&Object.freeze(r),r}(),S=function(t){var e=b(t),n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:w,isNone:y,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return S(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?o:C},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(y,(function(e){return n(t,e)}))}};return o},k=function(t){return null===t||void 0===t?C:S(t)},O={some:S,none:x,from:k},T=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},E=function(t){return function(e){return T(e)===t}},D=E("function"),A=Array.prototype.slice,_=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r},R=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},B=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n},I=function(t,e,n){return R(t,(function(t){n=e(n,t)})),n},N=D(Array.from)?Array.from:function(t){return A.call(t)},P={},M={exports:P};(function(e,n,r,o){(function(o){if("object"===typeof n&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof e&&e.amd)e([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(e,n,r){function i(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[a]={exports:{}};e[a][0].call(f.exports,(function(t){var n=e[a][1][t];return i(n||t)}),f,f.exports,t,e,n,r)}return n[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,e,n){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var l,f=[],d=!1,m=-1;function g(){d&&l&&(d=!1,l.length?f=l.concat(f):m=-1,f.length&&p())}function p(){if(!d){var t=c(g);d=!0;var e=f.length;while(e){l=f,f=[];while(++m<e)l&&l[m].run();m=-1,e=f.length}l=null,d=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new h(t,e)),1!==f.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){(function(n){var r=setTimeout;function o(){}function i(t,e){return function(){t.apply(e,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,e){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(o){return void s(e.promise,o)}c(e.promise,r)}else(1===t._state?c:s)(e.promise,t._value)}))):t._deferreds.push(e)}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof u)return t._state=3,t._value=e,void l(t);if("function"===typeof n)return void d(i(n,e),t)}t._state=1,t._value=e,l(t)}catch(r){s(t,r)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t((function(t){n||(n=!0,c(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(r){if(n)return;n=!0,s(e,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,e){var n=new this.constructor(o);return a(this,new f(t,e,n)),n},u.all=function(t){var e=Array.prototype.slice.call(t);return new u((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),n)}e[i]=u,0===--r&&t(e)}catch(c){n(c)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(e){e(t)}))},u.reject=function(t){return new u((function(e,n){n(t)}))},u.race=function(t){return new u((function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)}))},u._immediateFn="function"===typeof t?function(e){t(e)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof e&&e.exports?e.exports=u:n.Promise||(n.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(e,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n.setImmediate="function"===typeof e?e:function(t){var e=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[e]=!0,o((function(){a[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))})),e},n.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,P,M,void 0);var F=M.exports.boltExport,L=function(t){var n=O.none(),r=[],o=function(t){return L((function(e){i((function(n){e(t(n))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){n=O.some(t),c(r),r=[]},a=function(){return n.isSome()},c=function(t){R(t,s)},s=function(t){n.each((function(n){e.setTimeout((function(){t(n)}),0)}))};return t(u),{get:i,map:o,isReady:a}},H=function(t){return L((function(e){e(t)}))},z={nu:L,pure:H},j=function(t){e.setTimeout((function(){throw t}),0)},V=function(t){var e=function(e){t().then(e,j)},n=function(e){return V((function(){return t().then(e)}))},r=function(e){return V((function(){return t().then((function(t){return e(t).toPromise()}))}))},o=function(e){return V((function(){return t().then((function(){return e.toPromise()}))}))},i=function(){return z.nu(e)},u=function(){var e=null;return V((function(){return null===e&&(e=t()),e}))},a=t;return{map:n,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:e}},U=function(t){return V((function(){return new F(t)}))},W=function(t){return V((function(){return F.resolve(t)}))},G={nu:U,pure:W},q=function(t,e){return e((function(e){var n=[],r=0,o=function(o){return function(i){n[o]=i,r++,r>=t.length&&e(n)}};0===t.length?e([]):R(t,(function(t,e){t.get(o(e))}))}))},X=function(t){return q(t,G.nu)},$=function(t,e){return X(_(t,e))},Y=function(){var t=n(O.none()),e=function(){t.set(O.none())},r=function(e){t.set(O.some(e))},o=function(e){t.get().each(e)},i=function(){return t.get().isSome()};return{clear:e,set:r,isSet:i,on:o}},K=tinymce.util.Tools.resolve("tinymce.Env"),J=tinymce.util.Tools.resolve("tinymce.util.Delay"),Q=tinymce.util.Tools.resolve("tinymce.util.Tools"),Z=tinymce.util.Tools.resolve("tinymce.util.VK"),tt="x-tinymce/html",et="\x3c!-- "+tt+" --\x3e",nt=function(t){return et+t},rt=function(t){return t.replace(et,"")},ot=function(t){return-1!==t.indexOf(et)},it={mark:nt,unmark:rt,isMarked:ot,internalHtmlMime:function(){return tt}},ut=tinymce.util.Tools.resolve("tinymce.html.Entities"),at=function(t){return!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(t)},ct=function(t){return t.replace(/\r?\n/g,"<br>")},st=function(t,e){var n,r=[],o="<"+t;if("object"===typeof e){for(n in e)e.hasOwnProperty(n)&&r.push(n+'="'+ut.encodeAllRaw(e[n])+'"');r.length&&(o+=" "+r.join(" "))}return o+">"},lt=function(t,e,n){var r=t.split(/\n\n/),o=st(e,n),i="</"+e+">",u=Q.map(r,(function(t){return t.split(/\n/).join("<br />")})),a=function(t){return o+t+i};return 1===u.length?u[0]:Q.map(u,a).join("")},ft=function(t,e,n){return e?lt(t,!0===e?"p":e,n):ct(t)},dt={isPlainText:at,convert:ft,toBRs:ct,toBlockElements:lt},mt=tinymce.util.Tools.resolve("tinymce.html.DomParser"),gt=tinymce.util.Tools.resolve("tinymce.html.Serializer"),pt=tinymce.util.Tools.resolve("tinymce.html.Node"),ht=tinymce.util.Tools.resolve("tinymce.html.Schema"),vt=function(t){return t.getParam("paste_block_drop",!1)},bt=function(t){return t.getParam("paste_data_images",!1)},yt=function(t){return t.getParam("paste_filter_drop",!0)},wt=function(t){return t.getParam("paste_preprocess")},xt=function(t){return t.getParam("paste_postprocess")},Ct=function(t){return t.getParam("paste_webkit_styles")},St=function(t){return t.getParam("paste_remove_styles_if_webkit",!0)},kt=function(t){return t.getParam("paste_merge_formats",!0)},Ot=function(t){return t.getParam("smart_paste",!0)},Tt=function(t){return t.getParam("paste_as_text",!1)},Et=function(t){return t.getParam("paste_retain_style_properties")},Dt=function(t){var e="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody";return t.getParam("paste_word_valid_elements",e)},At=function(t){return t.getParam("paste_convert_word_fake_lists",!0)},_t=function(t){return t.getParam("paste_enable_default_filters",!0)},Rt={shouldBlockDrop:vt,shouldPasteDataImages:bt,shouldFilterDrop:yt,getPreProcess:wt,getPostProcess:xt,getWebkitStyles:Ct,shouldRemoveWebKitStyles:St,shouldMergeFormats:kt,isSmartPasteEnabled:Ot,isPasteAsTextEnabled:Tt,getRetainStyleProps:Et,getWordValidElements:Dt,shouldConvertWordFakeLists:At,shouldUseDefaultFilters:_t};function Bt(t,e){return Q.each(e,(function(e){t=e.constructor===RegExp?t.replace(e,""):t.replace(e[0],e[1])})),t}function It(t){var e=ht(),n=mt({},e),r="",o=e.getShortEndedElements(),i=Q.makeMap("script noscript style textarea video audio iframe object"," "),u=e.getBlockElements();function a(t){var e=t.name,n=t;if("br"!==e){if("wbr"!==e)if(o[e]&&(r+=" "),i[e])r+=" ";else{if(3===t.type&&(r+=t.value),!t.shortEnded&&(t=t.firstChild))do{a(t)}while(t=t.next);u[e]&&n.next&&(r+="\n","p"===e&&(r+="\n"))}}else r+="\n"}return t=Bt(t,[/<!\[[^\]]+\]>/g]),a(n.parse(t)),r}function Nt(t){function e(t,e,n){return e||n?" ":" "}return t=Bt(t,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/gi,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,e],/<br class="Apple-interchange-newline">/g,/<br>$/i]),t}function Pt(t){var e=0;return function(){return t+e++}}var Mt=function(){return-1!==e.navigator.userAgent.indexOf(" Edge/")},Ft={filter:Bt,innerText:It,trimHtml:Nt,createIdGenerator:Pt,isMsEdge:Mt};function Lt(t){return/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(t)||/class="OutlineElement/.test(t)||/id="?docs\-internal\-guid\-/.test(t)}function Ht(t){var e,n;return n=[/^[IVXLMCD]{1,2}\.[ \u00a0]/,/^[ivxlmcd]{1,2}\.[ \u00a0]/,/^[a-z]{1,2}[\.\)][ \u00a0]/,/^[A-Z]{1,2}[\.\)][ \u00a0]/,/^[0-9]+\.[ \u00a0]/,/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/],t=t.replace(/^[\u00a0 ]+/,""),Q.each(n,(function(n){if(n.test(t))return e=!0,!1})),e}function zt(t){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(t)}function jt(t){var e,n,r=1;function o(t){var e="";if(3===t.type)return t.value;if(t=t.firstChild)do{e+=o(t)}while(t=t.next);return e}function i(t,e){if(3===t.type&&e.test(t.value))return t.value=t.value.replace(e,""),!1;if(t=t.firstChild)do{if(!i(t,e))return!1}while(t=t.next);return!0}function u(t){if(t._listIgnore)t.remove();else if(t=t.firstChild)do{u(t)}while(t=t.next)}function a(t,o,a){var c=t._listLevel||r;c!==r&&(c<r?e&&(e=e.parent.parent):(n=e,e=null)),e&&e.name===o?e.append(t):(n=n||e,e=new pt(o,1),a>1&&e.attr("start",""+a),t.wrap(e)),t.name="li",c>r&&n&&n.lastChild.append(e),r=c,u(t),i(t,/^\u00a0+/),i(t,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),i(t,/^\u00a0+/)}var c=[],s=t.firstChild;while("undefined"!==typeof s&&null!==s)if(c.push(s),s=s.walk(),null!==s)while("undefined"!==typeof s&&s.parent!==t)s=s.walk();for(var l=0;l<c.length;l++)if(t=c[l],"p"===t.name&&t.firstChild){var f=o(t);if(zt(f)){a(t,"ul");continue}if(Ht(f)){var d=/([0-9]+)\./.exec(f),m=1;d&&(m=parseInt(d[1],10)),a(t,"ol",m);continue}if(t._listLevel){a(t,"ul",1);continue}e=null}else n=e,e=null}function Vt(t,e,n,r){var o,i={},u=t.dom.parseStyle(r);return Q.each(u,(function(u,a){switch(a){case"mso-list":o=/\w+ \w+([0-9]+)/i.exec(r),o&&(n._listLevel=parseInt(o[1],10)),/Ignore/i.test(u)&&n.firstChild&&(n._listIgnore=!0,n.firstChild._listIgnore=!0);break;case"horiz-align":a="text-align";break;case"vert-align":a="vertical-align";break;case"font-color":case"mso-foreground":a="color";break;case"mso-background":case"mso-highlight":a="background";break;case"font-weight":case"font-style":return void("normal"!==u&&(i[a]=u));case"mso-element":if(/^(comment|comment-list)$/i.test(u))return void n.remove();break}0!==a.indexOf("mso-comment")?0!==a.indexOf("mso-")&&("all"===Rt.getRetainStyleProps(t)||e&&e[a])&&(i[a]=u):n.remove()})),/(bold)/i.test(i["font-weight"])&&(delete i["font-weight"],n.wrap(new pt("b",1))),/(italic)/i.test(i["font-style"])&&(delete i["font-style"],n.wrap(new pt("i",1))),i=t.dom.serializeStyle(i,n.name),i||null}var Ut=function(t,e){var n,r;n=Rt.getRetainStyleProps(t),n&&(r=Q.makeMap(n.split(/[, ]/))),e=Ft.filter(e,[/<br class="?Apple-interchange-newline"?>/gi,/<b[^>]+id="?docs-internal-[^>]*>/gi,/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(t,e){return e.length>0?e.replace(/./," ").slice(Math.floor(e.length/2)).split("").join(" "):""}]]);var o=Rt.getWordValidElements(t),i=ht({valid_elements:o,valid_children:"-li[p]"});Q.each(i.elements,(function(t){t.attributes.class||(t.attributes.class={},t.attributesOrder.push("class")),t.attributes.style||(t.attributes.style={},t.attributesOrder.push("style"))}));var u=mt({},i);u.addAttributeFilter("style",(function(e){var n,o=e.length;while(o--)n=e[o],n.attr("style",Vt(t,r,n,n.attr("style"))),"span"===n.name&&n.parent&&!n.attributes.length&&n.unwrap()})),u.addAttributeFilter("class",(function(t){var e,n,r=t.length;while(r--)e=t[r],n=e.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(n)&&e.remove(),e.attr("class",null)})),u.addNodeFilter("del",(function(t){var e=t.length;while(e--)t[e].remove()})),u.addNodeFilter("a",(function(t){var e,n,r,o=t.length;while(o--)if(e=t[o],n=e.attr("href"),r=e.attr("name"),n&&-1!==n.indexOf("#_msocom_"))e.remove();else if(n&&0===n.indexOf("file://")&&(n=n.split("#")[1],n&&(n="#"+n)),n||r){if(r&&!/^_?(?:toc|edn|ftn)/i.test(r)){e.unwrap();continue}e.attr({href:n,name:r})}else e.unwrap()}));var a=u.parse(e);return Rt.shouldConvertWordFakeLists(t)&&jt(a),e=gt({validate:t.settings.validate},i).serialize(a),e},Wt=function(t,e){return Rt.shouldUseDefaultFilters(t)?Ut(t,e):e},Gt={preProcess:Wt,isWordContent:Lt},qt=function(t,e){var n=mt({},t.schema);n.addNodeFilter("meta",(function(t){Q.each(t,(function(t){return t.remove()}))}));var r=n.parse(e,{forced_root_block:!1,isRootContent:!0});return gt({validate:t.settings.validate},t.schema).serialize(r)},Xt=function(t,e){return{content:t,cancelled:e}},$t=function(t,e,n,r){var o=t.dom.create("div",{style:"display:none"},e),i=d.firePastePostProcess(t,o,n,r);return Xt(i.node.innerHTML,i.isDefaultPrevented())},Yt=function(t,e,n,r){var o=d.firePastePreProcess(t,e,n,r),i=qt(t,o.content);return t.hasEventListeners("PastePostProcess")&&!o.isDefaultPrevented()?$t(t,i,n,r):Xt(i,o.isDefaultPrevented())},Kt=function(t,e,n){var r=Gt.isWordContent(e),o=r?Gt.preProcess(t,e):e;return Yt(t,o,n,r)},Jt={process:Kt},Qt=function(t,e){return t.insertContent(e,{merge:Rt.shouldMergeFormats(t),paste:!0}),!0},Zt=function(t){return/^https?:\/\/[\w\?\-\/+=.&%@~#]+$/i.test(t)},te=function(t){return Zt(t)&&/.(gif|jpe?g|png)$/.test(t)},ee=function(t,e,n){return t.undoManager.extra((function(){n(t,e)}),(function(){t.insertContent('<img src="'+e+'">')})),!0},ne=function(t,e,n){return t.undoManager.extra((function(){n(t,e)}),(function(){t.execCommand("mceInsertLink",!1,e)})),!0},re=function(t,e,n){return!(!1!==t.selection.isCollapsed()||!Zt(e))&&ne(t,e,n)},oe=function(t,e,n){return!!te(e)&&ee(t,e,n)},ie=function(t,e){Q.each([re,oe,Qt],(function(n){return!0!==n(t,e,Qt)}))},ue=function(t,e){!1===Rt.isSmartPasteEnabled(t)?Qt(t,e):ie(t,e)},ae={isImageUrl:te,isAbsoluteUrl:Zt,insertContent:ue},ce=function(t){return-1!==" \f\t\v".indexOf(t)},se=function(t){return"\n"===t||"\r"===t},le=function(t,e){return e<t.length&&e>=0&&se(t[e])},fe=function(t){var e=I(t,(function(e,n){return ce(n)||" "===n?e.pcIsSpace||""===e.str||e.str.length===t.length-1||le(t,e.str.length+1)?{pcIsSpace:!1,str:e.str+" "}:{pcIsSpace:!0,str:e.str+" "}:{pcIsSpace:se(n),str:e.str+n}}),{pcIsSpace:!1,str:""});return e.str},de=function(t,e,n){var r=n||it.isMarked(e),o=Jt.process(t,it.unmark(e),r);!1===o.cancelled&&ae.insertContent(t,o.content)},me=function(t,e){var n=t.dom.encode(e).replace(/\r\n/g,"\n"),r=fe(n),o=dt.convert(r,t.settings.forced_root_block,t.settings.forced_root_block_attrs);de(t,o,!1)},ge=function(t){var e={},n="data:text/mce-internal,";if(t){if(t.getData){var r=t.getData("Text");r&&r.length>0&&-1===r.indexOf(n)&&(e["text/plain"]=r)}if(t.types)for(var o=0;o<t.types.length;o++){var i=t.types[o];try{e[i]=t.getData(i)}catch(u){e[i]=""}}}return e},pe=function(t,e){var n=ge(e.clipboardData||t.getDoc().dataTransfer);return Ft.isMsEdge()?Q.extend(n,{"text/html":""}):n},he=function(t,e){return e in t&&t[e].length>0},ve=function(t){return he(t,"text/html")||he(t,"text/plain")},be=function(t){var e;return e=t.indexOf(","),-1!==e?t.substr(e+1):null},ye=function(t,e){return!t.images_dataimg_filter||t.images_dataimg_filter(e)},we=function(t,e){var n=e.match(/([\s\S]+?)\.(?:jpeg|jpg|png|gif)$/i);return n?t.dom.encode(n[1]):null},xe=Ft.createIdGenerator("mceclip"),Ce=function(t,n){var r=be(n.uri),o=xe(),i=t.settings.images_reuse_filename&&n.blob.name?we(t,n.blob.name):o,u=new e.Image;if(u.src=n.uri,ye(t.settings,u)){var a=t.editorUpload.blobCache,c=void 0,s=void 0;s=a.findFirst((function(t){return t.base64()===r})),s?c=s:(c=a.create(o,n.blob,r,i),a.add(c)),de(t,'<img src="'+c.blobUri()+'">',!1)}else de(t,'<img src="'+n.uri+'">',!1)},Se=function(t){return"paste"===t.type},ke=function(t){return $(t,(function(t){return G.nu((function(e){var n=t.getAsFile?t.getAsFile():t,r=new window.FileReader;r.onload=function(){e({blob:n,uri:r.result})},r.readAsDataURL(n)}))}))},Oe=function(t){var e=t.items?_(N(t.items),(function(t){return t.getAsFile()})):[],n=t.files?N(t.files):[],r=B(e.length>0?e:n,(function(t){return/^image\/(jpeg|png|gif|bmp)$/.test(t.type)}));return r},Te=function(t,e,n){var r=Se(e)?e.clipboardData:e.dataTransfer;if(t.settings.paste_data_images&&r){var o=Oe(r);if(o.length>0)return e.preventDefault(),ke(o).get((function(e){n&&t.selection.setRng(n),R(e,(function(e){Ce(t,e)}))})),!0}return!1},Ee=function(t){var n=t.clipboardData;return-1!==e.navigator.userAgent.indexOf("Android")&&n&&n.items&&0===n.items.length},De=function(t){return Z.metaKeyPressed(t)&&86===t.keyCode||t.shiftKey&&45===t.keyCode},Ae=function(t,n,r){var o,i=Y();function u(e,r,o,i){var u,a;he(e,"text/html")?u=e["text/html"]:(u=n.getHtml(),i=i||it.isMarked(u),n.isDefaultContent(u)&&(o=!0)),u=Ft.trimHtml(u),n.remove(),a=!1===i&&dt.isPlainText(u),u.length&&!a||(o=!0),o&&(u=he(e,"text/plain")&&a?e["text/plain"]:Ft.innerText(u)),n.isDefaultContent(u)?r||t.windowManager.alert("Please use Ctrl+V/Cmd+V keyboard shortcuts to paste contents."):o?me(t,u):de(t,u,i)}t.on("keydown",(function(r){function u(t){De(t)&&!t.isDefaultPrevented()&&n.remove()}if(De(r)&&!r.isDefaultPrevented()){if(o=r.shiftKey&&86===r.keyCode,o&&K.webkit&&-1!==e.navigator.userAgent.indexOf("Version/"))return;if(r.stopImmediatePropagation(),i.set(r),window.setTimeout((function(){i.clear()}),100),K.ie&&o)return r.preventDefault(),void d.firePaste(t,!0);n.remove(),n.create(),t.once("keyup",u),t.once("paste",(function(){t.off("keyup",u)}))}}));var a=function(){return n.getLastRng()||t.selection.getRng()};t.on("paste",(function(e){var c=i.isSet(),s=pe(t,e),l="text"===r.get()||o,f=he(s,it.internalHtmlMime());o=!1,e.isDefaultPrevented()||Ee(e)?n.remove():ve(s)||!Te(t,e,a())?(c||e.preventDefault(),!K.ie||c&&!e.ieFake||he(s,"text/html")||(n.create(),t.dom.bind(n.getEl(),"paste",(function(t){t.stopPropagation()})),t.getDoc().execCommand("Paste",!1,null),s["text/html"]=n.getHtml()),he(s,"text/html")?(e.preventDefault(),f||(f=it.isMarked(s["text/html"])),u(s,c,l,f)):J.setEditorTimeout(t,(function(){u(s,c,l,f)}),0)):n.remove()}))},_e=function(t,e,n){var r;Ae(t,e,n),t.parser.addNodeFilter("img",(function(e,n,o){var i=function(t){return t.data&&!0===t.data.paste},u=function(t){t.attr("data-mce-object")||r===K.transparentSrc||t.remove()},a=function(t){return 0===t.indexOf("webkit-fake-url")},c=function(t){return 0===t.indexOf("data:")};if(!t.settings.paste_data_images&&i(o)){var s=e.length;while(s--)r=e[s].attr("src"),r&&(a(r)||!t.settings.allow_html_data_urls&&c(r))&&u(e[s])}}))},Re=function(t){return K.ie&&t.inline?e.document.body:t.getBody()},Be=function(t){return Re(t)!==t.getBody()},Ie=function(t,e,n){Be(t)&&t.dom.bind(e,"paste keyup",(function(e){je(t,n)||t.fire("paste")}))},Ne=function(t,e,n){var r,o=t.dom,i=t.getBody();e.set(t.selection.getRng()),r=t.dom.add(Re(t),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},n),(K.ie||K.gecko)&&o.setStyle(r,"left","rtl"===o.getStyle(i,"direction",!0)?65535:-65535),o.bind(r,"beforedeactivate focusin focusout",(function(t){t.stopPropagation()})),Ie(t,r,n),r.focus(),t.selection.select(r,!0)},Pe=function(t,e){if(Me(t)){var n=void 0,r=e.get();while(n=t.dom.get("mcepastebin"))t.dom.remove(n),t.dom.unbind(n);r&&t.selection.setRng(r)}e.set(null)},Me=function(t){return t.dom.get("mcepastebin")},Fe=function(t){var e,n,r,o,i,u=function(e,n){e.appendChild(n),t.dom.remove(n,!0)};for(n=Q.grep(Re(t).childNodes,(function(t){return"mcepastebin"===t.id})),e=n.shift(),Q.each(n,(function(t){u(e,t)})),o=t.dom.select("div[id=mcepastebin]",e),r=o.length-1;r>=0;r--)i=t.dom.create("div"),e.insertBefore(i,o[r]),u(i,o[r]);return e?e.innerHTML:""},Le=function(t){return t.get()},He=function(t,e){return e===t},ze=function(t){return t&&"mcepastebin"===t.id},je=function(t,e){var n=Me(t);return ze(n)&&He(e,n.innerHTML)},Ve=function(t){var e=n(null),r="%MCEPASTEBIN%";return{create:function(){return Ne(t,e,r)},remove:function(){return Pe(t,e)},getEl:function(){return Me(t)},getHtml:function(){return Fe(t)},getLastRng:function(){return Le(e)},isDefault:function(){return je(t,r)},isDefaultContent:function(t){return He(r,t)}}},Ue=function(t,e){var n=Ve(t);return t.on("PreInit",(function(){return _e(t,n,e)})),{pasteFormat:e,pasteHtml:function(e,n){return de(t,e,n)},pasteText:function(e){return me(t,e)},pasteImageData:function(e,n){return Te(t,e,n)},getDataTransferItems:ge,hasHtmlOrText:ve,hasContentType:he}},We=function(){},Ge=function(t){return!1===K.iOS&&void 0!==t&&"function"===typeof t.setData&&!0!==Ft.isMsEdge()},qe=function(t,e,n){if(!Ge(t))return!1;try{return t.clearData(),t.setData("text/html",e),t.setData("text/plain",n),t.setData(it.internalHtmlMime(),e),!0}catch(r){return!1}},Xe=function(t,e,n,r){qe(t.clipboardData,e.html,e.text)?(t.preventDefault(),r()):n(e.html,r)},$e=function(t){return function(e,n){var r=it.mark(e),o=t.dom.create("div",{contenteditable:"false","data-mce-bogus":"all"}),i=t.dom.create("div",{contenteditable:"true"},r);t.dom.setStyles(o,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),o.appendChild(i),t.dom.add(t.getBody(),o);var u=t.selection.getRng();i.focus();var a=t.dom.createRng();a.selectNodeContents(i),t.selection.setRng(a),J.setTimeout((function(){t.selection.setRng(u),o.parentNode.removeChild(o),n()}),0)}},Ye=function(t){return{html:t.selection.getContent({contextual:!0}),text:t.selection.getContent({format:"text"})}},Ke=function(t){return!!t.dom.getParent(t.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",t.getBody())},Je=function(t){return!t.selection.isCollapsed()||Ke(t)},Qe=function(t){return function(e){Je(t)&&Xe(e,Ye(t),$e(t),(function(){if(K.browser.isChrome()){var e=t.selection.getRng();J.setEditorTimeout(t,(function(){t.selection.setRng(e),t.execCommand("Delete")}),0)}else t.execCommand("Delete")}))}},Ze=function(t){return function(e){Je(t)&&Xe(e,Ye(t),$e(t),We)}},tn=function(t){t.on("cut",Qe(t)),t.on("copy",Ze(t))},en={register:tn},nn=tinymce.util.Tools.resolve("tinymce.dom.RangeUtils"),rn=function(t,e){return nn.getCaretRangeFromPoint(e.clientX,e.clientY,t.getDoc())},on=function(t){var e=t["text/plain"];return!!e&&0===e.indexOf("file://")},un=function(t,e){t.focus(),t.selection.setRng(e)},an=function(t,e,n){Rt.shouldBlockDrop(t)&&t.on("dragend dragover draggesture dragdrop drop drag",(function(t){t.preventDefault(),t.stopPropagation()})),Rt.shouldPasteDataImages(t)||t.on("drop",(function(t){var e=t.dataTransfer;e&&e.files&&e.files.length>0&&t.preventDefault()})),t.on("drop",(function(r){var o,i;if(i=rn(t,r),!r.isDefaultPrevented()&&!n.get()){o=e.getDataTransferItems(r.dataTransfer);var u=e.hasContentType(o,it.internalHtmlMime());if((e.hasHtmlOrText(o)&&!on(o)||!e.pasteImageData(r,i))&&i&&Rt.shouldFilterDrop(t)){var a=o["mce-internal"]||o["text/html"]||o["text/plain"];a&&(r.preventDefault(),J.setEditorTimeout(t,(function(){t.undoManager.transact((function(){o["mce-internal"]&&t.execCommand("Delete"),un(t,i),a=Ft.trimHtml(a),o["text/html"]?e.pasteHtml(a,u):e.pasteText(a)}))})))}}})),t.on("dragstart",(function(t){n.set(!0)})),t.on("dragover dragend",(function(e){Rt.shouldPasteDataImages(t)&&!1===n.get()&&(e.preventDefault(),un(t,rn(t,e))),"dragend"===e.type&&n.set(!1)}))},cn={setup:an},sn=function(t){var e=t.plugins.paste,n=Rt.getPreProcess(t);n&&t.on("PastePreProcess",(function(t){n.call(e,e,t)}));var r=Rt.getPostProcess(t);r&&t.on("PastePostProcess",(function(t){r.call(e,e,t)}))},ln={setup:sn};function fn(t,e){t.on("PastePreProcess",(function(n){n.content=e(t,n.content,n.internal,n.wordContent)}))}function dn(t,e){t.on("PastePostProcess",(function(n){e(t,n.node)}))}function mn(t,e){if(!Gt.isWordContent(e))return e;var n=[];Q.each(t.schema.getBlockElements(),(function(t,e){n.push(e)}));var r=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+n.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return e=Ft.filter(e,[[r,"$1"]]),e=Ft.filter(e,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]),e}function gn(t,e,n,r){if(r||n)return e;var o,i=Rt.getWebkitStyles(t);if(!1===Rt.shouldRemoveWebKitStyles(t)||"all"===i)return e;if(i&&(o=i.split(/[, ]/)),o){var u=t.dom,a=t.selection.getNode();e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(function(t,e,n,r){var i=u.parseStyle(u.decode(n)),c={};if("none"===o)return e+r;for(var s=0;s<o.length;s++){var l=i[o[s]],f=u.getStyle(a,o[s],!0);/color/.test(o[s])&&(l=u.toHex(l),f=u.toHex(f)),f!==l&&(c[o[s]]=l)}return c=u.serializeStyle(c,"span"),c?e+' style="'+c+'"'+r:e+r}))}else e=e.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return e=e.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(function(t,e,n,r){return e+' style="'+n+'"'+r})),e}function pn(t,e){t.$("a",e).find("font,u").each((function(e,n){t.dom.remove(n,!0)}))}var hn=function(t){K.webkit&&fn(t,gn),K.ie&&(fn(t,mn),dn(t,pn))},vn={setup:hn},bn=function(t,e){return function(n){n.setActive("text"===e.pasteFormat.get());var r=function(t){return n.setActive(t.state)};return t.on("PastePlainTextToggle",r),function(){return t.off("PastePlainTextToggle",r)}}},yn=function(t,e){t.ui.registry.addToggleButton("pastetext",{active:!1,icon:"paste-text",tooltip:"Paste as text",onAction:function(){return t.execCommand("mceTogglePlainTextPaste")},onSetup:bn(t,e)}),t.ui.registry.addToggleMenuItem("pastetext",{text:"Paste as text",onAction:function(){return t.execCommand("mceTogglePlainTextPaste")},onSetup:bn(t,e)})},wn={register:yn};function xn(){r.add("paste",(function(t){if(!1===i.hasProPlugin(t)){var e=n(!1),r=n(Rt.isPasteAsTextEnabled(t)?"text":"html"),o=Ue(t,r),u=vn.setup(t);return wn.register(t,o),h.register(t,o),ln.setup(t),en.register(t),cn.setup(t,o,e),a.get(o,u)}}))}xn()})(window)}).call(this,n("c8ba"))},"84ec":function(t,e,n){n("2401")},"94ce":function(t,e){(function(t){"use strict";var e=function(t){var n=t,r=function(){return n},o=function(t){n=t},i=function(){return e(r())};return{get:r,set:o,clone:i}},n=function(){},r=function(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];return t(e.apply(null,n))}},o=function(t){return function(){return t}},i=function(t){return t};function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}}var a=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return!t.apply(null,e)}},c=function(t){return function(){throw new Error(t)}},s=o(!1),l=o(!0),f=function(){return d},d=function(){var t=function(t){return t.isNone()},e=function(t){return t()},r=function(t){return t},i={fold:function(t,e){return t()},is:s,isSome:s,isNone:l,getOr:r,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:r,orThunk:e,map:f,each:n,bind:f,exists:s,forall:l,filter:f,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(i),i}(),m=function(t){var e=o(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:l,isNone:s,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return m(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:d},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(s,(function(e){return n(t,e)}))}};return i},g=function(t){return null===t||void 0===t?d:m(t)},p={some:m,none:f,from:g},h=tinymce.util.Tools.resolve("tinymce.PluginManager"),v=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},b=function(t){return function(e){return v(e)===t}},y=b("string"),w=b("array"),x=b("boolean"),C=b("function"),S=b("number"),k=Array.prototype.slice,O=Array.prototype.indexOf,T=Array.prototype.push,E=function(t,e){return O.call(t,e)},D=function(t,e){return E(t,e)>-1},A=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return!0}return!1},_=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r},R=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},B=function(t,e){for(var n=t.length-1;n>=0;n--){var r=t[n];e(r,n)}},I=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r)&&n.push(i)}return n},N=function(t,e,n){return B(t,(function(t){n=e(n,t)})),n},P=function(t,e,n){return R(t,(function(t){n=e(n,t)})),n},M=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return p.some(o)}return p.none()},F=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n))return p.some(n)}return p.none()},L=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!w(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);T.apply(e,t[n])}return e},H=function(t,e){var n=_(t,e);return L(n)},z=function(t,e){for(var n=0,r=t.length;n<r;++n){var o=t[n];if(!0!==e(o,n))return!1}return!0},j=function(t){var e=k.call(t,0);return e.reverse(),e},V=function(t){return 0===t.length?p.none():p.some(t[t.length-1])},U=(C(Array.from)&&Array.from,Object.keys),W=Object.hasOwnProperty,G=function(t,e){for(var n=U(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];e(u,i)}},q=function(t,e){return X(t,(function(t,n){return{k:n,v:e(t,n)}}))},X=function(t,e){var n={};return G(t,(function(t,r){var o=e(t,r);n[o.k]=o.v})),n},$=function(t,e){return Y(t,e)?p.from(t[e]):p.none()},Y=function(t,e){return W.call(t,e)},K=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return R(t,(function(t,n){r[t]=o(e[n])})),r}},J=function(t){return t.slice(0).sort()},Q=function(t,e){throw new Error("All required keys ("+J(t).join(", ")+") were not specified. Specified keys were: "+J(e).join(", ")+".")},Z=function(t){throw new Error("Unsupported keys for object: "+J(t).join(", "))},tt=function(t,e){if(!w(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");R(e,(function(e){if(!y(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")}))},et=function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+J(t).join(", ")+") were not.")},nt=function(t){var e=J(t),n=M(e,(function(t,n){return n<e.length-1&&t===e[n+1]}));n.each((function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")}))},rt=function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return tt("required",t),tt("optional",e),nt(n),function(r){var i=U(r),u=z(t,(function(t){return D(i,t)}));u||Q(t,i);var a=I(i,(function(t){return!D(n,t)}));a.length>0&&Z(a);var c={};return R(t,(function(t){c[t]=o(r[t])})),R(e,(function(t){c[t]=o(Object.prototype.hasOwnProperty.call(r,t)?p.some(r[t]):p.none())})),c}},ot=(t.Node.ATTRIBUTE_NODE,t.Node.CDATA_SECTION_NODE,t.Node.COMMENT_NODE),it=t.Node.DOCUMENT_NODE,ut=(t.Node.DOCUMENT_TYPE_NODE,t.Node.DOCUMENT_FRAGMENT_NODE,t.Node.ELEMENT_NODE),at=t.Node.TEXT_NODE,ct=(t.Node.PROCESSING_INSTRUCTION_NODE,t.Node.ENTITY_REFERENCE_NODE,t.Node.ENTITY_NODE,t.Node.NOTATION_NODE,"undefined"!==typeof t.window?t.window:Function("return this;")(),function(t){var e=t.dom().nodeName;return e.toLowerCase()}),st=function(t){return t.dom().nodeType},lt=function(t){return function(e){return st(e)===t}},ft=function(t){return st(t)===ot||"#comment"===ct(t)},dt=lt(ut),mt=lt(at),gt=function(e,n,r){if(!(y(r)||x(r)||S(r)))throw t.console.error("Invalid call to Attr.set. Key ",n,":: Value ",r,":: Element ",e),new Error("Attribute value was not simple");e.setAttribute(n,r+"")},pt=function(t,e,n){gt(t.dom(),e,n)},ht=function(t,e){var n=t.dom();G(e,(function(t,e){gt(n,e,t)}))},vt=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},bt=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},yt=function(t,e){t.dom().removeAttribute(e)},wt=function(t){return P(t.dom().attributes,(function(t,e){return t[e.name]=e.value,t}),{})},xt=function(t,e,n){if(""===e)return!0;if(t.length<e.length)return!1;var r=t.substr(n,n+e.length);return r===e},Ct=function(t,e){return-1!==t.indexOf(e)},St=function(t,e){return xt(t,e,0)},kt=function(t,e){return xt(t,e,t.length-e.length)},Ot=function(t){return t.replace(/^\s+|\s+$/g,"")},Tt=function(t){return void 0!==t.style&&C(t.style.getPropertyValue)},Et=function(t){var e,n=!1;return function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return n||(n=!0,e=t.apply(null,r)),e}},Dt=function(e,n){var r=n||t.document,o=r.createElement("div");if(o.innerHTML=e,!o.hasChildNodes()||o.childNodes.length>1)throw t.console.error("HTML does not have a single root node",e),new Error("HTML must have a single root node");return Rt(o.childNodes[0])},At=function(e,n){var r=n||t.document,o=r.createElement(e);return Rt(o)},_t=function(e,n){var r=n||t.document,o=r.createTextNode(e);return Rt(o)},Rt=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:o(t)}},Bt=function(t,e,n){var r=t.dom();return p.from(r.elementFromPoint(e,n)).map(Rt)},It={fromHtml:Dt,fromTag:At,fromText:_t,fromDom:Rt,fromPoint:Bt},Nt=function(t){var e=mt(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)},Pt=Et((function(){return Mt(It.fromDom(t.document))})),Mt=function(t){var e=t.dom().body;if(null===e||void 0===e)throw new Error("Body is not available yet");return It.fromDom(e)},Ft=function(e,n,r){if(!y(r))throw t.console.error("Invalid call to CSS.set. Property ",n,":: Value ",r,":: Element ",e),new Error("CSS value must be a string: "+r);Tt(e)&&e.style.setProperty(n,r)},Lt=function(t,e){Tt(t)&&t.style.removeProperty(e)},Ht=function(t,e,n){var r=t.dom();Ft(r,e,n)},zt=function(t,e){var n=t.dom();G(e,(function(t,e){Ft(n,e,t)}))},jt=function(e,n){var r=e.dom(),o=t.window.getComputedStyle(r),i=o.getPropertyValue(n),u=""!==i||Nt(e)?i:Vt(r,n);return null===u?void 0:u},Vt=function(t,e){return Tt(t)?t.style.getPropertyValue(e):""},Ut=function(t,e){var n=t.dom(),r=Vt(n,e);return p.from(r).filter((function(t){return t.length>0}))},Wt=function(t,e){var n=t.dom();Lt(n,e),bt(t,"style")&&""===Ot(vt(t,"style"))&&yt(t,"style")},Gt=function(t,e){var n=t.dom(),r=e.dom();Tt(n)&&Tt(r)&&(r.style.cssText=n.style.cssText)},qt=function(t,e,n){return 0!==(t.compareDocumentPosition(e)&n)},Xt=function(e,n){return qt(e,n,t.Node.DOCUMENT_POSITION_PRECEDING)},$t=function(e,n){return qt(e,n,t.Node.DOCUMENT_POSITION_CONTAINED_BY)},Yt={documentPositionPreceding:Xt,documentPositionContainedBy:$t},Kt=function(){return Kt=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Kt.apply(this,arguments)},Jt=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}},Qt=function(t,e){var n=Jt(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return ee(r(1),r(2))},Zt=function(t,e){var n=String(e).toLowerCase();return 0===t.length?te():Qt(t,n)},te=function(){return ee(0,0)},ee=function(t,e){return{major:t,minor:e}},ne={nu:ee,detect:Zt,unknown:te},re="Edge",oe="Chrome",ie="IE",ue="Opera",ae="Firefox",ce="Safari",se=function(t,e){return function(){return e===t}},le=function(){return fe({current:void 0,version:ne.unknown()})},fe=function(t){var e=t.current,n=t.version;return{current:e,version:n,isEdge:se(re,e),isChrome:se(oe,e),isIE:se(ie,e),isOpera:se(ue,e),isFirefox:se(ae,e),isSafari:se(ce,e)}},de={unknown:le,nu:fe,edge:o(re),chrome:o(oe),ie:o(ie),opera:o(ue),firefox:o(ae),safari:o(ce)},me="Windows",ge="iOS",pe="Android",he="Linux",ve="OSX",be="Solaris",ye="FreeBSD",we=function(t,e){return function(){return e===t}},xe=function(){return Ce({current:void 0,version:ne.unknown()})},Ce=function(t){var e=t.current,n=t.version;return{current:e,version:n,isWindows:we(me,e),isiOS:we(ge,e),isAndroid:we(pe,e),isOSX:we(ve,e),isLinux:we(he,e),isSolaris:we(be,e),isFreeBSD:we(ye,e)}},Se={unknown:xe,nu:Ce,windows:o(me),ios:o(ge),android:o(pe),linux:o(he),osx:o(ve),solaris:o(be),freebsd:o(ye)},ke=function(t,e,n,r){var i=t.isiOS()&&!0===/ipad/i.test(n),u=t.isiOS()&&!i,a=t.isiOS()||t.isAndroid(),c=a||r("(pointer:coarse)"),s=i||!u&&a&&r("(min-device-width:768px)"),l=u||a&&!s,f=e.isSafari()&&t.isiOS()&&!1===/safari/i.test(n),d=!l&&!s&&!f;return{isiPad:o(i),isiPhone:o(u),isTablet:o(s),isPhone:o(l),isTouch:o(c),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:o(f),isDesktop:o(d)}},Oe=function(t,e){var n=String(e).toLowerCase();return M(t,(function(t){return t.search(n)}))},Te=function(t,e){return Oe(t,e).map((function(t){var n=ne.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},Ee=function(t,e){return Oe(t,e).map((function(t){var n=ne.detect(t.versionRegexes,e);return{current:t.name,version:n}}))},De={detectBrowser:Te,detectOs:Ee},Ae=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,_e=function(t){return function(e){return Ct(e,t)}},Re=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Ct(t,"edge/")&&Ct(t,"chrome")&&Ct(t,"safari")&&Ct(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Ae],search:function(t){return Ct(t,"chrome")&&!Ct(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Ct(t,"msie")||Ct(t,"trident")}},{name:"Opera",versionRegexes:[Ae,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:_e("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:_e("firefox")},{name:"Safari",versionRegexes:[Ae,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Ct(t,"safari")||Ct(t,"mobile/"))&&Ct(t,"applewebkit")}}],Be=[{name:"Windows",search:_e("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Ct(t,"iphone")||Ct(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:_e("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:_e("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:_e("linux"),versionRegexes:[]},{name:"Solaris",search:_e("sunos"),versionRegexes:[]},{name:"FreeBSD",search:_e("freebsd"),versionRegexes:[]}],Ie={browsers:o(Re),oses:o(Be)},Ne=function(t,e){var n=Ie.browsers(),r=Ie.oses(),o=De.detectBrowser(n,t).fold(de.unknown,de.nu),i=De.detectOs(r,t).fold(Se.unknown,Se.nu),u=ke(i,o,t,e);return{browser:o,os:i,deviceType:u}},Pe={detect:Ne},Me=function(e){return t.window.matchMedia(e).matches},Fe=e(Pe.detect(t.navigator.userAgent,Me)),Le=function(){return Fe.get()},He=ut,ze=it,je=function(t,e){var n=t.dom();if(n.nodeType!==He)return!1;var r=n;if(void 0!==r.matches)return r.matches(e);if(void 0!==r.msMatchesSelector)return r.msMatchesSelector(e);if(void 0!==r.webkitMatchesSelector)return r.webkitMatchesSelector(e);if(void 0!==r.mozMatchesSelector)return r.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},Ve=function(t){return t.nodeType!==He&&t.nodeType!==ze||0===t.childElementCount},Ue=function(e,n){var r=void 0===n?t.document:n.dom();return Ve(r)?[]:_(r.querySelectorAll(e),It.fromDom)},We=function(e,n){var r=void 0===n?t.document:n.dom();return Ve(r)?p.none():p.from(r.querySelector(e)).map(It.fromDom)},Ge=function(t,e){return t.dom()===e.dom()},qe=function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Xe=function(t,e){return Yt.documentPositionContainedBy(t.dom(),e.dom())},$e=Le().browser,Ye=$e.isIE()?Xe:qe,Ke=je,Je=function(t){return It.fromDom(t.dom().ownerDocument)},Qe=function(t){return It.fromDom(t.dom().ownerDocument.defaultView)},Ze=function(t){return p.from(t.dom().parentNode).map(It.fromDom)},tn=function(t,e){var n=C(e)?e:s,r=t.dom(),o=[];while(null!==r.parentNode&&void 0!==r.parentNode){var i=r.parentNode,u=It.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},en=function(t){return p.from(t.dom().previousSibling).map(It.fromDom)},nn=function(t){return p.from(t.dom().nextSibling).map(It.fromDom)},rn=function(t){return _(t.dom().childNodes,It.fromDom)},on=function(t,e){var n=t.dom().childNodes;return p.from(n[e]).map(It.fromDom)},un=function(t){return on(t,0)},an=(K("element","offset"),function(t,e){var n=Ze(t);n.each((function(n){n.dom().insertBefore(e.dom(),t.dom())}))}),cn=function(t,e){var n=nn(t);n.fold((function(){var n=Ze(t);n.each((function(t){ln(t,e)}))}),(function(t){an(t,e)}))},sn=function(t,e){var n=un(t);n.fold((function(){ln(t,e)}),(function(n){t.dom().insertBefore(e.dom(),n.dom())}))},ln=function(t,e){t.dom().appendChild(e.dom())},fn=function(t,e){an(t,e),ln(e,t)},dn=function(t,e){R(e,(function(e){an(t,e)}))},mn=function(t,e){R(e,(function(n,r){var o=0===r?t:e[r-1];cn(o,n)}))},gn=function(t,e){R(e,(function(e){ln(t,e)}))},pn=function(t){t.dom().textContent="",R(rn(t),(function(t){hn(t)}))},hn=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},vn=function(t){var e=rn(t);e.length>0&&dn(t,e),hn(t)},bn=(K("width","height"),K("width","height"),K("rows","columns")),yn=K("row","column"),wn=(K("x","y"),K("element","rowspan","colspan")),xn=K("element","rowspan","colspan","isNew"),Cn=K("element","rowspan","colspan","row","column"),Sn=K("element","cells","section"),kn=K("element","isNew"),On=K("element","cells","section","isNew"),Tn=K("cells","section"),En=K("details","section"),Dn=K("startRow","startCol","finishRow","finishCol"),An=function(t,e,n){return I(tn(t,n),e)},_n=function(t,e){return I(rn(t),e)},Rn=function(t,e){var n=[];return R(rn(t),(function(t){e(t)&&(n=n.concat([t])),n=n.concat(Rn(t,e))})),n},Bn=function(t,e,n){return An(t,(function(t){return je(t,e)}),n)},In=function(t,e){return _n(t,(function(t){return je(t,e)}))},Nn=function(t,e){return Ue(e,t)};function Pn(t,e,n,r,o){return t(n,r)?p.some(n):C(o)&&o(n)?p.none():e(n,r,o)}var Mn=function(t,e,n){var r=t.dom(),i=C(n)?n:o(!1);while(r.parentNode){r=r.parentNode;var u=It.fromDom(r);if(e(u))return p.some(u);if(i(u))break}return p.none()},Fn=function(t,e,n){var r=function(t,e){return e(t)};return Pn(r,Mn,t,e,n)},Ln=function(t,e){var n=function(t){return e(It.fromDom(t))},r=M(t.dom().childNodes,n);return r.map(It.fromDom)},Hn=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){var o=It.fromDom(t.childNodes[r]);if(e(o))return p.some(o);var i=n(t.childNodes[r]);if(i.isSome())return i}return p.none()};return n(t.dom())},zn=function(t,e,n){return Mn(t,(function(t){return je(t,e)}),n)},jn=function(t,e){return Ln(t,(function(t){return je(t,e)}))},Vn=function(t,e){return We(e,t)},Un=function(t,e,n){return Pn(je,zn,t,e,n)},Wn=function(t,e){return Gn(t,e,o(!0))},Gn=function(t,e,n){return H(rn(t),(function(t){return je(t,e)?n(t)?[t]:[]:Gn(t,e,n)}))},qn={firstLayer:Wn,filterFirstLayer:Gn},Xn=function(t,e,n){if(void 0===n&&(n=s),n(e))return p.none();if(D(t,ct(e)))return p.some(e);var r=function(t){return je(t,"table")||n(t)};return zn(e,t.join(","),r)},$n=function(t,e){return Xn(["td","th"],t,e)},Yn=function(t){return qn.firstLayer(t,"th,td")},Kn=function(t,e){return Xn(["caption","tr","tbody","tfoot","thead"],t,e)},Jn=function(t,e){return Ze(e).map((function(e){return In(e,t)}))},Qn=u(Jn,"th,td"),Zn=u(Jn,"tr"),tr=function(t){return Vn(t,"th,td")},er=function(t,e){return Un(t,"table",e)},nr=function(t,e){return Xn(["tr"],t,e)},rr=function(t){return qn.firstLayer(t,"tr")},or=function(t,e){return parseInt(vt(t,e),10)},ir=function(t,e,n){var r=or(t,e),o=or(t,n);return bn(r,o)},ur={cell:$n,firstCell:tr,cells:Yn,neighbourCells:Qn,table:er,row:nr,rows:rr,notCell:Kn,neighbourRows:Zn,attr:or,grid:ir},ar=function(t){var e=ur.rows(t);return _(e,(function(t){var e=t,n=Ze(e),r=n.map((function(t){var e=ct(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"})).getOr("tbody"),o=_(ur.cells(t),(function(t){var e=bt(t,"rowspan")?parseInt(vt(t,"rowspan"),10):1,n=bt(t,"colspan")?parseInt(vt(t,"colspan"),10):1;return wn(t,e,n)}));return Sn(e,o,r)}))},cr=function(t,e){return _(t,(function(t){var n=_(ur.cells(t),(function(t){var e=bt(t,"rowspan")?parseInt(vt(t,"rowspan"),10):1,n=bt(t,"colspan")?parseInt(vt(t,"colspan"),10):1;return wn(t,e,n)}));return Sn(t,n,e.section())}))},sr={fromTable:ar,fromPastedRows:cr},lr=function(t,e){return t+","+e},fr=function(t,e,n){var r=t.access()[lr(e,n)];return void 0!==r?p.some(r):p.none()},dr=function(t,e,n){var r=mr(t,(function(t){return n(e,t.element())}));return r.length>0?p.some(r[0]):p.none()},mr=function(t,e){var n=H(t.all(),(function(t){return t.cells()}));return I(n,e)},gr=function(t){var e={},n=[],r=t.length,i=0;R(t,(function(t,r){var o=[];R(t.cells(),(function(t){var n=0;while(void 0!==e[lr(r,n)])n++;for(var u=Cn(t.element(),t.rowspan(),t.colspan(),r,n),a=0;a<t.colspan();a++)for(var c=0;c<t.rowspan();c++){var s=r+c,l=n+a,f=lr(s,l);e[f]=u,i=Math.max(i,l+1)}o.push(u)})),n.push(Sn(t.element(),o,t.section()))}));var u=bn(r,i);return{grid:o(u),access:o(e),all:o(n)}},pr=function(t){var e=_(t.all(),(function(t){return t.cells()}));return L(e)},hr={generate:gr,getAt:fr,findItem:dr,filterItems:mr,justCells:pr},vr=K("minRow","minCol","maxRow","maxCol"),br=function(t,e){var n=t.grid().columns(),r=t.grid().rows(),o=r,i=n,u=0,a=0;return G(t.access(),(function(t){if(e(t)){var n=t.row(),r=n+t.rowspan()-1,c=t.column(),s=c+t.colspan()-1;n<o?o=n:r>u&&(u=r),c<i?i=c:s>a&&(a=s)}})),vr(o,i,u,a)},yr=function(t,e,n){var r=t[n].element(),o=It.fromTag("td");ln(o,It.fromTag("br"));var i=e?ln:sn;i(r,o)},wr=function(t,e,n,r){for(var o=e.grid().columns(),i=e.grid().rows(),u=0;u<i;u++)for(var a=!1,c=0;c<o;c++)if(!(u<n.minRow()||u>n.maxRow()||c<n.minCol()||c>n.maxCol())){var s=hr.getAt(e,u,c).filter(r).isNone();s?yr(t,a,u):a=!0}},xr=function(t,e){var n=I(qn.firstLayer(t,"tr"),(function(t){return 0===t.dom().childElementCount}));R(n,hn),e.minCol()!==e.maxCol()&&e.minRow()!==e.maxRow()||R(qn.firstLayer(t,"th,td"),(function(t){yt(t,"rowspan"),yt(t,"colspan")})),yt(t,"width"),yt(t,"height"),Wt(t,"width"),Wt(t,"height")},Cr=function(t,e){var n=function(t){return je(t.element(),e)},r=sr.fromTable(t),o=hr.generate(r),i=br(o,n),u="th:not("+e+"),td:not("+e+")",a=qn.filterFirstLayer(t,"th,td",(function(t){return je(t,u)}));return R(a,hn),wr(r,o,i,n),xr(t,i),t},Sr={extract:Cr};function kr(t,e){var n=function(n){if(!t(n))throw new Error("Can only get "+e+" value of a "+e+" node");return r(n).getOr("")},r=function(e){return t(e)?p.from(e.dom().nodeValue):p.none()},o=function(n,r){if(!t(n))throw new Error("Can only set raw "+e+" value of a "+e+" node");n.dom().nodeValue=r};return{get:n,getOption:r,set:o}}var Or=kr(mt,"text"),Tr=function(t){return Or.get(t)},Er=function(t){return Or.getOption(t)},Dr=function(t,e){Or.set(t,e)},Ar=function(t){return"img"===ct(t)?1:Er(t).fold((function(){return rn(t).length}),(function(t){return t.length}))},_r=" ",Rr=function(t){return Er(t).filter((function(t){return 0!==t.trim().length||t.indexOf(_r)>-1})).isSome()},Br=["img","br"],Ir=function(t){var e=Rr(t);return e||D(Br,ct(t))},Nr=function(t){return Hn(t,Ir)},Pr=function(t){return Mr(t,Ir)},Mr=function(t,e){var n=function(t){for(var r=rn(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return p.some(i);var u=n(i);if(u.isSome())return u}return p.none()};return n(t)},Fr=function(t,e){return It.fromDom(t.dom().cloneNode(e))},Lr=function(t){return Fr(t,!1)},Hr=function(t){return Fr(t,!0)},zr=function(t,e){var n=It.fromTag(e),r=wt(t);return ht(n,r),n},jr=function(t,e){var n=zr(t,e),r=rn(Hr(t));return gn(n,r),n},Vr=function(){var t=It.fromTag("td");return ln(t,It.fromTag("br")),t},Ur=function(t,e,n){var r=jr(t,e);return G(n,(function(t,e){null===t?yt(r,e):pt(r,e,t)})),r},Wr=function(t){return t},Gr=function(t){return function(){return It.fromTag("tr",t.dom())}},qr=function(t,e,n){var r=Nr(t);return r.map((function(r){var o=n.join(","),i=Bn(r,o,(function(e){return Ge(e,t)}));return N(i,(function(t,e){var n=Lr(e);return yt(n,"contenteditable"),ln(t,n),n}),e)})).getOr(e)},Xr=function(t,e,n){var r=function(e){var r=Je(e.element()),o=It.fromTag(ct(e.element()),r.dom()),i=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),u=i.length>0?qr(e.element(),o,i):o;return ln(u,It.fromTag("br")),Gt(e.element(),o),Wt(o,"height"),1!==e.colspan()&&Wt(e.element(),"width"),t(e.element(),o),o};return{row:Gr(e),cell:r,replace:Ur,gap:Vr}},$r=function(t){return{row:Gr(t),cell:Vr,replace:Wr,gap:Vr}},Yr={cellOperations:Xr,paste:$r},Kr=function(e,n){var r=n||t.document,o=r.createElement("div");return o.innerHTML=e,rn(It.fromDom(o))},Jr=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},Qr=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},Zr=function(t,e){for(var n=!0,r=u(Qr,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&hr.getAt(t,o,i).exists(r);return n?p.some(e):p.none()},to={inSelection:Jr,isWithin:Qr,isRectangular:Zr},eo=function(t,e){return Dn(Math.min(t.row(),e.row()),Math.min(t.column(),e.column()),Math.max(t.row()+t.rowspan()-1,e.row()+e.rowspan()-1),Math.max(t.column()+t.colspan()-1,e.column()+e.colspan()-1))},no=function(t,e,n){var r=hr.findItem(t,e,Ge),o=hr.findItem(t,n,Ge);return r.bind((function(t){return o.map((function(e){return eo(t,e)}))}))},ro=function(t,e,n){return no(t,e,n).bind((function(e){return to.isRectangular(t,e)}))},oo={getAnyBox:no,getBox:ro},io=function(t,e,n,r){return hr.findItem(t,e,Ge).bind((function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column(),u=hr.getAt(t,o+n,i+r);return u.map((function(t){return t.element()}))}))},uo=function(t,e,n){return oo.getAnyBox(t,e,n).map((function(e){var n=hr.filterItems(t,u(to.inSelection,e));return _(n,(function(t){return t.element()}))}))},ao=function(t,e){var n=function(t,e){return Ye(e,t)};return hr.findItem(t,e,n).map((function(t){return t.element()}))},co={moveBy:io,intercepts:uo,parentCell:ao},so=function(t,e,n){return ur.table(t).bind((function(r){var o=go(r);return co.moveBy(o,t,e,n)}))},lo=function(t,e,n){var r=go(t);return co.intercepts(r,e,n)},fo=function(t,e,n,r,o){var i=go(t),u=Ge(t,n)?p.some(e):co.parentCell(i,e),a=Ge(t,o)?p.some(r):co.parentCell(i,r);return u.bind((function(t){return a.bind((function(e){return co.intercepts(i,t,e)}))}))},mo=function(t,e,n){var r=go(t);return oo.getBox(r,e,n)},go=function(t){var e=sr.fromTable(t);return hr.generate(e)},po={moveBy:so,intercepts:lo,nestedIntercepts:fo,getBox:mo},ho=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function vo(){var t=function(t){return It.fromDom(t.dom().cloneNode(!1))},e=function(t){return t.dom().ownerDocument},n=function(t){return!!dt(t)&&("body"===ct(t)||D(ho,ct(t)))},r=function(t){return!!dt(t)&&D(["br","img","hr","input"],ct(t))},i=function(t,e){return t.dom().compareDocumentPosition(e.dom())},u=function(t,e){var n=wt(t);ht(e,n)};return{up:o({selector:zn,closest:Un,predicate:Mn,all:tn}),down:o({selector:Nn,predicate:Rn}),styles:o({get:jt,getRaw:Ut,set:Ht,remove:Wt}),attrs:o({get:vt,set:pt,remove:yt,copyTo:u}),insert:o({before:an,after:cn,afterAll:mn,append:ln,appendAll:gn,prepend:sn,wrap:fn}),remove:o({unwrap:vn,remove:hn}),create:o({nu:It.fromTag,clone:t,text:It.fromText}),query:o({comparePosition:i,prevSibling:en,nextSibling:nn}),property:o({children:rn,name:ct,parent:Ze,document:e,isText:mt,isComment:ft,isElement:dt,getText:Tr,setText:Dr,isBoundary:n,isEmptyTag:r}),eq:Ge,is:Ke}}var bo=K("left","right"),yo=K("first","second","splits"),wo=function(t,e,n){var r=t.property().children(e),i=F(r,u(t.eq,n));return i.map((function(t){return{before:o(r.slice(0,t)),after:o(r.slice(t+1))}}))},xo=function(t,e,n){return wo(t,e,n).map((function(n){var r=t.create().clone(e);return t.insert().appendAll(r,n.after()),t.insert().after(e,r),bo(e,r)}))},Co=function(t,e,n){return wo(t,e,n).map((function(r){var o=t.create().clone(e);return t.insert().appendAll(o,r.before().concat([n])),t.insert().appendAll(e,r.after()),t.insert().before(e,o),bo(o,e)}))},So=function(t,e,n,r){var o=function(e,i,u){var a=yo(e,p.none(),u);return n(e)?yo(e,i,u):t.property().parent(e).bind((function(i){return r(t,i,e).map((function(t){var e=[{first:t.left,second:t.right}],r=n(i)?i:t.left();return o(r,p.some(t.right()),u.concat(e))}))})).getOr(a)};return o(e,p.none(),[])},ko=function(t,e,n,r){var o=n[0],i=n.slice(1);return r(t,e,o,i)},Oo=function(t,e,n){return n.length>0?ko(t,e,n,To):p.none()},To=function(t,e,n,r){var o=e(t,n);return N(r,(function(n,r){var o=e(t,r);return Eo(t,n,o)}),o)},Eo=function(t,e,n){return e.bind((function(e){return n.filter(u(t.eq,e))}))},Do=function(t,e){return u(t.eq,e)},Ao=function(t,e,n,r){var o=t.property().children(e);if(t.eq(e,n[0]))return p.some([n[0]]);if(t.eq(e,r[0]))return p.some([r[0]]);var i=function(n){var r=j(n),i=F(r,Do(t,e)).getOr(-1),u=i<r.length-1?r[i+1]:r[i];return F(o,Do(t,u))},u=i(n),a=i(r);return u.bind((function(t){return a.map((function(e){var n=Math.min(t,e),r=Math.max(t,e);return o.slice(n,r+1)}))}))},_o=function(t,e,n,r){void 0===r&&(r=s);var i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),a=function(t){var e=F(t,r);return e.fold((function(){return t}),(function(e){return t.slice(0,e+1)}))},c=a(i),l=a(u),f=M(c,(function(e){return A(l,Do(t,e))}));return{firstpath:o(c),secondpath:o(l),shared:o(f)}},Ro=function(t,e,n){var r=_o(t,e,n);return r.shared().bind((function(e){return Ao(t,e,r.firstpath(),r.secondpath())}))},Bo={subset:Ro,ancestors:_o},Io=Oo,No=Bo.subset,Po=Bo.ancestors,Mo=Co,Fo=xo,Lo=So,Ho={sharedOne:Io,subset:No,ancestors:Po,breakToLeft:Mo,breakToRight:Fo,breakPath:Lo},zo=vo(),jo=function(t,e){return Ho.sharedOne(zo,(function(e,n){return t(n)}),e)},Vo=function(t,e){return Ho.subset(zo,t,e)},Uo=function(t,e,n){return Ho.ancestors(zo,t,e,n)},Wo=function(t,e){return Ho.breakToLeft(zo,t,e)},Go=function(t,e){return Ho.breakToRight(zo,t,e)},qo=function(t,e,n){return Ho.breakPath(zo,t,e,(function(t,e,r){return n(e,r)}))},Xo={sharedOne:jo,subset:Vo,ancestors:Uo,breakToLeft:Wo,breakToRight:Go,breakPath:qo},$o=rt(["boxes","start","finish"],[]),Yo={create:$o},Ko=function(t){return zn(t,"table")},Jo=function(t,e,n){var r=function(t){return function(e){return void 0!==n&&n(e)||Ge(e,t)}};return Ge(t,e)?p.some(Yo.create({boxes:p.some([t]),start:t,finish:e})):Ko(t).bind((function(o){return Ko(e).bind((function(i){if(Ge(o,i))return p.some(Yo.create({boxes:po.intercepts(o,t,e),start:t,finish:e}));if(Ye(o,i)){var u=Bn(e,"td,th",r(o)),a=u.length>0?u[u.length-1]:e;return p.some(Yo.create({boxes:po.nestedIntercepts(o,t,o,e,i),start:t,finish:a}))}if(Ye(i,o)){u=Bn(t,"td,th",r(i));var c=u.length>0?u[u.length-1]:t;return p.some(Yo.create({boxes:po.nestedIntercepts(i,t,o,e,i),start:t,finish:c}))}return Xo.ancestors(t,e).shared().bind((function(u){return Un(u,"table",n).bind((function(n){var u=Bn(e,"td,th",r(n)),a=u.length>0?u[u.length-1]:e,c=Bn(t,"td,th",r(n)),s=c.length>0?c[c.length-1]:t;return p.some(Yo.create({boxes:po.nestedIntercepts(n,t,o,e,i),start:s,finish:a}))}))}))}))}))},Qo=function(t,e){var n=Nn(t,e);return n.length>0?p.some(n):p.none()},Zo=function(t,e){return M(t,(function(t){return je(t,e)}))},ti=function(t,e,n){return Vn(t,e).bind((function(e){return Vn(t,n).bind((function(t){return Xo.sharedOne(Ko,[e,t]).map((function(n){return{first:o(e),last:o(t),table:o(n)}}))}))}))},ei=function(t,e){return zn(t,"table").bind((function(n){return Vn(n,e).bind((function(e){return Jo(e,t).bind((function(t){return t.boxes().map((function(e){return{boxes:o(e),start:o(t.start()),finish:o(t.finish())}}))}))}))}))},ni=function(t,e,n,r,o){return Zo(t,o).bind((function(t){return po.moveBy(t,e,n).bind((function(t){return ei(t,r)}))}))},ri={identify:Jo,retrieve:Qo,shiftSelection:ni,getEdges:ti},oi=function(t,e){return ri.retrieve(t,e)},ii=function(t,e,n){return ri.getEdges(t,e,n).bind((function(e){var n=function(e){return Ge(t,e)},r=zn(e.first(),"thead,tfoot,tbody,table",n),o=zn(e.last(),"thead,tfoot,tbody,table",n);return r.bind((function(t){return o.bind((function(n){return Ge(t,n)?po.getBox(e.table(),e.first(),e.last()):p.none()}))}))}))},ui={retrieve:oi,retrieveBox:ii},ai="data-mce-selected",ci="td["+ai+"],th["+ai+"]",si="["+ai+"]",li="data-mce-first-selected",fi="td["+li+"],th["+li+"]",di="data-mce-last-selected",mi="td["+di+"],th["+di+"]",gi={selected:o(ai),selectedSelector:o(ci),attributeSelector:o(si),firstSelected:o(li),firstSelectedSelector:o(fi),lastSelected:o(di),lastSelectedSelector:o(mi)},pi=function(e){if(!w(e))throw new Error("cases must be an array");if(0===e.length)throw new Error("there must be at least one case");var n=[],r={};return R(e,(function(o,i){var u=U(o);if(1!==u.length)throw new Error("one and only one name per case");var a=u[0],c=o[a];if(void 0!==r[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!w(c))throw new Error("case arguments must be an array");n.push(a),r[a]=function(){var r=arguments.length;if(r!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+r);for(var o=new Array(r),u=0;u<o.length;u++)o[u]=arguments[u];var s=function(t){var e=U(t);if(n.length!==e.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+e.join(","));var r=z(n,(function(t){return D(e,t)}));if(!r)throw new Error("Not all branches were specified when using match. Specified: "+e.join(", ")+"\nRequired: "+n.join(", "));return t[a].apply(null,o)};return{fold:function(){if(arguments.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+arguments.length);var t=arguments[i];return t.apply(null,o)},match:s,log:function(e){t.console.log(e,{constructors:n,constructor:a,params:o})}}}})),r},hi={generate:pi},vi=hi.generate([{none:[]},{multiple:["elements"]},{single:["selection"]}]),bi=function(t,e,n,r){return t.fold(e,n,r)},yi={cata:bi,none:vi.none,multiple:vi.multiple,single:vi.single},wi=function(t,e){return yi.cata(e.get(),o([]),i,o([t]))},xi=function(t,e){var n=function(t){return bt(t,"rowspan")&&parseInt(vt(t,"rowspan"),10)>1||bt(t,"colspan")&&parseInt(vt(t,"colspan"),10)>1},r=wi(t,e);return r.length>0&&z(r,n)?p.some(r):p.none()},Ci=function(t,e){return yi.cata(e.get(),p.none,(function(e,n){return 0===e.length?p.none():ui.retrieveBox(t,gi.firstSelectedSelector(),gi.lastSelectedSelector()).bind((function(t){return e.length>1?p.some({bounds:o(t),cells:o(e)}):p.none()}))}),p.none)},Si={mergable:Ci,unmergable:xi,selection:wi},ki=function(t){return{element:o(t),mergable:p.none,unmergable:p.none,selection:o([t])}},Oi=function(t,e,n){return{element:o(n),mergable:o(Si.mergable(e,t)),unmergable:o(Si.unmergable(n,t)),selection:o(Si.selection(n,t))}},Ti=function(t){return ki(t)},Ei=K("element","clipboard","generators"),Di=function(t,e,n,r,i){return{element:o(n),mergable:p.none,unmergable:p.none,selection:o(Si.selection(n,t)),clipboard:o(r),generators:o(i)}},Ai={noMenu:ki,forMenu:Oi,notCell:Ti,paste:Ei,pasteRows:Di},_i=function(t){return ur.table(t[0]).map(Hr).map((function(t){return[Sr.extract(t,gi.attributeSelector())]}))},Ri=function(t,e){return _(e,(function(e){return t.selection.serializer.serialize(e.dom(),{})})).join("")},Bi=function(t){return _(t,(function(t){return t.dom().innerText})).join("")},Ii=function(t,e,r,o){t.on("BeforeGetContent",(function(r){var o=function(e){r.preventDefault(),_i(e).each((function(e){r.content="text"===r.format?Bi(e):Ri(t,e)}))};!0===r.selection&&yi.cata(e.get(),n,o,n)})),t.on("BeforeSetContent",(function(e){if(!0===e.selection&&!0===e.paste){var n=p.from(t.dom.getParent(t.selection.getStart(),"th,td"));n.each((function(n){var i=It.fromDom(n);ur.table(i).each((function(n){var u=I(Kr(e.content),(function(t){return"meta"!==ct(t)}));if(1===u.length&&"table"===ct(u[0])){e.preventDefault();var a=It.fromDom(t.getDoc()),c=Yr.paste(a),s=Ai.paste(i,u[0],c);r.pasteCells(n,s).each((function(e){t.selection.setRng(e),t.focus(),o.clear(n)}))}}))}))}}))},Ni={registerEvents:Ii};function Pi(t,e){var n=function(e,n){if(!S(n)&&!n.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+n);var r=e.dom();Tt(r)&&(r.style[t]=n+"px")},r=function(n){var r=e(n);if(r<=0||null===r){var o=jt(n,t);return parseFloat(o)||0}return r},o=r,i=function(t,e){return P(e,(function(e,n){var r=jt(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o}),0)},u=function(t,e,n){var r=i(t,n),o=e>r?e-r:0;return o};return{set:n,get:r,getOuter:o,aggregate:i,max:u}}var Mi=Pi("height",(function(t){var e=t.dom();return Nt(t)?e.getBoundingClientRect().height:e.offsetHeight})),Fi=function(t){return Mi.get(t)},Li=function(t){return Mi.getOuter(t)},Hi=Pi("width",(function(t){return t.dom().offsetWidth})),zi=function(t){return Hi.get(t)},ji=function(t){return Hi.getOuter(t)},Vi=Le(),Ui=function(){return Vi.browser.isIE()||Vi.browser.isEdge()},Wi=function(t,e){var n=parseFloat(t);return isNaN(n)?e:n},Gi=function(t,e,n){return Wi(jt(t,e),n)},qi=function(t){var e=Gi(t,"padding-top",0),n=Gi(t,"padding-bottom",0),r=Gi(t,"border-top-width",0),o=Gi(t,"border-bottom-width",0),i=t.dom().getBoundingClientRect().height,u=jt(t,"box-sizing"),a=r+o;return"border-box"===u?i:i-e-n-a},Xi=function(t){return Gi(t,"width",zi(t))},$i=function(t){return Ui()?qi(t):Gi(t,"height",Fi(t))},Yi={getWidth:Xi,getHeight:$i},Ki=/(\d+(\.\d+)?)(\w|%)*/,Ji=/(\d+(\.\d+)?)%/,Qi=/(\d+(\.\d+)?)px|em/,Zi=function(t,e){Ht(t,"width",e+"px")},tu=function(t,e){Ht(t,"width",e+"%")},eu=function(t,e){Ht(t,"height",e+"px")},nu=function(t){return Ut(t,"height").getOrThunk((function(){return Yi.getHeight(t)+"px"}))},ru=function(t,e,n,r){var o=ur.table(t).map((function(t){var r=n(t);return Math.floor(e/100*r)})).getOr(e);return r(t,o),o},ou=function(t,e,n,r){var o=parseInt(t,10);return kt(t,"%")&&"table"!==ct(e)?ru(e,o,n,r):o},iu=function(t){var e=nu(t);return e?ou(e,t,Fi,eu):Fi(t)},uu=function(t,e,n){var r=n(t),o=au(t,e);return r/o},au=function(t,e){return bt(t,e)?parseInt(vt(t,e),10):1},cu=function(t){var e=Ut(t,"width");return e.fold((function(){return p.from(vt(t,"width"))}),(function(t){return p.some(t)}))},su=function(t,e){return t/e.pixelWidth()*100},lu=function(t,e,n){var r=Ji.exec(e);if(null!==r)return parseFloat(r[1]);var o=zi(t);return su(o,n)},fu=function(t,e){var n=cu(t);return n.fold((function(){var n=zi(t);return su(n,e)}),(function(n){return lu(t,n,e)}))},du=function(t,e){return t/100*e.pixelWidth()},mu=function(t,e,n){var r=Qi.exec(e);if(null!==r)return parseInt(r[1],10);var o=Ji.exec(e);if(null!==o){var i=parseFloat(o[1]);return du(i,n)}return zi(t)},gu=function(t,e){var n=cu(t);return n.fold((function(){return zi(t)}),(function(n){return mu(t,n,e)}))},pu=function(t){return uu(t,"rowspan",iu)},hu=function(t){var e=cu(t);return e.bind((function(t){var e=Ki.exec(t);return null!==e?p.some({width:o(parseFloat(e[1])),unit:o(e[3])}):p.none()}))},vu=function(t,e,n){Ht(t,"width",e+n)},bu={percentageBasedSizeRegex:o(Ji),pixelBasedSizeRegex:o(Qi),setPixelWidth:Zi,setPercentageWidth:tu,setHeight:eu,getPixelWidth:gu,getPercentageWidth:fu,getGenericWidth:hu,setGenericWidth:vu,getHeight:pu,getRawWidth:cu},yu=function(t,e){var n=bu.getGenericWidth(t);n.each((function(n){var r=n.width()/2;bu.setGenericWidth(t,r,n.unit()),bu.setGenericWidth(e,r,n.unit())}))},wu={halve:yu},xu=function(t,e){var n=function(n,r){return xu(t+n,e+r)};return{left:o(t),top:o(e),translate:n}},Cu=xu,Su=function(t){var e=t.getBoundingClientRect();return Cu(e.left,e.top)},ku=function(t,e){return void 0!==t?t:void 0!==e?e:0},Ou=function(t){var e=t.dom().ownerDocument,n=e.body,r=e.defaultView,o=e.documentElement;if(n===t.dom())return Cu(n.offsetLeft,n.offsetTop);var i=ku(r.pageYOffset,o.scrollTop),u=ku(r.pageXOffset,o.scrollLeft),a=ku(o.clientTop,n.clientTop),c=ku(o.clientLeft,n.clientLeft);return Tu(t).translate(u-c,i-a)},Tu=function(t){var e=t.dom(),n=e.ownerDocument,r=n.body;return r===e?Cu(r.offsetLeft,r.offsetTop):Nt(t)?Su(e):Cu(0,0)},Eu=K("row","y"),Du=K("col","x"),Au=function(t){var e=Ou(t);return e.left()+ji(t)},_u=function(t){return Ou(t).left()},Ru=function(t,e){return Du(t,_u(e))},Bu=function(t,e){return Du(t,Au(e))},Iu=function(t){return Ou(t).top()},Nu=function(t,e){return Eu(t,Iu(e))},Pu=function(t,e){return Eu(t,Iu(e)+Li(e))},Mu=function(t,e,n){if(0===n.length)return[];var r=_(n.slice(1),(function(e,n){return e.map((function(e){return t(n,e)}))})),o=n[n.length-1].map((function(t){return e(n.length-1,t)}));return r.concat([o])},Fu=function(t){return-t},Lu={delta:i,positions:function(t){return Mu(Nu,Pu,t)},edge:Iu},Hu={delta:i,edge:_u,positions:function(t){return Mu(Ru,Bu,t)}},zu={delta:Fu,edge:Au,positions:function(t){return Mu(Bu,Ru,t)}},ju={height:Lu,rtl:zu,ltr:Hu},Vu={ltr:ju.ltr,rtl:ju.rtl};function Uu(t){var e=function(e){return t(e).isRtl()?Vu.rtl:Vu.ltr},n=function(t,n){return e(n).delta(t,n)},r=function(t,n){return e(n).positions(t,n)},o=function(t){return e(t).edge(t)};return{delta:n,edge:o,positions:r}}var Wu=function(t){var e=sr.fromTable(t),n=hr.generate(e);return n.grid()},Gu={getGridSize:Wu},qu=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},Xu=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return p.none()},$u=function(t,e,n,r){n===r?yt(t,e):pt(t,e,n)},Yu=function(t,e){var n=[],r=[],i=function(e,o){var i=jn(t,o).getOrThunk((function(){var e=It.fromTag(o,Je(t).dom());return ln(t,e),e}));pn(i);var u=_(e,(function(t){t.isNew()&&n.push(t.element());var e=t.element();return pn(e),R(t.cells(),(function(t){t.isNew()&&r.push(t.element()),$u(t.element(),"colspan",t.colspan(),1),$u(t.element(),"rowspan",t.rowspan(),1),ln(e,t.element())})),e}));gn(i,u)},u=function(e){jn(t,e).each(hn)},a=function(t,e){t.length>0?i(t,e):u(e)},c=[],s=[],l=[];return R(e,(function(t){switch(t.section()){case"thead":c.push(t);break;case"tbody":s.push(t);break;case"tfoot":l.push(t);break}})),a(c,"thead"),a(s,"tbody"),a(l,"tfoot"),{newRows:o(n),newCells:o(r)}},Ku=function(t){var e=_(t,(function(t){var e=Lr(t.element());return R(t.cells(),(function(t){var n=Hr(t.element());$u(n,"colspan",t.colspan(),1),$u(n,"rowspan",t.rowspan(),1),ln(e,n)})),e}));return e},Ju={render:Yu,copy:Ku},Qu=function(t,e){var n=vt(t,e);return void 0===n||""===n?[]:n.split(" ")},Zu=function(t,e,n){var r=Qu(t,e),o=r.concat([n]);return pt(t,e,o.join(" ")),!0},ta=function(t,e,n){var r=I(Qu(t,e),(function(t){return t!==n}));return r.length>0?pt(t,e,r.join(" ")):yt(t,e),!1},ea=function(t){return void 0!==t.dom().classList},na=function(t){return Qu(t,"class")},ra=function(t,e){return Zu(t,"class",e)},oa=function(t,e){return ta(t,"class",e)},ia=function(t,e){ea(t)?t.dom().classList.add(e):ra(t,e)},ua=function(t){var e=ea(t)?t.dom().classList:na(t);0===e.length&&yt(t,"class")},aa=function(t,e){if(ea(t)){var n=t.dom().classList;n.remove(e)}else oa(t,e);ua(t)},ca=function(t,e){return ea(t)&&t.dom().classList.contains(e)},sa=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},la=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},fa=function(t,e){if(e<0||e>=t.length-1)return p.none();var n=t[e].fold((function(){var n=j(t.slice(0,e));return Xu(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return p.some({value:t,delta:0})})),r=t[e+1].fold((function(){var n=t.slice(e+1);return Xu(n,(function(t,e){return t.map((function(t){return{value:t,delta:e+1}}))}))}),(function(t){return p.some({value:t,delta:1})}));return n.bind((function(t){return r.map((function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n}))}))},da=function(t){var e=t.grid(),n=la(0,e.columns()),r=la(0,e.rows());return _(n,(function(e){var n=function(){return H(r,(function(n){return hr.getAt(t,n,e).filter((function(t){return t.column()===e})).fold(o([]),(function(t){return[t]}))}))},i=function(t){return 1===t.colspan()},u=function(){return hr.getAt(t,0,e)};return ma(n,i,u)}))},ma=function(t,e,n){var r=t(),o=M(r,e),i=o.orThunk((function(){return p.from(r[0]).orThunk(n)}));return i.map((function(t){return t.element()}))},ga=function(t){var e=t.grid(),n=la(0,e.rows()),r=la(0,e.columns());return _(n,(function(e){var n=function(){return H(r,(function(n){return hr.getAt(t,e,n).filter((function(t){return t.row()===e})).fold(o([]),(function(t){return[t]}))}))},i=function(t){return 1===t.rowspan()},u=function(){return hr.getAt(t,e,0)};return ma(n,i,u)}))},pa={columns:da,rows:ga},ha=function(t){var e=t.replace(/\./g,"-"),n=function(t){return e+"-"+t};return{resolve:n}},va=ha("ephox-snooker"),ba={resolve:va.resolve},ya=function(t,e,n,r,o){var i=It.fromTag("div");return zt(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),ht(i,{"data-column":t,role:"presentation"}),i},wa=function(t,e,n,r,o){var i=It.fromTag("div");return zt(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),ht(i,{"data-row":t,role:"presentation"}),i},xa={col:ya,row:wa},Ca=ba.resolve("resizer-bar"),Sa=ba.resolve("resizer-rows"),ka=ba.resolve("resizer-cols"),Oa=7,Ta=function(t){var e=Nn(t.parent(),"."+Ca);R(e,hn)},Ea=function(t,e,n){var r=t.origin();R(e,(function(e,o){e.each((function(e){var o=n(r,e);ia(o,Ca),ln(t.parent(),o)}))}))},Da=function(t,e,n,r){Ea(t,e,(function(t,e){var o=xa.col(e.col(),e.x()-t.left(),n.top()-t.top(),Oa,r);return ia(o,ka),o}))},Aa=function(t,e,n,r){Ea(t,e,(function(t,e){var o=xa.row(e.row(),n.left()-t.left(),e.y()-t.top(),r,Oa);return ia(o,Sa),o}))},_a=function(t,e,n,r,o,i){var u=Ou(e),a=n.length>0?o.positions(n,e):[];Aa(t,a,u,ji(e));var c=r.length>0?i.positions(r,e):[];Da(t,c,u,Li(e))},Ra=function(t,e,n,r){Ta(t);var o=sr.fromTable(e),i=hr.generate(o),u=pa.rows(i),a=pa.columns(i);_a(t,e,u,a,n,r)},Ba=function(t,e){var n=Nn(t.parent(),"."+Ca);R(n,e)},Ia=function(t){Ba(t,(function(t){Ht(t,"display","none")}))},Na=function(t){Ba(t,(function(t){Ht(t,"display","block")}))},Pa=function(t){return ca(t,Sa)},Ma=function(t){return ca(t,ka)},Fa={refresh:Ra,hide:Ia,show:Na,destroy:Ta,isRowBar:Pa,isColBar:Ma},La=function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return za(t,u)},Ha=function(t,e,n){var r=t.cells();r[e]=n},za=function(t,e){return Tn(e,t.section())},ja=function(t,e){var n=t.cells(),r=_(n,e);return Tn(r,t.section())},Va=function(t,e){return t.cells()[e]},Ua=function(t,e){return Va(t,e).element()},Wa=function(t){return t.cells().length},Ga={addCell:La,setCells:za,mutateCell:Ha,getCell:Va,getCellElement:Ua,mapCells:ja,cellLength:Wa},qa=function(t,e){return _(t,(function(t){return Ga.getCell(t,e)}))},Xa=function(t,e){return t[e]},$a=function(t,e){if(0===t.length)return 0;var n=t[0],r=F(t,(function(t){return!e(n.element(),t.element())}));return r.fold((function(){return t.length}),(function(t){return t}))},Ya=function(t,e,n,r){var i=Xa(t,e).cells().slice(n),u=$a(i,r),a=qa(t,n).slice(e),c=$a(a,r);return{colspan:o(u),rowspan:o(c)}},Ka={subgrid:Ya},Ja=function(t,e){var n=_(t,(function(t,e){return _(t.cells(),(function(t,e){return!1}))})),r=function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0};return _(t,(function(o,i){var u=H(o.cells(),(function(o,u){if(!1===n[i][u]){var a=Ka.subgrid(t,i,u,e);return r(i,u,a.rowspan(),a.colspan()),[xn(o.element(),a.rowspan(),a.colspan(),o.isNew())]}return[]}));return En(u,o.section())}))},Qa=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=hr.getAt(t,o,u).map((function(t){return kn(t.element(),n)})).getOrThunk((function(){return kn(e.gap(),!0)}));i.push(a)}var c=Tn(i,t.all()[o].section());r.push(c)}return r},Za={toDetails:Ja,toGrid:Qa},tc=function(t,e){return Za.toGrid(t,e,!1)},ec=function(t,e){var n=function(t){var n=Xu(t,(function(t){return Ze(t.element()).map((function(t){var e=Ze(t).isNone();return kn(t,e)}))}));return n.getOrThunk((function(){return kn(e.row(),!0)}))};return _(t,(function(t){var e=n(t.details());return On(e.element(),t.details(),t.section(),e.isNew())}))},nc=function(t,e){var n=Za.toDetails(t,Ge);return ec(n,e)},rc=function(t,e){var n=L(_(t.all(),(function(t){return t.cells()})));return M(n,(function(t){return Ge(e,t.element())}))},oc=function(t,e,n,r,i){return function(u,a,c,s,l){var f=sr.fromTable(a),d=hr.generate(f),m=e(d,c).map((function(e){var n=tc(d,s),r=t(n,e,Ge,i(s)),u=nc(r.grid(),s);return{grid:o(u),cursor:r.cursor}}));return m.fold((function(){return p.none()}),(function(t){var e=Ju.render(a,t.grid());return n(a,t.grid(),l),r(a),Fa.refresh(u,a,ju.height,l),p.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})}))}},ic=function(t,e){return ur.cell(e.element()).bind((function(e){return rc(t,e)}))},uc=function(t,e){return ur.cell(e.element()).bind((function(n){return rc(t,n).map((function(t){var n=Kt(Kt({},t),{generators:e.generators,clipboard:e.clipboard});return n}))}))},ac=function(t,e){var n=_(e.selection(),(function(e){return ur.cell(e).bind((function(e){return rc(t,e)}))})),r=qu(n);return r.length>0?p.some({cells:r,generators:e.generators,clipboard:e.clipboard}):p.none()},cc=function(t,e){return e.mergable()},sc=function(t,e){return e.unmergable()},lc=function(t,e){var n=_(e.selection(),(function(e){return ur.cell(e).bind((function(e){return rc(t,e)}))})),r=qu(n);return r.length>0?p.some(r):p.none()},fc=function(t){var e=function(e){return t===e},n=function(e){return fc(t)},r=function(e){return fc(t)},i=function(e){return fc(e(t))},u=function(e){return fc(t)},a=function(e){e(t)},c=function(e){return e(t)},f=function(e,n){return n(t)},d=function(e){return e(t)},m=function(e){return e(t)},g=function(){return p.some(t)};return{is:e,isValue:l,isError:s,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:n,orThunk:r,fold:f,map:i,mapError:u,each:a,bind:c,exists:d,forall:m,toOption:g}},dc=function(t){var e=function(t){return t()},r=function(){return c(String(t))()},o=function(t){return t},u=function(t){return t()},a=function(e){return dc(t)},f=function(e){return dc(e(t))},d=function(e){return dc(t)},m=function(e,n){return e(t)};return{is:s,isValue:s,isError:l,getOr:i,getOrThunk:e,getOrDie:r,or:o,orThunk:u,fold:m,map:a,mapError:f,each:n,bind:d,exists:s,forall:l,toOption:p.none}},mc=function(t,e){return t.fold((function(){return dc(e)}),fc)},gc={value:fc,error:dc,fromOption:mc},pc=function(t,e,n){if(t.row()>=e.length||t.column()>Ga.cellLength(e[0]))return gc.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),i=r[0].cells().slice(t.column()),u=Ga.cellLength(n[0]),a=n.length;return gc.value({rowDelta:o(r.length-a),colDelta:o(i.length-u)})},hc=function(t,e){var n=Ga.cellLength(t[0]),r=Ga.cellLength(e[0]);return{rowDelta:o(0),colDelta:o(n-r)}},vc=function(t,e){return _(t,(function(){return kn(e.cell(),!0)}))},bc=function(t,e,n){return t.concat(sa(e,(function(e){return Ga.setCells(t[t.length-1],vc(t[t.length-1].cells(),n))})))},yc=function(t,e,n){return _(t,(function(t){return Ga.setCells(t,t.cells().concat(vc(la(0,e),n)))}))},wc=function(t,e,n){var r=e.colDelta()<0?yc:i,o=e.rowDelta()<0?bc:i,u=r(t,Math.abs(e.colDelta()),n),a=o(u,Math.abs(e.rowDelta()),n);return a},xc={measure:pc,measureWidth:hc,tailor:wc},Cc=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)Ga.mutateCell(t[o],i,kn(r(),!1));return t},Sc=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<Ga.cellLength(t[0]);u++){var a=Ga.getCellElement(t[i],u),c=n(a,e);!0===c&&!1===o?Ga.mutateCell(t[i],u,kn(r(),!0)):!0===c&&(o=!1)}return t},kc=function(t,e){return P(t,(function(t,n){return A(t,(function(t){return e(t.element(),n.element())}))?t:t.concat([n])}),[])},Oc=function(t,e,n,r){if(e>0&&e<t.length){var o=t[e-1].cells(),i=kc(o,n);R(i,(function(o){for(var i=p.none(),u=function(e){for(var u=function(u){var a=t[e].cells()[u],c=n(a.element(),o.element());c&&(i.isNone()&&(i=p.some(r())),i.each((function(n){Ga.mutateCell(t[e],u,kn(n,!0))})))},a=0;a<Ga.cellLength(t[0]);a++)u(a)},a=e;a<t.length;a++)u(a)}))}return t},Tc={merge:Cc,unmerge:Sc,splitRows:Oc},Ec=function(t,e,n,r){var o=Ga.getCell(t[e],n),i=u(r,o.element()),a=t[e];return t.length>1&&Ga.cellLength(a)>1&&(n>0&&i(Ga.getCellElement(a,n-1))||n<a.cells().length-1&&i(Ga.getCellElement(a,n+1))||e>0&&i(Ga.getCellElement(t[e-1],n))||e<t.length-1&&i(Ga.getCellElement(t[e+1],n)))},Dc=function(t,e,n,r,o){for(var i=t.row(),u=t.column(),a=n.length,c=Ga.cellLength(n[0]),s=i+a,l=u+c,f=i;f<s;f++)for(var d=u;d<l;d++){Ec(e,f,d,o)&&Tc.unmerge(e,Ga.getCellElement(e[f],d),o,r.cell);var m=Ga.getCellElement(n[f-i],d-u),g=r.replace(m);Ga.mutateCell(e[f],d,kn(g,!0))}return e},Ac=function(t,e,n,r,o){var i=xc.measure(t,e,n);return i.map((function(i){var u=xc.tailor(e,i,r);return Dc(t,u,n,r,o)}))},_c=function(t,e,n,r,o){Tc.splitRows(e,t,o,r.cell);var i=xc.measureWidth(n,e),u=xc.tailor(n,i,r),a=xc.measureWidth(e,u),c=xc.tailor(e,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Rc={merge:Ac,insert:_c},Bc=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),a=Ga.mapCells(t[n],(function(n,i){var u=e>0&&e<t.length&&r(Ga.getCellElement(t[e-1],i),Ga.getCellElement(t[e],i)),a=u?Ga.getCell(t[e],i):kn(o(n.element(),r),!0);return a}));return i.concat([a]).concat(u)},Ic=function(t,e,n,r,o){return _(t,(function(t){var i=e>0&&e<Ga.cellLength(t)&&r(Ga.getCellElement(t,e-1),Ga.getCellElement(t,e)),u=i?Ga.getCell(t,e):kn(o(Ga.getCellElement(t,n),r),!0);return Ga.addCell(t,e,u)}))},Nc=function(t,e,n,r,o){var i=n+1;return _(t,(function(t,u){var a=u===e,c=a?kn(o(Ga.getCellElement(t,n),r),!0):Ga.getCell(t,n);return Ga.addCell(t,i,c)}))},Pc=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),a=t.slice(i),c=Ga.mapCells(t[e],(function(t,e){var i=e===n;return i?kn(o(t.element(),r),!0):t}));return u.concat([c]).concat(a)},Mc=function(t,e,n){var r=_(t,(function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return Tn(r,t.section())}));return I(r,(function(t){return t.cells().length>0}))},Fc=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},Lc={insertRowAt:Bc,insertColumnAt:Ic,splitCellIntoColumns:Nc,splitCellIntoRows:Pc,deleteRowsAt:Fc,deleteColumnsAt:Mc},Hc=function(t,e,n,r){var o=function(t){return A(e,(function(e){return n(t.element(),e.element())}))};return _(t,(function(t){return Ga.mapCells(t,(function(t){return o(t)?kn(r(t.element(),n),!0):t}))}))},zc=function(t,e,n,r){return void 0!==Ga.getCellElement(t[e],n)&&e>0&&r(Ga.getCellElement(t[e-1],n),Ga.getCellElement(t[e],n))},jc=function(t,e,n){return e>0&&n(Ga.getCellElement(t,e-1),Ga.getCellElement(t,e))},Vc=function(t,e,n,r){var o=H(t,(function(r,o){var i=zc(t,o,e,n)||jc(r,e,n);return i?[]:[Ga.getCell(r,e)]}));return Hc(t,o,n,r)},Uc=function(t,e,n,r){var o=t[e],i=H(o.cells(),(function(r,i){var u=zc(t,e,i,n)||jc(o,i,n);return u?[]:[r]}));return Hc(t,i,n,r)},Wc={replaceColumn:Vc,replaceRow:Uc},Gc=hi.generate([{none:[]},{only:["index"]},{left:["index","next"]},{middle:["prev","index","next"]},{right:["prev","index"]}]),qc=Kt({},Gc),Xc=function(t,e){return 0===t.length?qc.none():1===t.length?qc.only(0):0===e?qc.left(0,1):e===t.length-1?qc.right(e-1,e):e>0&&e<t.length-1?qc.middle(e-1,e,e+1):qc.none()},$c=function(t,e,n,r){var i=t.slice(0),u=Xc(t,e),a=function(t){return _(t,o(0))},c=o(a(i)),s=function(t){return r.singleColumnWidth(i[t],n)},l=function(t,e){if(n>=0){var o=Math.max(r.minCellWidth(),i[e]-n);return a(i.slice(0,t)).concat([n,o-i[e]]).concat(a(i.slice(e+1)))}var u=Math.max(r.minCellWidth(),i[t]+n),c=i[t]-u;return a(i.slice(0,t)).concat([u-i[t],c]).concat(a(i.slice(e+1)))},f=l,d=function(t,e,n){return l(e,n)},m=function(t,e){if(n>=0)return a(i.slice(0,e)).concat([n]);var o=Math.max(r.minCellWidth(),i[e]+n);return a(i.slice(0,e)).concat([o-i[e]])};return u.fold(c,s,f,d,m)},Yc={determine:$c},Kc=function(t,e){return bt(t,e)&&parseInt(vt(t,e),10)>1},Jc=function(t){return Kc(t,"colspan")},Qc=function(t){return Kc(t,"rowspan")},Zc=function(t,e){return parseInt(jt(t,e),10)},ts={hasColspan:Jc,hasRowspan:Qc,minWidth:o(10),minHeight:o(10),getInt:Zc},es=function(t,e,n){return Ut(t,e).fold((function(){return n(t)+"px"}),(function(t){return t}))},ns=function(t,e){return es(t,"width",(function(t){return bu.getPixelWidth(t,e)}))},rs=function(t){return es(t,"height",bu.getHeight)},os=function(t,e,n,r,o){var i=pa.columns(t),u=_(i,(function(t){return t.map(e.edge)}));return _(i,(function(t,e){var i=t.filter(a(ts.hasColspan));return i.fold((function(){var t=fa(u,e);return r(t)}),(function(t){return n(t,o)}))}))},is=function(t){return t.map((function(t){return t+"px"})).getOr("")},us=function(t,e,n){return os(t,e,ns,is,n)},as=function(t,e,n){return os(t,e,bu.getPercentageWidth,(function(t){return t.fold((function(){return n.minCellWidth()}),(function(t){return t/n.pixelWidth()*100}))}),n)},cs=function(t,e,n){return os(t,e,bu.getPixelWidth,(function(t){return t.getOrThunk(n.minCellWidth)}),n)},ss=function(t,e,n,r){var o=pa.rows(t),i=_(o,(function(t){return t.map(e.edge)}));return _(o,(function(t,e){var o=t.filter(a(ts.hasRowspan));return o.fold((function(){var t=fa(i,e);return r(t)}),(function(t){return n(t)}))}))},ls=function(t,e){return ss(t,e,bu.getHeight,(function(t){return t.getOrThunk(ts.minHeight)}))},fs=function(t,e){return ss(t,e,rs,is)},ds={getRawWidths:us,getPixelWidths:cs,getPercentageWidths:as,getPixelHeights:ls,getRawHeights:fs},ms=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},gs=function(t,e){var n=hr.justCells(t);return _(n,(function(t){var n=ms(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:o(n),colspan:t.colspan}}))},ps=function(t,e){var n=hr.justCells(t);return _(n,(function(t){var n=ms(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:o(n),rowspan:t.rowspan}}))},hs=function(t,e){return _(t.all(),(function(t,n){return{element:t.element,height:o(e[n])}}))},vs={recalculateWidth:gs,recalculateHeight:ps,matchRowHeight:hs},bs=function(t,e){var n=parseFloat(t),r=zi(e),i=function(t){return t/r*100},u=function(t,e){return[100-t]},a=function(){return ts.minWidth()/r*100},c=function(t,e,r){var o=r/100,i=o*n;bu.setPercentageWidth(t,n+i)};return{width:o(n),pixelWidth:o(r),getWidths:ds.getPercentageWidths,getCellDelta:i,singleColumnWidth:u,minCellWidth:a,setElementWidth:bu.setPercentageWidth,setTableWidth:c}},ys=function(t){var e=i,n=function(t,e){var n=Math.max(ts.minWidth(),t+e);return[n-t]},r=function(t,e,n){var r=N(e,(function(t,e){return t+e}),0);bu.setPixelWidth(t,r)};return{width:o(t),pixelWidth:o(t),getWidths:ds.getPixelWidths,getCellDelta:e,singleColumnWidth:n,minCellWidth:ts.minWidth,setElementWidth:bu.setPixelWidth,setTableWidth:r}},ws=function(t,e){var n=bu.percentageBasedSizeRegex().exec(e);if(null!==n)return bs(n[1],t);var r=bu.pixelBasedSizeRegex().exec(e);if(null!==r){var o=parseInt(r[1],10);return ys(o)}var i=zi(t);return ys(i)},xs=function(t){var e=bu.getRawWidth(t);return e.fold((function(){var e=zi(t);return ys(e)}),(function(e){return ws(t,e)}))},Cs={getTableSize:xs},Ss=function(t){return hr.generate(t)},ks=function(t){return N(t,(function(t,e){return t+e}),0)},Os=function(t){var e=sr.fromTable(t);return Ss(e)},Ts=function(t,e,n,r){var o=Cs.getTableSize(t),i=o.getCellDelta(e),u=Os(t),a=o.getWidths(u,r,o),c=Yc.determine(a,n,i,o),s=_(c,(function(t,e){return t+a[e]})),l=vs.recalculateWidth(u,s);R(l,(function(t){o.setElementWidth(t.element(),t.width())})),n===u.grid().columns()-1&&o.setTableWidth(t,s,i)},Es=function(t,e,n,r){var o=Os(t),i=ds.getPixelHeights(o,r),u=_(i,(function(t,r){return n===r?Math.max(e+t,ts.minHeight()):t})),a=vs.recalculateHeight(o,u),c=vs.matchRowHeight(o,u);R(c,(function(t){bu.setHeight(t.element(),t.height())})),R(a,(function(t){bu.setHeight(t.element(),t.height())}));var s=ks(u);bu.setHeight(t,s)},Ds=function(t,e,n){var r=Cs.getTableSize(t),o=Ss(e),i=r.getWidths(o,n,r),u=vs.recalculateWidth(o,i);R(u,(function(t){r.setElementWidth(t.element(),t.width())})),u.length>0&&r.setTableWidth(t,i,r.getCellDelta(0))},As={adjustWidth:Ts,adjustHeight:Es,adjustWidthTo:Ds},_s=function(t,e){return Rs(t,e,{validate:C,label:"function"})},Rs=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return tt("required",e),nt(e),function(r){var o=U(r),i=z(e,(function(t){return D(o,t)}));i||Q(e,o),t(e,o);var u=I(e,(function(t){return!n.validate(r[t],t)}));return u.length>0&&et(u,n.label),r}},Bs=function(t,e){var n=I(e,(function(e){return!D(t,e)}));n.length>0&&Z(n)},Is=function(t){return _s(Bs,t)},Ns=Is(["cell","row","replace","gap"]),Ps=function(t){var e=bt(t,"colspan")?parseInt(vt(t,"colspan"),10):1,n=bt(t,"rowspan")?parseInt(vt(t,"rowspan"),10):1;return{element:o(t),colspan:o(e),rowspan:o(n)}},Ms=function(t,n){void 0===n&&(n=Ps),Ns(t);var r=e(p.none()),o=function(e){return t.cell(e)},i=function(t){var e=n(t);return o(e)},u=function(t){var e=i(t);return r.get().isNone()&&r.set(p.some(e)),a=p.some({item:t,replacement:e}),e},a=p.none(),c=function(t,e){return a.fold((function(){return u(t)}),(function(n){return e(t,n.item)?n.replacement:u(t)}))};return{getOrInit:c,cursor:r.get}},Fs=function(t,n){return function(r){var o=e(p.none());Ns(r);var i=[],u=function(t,e){return M(i,(function(n){return e(n.item,t)}))},a=function(e){var u={scope:t},a=r.replace(e,n,u);return i.push({item:e,sub:a}),o.get().isNone()&&o.set(p.some(a)),a},c=function(t,e){return u(t,e).fold((function(){return a(t)}),(function(n){return e(t,n.item)?n.sub:a(t)}))};return{replaceOrInit:c,cursor:o.get}}},Ls=function(t){Ns(t);var n=e(p.none()),r=function(e){return n.get().isNone()&&n.set(p.some(e)),function(){var n=t.cell({element:o(e),colspan:o(1),rowspan:o(1)});return Wt(n,"width"),Wt(e,"width"),n}};return{combine:r,cursor:n.get}},Hs={modification:Ms,transform:Fs,merging:Ls},zs=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],js=function(t,e){var n=t.property().name(e);return D(["ol","ul"],n)},Vs=function(t,e){var n=t.property().name(e);return D(zs,n)},Us=function(t,e){var n=t.property().name(e);return D(["address","pre","p","h1","h2","h3","h4","h5","h6"],n)},Ws=function(t,e){var n=t.property().name(e);return D(["h1","h2","h3","h4","h5","h6"],n)},Gs=function(t,e){return D(["div","li","td","th","blockquote","body","caption"],t.property().name(e))},qs=function(t,e){return D(["br","img","hr","input"],t.property().name(e))},Xs=function(t,e){return"iframe"===t.property().name(e)},$s=function(t,e){return!(Vs(t,e)||qs(t,e))&&"li"!==t.property().name(e)},Ys={isBlock:Vs,isList:js,isFormatting:Us,isHeading:Ws,isContainer:Gs,isEmptyTag:qs,isFrame:Xs,isInline:$s},Ks=vo(),Js=function(t){return Ys.isBlock(Ks,t)},Qs=function(t){return Ys.isList(Ks,t)},Zs=function(t){return Ys.isFormatting(Ks,t)},tl=function(t){return Ys.isHeading(Ks,t)},el=function(t){return Ys.isContainer(Ks,t)},nl=function(t){return Ys.isEmptyTag(Ks,t)},rl=function(t){return Ys.isFrame(Ks,t)},ol=function(t){return Ys.isInline(Ks,t)},il={isBlock:Js,isList:Qs,isFormatting:Zs,isHeading:tl,isContainer:el,isEmptyTag:nl,isFrame:rl,isInline:ol},ul=function(t){var e=function(t){return"br"===ct(t)},n=function(t){return z(t,(function(t){return e(t)||mt(t)&&0===Tr(t).trim().length}))},r=function(t){return"li"===ct(t)||Mn(t,il.isList).isSome()},o=function(t){return nn(t).map((function(t){return!!il.isBlock(t)||!!il.isEmptyTag(t)&&"img"!==ct(t)})).getOr(!1)},i=function(t){return Pr(t).bind((function(n){var i=o(n);return Ze(n).map((function(o){return!0===i||r(o)||e(n)||il.isBlock(o)&&!Ge(t,o)?[]:[It.fromTag("br")]}))})).getOr([])},u=function(){var e=H(t,(function(t){var e=rn(t);return n(e)?[]:e.concat(i(t))}));return 0===e.length?[It.fromTag("br")]:e},a=u();pn(t[0]),gn(t[0],a)},al={merge:ul},cl=function(t){var e=ur.cells(t);0===e.length&&hn(t)},sl=K("grid","cursor"),ll=function(t,e,n){return fl(t,e,n).orThunk((function(){return fl(t,0,0)}))},fl=function(t,e,n){return p.from(t[e]).bind((function(t){return p.from(t.cells()[n]).bind((function(t){return p.from(t.element())}))}))},dl=function(t,e,n){return sl(t,fl(t,e,n))},ml=function(t){return P(t,(function(t,e){return A(t,(function(t){return t.row()===e.row()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.row()-e.row()}))},gl=function(t){return P(t,(function(t,e){return A(t,(function(t){return t.column()===e.column()}))?t:t.concat([e])}),[]).sort((function(t,e){return t.column()-e.column()}))},pl=function(t,e,n,r){var o=e.row(),i=e.row(),u=Lc.insertRowAt(t,i,o,n,r.getOrInit);return dl(u,i,e.column())},hl=function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=ml(e),a=P(u,(function(t,e){return Lc.insertRowAt(t,i,o,n,r.getOrInit)}),t);return dl(a,i,e[0].column())},vl=function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=Lc.insertRowAt(t,i,o,n,r.getOrInit);return dl(u,i,e.column())},bl=function(t,e,n,r){var o=ml(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=P(o,(function(t,e){return Lc.insertRowAt(t,u,i,n,r.getOrInit)}),t);return dl(a,u,e[0].column())},yl=function(t,e,n,r){var o=e.column(),i=e.column(),u=Lc.insertColumnAt(t,i,o,n,r.getOrInit);return dl(u,e.row(),i)},wl=function(t,e,n,r){var o=gl(e),i=o[0].column(),u=o[0].column(),a=P(o,(function(t,e){return Lc.insertColumnAt(t,u,i,n,r.getOrInit)}),t);return dl(a,e[0].row(),u)},xl=function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Lc.insertColumnAt(t,i,o,n,r.getOrInit);return dl(u,e.row(),i)},Cl=function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=gl(e),a=P(u,(function(t,e){return Lc.insertColumnAt(t,i,o,n,r.getOrInit)}),t);return dl(a,e[0].row(),i)},Sl=function(t,e,n,r){var o=Wc.replaceRow(t,e.row(),n,r.replaceOrInit);return dl(o,e.row(),e.column())},kl=function(t,e,n,r){var o=Wc.replaceColumn(t,e.column(),n,r.replaceOrInit);return dl(o,e.row(),e.column())},Ol=function(t,e,n,r){var o=Wc.replaceRow(t,e.row(),n,r.replaceOrInit);return dl(o,e.row(),e.column())},Tl=function(t,e,n,r){var o=Wc.replaceColumn(t,e.column(),n,r.replaceOrInit);return dl(o,e.row(),e.column())},El=function(t,e,n,r){var o=Lc.splitCellIntoColumns(t,e.row(),e.column(),n,r.getOrInit);return dl(o,e.row(),e.column())},Dl=function(t,e,n,r){var o=Lc.splitCellIntoRows(t,e.row(),e.column(),n,r.getOrInit);return dl(o,e.row(),e.column())},Al=function(t,e,n,r){var o=gl(e),i=Lc.deleteColumnsAt(t,o[0].column(),o[o.length-1].column()),u=ll(i,e[0].row(),e[0].column());return sl(i,u)},_l=function(t,e,n,r){var o=ml(e),i=Lc.deleteRowsAt(t,o[0].row(),o[o.length-1].row()),u=ll(i,e[0].row(),e[0].column());return sl(i,u)},Rl=function(t,e,n,r){var i=e.cells();al.merge(i);var u=Tc.merge(t,e.bounds(),n,o(i[0]));return sl(u,p.from(i[0]))},Bl=function(t,e,n,r){var o=N(e,(function(t,e){return Tc.unmerge(t,e,n,r.combine(e))}),t);return sl(o,p.from(e[0]))},Il=function(t,e,n,r){var o=function(t,e){var n=sr.fromTable(t),r=hr.generate(n);return Za.toGrid(r,e,!0)},i=o(e.clipboard(),e.generators()),u=yn(e.row(),e.column()),a=Rc.merge(u,t,i,e.generators(),n);return a.fold((function(){return sl(t,p.some(e.element()))}),(function(t){var n=ll(t,e.row(),e.column());return sl(t,n)}))},Nl=function(t,e,n){var r=sr.fromPastedRows(t,n),o=hr.generate(r);return Za.toGrid(o,e,!0)},Pl=function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=Nl(e.clipboard(),e.generators(),o),a=Rc.insert(i,t,u,e.generators(),n),c=ll(a,e.cells[0].row(),e.cells[0].column());return sl(a,c)},Ml=function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=Nl(e.clipboard(),e.generators(),o),a=Rc.insert(i,t,u,e.generators(),n),c=ll(a,e.cells[0].row(),e.cells[0].column());return sl(a,c)},Fl=As.adjustWidthTo,Ll={insertRowBefore:oc(pl,ic,n,n,Hs.modification),insertRowsBefore:oc(hl,lc,n,n,Hs.modification),insertRowAfter:oc(vl,ic,n,n,Hs.modification),insertRowsAfter:oc(bl,lc,n,n,Hs.modification),insertColumnBefore:oc(yl,ic,Fl,n,Hs.modification),insertColumnsBefore:oc(wl,lc,Fl,n,Hs.modification),insertColumnAfter:oc(xl,ic,Fl,n,Hs.modification),insertColumnsAfter:oc(Cl,lc,Fl,n,Hs.modification),splitCellIntoColumns:oc(El,ic,Fl,n,Hs.modification),splitCellIntoRows:oc(Dl,ic,n,n,Hs.modification),eraseColumns:oc(Al,lc,Fl,cl,Hs.modification),eraseRows:oc(_l,lc,n,cl,Hs.modification),makeColumnHeader:oc(kl,ic,n,n,Hs.transform("row","th")),unmakeColumnHeader:oc(Tl,ic,n,n,Hs.transform(null,"td")),makeRowHeader:oc(Sl,ic,n,n,Hs.transform("col","th")),unmakeRowHeader:oc(Ol,ic,n,n,Hs.transform(null,"td")),mergeCells:oc(Rl,cc,n,n,Hs.merging),unmergeCells:oc(Bl,sc,Fl,n,Hs.merging),pasteCells:oc(Il,uc,Fl,n,Hs.modification),pasteRowsBefore:oc(Pl,ac,n,n,Hs.modification),pasteRowsAfter:oc(Ml,ac,n,n,Hs.modification)},Hl=function(t){return It.fromDom(t.getBody())},zl=function(t){return t.getBoundingClientRect().width},jl=function(t){return t.getBoundingClientRect().height},Vl=function(t){return function(e){return Ge(e,Hl(t))}},Ul=function(t){return t?t.replace(/px$/,""):""},Wl=function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},Gl=function(t){var e=Nn(t,"td[data-mce-style],th[data-mce-style]");yt(t,"data-mce-style"),R(e,(function(t){yt(t,"data-mce-style")}))},ql=function(t){return"rtl"===jt(t,"direction")?"rtl":"ltr"},Xl={isRtl:o(!1)},$l={isRtl:o(!0)},Yl=function(t){var e=ql(t);return"rtl"===e?$l:Xl},Kl={directionAt:Yl},Jl="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol",Ql={"border-collapse":"collapse",width:"100%"},Zl={border:"1"},tf=function(t){return t.getParam("table_default_attributes",Zl,"object")},ef=function(t){return t.getParam("table_default_styles",Ql,"object")},nf=function(t){return t.getParam("table_resize_bars",!0,"boolean")},rf=function(t){return t.getParam("table_tab_navigation",!0,"boolean")},of=function(t){return t.getParam("table_cell_advtab",!0,"boolean")},uf=function(t){return t.getParam("table_row_advtab",!0,"boolean")},af=function(t){return t.getParam("table_advtab",!0,"boolean")},cf=function(t){return t.getParam("table_appearance_options",!0,"boolean")},sf=function(t){return t.getParam("table_grid",!0,"boolean")},lf=function(t){return t.getParam("table_style_by_css",!1,"boolean")},ff=function(t){return t.getParam("table_cell_class_list",[],"array")},df=function(t){return t.getParam("table_row_class_list",[],"array")},mf=function(t){return t.getParam("table_class_list",[],"array")},gf=function(t){return!0===t.getParam("table_responsive_width")},pf=function(t){return!1===t.getParam("table_responsive_width")},hf=function(t){return t.getParam("table_toolbar",Jl)},vf=function(t){var e=t.getParam("table_clone_elements");return y(e)?p.some(e.split(/[ ,]/)):Array.isArray(e)?p.some(e):p.none()},bf=function(t){var e=t.getParam("object_resizing",!0);return y(e)?"table"===e:e},yf=function(t,e){return t.fire("newrow",{node:e})},wf=function(t,e){return t.fire("newcell",{node:e})},xf=function(t,e,n,r){t.fire("ObjectResizeStart",{target:e,width:n,height:r})},Cf=function(t,e,n,r){t.fire("ObjectResized",{target:e,width:n,height:r})},Sf=function(t,e,n,r,o){t.fire("TableSelectionChange",{cells:e,start:n,finish:r,otherCells:o})},kf=function(t){t.fire("TableSelectionClear")},Of=function(t,e){var r=function(t){return"table"===ct(Hl(t))},o=function(e){var n=Gu.getGridSize(e);return!1===r(t)||n.rows()>1},i=function(e){var n=Gu.getGridSize(e);return!1===r(t)||n.columns()>1},u=vf(t),a=function(e,n,r,o){return function(i,a){Gl(i);var c=o(),s=It.fromDom(t.getDoc()),l=Uu(Kl.directionAt),f=Yr.cellOperations(r,s,u);return n(i)?e(c,i,a,f,l).bind((function(e){return R(e.newRows(),(function(e){yf(t,e.dom())})),R(e.newCells(),(function(e){wf(t,e.dom())})),e.cursor().map((function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n}))})):p.none()}},c=a(Ll.eraseRows,o,n,e),s=a(Ll.eraseColumns,i,n,e),f=a(Ll.insertRowsBefore,l,n,e),d=a(Ll.insertRowsAfter,l,n,e),m=a(Ll.insertColumnsBefore,l,wu.halve,e),g=a(Ll.insertColumnsAfter,l,wu.halve,e),h=a(Ll.mergeCells,l,n,e),v=a(Ll.unmergeCells,l,n,e),b=a(Ll.pasteRowsBefore,l,n,e),y=a(Ll.pasteRowsAfter,l,n,e),w=a(Ll.pasteCells,l,n,e);return{deleteRow:c,deleteColumn:s,insertRowsBefore:f,insertRowsAfter:d,insertColumnsBefore:m,insertColumnsAfter:g,mergeCells:h,unmergeCells:v,pasteRowsBefore:b,pasteRowsAfter:y,pasteCells:w}},Tf=function(t,e,n){var r=sr.fromTable(t),o=hr.generate(r),i=lc(o,e);return i.map((function(t){var e=Za.toGrid(o,n,!1),r=e.slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),i=nc(r,n);return Ju.copy(i)}))},Ef={copyRows:Tf},Df=tinymce.util.Tools.resolve("tinymce.util.Tools"),Af=function(t,e,n){var r,o=t.select("td,th",e),i=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if("undefined"===typeof e&&(e=i),e!==i)return""}return e};return r=i(r,o),r},_f=function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},Rf=function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},Bf=function(t,e){Df.each("left center right".split(" "),(function(n){t.formatter.remove("align"+n,{},e)}))},If=function(t,e){Df.each("top middle bottom".split(" "),(function(n){t.formatter.remove("valign"+n,{},e)}))},Nf={applyAlign:_f,applyVAlign:Rf,unApplyAlign:Bf,unApplyVAlign:If,getTDTHOverallStyle:Af},Pf=function(t,e,n){var r=function(t,n){return n=n||[],Df.each(t,(function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)})),n};return r(t,n||[])},Mf=function(t,e){var n=function(e){return St(e,"rgb")?t.toHex(e):e},r=Ut(It.fromDom(e),"border-width").getOr(""),o=Ut(It.fromDom(e),"border-style").getOr(""),i=Ut(It.fromDom(e),"border-color").map(n).getOr(""),u=Ut(It.fromDom(e),"background-color").map(n).getOr("");return{borderwidth:r,borderstyle:o,bordercolor:i,backgroundcolor:u}},Ff=function(t){var e=t[0],n=t.slice(1),r=U(e);return R(n,(function(t){R(r,(function(n){G(t,(function(t,r){var o=e[n];""!==o&&n===r&&o!==t&&(e[n]="")}))}))})),e},Lf=function(t){var e=[{name:"borderstyle",type:"selectbox",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{name:"bordercolor",type:"colorinput",label:"Border color"},{name:"backgroundcolor",type:"colorinput",label:"Background color"}],n={name:"borderwidth",type:"input",label:"Border width"},r="cell"===t?[n].concat(e):e;return{title:"Advanced",name:"advanced",items:r}},Hf=function(t,e,n,r,o){var i={};return Df.each(t.split(" "),(function(t){r.formatter.matchNode(o,e+t)&&(i[n]=t)})),i[n]||(i[n]=""),i},zf=u(Hf,"left center right"),jf=u(Hf,"top middle bottom"),Vf=function(t,e){var n=ef(t),r=tf(t),o=function(t){var e=function(e){return St(e,"rgb")?t.toHex(e):e},r=$(n,"border-style").getOr(""),o=$(n,"border-color").getOr(""),i=$(n,"background-color").getOr("");return{borderstyle:r,bordercolor:e(o),backgroundcolor:e(i)}},i={height:"",width:"100%",cellspacing:"",cellpadding:"",caption:!1,class:"",align:"",border:""},u=function(){var e=n["border-width"];return lf(t)&&e?{border:e}:$(r,"border").fold((function(){return{}}),(function(t){return{border:t}}))},a=t.dom,c=e?o(a):{},s=function(){var t=$(n,"border-spacing").or($(r,"cellspacing")).fold((function(){return{}}),(function(t){return{cellspacing:t}})),e=$(n,"border-padding").or($(r,"cellpadding")).fold((function(){return{}}),(function(t){return{cellpadding:t}}));return Kt(Kt({},t),e)},l=Kt(Kt(Kt(Kt(Kt(Kt({},i),n),r),c),u()),s());return l},Uf=function(t,e,n){var r=function(e,n){var r=Ut(It.fromDom(n),"border-width");return lf(t)&&r.isSome()?r.getOr(""):e.getAttrib(n,"border")||Nf.getTDTHOverallStyle(t.dom,n,"border-width")||Nf.getTDTHOverallStyle(t.dom,n,"border")},o=t.dom,i=Kt(Kt({width:o.getStyle(e,"width")||o.getAttrib(e,"width"),height:o.getStyle(e,"height")||o.getAttrib(e,"height"),cellspacing:o.getStyle(e,"border-spacing")||o.getAttrib(e,"cellspacing"),cellpadding:o.getAttrib(e,"cellpadding")||Nf.getTDTHOverallStyle(t.dom,e,"padding"),border:r(o,e),caption:!!o.select("caption",e)[0],class:o.getAttrib(e,"class","")},zf("align","align",t,e)),n?Mf(o,e):{});return i},Wf=function(t,e,n){var r=t.dom,o=Kt(Kt({height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),class:r.getAttrib(e,"class",""),align:"",type:e.parentNode.nodeName.toLowerCase()},zf("align","align",t,e)),n?Mf(r,e):{});return o},Gf=function(t,e,n){var r=t.dom,o=Kt(Kt(Kt({width:r.getStyle(e,"width")||r.getAttrib(e,"width"),height:r.getStyle(e,"height")||r.getAttrib(e,"height"),scope:r.getAttrib(e,"scope"),celltype:e.nodeName.toLowerCase(),class:r.getAttrib(e,"class","")},zf("align","halign",t,e)),jf("valign","valign",t,e)),n?Mf(r,e):{});return o},qf={buildListItems:Pf,extractAdvancedStyles:Mf,getSharedValues:Ff,getAdvancedTab:Lf,extractDataFromTableElement:Uf,extractDataFromRowElement:Wf,extractDataFromCellElement:Gf,extractDataFromSettings:Vf},Xf=function(t){var e=ff(t),n=qf.buildListItems(e,(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})}));return e.length>0?p.some({name:"class",type:"selectbox",label:"Class",items:n}):p.none()},$f=[{name:"width",type:"input",label:"Width"},{name:"height",type:"input",label:"Height"},{name:"celltype",type:"selectbox",label:"Cell type",items:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{name:"scope",type:"selectbox",label:"Scope",items:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{name:"halign",type:"selectbox",label:"H Align",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{name:"valign",type:"selectbox",label:"V Align",items:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}],Yf=function(t){return Xf(t).fold((function(){return $f}),(function(t){return $f.concat(t)}))},Kf={getItems:Yf},Jf=function(t,e){var n=function(n,r){t.setAttrib(e,n,r)},r=function(n,r){t.setStyle(e,n,r)};return{setAttrib:n,setStyle:r}},Qf=function(t,e){var n=function(n,r){r&&t.setAttrib(e,n,r)},r=function(n,r){r&&t.setStyle(e,n,r)};return{setAttrib:n,setStyle:r}},Zf={normal:Jf,ifTruthy:Qf},td=function(t,e){t.setAttrib("scope",e.scope),t.setAttrib("class",e.class),t.setStyle("width",Wl(e.width)),t.setStyle("height",Wl(e.height))},ed=function(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle),t.setStyle("border-width",Wl(e.borderwidth))},nd=function(t,e,n){var r=t.dom,o=n.celltype&&e[0].nodeName.toLowerCase()!==n.celltype?r.rename(e[0],n.celltype):e[0],i=Zf.normal(r,o);td(i,n),of(t)&&ed(i,n),Nf.unApplyAlign(t,o),Nf.unApplyVAlign(t,o),n.halign&&Nf.applyAlign(t,o,n.halign),n.valign&&Nf.applyVAlign(t,o,n.valign)},rd=function(t,e,n){var r=t.dom;Df.each(e,(function(e){n.celltype&&e.nodeName.toLowerCase()!==n.celltype&&(e=r.rename(e,n.celltype));var o=Zf.ifTruthy(r,e);td(o,n),of(t)&&ed(o,n),n.halign&&Nf.applyAlign(t,e,n.halign),n.valign&&Nf.applyVAlign(t,e,n.valign)}))},od=function(t,e,n){var r=n.getData();n.close(),t.undoManager.transact((function(){var n=1===e.length?nd:rd;n(t,e,r),t.focus()}))},id=function(t){var e,n=[];if(n=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!n.length&&e&&n.push(e),e=e||n[0],e){var r=Df.map(n,(function(e){return qf.extractDataFromCellElement(t,e,of(t))})),o=qf.getSharedValues(r),i={type:"tabpanel",tabs:[{title:"General",name:"general",items:Kf.getItems(t)},qf.getAdvancedTab("cell")]},a={type:"panel",items:[{type:"grid",columns:2,items:Kf.getItems(t)}]};t.windowManager.open({title:"Cell Properties",size:"normal",body:of(t)?i:a,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o,onSubmit:u(od,t,n)})}},ud={open:id},ad=function(t){var e=df(t),n=qf.buildListItems(e,(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})}));return e.length>0?p.some({name:"class",type:"selectbox",label:"Class",items:n}):p.none()},cd=[{type:"selectbox",name:"type",label:"Row type",items:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height",type:"input"}],sd=function(t){return ad(t).fold((function(){return cd}),(function(t){return cd.concat(t)}))},ld={getItems:sd},fd=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)},dd=function(t,e){t.setStyle("background-color",e.backgroundcolor),t.setStyle("border-color",e.bordercolor),t.setStyle("border-style",e.borderstyle)},md=function(t,e,n,r){var o=t.dom,i=r.getData();r.close();var u=1===e.length?Zf.normal:Zf.ifTruthy;t.undoManager.transact((function(){Df.each(e,(function(e){i.type!==e.parentNode.nodeName.toLowerCase()&&fd(t.dom,e,i.type);var r=u(o,e);r.setAttrib("scope",i.scope),r.setAttrib("class",i.class),r.setStyle("height",Wl(i.height)),uf(t)&&dd(r,i),i.align!==n.align&&(Nf.unApplyAlign(t,e),Nf.applyAlign(t,e,i.align))})),t.focus()}))},gd=function(t){var e,n,r,o=t.dom,i=[];if(e=o.getParent(t.selection.getStart(),"table"),e&&(n=o.getParent(t.selection.getStart(),"td,th"),Df.each(e.rows,(function(t){Df.each(t.cells,(function(e){if((o.getAttrib(e,"data-mce-selected")||e===n)&&i.indexOf(t)<0)return i.push(t),!1}))})),r=i[0],r)){var a=Df.map(i,(function(e){return qf.extractDataFromRowElement(t,e,uf(t))})),c=qf.getSharedValues(a),s={type:"tabpanel",tabs:[{title:"General",name:"general",items:ld.getItems(t)},qf.getAdvancedTab("row")]},l={type:"panel",items:[{type:"grid",columns:2,items:ld.getItems(t)}]};t.windowManager.open({title:"Row Properties",size:"normal",body:uf(t)?s:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onSubmit:u(md,t,i,c)})}},pd={open:gd},hd=Object.prototype.hasOwnProperty,vd=function(t,e){return e},bd=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)hd.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},yd=bd(vd),wd=tinymce.util.Tools.resolve("tinymce.Env"),xd={styles:{"border-collapse":"collapse",width:"100%"},attributes:{border:"1"},percentages:!0},Cd=function(){return It.fromTag("table")},Sd=function(){return It.fromTag("tbody")},kd=function(){return It.fromTag("tr")},Od=function(){return It.fromTag("th")},Td=function(){return It.fromTag("td")},Ed=function(t,e,n,r,o){void 0===o&&(o=xd);var i=Cd();zt(i,o.styles),ht(i,o.attributes);var u=Sd();ln(i,u);for(var a=[],c=0;c<t;c++){for(var s=kd(),l=0;l<e;l++){var f=c<n||l<r?Od():Td();l<r&&pt(f,"scope","row"),c<n&&pt(f,"scope","col"),ln(f,It.fromTag("br")),o.percentages&&Ht(f,"width",100/e+"%"),ln(s,f)}a.push(s)}return gn(u,a),i},Dd=function(t){return t.dom().innerHTML},Ad=function(t){var e=It.fromTag("div"),n=It.fromDom(t.dom().cloneNode(!0));return ln(e,n),Dd(e)},_d=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},Rd=function(t,e){Vn(e,"td,th").each(u(_d,t))},Bd=function(t,e){R(Nn(e,"tr"),(function(e){yf(t,e.dom()),R(Nn(e,"th,td"),(function(e){wf(t,e.dom())}))}))},Id=function(t){return y(t)&&-1!==t.indexOf("%")},Nd=function(t,e,n){var r=ef(t),o={styles:r,attributes:tf(t),percentages:Id(r.width)&&!pf(t)},i=Ed(n,e,0,0,o);pt(i,"data-mce-id","__mce");var u=Ad(i);return t.insertContent(u),Vn(Hl(t),'table[data-mce-id="__mce"]').map((function(e){return pf(t)&&Ht(e,"width",jt(e,"width")),yt(e,"data-mce-id"),Bd(t,e),Rd(t,e),e.dom()})).getOr(null)},Pd={insert:Nd},Md=function(t,e,n){var r=n?[{type:"input",name:"cols",label:"Cols",inputMode:"numeric"},{type:"input",name:"rows",label:"Rows",inputMode:"numeric"}]:[],o=[{type:"input",name:"width",label:"Width"},{type:"input",name:"height",label:"Height"}],i=cf(t)?[{type:"input",name:"cellspacing",label:"Cell spacing",inputMode:"numeric"},{type:"input",name:"cellpadding",label:"Cell padding",inputMode:"numeric"},{type:"input",name:"border",label:"Border width"},{type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]}]:[],u=[{type:"selectbox",name:"align",label:"Alignment",items:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]}],a=e?[{type:"selectbox",name:"class",label:"Class",items:qf.buildListItems(mf(t),(function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})}))}]:[];return r.concat(o).concat(i).concat(u).concat(a)},Fd={getItems:Md},Ld=function(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)y(n)?t.setStyle(e,n,r):t.setStyle(e,n);else if(e.children)for(var o=0;o<e.children.length;o++)Ld(t,e.children[o],n,r)},Hd=function(t,e,n){var r=t.dom,o={},i={};if(o.class=n.class,i.height=Wl(n.height),r.getAttrib(e,"width")&&!lf(t)?o.width=Ul(n.width):i.width=Wl(n.width),lf(t)?(i["border-width"]=Wl(n.border),i["border-spacing"]=Wl(n.cellspacing)):(o.border=n.border,o.cellpadding=n.cellpadding,o.cellspacing=n.cellspacing),lf(t)&&e.children)for(var u=0;u<e.children.length;u++)Ld(r,e.children[u],{"border-width":Wl(n.border),padding:Wl(n.cellpadding)}),af(t)&&Ld(r,e.children[u],{"border-color":n.bordercolor});af(t)&&(i["background-color"]=n.backgroundcolor,i["border-color"]=n.bordercolor,i["border-style"]=n.borderstyle),o.style=r.serializeStyle(yd(ef(t),i)),r.setAttribs(e,yd(tf(t),o))},zd=function(t,e,n){var r,o=t.dom,i=n.getData();n.close(),""===i.class&&delete i.class,t.undoManager.transact((function(){if(!e){var n=parseInt(i.cols,10)||1,u=parseInt(i.rows,10)||1;e=Pd.insert(t,n,u)}Hd(t,e,i),r=o.select("caption",e)[0],r&&!i.caption&&o.remove(r),!r&&i.caption&&(r=o.create("caption"),r.innerHTML=wd.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),""===i.align?Nf.unApplyAlign(t,e):Nf.applyAlign(t,e,i.align),t.focus(),t.addVisual()}))},jd=function(t,e){var n,r=t.dom,o=qf.extractDataFromSettings(t,af(t));!1===e?(n=r.getParent(t.selection.getStart(),"table"),n?o=qf.extractDataFromTableElement(t,n,af(t)):af(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor="")):(o.cols="1",o.rows="1",af(t)&&(o.borderstyle="",o.bordercolor="",o.backgroundcolor=""));var i=mf(t).length>0;i&&o.class&&(o.class=o.class.replace(/\s*mce\-item\-table\s*/g,""));var a={type:"grid",columns:2,items:Fd.getItems(t,i,e)},c=function(){return{type:"panel",items:[a]}},s=function(){return{type:"tabpanel",tabs:[{title:"General",name:"general",items:[a]},qf.getAdvancedTab("table")]}},l=af(t)?s():c();t.windowManager.open({title:"Table Properties",size:"normal",body:l,onSubmit:u(zd,t,n),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:o})},Vd={open:jd},Ud=function(t){return function(e){return p.from(e.dom.getParent(e.selection.getStart(),t)).map(It.fromDom)}},Wd=Ud("th,td"),Gd=Ud("th,td,caption"),qd=Df.each,Xd=function(t,e,r,o,i){var c=Vl(t),s=function(){Gd(t).each((function(e){var n=ur.table(e,c);n.filter(a(c)).each((function(e){var n=It.fromText("");if(cn(e,n),hn(e),t.dom.isEmpty(t.getBody()))t.setContent(""),t.selection.setCursorLocation();else{var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r),t.nodeChanged()}}))}))},l=function(t){return ur.table(t,c)},f=function(t){return{width:zl(t.dom()),height:zl(t.dom())}},d=function(t,e,n){var r=f(n);e.width===r.width&&e.height===r.height||(xf(t,n.dom(),e.width,e.height),Cf(t,n.dom(),r.width,r.height))},m=function(e){Wd(t).each((function(n){l(n).each((function(i){var u=Ai.forMenu(o,i,n),a=f(i);e(i,u).each((function(e){d(t,a,i),t.selection.setRng(e),t.focus(),r.clear(i),Gl(i)}))}))}))},g=function(e){return Wd(t).map((function(e){return l(e).bind((function(r){var i=It.fromDom(t.getDoc()),u=Ai.forMenu(o,r,e),a=Yr.cellOperations(n,i,p.none());return Ef.copyRows(r,u,a)}))}))},h=function(e){i.get().each((function(n){var i=_(n,(function(t){return Hr(t)}));Wd(t).each((function(n){l(n).each((function(u){var a=It.fromDom(t.getDoc()),c=Yr.paste(a),s=Ai.pasteRows(o,u,n,i,c);e(u,s).each((function(e){t.selection.setRng(e),t.focus(),r.clear(u)}))}))}))}))};qd({mceTableSplitCells:function(){m(e.unmergeCells)},mceTableMergeCells:function(){m(e.mergeCells)},mceTableInsertRowBefore:function(){m(e.insertRowsBefore)},mceTableInsertRowAfter:function(){m(e.insertRowsAfter)},mceTableInsertColBefore:function(){m(e.insertColumnsBefore)},mceTableInsertColAfter:function(){m(e.insertColumnsAfter)},mceTableDeleteCol:function(){m(e.deleteColumn)},mceTableDeleteRow:function(){m(e.deleteRow)},mceTableCutRow:function(t){g().each((function(t){i.set(t),m(e.deleteRow)}))},mceTableCopyRow:function(t){g().each((function(t){i.set(t)}))},mceTablePasteRowBefore:function(t){h(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){h(e.pasteRowsAfter)},mceTableDelete:s},(function(e,n){t.addCommand(n,e)})),qd({mceInsertTable:u(Vd.open,t,!0),mceTableProps:u(Vd.open,t,!1),mceTableRowProps:u(pd.open,t),mceTableCellProps:u(ud.open,t)},(function(e,n){t.addCommand(n,(function(){e()}))}))},$d={registerCommands:Xd},Yd=function(t){var e=p.from(t.dom().documentElement).map(It.fromDom).getOr(t);return{parent:o(e),view:o(t),origin:o(Cu(0,0))}},Kd=function(t,e){var n=function(){return Ou(e)};return{parent:o(e),view:o(t),origin:n}},Jd=function(t,e){return{parent:o(e),view:o(t),origin:o(Cu(0,0))}},Qd={only:Yd,detached:Kd,body:Jd},Zd=function(t){var e=K.apply(null,t),n=[],r=function(t){if(void 0===t)throw new Error("Event bind error: undefined handler");n.push(t)},o=function(t){n=I(n,(function(e){return e!==t}))},i=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var o=e.apply(null,t);R(n,(function(t){t(o)}))};return{bind:r,unbind:o,trigger:i}},tm=function(t){var e=q(t,(function(t){return{bind:t.bind,unbind:t.unbind}})),n=q(t,(function(t){return t.trigger}));return{registry:e,trigger:n}},em={create:tm},nm=function(t,e,n,r,i,u,a){return{target:o(t),x:o(e),y:o(n),stop:r,prevent:i,kill:u,raw:o(a)}},rm=function(t){var e=It.fromDom(t.target),n=function(){t.stopPropagation()},o=function(){t.preventDefault()},i=r(o,n);return nm(e,t.clientX,t.clientY,n,o,i,t)},om=function(t,e){return function(n){t(n)&&e(rm(n))}},im=function(t,e,n,r,o){var i=om(n,r);return t.dom().addEventListener(e,i,o),{unbind:u(am,t,e,i,o)}},um=function(t,e,n,r){return im(t,e,n,r,!1)},am=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},cm=o(!0),sm=function(t,e,n){return um(t,e,cm,n)},lm=ha("ephox-dragster"),fm={resolve:lm.resolve},dm=function(t){var e=yd({layerClass:fm.resolve("blocker")},t),n=It.fromTag("div");pt(n,"role","presentation"),zt(n,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),ia(n,fm.resolve("blocker")),ia(n,e.layerClass);var r=function(){return n},o=function(){hn(n)};return{element:r,destroy:o}},mm=Is(["compare","extract","mutate","sink"]),gm=Is(["element","start","stop","destroy"]),pm=Is(["forceDrop","drop","move","delayDrop"]),hm=function(t,e){return Cu(e.left()-t.left(),e.top()-t.top())},vm=function(t){return p.some(Cu(t.x(),t.y()))},bm=function(t,e){t.mutate(e.left(),e.top())},ym=function(t,e){var n=dm(e),r=sm(n.element(),"mousedown",t.forceDrop),o=sm(n.element(),"mouseup",t.drop),i=sm(n.element(),"mousemove",t.move),u=sm(n.element(),"mouseout",t.delayDrop),a=function(){n.destroy(),o.unbind(),i.unbind(),u.unbind(),r.unbind()},c=function(t){ln(t,n.element())},s=function(){hn(n.element())};return gm({element:n.element,start:c,stop:s,destroy:a})},wm=mm({compare:hm,extract:vm,sink:ym,mutate:bm}),xm=function(e,n){var r=null,o=function(){null!==r&&(t.clearTimeout(r),r=null)},i=function(){for(var o=[],i=0;i<arguments.length;i++)o[i]=arguments[i];null!==r&&t.clearTimeout(r),r=t.setTimeout((function(){e.apply(null,o),r=null}),n)};return{cancel:o,throttle:i}};function Cm(){var t=p.none(),e=function(){t=p.none()},n=function(e,n){var r=t.map((function(t){return e.compare(t,n)}));return t=p.some(n),r},r=function(t,e){var r=e.extract(t);r.each((function(t){var r=n(e,t);r.each((function(t){o.trigger.move(t)}))}))},o=em.create({move:Zd(["info"])});return{onEvent:r,reset:e,events:o.registry}}function Sm(){return{onEvent:n,reset:n}}function km(){var t=Sm(),e=Cm(),n=t,r=function(){n.reset(),n=e},o=function(){n.reset(),n=t},i=function(t,e){n.onEvent(t,e)},u=function(){return n===e};return{on:r,off:o,isOn:u,onEvent:i,events:e.events}}var Om=function(t,e,n){var r=!1,o=em.create({start:Zd([]),stop:Zd([])}),i=km(),u=function(){m.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=xm(u,200),c=function(t){m.start(t),i.on(),o.trigger.start()},s=function(t){a.cancel(),i.onEvent(t,e)};i.events.move.bind((function(n){e.mutate(t,n.info())}));var l=function(){r=!0},f=function(){r=!1},d=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r&&t.apply(null,e)}},m=e.sink(pm({forceDrop:u,drop:d(u),move:d(s),delayDrop:d(a.throttle)}),n),g=function(){m.destroy()};return{element:m.element,go:c,on:l,off:f,destroy:g,events:o.registry}},Tm={setup:Om},Em=function(t,e){void 0===e&&(e={});var n=void 0!==e.mode?e.mode:wm;return Tm.setup(t,n,e)},Dm={transform:Em},Am=function(){var t=em.create({drag:Zd(["xDelta","yDelta"])}),e=function(e,n){t.trigger.drag(e,n)};return{mutate:e,events:t.registry}},_m=function(){var t=em.create({drag:Zd(["xDelta","yDelta","target"])}),e=p.none(),n=Am();n.events.drag.bind((function(n){e.each((function(e){t.trigger.drag(n.xDelta(),n.yDelta(),e)}))}));var r=function(t){e=p.some(t)},o=function(){return e};return{assign:r,get:o,mutate:n.mutate,events:t.registry}},Rm=function(t){return"true"===vt(t,"contenteditable")},Bm=function(t,e){return Un(t,"[contenteditable]",e)},Im=ba.resolve("resizer-bar-dragging"),Nm=function(t,e,n){var r=_m(),o=Dm.transform(r,{}),i=p.none(),a=function(t,e){return p.from(vt(t,e))};r.events.drag.bind((function(t){a(t.target(),"data-row").each((function(e){var n=ts.getInt(t.target(),"top");Ht(t.target(),"top",n+t.yDelta()+"px")})),a(t.target(),"data-column").each((function(e){var n=ts.getInt(t.target(),"left");Ht(t.target(),"left",n+t.xDelta()+"px")}))}));var c=function(t,e){var n=ts.getInt(t,e),r=parseInt(vt(t,"data-initial-"+e),10);return n-r};o.events.stop.bind((function(){r.get().each((function(r){i.each((function(o){a(r,"data-row").each((function(t){var e=c(r,"top");yt(r,"data-initial-top"),v.trigger.adjustHeight(o,e,parseInt(t,10))})),a(r,"data-column").each((function(t){var e=c(r,"left");yt(r,"data-initial-left"),v.trigger.adjustWidth(o,e,parseInt(t,10))})),Fa.refresh(t,o,n,e)}))}))}));var s=function(e,n){v.trigger.startAdjust(),r.assign(e),pt(e,"data-initial-"+n,parseInt(jt(e,n),10)),ia(e,Im),Ht(e,"opacity","0.2"),o.go(t.parent())},l=sm(t.parent(),"mousedown",(function(t){Fa.isRowBar(t.target())&&s(t.target(),"top"),Fa.isColBar(t.target())&&s(t.target(),"left")})),f=function(e){return Ge(e,t.view())},d=function(t){return Un(t,"table",f).filter((function(t){return Bm(t,f).exists(Rm)}))},m=sm(t.view(),"mouseover",(function(r){d(r.target()).fold((function(){Nt(r.target())&&Fa.destroy(t)}),(function(r){i=p.some(r),Fa.refresh(t,r,n,e)}))})),g=function(){l.unbind(),m.unbind(),o.destroy(),Fa.destroy(t)},h=function(r){Fa.refresh(t,r,n,e)},v=em.create({adjustHeight:Zd(["table","delta","row"]),adjustWidth:Zd(["table","delta","column"]),startAdjust:Zd([])});return{destroy:g,refresh:h,on:o.on,off:o.off,hideBars:u(Fa.hide,t),showBars:u(Fa.show,t),events:v.registry}},Pm=function(t,e){var n=ju.height,r=Nm(t,e,n),o=em.create({beforeResize:Zd(["table"]),afterResize:Zd(["table"]),startDrag:Zd([])});return r.events.adjustHeight.bind((function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());As.adjustHeight(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())})),r.events.startAdjust.bind((function(t){o.trigger.startDrag()})),r.events.adjustWidth.bind((function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());As.adjustWidth(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())})),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}},Mm={create:Pm},Fm=function(){var t=It.fromTag("div");return zt(t,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),ln(Pt(),t),t},Lm=function(t,e){return t.inline?Qd.body(Hl(t),Fm()):Qd.only(It.fromDom(t.getDoc()))},Hm=function(t,e){t.inline&&hn(e.parent())},zm={get:Lm,remove:Hm},jm=function(t,e){return zl(t.dom())/zl(e.dom())*100+"%"},Vm=function(t){var e=It.fromDom(t);Ze(e).map((function(t){return jm(e,t)})).each((function(t){Ht(e,"width",t),R(Nn(e,"tr"),(function(t){R(rn(t),(function(e){Ht(e,"width",jm(e,t))}))}))}))},Um=function(t){Ht(It.fromDom(t),"width",zl(t).toString()+"px")},Wm=function(t){var e,n,r=p.none(),o=p.none(),i=p.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName},c=function(e){var n=t.dom.getStyle(e,"width")||t.dom.getAttrib(e,"width");return p.from(n).filter((function(t){return t.length>0}))},s=function(){return o},l=function(){return i.getOr(Qd.only(It.fromDom(t.getBody())))},f=function(){o.each((function(t){t.destroy()})),i.each((function(e){zm.remove(t,e)}))};return t.on("init",(function(){var e=Uu(Kl.directionAt),n=zm.get(t);if(i=p.some(n),bf(t)&&nf(t)){var u=Mm.create(n,e);u.on(),u.events.startDrag.bind((function(e){r=p.some(t.selection.getRng())})),u.events.beforeResize.bind((function(e){var n=e.table().dom();xf(t,n,zl(n),jl(n))})),u.events.afterResize.bind((function(e){var n=e.table(),o=n.dom();Gl(n),r.each((function(e){t.selection.setRng(e),t.focus()})),Cf(t,o,zl(o),jl(o)),t.undoManager.add()})),o=p.some(u)}})),t.on("ObjectResizeStart",(function(r){var o=r.target;if(a(o)){var i=c(o).map((function(t){return u.test(t)})).getOr(!1);i&&pf(t)?Um(o):!i&&gf(t)&&Vm(o),e=r.width,n=c(o).getOr("")}})),t.on("ObjectResized",(function(r){var o=r.target;if(a(o)){var i=o;if(u.test(n)){var c=parseFloat(u.exec(n)[1]),s=r.width*c/e;t.dom.setStyle(i,"width",s+"%")}else{var l=[];Df.each(i.rows,(function(e){Df.each(e.cells,(function(e){var n=t.dom.getStyle(e,"width",!0);l.push({cell:e,width:n})}))})),Df.each(l,(function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)}))}}})),t.on("SwitchMode",(function(){s().each((function(e){t.readonly?e.hideBars():e.showBars()}))})),{lazyResize:s,lazyWire:l,destroy:f}},Gm=hi.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),qm=function(t){return void 0===t&&(t=void 0),Gm.none(t)},Xm=Kt(Kt({},Gm),{none:qm}),$m=function(t,e){return ur.table(t,e).bind((function(e){var n=ur.cells(e),r=F(n,(function(e){return Ge(t,e)}));return r.map((function(t){return{index:o(t),all:o(n)}}))}))},Ym=function(t,e){var n=$m(t,e);return n.fold((function(){return Xm.none(t)}),(function(e){return e.index()+1<e.all().length?Xm.middle(t,e.all()[e.index()+1]):Xm.last(t)}))},Km=function(t,e){var n=$m(t,e);return n.fold((function(){return Xm.none()}),(function(e){return e.index()-1>=0?Xm.middle(t,e.all()[e.index()-1]):Xm.first(t)}))},Jm={next:Ym,prev:Km},Qm=K("start","soffset","finish","foffset"),Zm={create:Qm},tg=hi.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),eg=function(t,e,n,r){return t.fold(e,n,r)},ng=function(t){return t.fold(i,i,i)},rg=tg.before,og=tg.on,ig=tg.after,ug={before:rg,on:og,after:ig,cata:eg,getStart:ng},ag=hi.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),cg=function(t){return ag.exact(t.start(),t.soffset(),t.finish(),t.foffset())},sg=function(t){return t.match({domRange:function(t){return It.fromDom(t.startContainer)},relative:function(t,e){return ug.getStart(t)},exact:function(t,e,n,r){return t}})},lg=ag.domRange,fg=ag.relative,dg=ag.exact,mg=function(t){var e=sg(t);return Qe(e)},gg=Zm.create,pg={domRange:lg,relative:fg,exact:dg,exactFromRange:cg,getWin:mg,range:gg},hg=function(t,e){var n=t.document.createRange();return vg(n,e),n},vg=function(t,e){t.selectNodeContents(e.dom())},bg=function(t,e){e.fold((function(e){t.setStartBefore(e.dom())}),(function(e,n){t.setStart(e.dom(),n)}),(function(e){t.setStartAfter(e.dom())}))},yg=function(t,e){e.fold((function(e){t.setEndBefore(e.dom())}),(function(e,n){t.setEnd(e.dom(),n)}),(function(e){t.setEndAfter(e.dom())}))},wg=function(t,e,n){var r=t.document.createRange();return bg(r,e),yg(r,n),r},xg=function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},Cg=function(t){return{left:o(t.left),top:o(t.top),right:o(t.right),bottom:o(t.bottom),width:o(t.width),height:o(t.height)}},Sg=function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?p.some(n).map(Cg):p.none()},kg=hi.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Og=function(t,e,n){return e(It.fromDom(n.startContainer),n.startOffset,It.fromDom(n.endContainer),n.endOffset)},Tg=function(t,e){return e.match({domRange:function(t){return{ltr:o(t),rtl:p.none}},relative:function(e,n){return{ltr:Et((function(){return wg(t,e,n)})),rtl:Et((function(){return p.some(wg(t,n,e))}))}},exact:function(e,n,r,o){return{ltr:Et((function(){return xg(t,e,n,r,o)})),rtl:Et((function(){return p.some(xg(t,r,o,e,n))}))}}})},Eg=function(t,e){var n=e.ltr();if(n.collapsed){var r=e.rtl().filter((function(t){return!1===t.collapsed}));return r.map((function(t){return kg.rtl(It.fromDom(t.endContainer),t.endOffset,It.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Og(t,kg.ltr,n)}))}return Og(t,kg.ltr,n)},Dg=function(t,e){var n=Tg(t,e);return Eg(t,n)},Ag=function(t,e){var n=Dg(t,e);return n.match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})},_g=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n<=a.bottom){if(n<a.top||c>i)return u-1;i=c}}return 0},Rg=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},Bg=function(t,e,n,r,o){var i=function(n){var r=t.dom().createRange();return r.setStart(e.dom(),n),r.collapse(!0),r},u=function(t){var e=i(t);return e.getBoundingClientRect()},a=Tr(e).length,c=_g(u,n,r,o.right,a);return i(c)},Ig=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects(),u=Xu(i,(function(t){return Rg(t,n,r)?p.some(t):p.none()}));return u.map((function(o){return Bg(t,e,n,r,o)}))},Ng=function(t,e,n,r){var o=t.dom().createRange(),i=rn(e);return Xu(i,(function(e){return o.selectNode(e.dom()),Rg(o.getBoundingClientRect(),n,r)?Pg(t,e,n,r):p.none()}))},Pg=function(t,e,n,r){return mt(e)?Ig(t,e,n,r):Ng(t,e,n,r)},Mg=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Pg(t,e,u,a)},Fg=!0,Lg=!1,Hg=function(t,e){return e-t.left<t.right-e?Fg:Lg},zg=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},jg=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=Hg(o,n),u=i===Fg?Nr:Pr;return u(e).map((function(e){return zg(t,e,i)}))},Vg=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=Hg(r,n);return p.some(zg(t,e,o))},Ug=function(t,e,n){var r=0===rn(e).length?Vg:jg;return r(t,e,n)},Wg=function(t,e,n){return p.from(t.dom().caretPositionFromPoint(e,n)).bind((function(e){if(null===e.offsetNode)return p.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),p.some(n)}))},Gg=function(t,e,n){return p.from(t.dom().caretRangeFromPoint(e,n))},qg=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return Mg(t,e,u,a)},Xg=function(t,e,n){return It.fromPoint(t,e,n).bind((function(r){var o=function(){return Ug(t,r,e)};return 0===rn(r).length?o():qg(t,r,e,n).orThunk(o)}))},$g=document.caretPositionFromPoint?Wg:document.caretRangeFromPoint?Gg:Xg,Yg=function(t,e,n){var r=It.fromDom(t.document);return $g(r,e,n).map((function(t){return Zm.create(It.fromDom(t.startContainer),t.startOffset,It.fromDom(t.endContainer),t.endOffset)}))},Kg=function(t,e){var n=ct(t);return"input"===n?ug.after(t):D(["br","img"],n)?0===e?ug.before(t):ug.after(t):ug.on(t,e)},Jg=function(t,e){var n=t.fold(ug.before,Kg,ug.after),r=e.fold(ug.before,Kg,ug.after);return pg.relative(n,r)},Qg=function(t,e,n,r){var o=Kg(t,e),i=Kg(n,r);return pg.relative(o,i)},Zg=function(t){return t.match({domRange:function(t){var e=It.fromDom(t.startContainer),n=It.fromDom(t.endContainer);return Qg(e,t.startOffset,n,t.endOffset)},relative:Jg,exact:Qg})},tp=function(t,e,n,r){var o=Je(t),i=o.dom().createRange();return i.setStart(t.dom(),e),i.setEnd(n.dom(),r),i},ep=function(t,e,n,r){var o=tp(t,e,n,r),i=Ge(t,n)&&e===r;return o.collapsed&&!i},np=function(t,e){p.from(t.getSelection()).each((function(t){t.removeAllRanges(),t.addRange(e)}))},rp=function(t,e,n,r,o){var i=xg(t,e,n,r,o);np(t,i)},op=function(t,e,n,r,o,i){e.collapse(n.dom(),r),e.extend(o.dom(),i)},ip=function(t,e){return Dg(t,e).match({ltr:function(e,n,r,o){rp(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();if(i.setBaseAndExtent)i.setBaseAndExtent(e.dom(),n,r.dom(),o);else if(i.extend)try{op(t,i,e,n,r,o)}catch(u){rp(t,r,o,e,n)}else rp(t,r,o,e,n)}})},up=function(t,e,n,r,o){var i=Qg(e,n,r,o);ip(t,i)},ap=function(t,e,n){var r=Jg(e,n);ip(t,r)},cp=function(t){var e=pg.getWin(t).dom(),n=function(t,n,r,o){return xg(e,t,n,r,o)},r=Zg(t);return Dg(e,r).match({ltr:n,rtl:n})},sp=function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return p.some(Zm.create(It.fromDom(e.startContainer),e.startOffset,It.fromDom(n.endContainer),n.endOffset))}return p.none()},lp=function(t){var e=It.fromDom(t.anchorNode),n=It.fromDom(t.focusNode);return ep(e,t.anchorOffset,n,t.focusOffset)?p.some(Zm.create(e,t.anchorOffset,n,t.focusOffset)):sp(t)},fp=function(t,e){var n=hg(t,e);np(t,n)},dp=function(t){return p.from(t.getSelection()).filter((function(t){return t.rangeCount>0})).bind(lp)},mp=function(t){return dp(t).map((function(t){return pg.exact(t.start(),t.soffset(),t.finish(),t.foffset())}))},gp=function(t,e){var n=Ag(t,e);return Sg(n)},pp=function(t,e,n){return Yg(t,e,n)},hp=function(t){var e=t.getSelection();e.removeAllRanges()},vp=tinymce.util.Tools.resolve("tinymce.util.VK"),bp=function(t,e,n,r){return Cp(t,e,Jm.next(n),r)},yp=function(t,e,n,r){return Cp(t,e,Jm.prev(n),r)},wp=function(t,e){var n=pg.exact(e,0,e,0);return cp(n)},xp=function(t,e){var n=Nn(e,"tr");return V(n).bind((function(e){return Vn(e,"td,th").map((function(e){return wp(t,e)}))}))},Cp=function(t,e,n,r,o){return n.fold(p.none,p.none,(function(e,n){return Nr(n).map((function(e){return wp(t,e)}))}),(function(n){return ur.table(n,e).bind((function(e){var o=Ai.noMenu(n);return t.undoManager.transact((function(){r.insertRowsAfter(e,o)})),xp(t,e)}))}))},Sp=["table","li","dl"],kp=function(t,e,n,r){if(t.keyCode===vp.TAB){var o=Hl(e),i=function(t){var e=ct(t);return Ge(t,o)||D(Sp,e)},u=e.selection.getRng();if(u.collapsed){var a=It.fromDom(u.startContainer);ur.cell(a,i).each((function(o){t.preventDefault();var u=t.shiftKey?yp:bp,a=u(e,i,o,n,r);a.each((function(t){e.selection.setRng(t)}))}))}}},Op={handle:kp},Tp=K("selection","kill"),Ep={create:Tp},Dp=function(t,e,n,r){return{start:o(ug.on(t,e)),finish:o(ug.on(n,r))}},Ap={create:Dp},_p=function(t,e){var n=Ag(t,e);return Zm.create(It.fromDom(n.startContainer),n.startOffset,It.fromDom(n.endContainer),n.endOffset)},Rp=Ap.create,Bp={convertToRange:_p,makeSitus:Rp},Ip=function(t,e,n,r,o,i,u){return Ge(n,o)&&r===i?p.none():Un(n,"td,th",e).bind((function(n){return Un(o,"td,th",e).bind((function(r){return Np(t,e,n,r,u)}))}))},Np=function(t,e,n,r,o){return Ge(n,r)?p.none():ri.identify(n,r,e).bind((function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),p.some(Ep.create(p.some(Bp.makeSitus(n,0,n,Ar(n))),!0))):p.none()}))},Pp=function(t,e,n,r,o){var i=function(t){return o.clearBeforeUpdate(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()};return ri.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(i)},Mp={sync:Ip,detect:Np,update:Pp},Fp=K("item","mode"),Lp=function(t,e,n,r){return void 0===r&&(r=Hp),t.property().parent(e).map((function(t){return Fp(t,r)}))},Hp=function(t,e,n,r){return void 0===r&&(r=zp),n.sibling(t,e).map((function(t){return Fp(t,r)}))},zp=function(t,e,n,r){void 0===r&&(r=zp);var o=t.property().children(e),i=n.first(o);return i.map((function(t){return Fp(t,r)}))},jp=[{current:Lp,next:Hp,fallback:p.none()},{current:Hp,next:zp,fallback:p.some(Lp)},{current:zp,next:zp,fallback:p.some(Hp)}],Vp=function(t,e,n,r,o){void 0===o&&(o=jp);var i=M(o,(function(t){return t.current===n}));return i.bind((function(n){return n.current(t,e,r,n.next).orThunk((function(){return n.fallback.bind((function(n){return Vp(t,e,n,r)}))}))}))},Up=function(){var t=function(t,e){return t.query().prevSibling(e)},e=function(t){return t.length>0?p.some(t[t.length-1]):p.none()};return{sibling:t,first:e}},Wp=function(){var t=function(t,e){return t.query().nextSibling(e)},e=function(t){return t.length>0?p.some(t[0]):p.none()};return{sibling:t,first:e}},Gp={left:Up,right:Wp},qp=function(t,e,n,r,o,i){var u=Vp(t,e,r,o);return u.bind((function(e){return i(e.item())?p.none():n(e.item())?p.some(e.item()):qp(t,e.item(),n,e.mode(),o,i)}))},Xp=function(t,e,n,r){return qp(t,e,n,Hp,Gp.left(),r)},$p=function(t,e,n,r){return qp(t,e,n,Hp,Gp.right(),r)},Yp=function(t){return function(e){return 0===t.property().children(e).length}},Kp=function(t,e,n){return Qp(t,e,Yp(t),n)},Jp=function(t,e,n){return Zp(t,e,Yp(t),n)},Qp=Xp,Zp=$p,th=vo(),eh=function(t,e){return Kp(th,t,e)},nh=function(t,e){return Jp(th,t,e)},rh=function(t,e,n){return Qp(th,t,e,n)},oh=function(t,e,n){return Zp(th,t,e,n)},ih=function(t,e,n){return Mn(t,e,n).isSome()},uh=K("element","offset"),ah=(K("element","deltaOffset"),K("element","start","finish"),K("begin","end"),K("element","text"),hi.generate([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}])),ch=function(t,e,n){var r=t.getRect(e),o=t.getRect(n);return o.right>r.left&&o.left<r.right},sh=function(t){return Un(t,"tr")},lh=function(t,e,n,r,o,i,u){return Un(r,"td,th",u).bind((function(n){return Un(e,"td,th",u).map((function(e){return Ge(n,e)?Ge(r,n)&&Ar(n)===o?i(e):ah.none("in same cell"):Xo.sharedOne(sh,[n,e]).fold((function(){return ch(t,e,n)?ah.success():i(e)}),(function(t){return i(e)}))}))})).getOr(ah.none("default"))},fh=function(t,e,n,r,o){return t.fold(e,n,r,o)},dh=Kt(Kt({},ah),{verify:lh,cata:fh}),mh=(K("ancestor","descendants","element","index"),K("parent","children","element","index")),gh=function(t){return Ze(t).bind((function(e){var n=rn(e);return ph(n,t).map((function(r){return mh(e,n,t,r)}))}))},ph=function(t,e){return F(t,u(Ge,e))},hh=function(t){return"br"===ct(t)},vh=function(t,e,n){return e(t,n).bind((function(t){return mt(t)&&0===Tr(t).trim().length?vh(t,e,n):p.some(t)}))},bh=function(t,e,n){return n.traverse(e).orThunk((function(){return vh(e,n.gather,t)})).map(n.relative)},yh=function(t,e){return on(t,e).filter(hh).orThunk((function(){return on(t,e-1).filter(hh)}))},wh=function(t,e,n,r){return yh(e,n).bind((function(e){return r.traverse(e).fold((function(){return vh(e,r.gather,t).map(r.relative)}),(function(t){return gh(t).map((function(t){return ug.on(t.parent(),t.index())}))}))}))},xh=function(t,e,n,r){var i=hh(e)?bh(t,e,r):wh(t,e,n,r);return i.map((function(t){return{start:o(t),finish:o(t)}}))},Ch=function(t){return dh.cata(t,(function(t){return p.none()}),(function(){return p.none()}),(function(t){return p.some(uh(t,0))}),(function(t){return p.some(uh(t,Ar(t)))}))},Sh={tryBr:xh,process:Ch},kh=rt(["left","top","right","bottom"],[]),Oh=function(t,e){return kh({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},Th=function(t,e){return kh({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},Eh=function(t,e){var n=t.bottom()-t.top();return kh({left:t.left(),top:e-n,right:t.right(),bottom:e})},Dh=function(t,e){var n=t.bottom()-t.top();return kh({left:t.left(),top:e,right:t.right(),bottom:e+n})},Ah=function(t,e,n){return kh({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},_h=function(t){return t.top()},Rh=function(t){return t.bottom()},Bh=function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"},Ih={nu:kh,moveUp:Th,moveDown:Oh,moveBottomTo:Eh,moveTopTo:Dh,getTop:_h,getBottom:Rh,translate:Ah,toString:Bh},Nh=function(t,e,n){return n>=0&&n<Ar(e)?t.getRangedRect(e,n,e,n+1):n>0?t.getRangedRect(e,n-1,e,n):p.none()},Ph=function(t){return Ih.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},Mh=function(t,e){return p.some(t.getRect(e))},Fh=function(t,e,n){return dt(e)?Mh(t,e).map(Ph):mt(e)?Nh(t,e,n).map(Ph):p.none()},Lh=function(t,e){return dt(e)?Mh(t,e).map(Ph):mt(e)?t.getRangedRect(e,0,e,Ar(e)).map(Ph):p.none()},Hh={getBoxAt:Fh,getEntireBox:Lh},zh=5,jh=100,Vh=hi.generate([{none:[]},{retry:["caret"]}]),Uh=function(t,e){return t.left()<e.left()||Math.abs(e.right()-t.left())<1||t.left()>e.right()},Wh=function(t,e,n){return Fn(e,il.isBlock).fold(o(!1),(function(e){return Hh.getEntireBox(t,e).exists((function(t){return Uh(n,t)}))}))},Gh=function(t,e,n,r,o){var i=Ih.moveDown(o,zh);return Math.abs(n.bottom()-r.bottom())<1||n.top()>o.bottom()?Vh.retry(i):n.top()===o.bottom()?Vh.retry(Ih.moveDown(o,1)):Wh(t,e,o)?Vh.retry(Ih.translate(i,zh,0)):Vh.none()},qh=function(t,e,n,r,o){var i=Ih.moveUp(o,zh);return Math.abs(n.top()-r.top())<1||n.bottom()<o.top()?Vh.retry(i):n.bottom()===o.top()?Vh.retry(Ih.moveUp(o,1)):Wh(t,e,o)?Vh.retry(Ih.translate(i,zh,0)):Vh.none()},Xh={point:Ih.getTop,adjuster:qh,move:Ih.moveUp,gather:eh},$h={point:Ih.getBottom,adjuster:Gh,move:Ih.moveDown,gather:nh},Yh=function(t,e,n){return t.elementFromPoint(e,n).filter((function(t){return"table"===ct(t)})).isSome()},Kh=function(t,e,n,r,o){return Jh(t,e,n,e.move(r,zh),o)},Jh=function(t,e,n,r,o){return 0===o?p.some(r):Yh(t,r.left(),e.point(r))?Kh(t,e,n,r,o-1):t.situsFromPoint(r.left(),e.point(r)).bind((function(i){return i.start().fold(p.none,(function(i){return Hh.getEntireBox(t,i).bind((function(u){return e.adjuster(t,i,u,n,r).fold(p.none,(function(r){return Jh(t,e,n,r,o-1)}))})).orThunk((function(){return p.some(r)}))}),p.none)}))},Qh=function(t,e){return t.situsFromPoint(e.left(),e.bottom()+zh)},Zh=function(t,e){return t.situsFromPoint(e.left(),e.top()-zh)},tv=function(t,e,n){return t.point(e)>n.getInnerHeight()?p.some(t.point(e)-n.getInnerHeight()):t.point(e)<0?p.some(-t.point(e)):p.none()},ev=function(t,e,n){var r=t.move(n,zh),o=Jh(e,t,n,r,jh).getOr(r);return tv(t,o,e).fold((function(){return e.situsFromPoint(o.left(),t.point(o))}),(function(n){return e.scrollBy(0,n),e.situsFromPoint(o.left(),t.point(o)-n)}))},nv={tryUp:u(ev,Xh),tryDown:u(ev,$h),ieTryUp:Zh,ieTryDown:Qh,getJumpSize:o(zh)},rv=20,ov=Le(),iv=function(t,e,n){return t.getSelection().bind((function(r){return Sh.tryBr(e,r.finish(),r.foffset(),n).fold((function(){return p.some(uh(r.finish(),r.foffset()))}),(function(o){var i=t.fromSitus(o),u=dh.verify(t,r.finish(),r.foffset(),i.finish(),i.foffset(),n.failure,e);return Sh.process(u)}))}))},uv=function(t,e,n,r,o,i){return 0===i?p.none():sv(t,e,n,r,o).bind((function(u){var a=t.fromSitus(u),c=dh.verify(t,n,r,a.finish(),a.foffset(),o.failure,e);return dh.cata(c,(function(){return p.none()}),(function(){return p.some(u)}),(function(u){return Ge(n,u)&&0===r?av(t,n,r,Ih.moveUp,o):uv(t,e,u,0,o,i-1)}),(function(u){return Ge(n,u)&&r===Ar(u)?av(t,n,r,Ih.moveDown,o):uv(t,e,u,Ar(u),o,i-1)}))}))},av=function(t,e,n,r,o){return Hh.getBoxAt(t,e,n).bind((function(e){return cv(t,o,r(e,nv.getJumpSize()))}))},cv=function(t,e,n){return ov.browser.isChrome()||ov.browser.isSafari()||ov.browser.isFirefox()||ov.browser.isEdge()?e.otherRetry(t,n):ov.browser.isIE()?e.ieRetry(t,n):p.none()},sv=function(t,e,n,r,o){return Hh.getBoxAt(t,n,r).bind((function(e){return cv(t,o,e)}))},lv=function(t,e,n){return iv(t,e,n).bind((function(r){return uv(t,e,r.element(),r.offset(),n,rv).map(t.fromSitus)}))},fv={handle:lv},dv=Le(),mv=function(t,e){return ih(t,(function(t){return Ze(t).exists((function(t){return Ge(t,e)}))}))},gv=function(t,e,n,r,i){return Un(r,"td,th",e).bind((function(r){return Un(r,"table",e).bind((function(u){return mv(i,u)?fv.handle(t,e,n).bind((function(t){return Un(t.finish(),"td,th",e).map((function(e){return{start:o(r),finish:o(e),range:o(t)}}))})):p.none()}))}))},pv=function(t,e,n,r,o,i){return dv.browser.isIE()?p.none():i(r,e).orThunk((function(){return gv(t,e,n,r,o).map((function(t){var e=t.range();return Ep.create(p.some(Bp.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)}))}))},hv=function(t,e){return Un(t,"tr",e).bind((function(t){return Un(t,"table",e).bind((function(n){var r=Nn(n,"tr");return Ge(t,r[0])?rh(n,(function(t){return Pr(t).isSome()}),e).map((function(t){var e=Ar(t);return Ep.create(p.some(Bp.makeSitus(t,e,t,e)),!0)})):p.none()}))}))},vv=function(t,e){return Un(t,"tr",e).bind((function(t){return Un(t,"table",e).bind((function(n){var r=Nn(n,"tr");return Ge(t,r[r.length-1])?oh(n,(function(t){return Nr(t).isSome()}),e).map((function(t){return Ep.create(p.some(Bp.makeSitus(t,0,t,0)),!0)})):p.none()}))}))},bv=function(t,e,n,r,o,i,u){return gv(t,n,r,o,i).bind((function(t){return Mp.detect(e,n,t.start(),t.finish(),u)}))},yv={navigate:pv,select:bv,firstUpCheck:hv,lastDownCheck:vv},wv=function(t,e){return Un(t,"td,th",e)};function xv(t,e,n,r){var o=p.none(),i=function(){o=p.none()},u=function(t){r.clear(e),o=wv(t.target(),n)},a=function(i){o.each((function(o){r.clearBeforeUpdate(e),wv(i.target(),n).each((function(i){ri.identify(o,i,n).each((function(n){var u=n.boxes().getOr([]);(u.length>1||1===u.length&&!Ge(o,i))&&(r.selectRange(e,u,n.start(),n.finish()),t.selectContents(i))}))}))}))},c=function(t){o.each(i)};return{mousedown:u,mouseover:a,mouseup:c}}var Cv={traverse:nn,gather:nh,relative:ug.before,otherRetry:nv.tryDown,ieRetry:nv.ieTryDown,failure:dh.failedDown},Sv={traverse:en,gather:eh,relative:ug.before,otherRetry:nv.tryUp,ieRetry:nv.ieTryUp,failure:dh.failedUp},kv={down:Cv,up:Sv},Ov=function(t){return function(e){return e===t}},Tv=Ov(38),Ev=Ov(40),Dv=function(t){return t>=37&&t<=40},Av={ltr:{isBackward:Ov(37),isForward:Ov(39)},rtl:{isBackward:Ov(39),isForward:Ov(37)},isUp:Tv,isDown:Ev,isNavigation:Dv},_v=function(t){return{left:t.left(),top:t.top(),right:t.right(),bottom:t.bottom(),width:t.width(),height:t.height()}},Rv={toRaw:_v},Bv=(Le().browser.isSafari(),function(e){var n=void 0!==e?e.dom():t.document,r=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return Cu(r,o)}),Iv=function(e,n,r){var o=void 0!==r?r.dom():t.document,i=o.defaultView;i.scrollBy(e,n)},Nv=function(t){var e=function(e,n){return It.fromPoint(It.fromDom(t.document),e,n)},n=function(t){return t.dom().getBoundingClientRect()},r=function(e,n,r,o){var i=pg.exact(e,n,r,o);return gp(t,i).map(Rv.toRaw)},o=function(){return mp(t).map((function(e){return Bp.convertToRange(t,e)}))},i=function(e){var n=pg.relative(e.start(),e.finish());return Bp.convertToRange(t,n)},u=function(e,n){return pp(t,e,n).map((function(t){return Ap.create(t.start(),t.soffset(),t.finish(),t.foffset())}))},a=function(){hp(t)},c=function(e){void 0===e&&(e=!1),mp(t).each((function(n){return n.fold((function(t){return t.collapse(e)}),(function(n,r){var o=e?n:r;ap(t,o,o)}),(function(n,r,o,i){var u=e?n:o,a=e?r:i;up(t,u,a,u,a)}))}))},s=function(e){fp(t,e)},l=function(e){up(t,e.start(),e.soffset(),e.finish(),e.foffset())},f=function(e,n){ap(t,e,n)},d=function(){return t.innerHeight},m=function(){var e=Bv(It.fromDom(t.document));return e.top()},g=function(e,n){Iv(e,n,It.fromDom(t.document))};return{elementFromPoint:e,getRect:n,getRangedRect:r,getSelection:o,fromSitus:i,situsFromPoint:u,clearSelection:a,collapseSelection:c,setSelection:l,setRelativeSelection:f,selectContents:s,getInnerHeight:d,getScrollY:m,scrollBy:g}},Pv=K("rows","cols"),Mv=function(t,e,n,r){var o=Nv(t),i=xv(o,e,n,r);return{mousedown:i.mousedown,mouseover:i.mouseover,mouseup:i.mouseup}},Fv=function(t,e,n,r){var o=Nv(t),i=function(){return r.clear(e),p.none()},a=function(t,a,c,s,l,f){var d=t.raw(),m=d.which,g=!0===d.shiftKey,h=ri.retrieve(e,r.selectedSelector()).fold((function(){return Av.isDown(m)&&g?u(yv.select,o,e,n,kv.down,s,a,r.selectRange):Av.isUp(m)&&g?u(yv.select,o,e,n,kv.up,s,a,r.selectRange):Av.isDown(m)?u(yv.navigate,o,n,kv.down,s,a,yv.lastDownCheck):Av.isUp(m)?u(yv.navigate,o,n,kv.up,s,a,yv.firstUpCheck):p.none}),(function(t){var n=function(n){return function(){var i=Xu(n,(function(n){return Mp.update(n.rows(),n.cols(),e,t,r)}));return i.fold((function(){return ri.getEdges(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map((function(t){var n=Av.isDown(m)||f.isForward(m)?ug.after:ug.before;return o.setRelativeSelection(ug.on(t.first(),0),n(t.table())),r.clear(e),Ep.create(p.none(),!0)}))}),(function(t){return p.some(Ep.create(p.none(),!0))}))}};return Av.isDown(m)&&g?n([Pv(1,0)]):Av.isUp(m)&&g?n([Pv(-1,0)]):f.isBackward(m)&&g?n([Pv(0,-1),Pv(-1,0)]):f.isForward(m)&&g?n([Pv(0,1),Pv(1,0)]):Av.isNavigation(m)&&!1===g?i:p.none}));return h()},c=function(t,o,i,u,a){return ri.retrieve(e,r.selectedSelector()).fold((function(){var c=t.raw(),s=c.which,l=!0===c.shiftKey;return!1===l?p.none():Av.isNavigation(s)?Mp.sync(e,n,o,i,u,a,r.selectRange):p.none()}),p.none)};return{keydown:a,keyup:c}},Lv=function(t,e,n,r){var o=Nv(t);return function(t,i){r.clearBeforeUpdate(e),ri.identify(t,i,n).each((function(t){var n=t.boxes().getOr([]);r.selectRange(e,n,t.start(),t.finish()),o.selectContents(i),o.collapseSelection()}))}},Hv={mouse:Mv,keyboard:Fv,external:Lv},zv=function(t,e){R(e,(function(e){aa(t,e)}))},jv=function(t){return function(e){ia(e,t)}},Vv=function(t){return function(e){zv(e,t)}},Uv=function(t){var e=jv(t.selected()),n=Vv([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(e){var r=Nn(e,t.selectedSelector());R(r,n)},o=function(n,o,i,u){r(n),R(o,e),ia(i,t.firstSelected()),ia(u,t.lastSelected())};return{clearBeforeUpdate:r,clear:r,selectRange:o,selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},Wv=function(t,e,n){var r=function(e){yt(e,t.selected()),yt(e,t.firstSelected()),yt(e,t.lastSelected())},o=function(e){pt(e,t.selected(),"1")},i=function(t){u(t),n()},u=function(e){var n=Nn(e,t.selectedSelector());R(n,r)},a=function(n,r,u,a){i(n),R(r,o),pt(u,t.firstSelected(),"1"),pt(a,t.lastSelected(),"1"),e(r,u,a)};return{clearBeforeUpdate:u,clear:i,selectRange:a,selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},Gv={byClass:Uv,byAttr:Wv},qv=function(t,e,n){var r=t.slice(0,e[e.length-1].row()+1),o=nc(r,n);return H(o,(function(t){var n=t.cells().slice(0,e[e.length-1].column()+1);return _(n,(function(t){return t.element()}))}))},Xv=function(t,e,n){var r=t.slice(e[0].row()+e[0].rowspan()-1,t.length),o=nc(r,n);return H(o,(function(t){var n=t.cells().slice(e[0].column()+e[0].colspan()-1,+t.cells().length);return _(n,(function(t){return t.element()}))}))},$v=function(t,e,n){var r=sr.fromTable(t),o=hr.generate(r),i=lc(o,e);return i.map((function(t){var e=Za.toGrid(o,n,!1),r=qv(e,t,n),i=Xv(e,t,n);return{upOrLeftCells:r,downOrRightCells:i}}))},Yv={getOtherCells:$v},Kv=function(t){return!1===ca(It.fromDom(t.target),"ephox-snooker-resizer-bar")};function Jv(t,i,u){var a=rt(["mousedown","mouseover","mouseup","keyup","keydown"],[]),c=p.none(),s=vf(t),l=function(e,r,o){u.targets().each((function(i){var u=ur.table(r);u.each((function(u){var a=It.fromDom(t.getDoc()),c=Yr.cellOperations(n,a,s),l=Yv.getOtherCells(u,i,c);Sf(t,e,r,o,l)}))}))},f=function(){kf(t)},d=Gv.byAttr(gi,l,f);t.on("init",(function(u){var s=t.getWin(),l=Hl(t),f=Vl(t),m=function(){var e=t.selection,r=It.fromDom(e.getStart()),o=It.fromDom(e.getEnd()),i=Xo.sharedOne(ur.table,[r,o]);i.fold((function(){d.clear(l)}),n)},g=Hv.mouse(s,l,f,d),h=Hv.keyboard(s,l,f,d),v=Hv.external(s,l,f,d),b=function(t){return!0===t.raw().shiftKey};t.on("TableSelectorChange",(function(t){v(t.start,t.finish)}));var y=function(e,n){b(e)&&(n.kill()&&e.kill(),n.selection().each((function(e){var n=pg.relative(e.start(),e.finish()),r=Ag(s,n);t.selection.setRng(r)})))},w=function(e){var n=S(e);if(n.raw().shiftKey&&Av.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=It.fromDom(r.startContainer),i=It.fromDom(r.endContainer);h.keyup(n,o,r.startOffset,i,r.endOffset).each((function(t){y(n,t)}))}},x=function(e){var n=S(e);i().each((function(t){t.hideBars()}));var r=t.selection.getRng(),o=It.fromDom(t.selection.getStart()),u=It.fromDom(r.startContainer),a=It.fromDom(r.endContainer),c=Kl.directionAt(o).isRtl()?Av.rtl:Av.ltr;h.keydown(n,u,r.startOffset,a,r.endOffset,c).each((function(t){y(n,t)})),i().each((function(t){t.showBars()}))},C=function(t){return t.hasOwnProperty("x")&&t.hasOwnProperty("y")},S=function(t){var e=It.fromDom(t.target),n=function(){t.stopPropagation()},i=function(){t.preventDefault()},u=r(i,n);return{target:o(e),x:o(C(t)?t.x:null),y:o(C(t)?t.y:null),stop:n,prevent:i,kill:u,raw:o(t)}},k=function(t){return 0===t.button},O=function(t){return void 0===t.buttons||0!==(1&t.buttons)},T=function(t){k(t)&&Kv(t)&&g.mousedown(S(t))},E=function(t){O(t)&&Kv(t)&&g.mouseover(S(t))},D=function(t){k(t)&&Kv(t)&&g.mouseup(S(t))},A=function(){var t=e(It.fromDom(l)),n=e(0),r=function(e){var r=It.fromDom(e.target);if("td"===ct(r)||"th"===ct(r)){var o=t.get(),i=n.get();Ge(o,r)&&e.timeStamp-i<300&&(e.preventDefault(),v(r,r))}t.set(r),n.set(e.timeStamp)};return{touchEnd:r}},_=A();t.on("mousedown",T),t.on("mouseover",E),t.on("mouseup",D),t.on("touchend",_.touchEnd),t.on("keyup",w),t.on("keydown",x),t.on("NodeChange",m),c=p.some(a({mousedown:T,mouseover:E,mouseup:D,keyup:w,keydown:x}))}));var m=function(){c.each((function(t){}))};return{clear:d.clear,destroy:m}}var Qv=function(t){var e=function(){var e=Hl(t);return ui.retrieve(e,gi.selectedSelector()).fold((function(){return void 0===t.selection.getStart()?yi.none():yi.single(t.selection)}),(function(t){return yi.multiple(t)}))};return{get:e}},Zv=function(t,n){var r=e(p.none()),o=e([]),i=function(){return Gd(t).bind((function(t){var e=ur.table(t);return e.map((function(e){return"caption"===ct(t)?Ai.notCell(t):Ai.forMenu(n,e,t)}))}))},u=function(){r.set(Et(i)()),R(o.get(),(function(t){return t()}))},a=function(t,e){var n=function(){return r.get().fold((function(){t.setDisabled(!0)}),(function(n){t.setDisabled(e(n))}))};return n(),o.set(o.get().concat([n])),function(){o.set(I(o.get(),(function(t){return t!==n})))}},c=function(t){return a(t,(function(t){return!1}))},s=function(t){return a(t,(function(t){return"caption"===ct(t.element())}))},l=function(t){return a(t,(function(t){return t.mergable().isNone()}))},f=function(t){return a(t,(function(t){return t.unmergable().isNone()}))};return t.on("NodeChange TableSelectorChange",u),{onSetupTable:c,onSetupCellOrRow:s,onSetupMergeable:l,onSetupUnmergeable:f,resetTargets:u,targets:function(){return r.get()}}},tb=function(t,e){t.ui.registry.addMenuButton("table",{tooltip:"Table",icon:"table",fetch:function(t){return t("inserttable | cell row column | advtablesort | tableprops deletetable")}});var n=function(e){return function(){return t.execCommand(e)}};t.ui.registry.addButton("tableprops",{tooltip:"Table properties",onAction:n("mceTableProps"),icon:"table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tabledelete",{tooltip:"Delete table",onAction:n("mceTableDelete"),icon:"table-delete-table",onSetup:e.onSetupTable}),t.ui.registry.addButton("tablecellprops",{tooltip:"Cell properties",onAction:n("mceTableCellProps"),icon:"table-cell-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablemergecells",{tooltip:"Merge cells",onAction:n("mceTableMergeCells"),icon:"table-merge-cells",onSetup:e.onSetupMergeable}),t.ui.registry.addButton("tablesplitcells",{tooltip:"Split cell",onAction:n("mceTableSplitCells"),icon:"table-split-cells",onSetup:e.onSetupUnmergeable}),t.ui.registry.addButton("tableinsertrowbefore",{tooltip:"Insert row before",onAction:n("mceTableInsertRowBefore"),icon:"table-insert-row-above",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertrowafter",{tooltip:"Insert row after",onAction:n("mceTableInsertRowAfter"),icon:"table-insert-row-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeleterow",{tooltip:"Delete row",onAction:n("mceTableDeleteRow"),icon:"table-delete-row",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablerowprops",{tooltip:"Row properties",onAction:n("mceTableRowProps"),icon:"table-row-properties",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolbefore",{tooltip:"Insert column before",onAction:n("mceTableInsertColBefore"),icon:"table-insert-column-before",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertcolafter",{tooltip:"Insert column after",onAction:n("mceTableInsertColAfter"),icon:"table-insert-column-after",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tabledeletecol",{tooltip:"Delete column",onAction:n("mceTableDeleteCol"),icon:"table-delete-column",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecutrow",{tooltip:"Cut row",onAction:n("mceTableCutRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablecopyrow",{tooltip:"Copy row",onAction:n("mceTableCopyRow"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowbefore",{tooltip:"Paste row before",onAction:n("mceTablePasteRowBefore"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tablepasterowafter",{tooltip:"Paste row after",onAction:n("mceTablePasteRowAfter"),icon:"temporary-placeholder",onSetup:e.onSetupCellOrRow}),t.ui.registry.addButton("tableinsertdialog",{tooltip:"Insert table",onAction:n("mceInsertTable"),icon:"table"})},eb=function(t){var e=function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},n=hf(t);n.length>0&&t.ui.registry.addContextToolbar("table",{predicate:e,items:n,scope:"node",position:"node"})},nb={addButtons:tb,addToolbars:eb},rb=function(t,e){var n=function(e){return function(){return t.execCommand(e)}},r=function(e){var n=e.numRows,r=e.numColumns;t.undoManager.transact((function(){Pd.insert(t,r,n)})),t.addVisual()},o={text:"Table properties",onSetup:e.onSetupTable,onAction:n("mceTableProps")},i={text:"Delete table",icon:"table-delete-table",onSetup:e.onSetupTable,onAction:n("mceTableDelete")},u=[{type:"menuitem",text:"Insert row before",icon:"table-insert-row-above",onAction:n("mceTableInsertRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert row after",icon:"table-insert-row-after",onAction:n("mceTableInsertRowAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete row",icon:"table-delete-row",onAction:n("mceTableDeleteRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Row properties",icon:"table-row-properties",onAction:n("mceTableRowProps"),onSetup:e.onSetupCellOrRow},{type:"separator"},{type:"menuitem",text:"Cut row",onAction:n("mceTableCutRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Copy row",onAction:n("mceTableCopyRow"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row before",onAction:n("mceTablePasteRowBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Paste row after",onAction:n("mceTablePasteRowAfter"),onSetup:e.onSetupCellOrRow}],a={type:"nestedmenuitem",text:"Row",getSubmenuItems:function(){return u}},c=[{type:"menuitem",text:"Insert column before",icon:"table-insert-column-before",onAction:n("mceTableInsertColBefore"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Insert column after",icon:"table-insert-column-after",onAction:n("mceTableInsertColAfter"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Delete column",icon:"table-delete-column",onAction:n("mceTableDeleteCol"),onSetup:e.onSetupCellOrRow}],s={type:"nestedmenuitem",text:"Column",getSubmenuItems:function(){return c}},l=[{type:"menuitem",text:"Cell properties",icon:"table-cell-properties",onAction:n("mceTableCellProps"),onSetup:e.onSetupCellOrRow},{type:"menuitem",text:"Merge cells",icon:"table-merge-cells",onAction:n("mceTableMergeCells"),onSetup:e.onSetupMergeable},{type:"menuitem",text:"Split cell",icon:"table-split-cells",onAction:n("mceTableSplitCells"),onSetup:e.onSetupUnmergeable}],f={type:"nestedmenuitem",text:"Cell",getSubmenuItems:function(){return l}};!1===sf(t)?t.ui.registry.addMenuItem("inserttable",{text:"Table",icon:"table",onAction:n("mceInsertTable")}):t.ui.registry.addNestedMenuItem("inserttable",{text:"Table",icon:"table",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"inserttable",onAction:r}]}}),t.ui.registry.addMenuItem("inserttabledialog",{text:"Insert table",icon:"table",onAction:n("mceInsertTable")}),t.ui.registry.addMenuItem("tableprops",o),t.ui.registry.addMenuItem("deletetable",i),t.ui.registry.addNestedMenuItem("row",a),t.ui.registry.addNestedMenuItem("column",s),t.ui.registry.addNestedMenuItem("cell",f),t.ui.registry.addContextMenu("table",{update:function(){return e.resetTargets(),e.targets().fold((function(){return""}),(function(t){return"caption"===ct(t.element())?"tableprops deletetable":"cell row column | advtablesort | tableprops deletetable"}))}})},ob={addMenuItems:rb},ib=function(t){return t.get().fold((function(){}),(function(t){return _(t,(function(t){return t.dom()}))}))},ub=function(t,e){var n=_(t,It.fromDom);e.set(p.from(n))},ab=function(t,e,n,r){return{insertTable:function(e,n){return Pd.insert(t,e,n)},setClipboardRows:function(t){return ub(t,e)},getClipboardRows:function(){return ib(e)},resizeHandler:n,selectionTargets:r}};function cb(t){var n=Qv(t),r=Zv(t,n),o=Wm(t),i=Jv(t,o.lazyResize,r),u=Of(t,o.lazyWire),a=e(p.none());return $d.registerCommands(t,u,i,n,a),Ni.registerEvents(t,n,u,i),ob.addMenuItems(t,r),nb.addButtons(t,r),nb.addToolbars(t),t.on("PreInit",(function(){t.serializer.addTempAttr(gi.firstSelected()),t.serializer.addTempAttr(gi.lastSelected())})),rf(t)&&t.on("keydown",(function(e){Op.handle(e,t,u,o.lazyWire)})),t.on("remove",(function(){o.destroy(),i.destroy()})),ab(t,a,o,r)}function sb(){h.add("table",cb)}sb()})(window)},bc54:function(t,e,n){n("7c4f")},be7f:function(t,e,n){(function(t){(function(e){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=tinymce.util.Tools.resolve("tinymce.util.VK"),o=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},i=function(t){return function(e){return o(e)===t}},u=i("string"),a=i("array"),c=i("boolean"),s=i("function"),l=function(t){var e=t.getParam("link_assume_external_targets",!1);return c(e)&&e?1:!u(e)||"http"!==e&&"https"!==e?0:e},f=function(t){return t.getParam("link_context_toolbar",!1,"boolean")},d=function(t){return t.getParam("link_list")},m=function(t){return t.getParam("default_link_target")},g=function(t){return t.getParam("target_list",!0)},p=function(t){return t.getParam("rel_list",[],"array")},h=function(t){return t.getParam("link_class_list",[],"array")},v=function(t){return t.getParam("link_title",!0,"boolean")},b=function(t){return t.getParam("allow_unsafe_link_target",!1,"boolean")},y=function(t){return t.getParam("link_quicklink",!1,"boolean")},w={assumeExternalTargets:l,hasContextToolbar:f,getLinkList:d,getDefaultLinkTarget:m,getTargetList:g,getRelList:p,getLinkClassList:h,shouldShowLinkTitle:v,allowUnsafeLinkTarget:b,useQuickLink:y},x=function(t,n){e.document.body.appendChild(t),t.dispatchEvent(n),e.document.body.removeChild(t)},C=function(t){var n=e.document.createElement("a");n.target="_blank",n.href=t,n.rel="noreferrer noopener";var r=e.document.createEvent("MouseEvents");r.initMouseEvent("click",!0,!0,e.window,0,0,0,0,0,!1,!1,!1,!1,0,null),x(n,r)},S={open:C},k=function(){return k=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},k.apply(this,arguments)},O=function(){},T=function(t){return function(){return t}},E=T(!1),D=T(!0),A=function(){return _},_=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},r={fold:function(t,e){return t()},is:E,isSome:E,isNone:D,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:T(null),getOrUndefined:T(void 0),or:n,orThunk:e,map:A,each:O,bind:A,exists:E,forall:D,filter:A,equals:t,equals_:t,toArray:function(){return[]},toString:T("none()")};return Object.freeze&&Object.freeze(r),r}(),R=function(t){var e=T(t),n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:D,isNone:E,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return R(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?o:_},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(E,(function(e){return n(t,e)}))}};return o},B=function(t){return null===t||void 0===t?_:R(t)},I={some:R,none:A,from:B},N=Array.prototype.slice,P=Array.prototype.indexOf,M=Array.prototype.push,F=function(t,e){return P.call(t,e)},L=function(t,e){return F(t,e)>-1},H=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o)}return r},z=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},j=function(t,e,n){return z(t,(function(t){n=e(n,t)})),n},V=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!a(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);M.apply(e,t[n])}return e},U=function(t,e){var n=H(t,e);return V(n)},W=(s(Array.from)&&Array.from,tinymce.util.Tools.resolve("tinymce.util.Tools")),G=function(t){return/^\w+:/i.test(t)},q=function(t){var e=t.getAttribute("data-mce-href");return e||t.getAttribute("href")},X=function(t,e){var n=["noopener"],r=t?t.split(/\s+/):[],o=function(t){return W.trim(t.sort().join(" "))},i=function(t){return t=u(t),t.length>0?t.concat(n):n},u=function(t){return t.filter((function(t){return-1===W.inArray(n,t)}))},a=e?i(r):u(r);return a.length>0?o(a):""},$=function(t){return t.replace(/\uFEFF/g,"")},Y=function(t,e){return e=e||t.selection.getNode(),tt(e)?t.dom.select("a[href]",e)[0]:t.dom.getParent(e,"a[href]")},K=function(t,e){var n=e?e.innerText||e.textContent:t.getContent({format:"text"});return $(n)},J=function(t){return t&&"A"===t.nodeName&&!!t.href},Q=function(t){return W.grep(t,J).length>0},Z=function(t){return!(/</.test(t)&&(!/^<a [^>]+>[^<]+<\/a>$/.test(t)||-1===t.indexOf("href=")))},tt=function(t){return t&&"FIGURE"===t.nodeName&&/\bimage\b/i.test(t.className)},et=function(t){return j(["title","rel","class","target"],(function(e,n){return t[n].each((function(t){e[n]=t.length>0?t:null})),e}),{href:t.href})},nt=function(t,e){return"http"!==e&&"https"!==e||G(t)?t:e+"://"+t},rt=function(t,e){var n=k({},e);if(!(w.getRelList(t).length>0)&&!1===w.allowUnsafeLinkTarget(t)){var r=X(n.rel,"_blank"===n.target);n.rel=r||null}return I.from(n.target).isNone()&&!1===w.getTargetList(t)&&(n.target=w.getDefaultLinkTarget(t)),n.href=nt(n.href,w.assumeExternalTargets(t)),n},ot=function(t,e,n,r){n.each((function(t){e.hasOwnProperty("innerText")?e.innerText=t:e.textContent=t})),t.dom.setAttribs(e,r),t.selection.select(e)},it=function(t,e,n,r){tt(e)?st(t,e,r):n.fold((function(){t.execCommand("mceInsertLink",!1,r)}),(function(e){t.insertContent(t.dom.createHTML("a",r,t.dom.encode(e)))}))},ut=function(t,e,n){var r=t.selection.getNode(),o=Y(t,r),i=rt(t,et(n));t.undoManager.transact((function(){n.href===e.href&&e.attach(),o?(t.focus(),ot(t,o,n.text,i)):it(t,r,n.text,i)}))},at=function(t){t.undoManager.transact((function(){var e=t.selection.getNode();if(tt(e))ct(t,e);else{var n=t.dom.getParent(e,"a[href]",t.getBody());n&&t.dom.remove(n,!0)}t.focus()}))},ct=function(t,e){var n=t.dom.select("img",e)[0];if(n){var r=t.dom.getParents(n,"a[href]",e)[0];r&&(r.parentNode.insertBefore(n,r),t.dom.remove(r))}},st=function(t,e,n){var r=t.dom.select("img",e)[0];if(r){var o=t.dom.create("a",n);r.parentNode.insertBefore(o,r),o.appendChild(r)}},lt={link:ut,unlink:at,isLink:J,hasLinks:Q,getHref:q,isOnlyTextSelected:Z,getAnchorElement:Y,getAnchorText:K,applyRelTargetRules:X,hasProtocol:G},ft=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},dt=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return I.none()},mt=function(t){return u(t.value)?t.value:""},gt=function(t,e){var n=[];return W.each(t,(function(t){var r=u(t.text)?t.text:u(t.title)?t.title:"";if(void 0!==t.menu);else{var o=e(t);n.push({text:r,value:o})}})),n},pt=function(t){return void 0===t&&(t=mt),function(e){return I.from(e).map((function(e){return gt(e,t)}))}},ht=function(t){return pt(mt)(t)},vt=function(t,e){return function(n){return{name:t,type:"selectbox",label:e,items:n}}},bt={sanitize:ht,sanitizeWith:pt,createUi:vt,getValue:mt},yt=function(t){var e=t,n=function(){return e},r=function(t){e=t},o=function(){return yt(n())};return{get:n,set:r,clone:o}},wt=function(t,e){return dt(e,(function(e){return I.some(e).filter((function(e){return e.value===t}))}))},xt=function(t,e,n,r){var o=r[e],i=t.length>0;return void 0!==o?wt(o,n).map((function(e){return{url:{value:e.value,meta:{text:i?t:e.text,attach:O}},text:i?t:e.text}})):I.none()},Ct=function(t,e){return"link"===e?t.catalogs.link:"anchor"===e?t.catalogs.anchor:I.none()},St=function(t,e){var n=yt(t.text),r=function(t){if(n.get().length<=0){var e=void 0!==t.url.meta.text?t.url.meta.text:t.url.value;return I.some({text:e})}return I.none()},o=function(t,r){var o=Ct(e,r.name).getOr([]);return xt(n.get(),r.name,o,t)},i=function(t,e){return"url"===e.name?r(t()):L(["anchor","link"],e.name)?o(t(),e):"text"===e.name?(n.set(t().text),I.none()):I.none()};return{onChange:i}},kt={init:St,getDelta:xt},Ot={},Tt={exports:Ot};(function(e,n,r,o){(function(o){if("object"===typeof n&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof e&&e.amd)e([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(e,n,r){function i(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[a]={exports:{}};e[a][0].call(f.exports,(function(t){var n=e[a][1][t];return i(n||t)}),f,f.exports,t,e,n,r)}return n[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,e,n){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var l,f=[],d=!1,m=-1;function g(){d&&l&&(d=!1,l.length?f=l.concat(f):m=-1,f.length&&p())}function p(){if(!d){var t=c(g);d=!0;var e=f.length;while(e){l=f,f=[];while(++m<e)l&&l[m].run();m=-1,e=f.length}l=null,d=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new h(t,e)),1!==f.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){(function(n){var r=setTimeout;function o(){}function i(t,e){return function(){t.apply(e,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,e){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(o){return void s(e.promise,o)}c(e.promise,r)}else(1===t._state?c:s)(e.promise,t._value)}))):t._deferreds.push(e)}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof u)return t._state=3,t._value=e,void l(t);if("function"===typeof n)return void d(i(n,e),t)}t._state=1,t._value=e,l(t)}catch(r){s(t,r)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t((function(t){n||(n=!0,c(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(r){if(n)return;n=!0,s(e,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,e){var n=new this.constructor(o);return a(this,new f(t,e,n)),n},u.all=function(t){var e=Array.prototype.slice.call(t);return new u((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),n)}e[i]=u,0===--r&&t(e)}catch(c){n(c)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(e){e(t)}))},u.reject=function(t){return new u((function(e,n){n(t)}))},u.race=function(t){return new u((function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)}))},u._immediateFn="function"===typeof t?function(e){t(e)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof e&&e.exports?e.exports=u:n.Promise||(n.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(e,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n.setImmediate="function"===typeof e?e:function(t){var e=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[e]=!0,o((function(){a[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))})),e},n.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,Ot,Tt,void 0);var Et=Tt.exports.boltExport,Dt=function(t){var n=I.none(),r=[],o=function(t){return Dt((function(e){i((function(n){e(t(n))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){n=I.some(t),c(r),r=[]},a=function(){return n.isSome()},c=function(t){z(t,s)},s=function(t){n.each((function(n){e.setTimeout((function(){t(n)}),0)}))};return t(u),{get:i,map:o,isReady:a}},At=function(t){return Dt((function(e){e(t)}))},_t={nu:Dt,pure:At},Rt=function(t){e.setTimeout((function(){throw t}),0)},Bt=function(t){var e=function(e){t().then(e,Rt)},n=function(e){return Bt((function(){return t().then(e)}))},r=function(e){return Bt((function(){return t().then((function(t){return e(t).toPromise()}))}))},o=function(e){return Bt((function(){return t().then((function(){return e.toPromise()}))}))},i=function(){return _t.nu(e)},u=function(){var e=null;return Bt((function(){return null===e&&(e=t()),e}))},a=t;return{map:n,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:e}},It=function(t){return Bt((function(){return new Et(t)}))},Nt=function(t){return Bt((function(){return Et.resolve(t)}))},Pt={nu:It,pure:Nt},Mt=tinymce.util.Tools.resolve("tinymce.util.Delay"),Ft=function(t,e,n){var r=t.selection.getRng();Mt.setEditorTimeout(t,(function(){t.windowManager.confirm(e,(function(e){t.selection.setRng(r),n(e)}))}))},Lt=function(t){var e=t.href,n=e.indexOf("@")>0&&-1===e.indexOf("//")&&-1===e.indexOf("mailto:");return n?I.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(t){return k(k({},t),{href:"mailto:"+e})}}):I.none()},Ht=function(t){return function(e){var n=e.href,r=1===t&&!lt.hasProtocol(n)||0===t&&/^\s*www[\.|\d\.]/i.test(n);return r?I.some({message:"The URL you entered seems to be an external link. Do you want to add the required http:// prefix?",preprocess:function(t){return k(k({},t),{href:"http://"+n})}}):I.none()}},zt=function(t,e,n){return dt([Lt,Ht(e)],(function(t){return t(n)})).fold((function(){return Pt.pure(n)}),(function(e){return Pt.nu((function(r){Ft(t,e.message,(function(t){r(t?e.preprocess(n):n)}))}))}))},jt={preprocess:zt},Vt=function(t){var e=t.dom.select("a:not([href])"),n=U(e,(function(t){var e=t.name||t.id;return e?[{text:e,value:"#"+e}]:[]}));return n.length>0?I.some([{text:"None",value:""}].concat(n)):I.none()},Ut={getAnchors:Vt},Wt=function(t){var e=w.getLinkClassList(t);return e.length>0?bt.sanitize(e):I.none()},Gt={getClasses:Wt},qt=tinymce.util.Tools.resolve("tinymce.util.XHR"),Xt=function(t){try{return I.some(JSON.parse(t))}catch(e){return I.none()}},$t=function(t){var e=function(e){return t.convertURL(e.value||e.url,"href")},n=w.getLinkList(t);return Pt.nu((function(t){u(n)?qt.send({url:n,success:function(e){return t(Xt(e))},error:function(e){return t(I.none())}}):s(n)?n((function(e){return t(I.some(e))})):t(I.from(n))})).map((function(t){return t.bind(bt.sanitizeWith(e)).map((function(t){return t.length>0?[{text:"None",value:""}].concat(t):t}))}))},Yt={getLinks:$t},Kt=function(t,e){var n=w.getRelList(t);if(n.length>0){var r=e.is("_blank"),o=!1===w.allowUnsafeLinkTarget(t),i=function(t){return lt.applyRelTargetRules(bt.getValue(t),r)},u=o?bt.sanitizeWith(i):bt.sanitize;return u(n)}return I.none()},Jt={getRels:Kt},Qt=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],Zt=function(t){var e=w.getTargetList(t);return a(e)?bt.sanitize(e).orThunk((function(){return I.some(Qt)})):!1===e?I.none():I.some(Qt)},te={getTargets:Zt},ee=function(t,e,n){var r=t.getAttrib(e,n);return null!==r&&r.length>0?I.some(r):I.none()},ne=function(t,e){var n=t.dom,r=lt.isOnlyTextSelected(t.selection.getContent()),o=r?I.some(lt.getAnchorText(t.selection,e)):I.none(),i=e?I.some(n.getAttrib(e,"href")):I.none(),u=e?I.from(n.getAttrib(e,"target")):I.none(),a=ee(n,e,"rel"),c=ee(n,e,"class"),s=ee(n,e,"title");return{url:i,text:o,title:s,target:u,rel:a,linkClass:c}},re=function(t,e){return Yt.getLinks(t).map((function(n){var r=ne(t,e);return{anchor:r,catalogs:{targets:te.getTargets(t),rels:Jt.getRels(t,r.target),classes:Gt.getClasses(t),anchor:Ut.getAnchors(t),link:n},optNode:I.from(e),flags:{titleEnabled:w.shouldShowLinkTitle(t)}}}))},oe={collect:re},ie=function(t,e,n){return function(r){var o=r.getData();if(!o.url.value)return lt.unlink(t),void r.close();var i=function(t){return I.from(o[t]).filter((function(n){return!e.anchor[t].is(n)}))},u={href:o.url.value,text:i("text"),target:i("target"),rel:i("rel"),class:i("linkClass"),title:i("title")},a={href:o.url.value,attach:void 0!==o.url.meta&&o.url.meta.attach?o.url.meta.attach:function(){}};jt.preprocess(t,n,u).get((function(e){lt.link(t,a,e)})),r.close()}},ue=function(t){var e=lt.getAnchorElement(t);return oe.collect(t,e)},ae=function(t,e){return{url:{value:t.anchor.url.getOr(""),meta:{attach:function(){},text:t.anchor.url.fold((function(){return""}),(function(){return t.anchor.text.getOr("")})),original:{value:t.anchor.url.getOr("")}}},text:t.anchor.text.getOr(""),title:t.anchor.title.getOr(""),anchor:t.anchor.url.getOr(""),link:t.anchor.url.getOr(""),rel:t.anchor.rel.getOr(""),target:t.anchor.target.or(e).getOr(""),linkClass:t.anchor.linkClass.getOr("")}},ce=function(t,e,n){var r=[{name:"url",type:"urlinput",filetype:"file",label:"URL"}],o=t.anchor.text.map((function(){return{name:"text",type:"input",label:"Text to display"}})).toArray(),i=t.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],u=I.from(w.getDefaultLinkTarget(n)),a=ae(t,u),c=kt.init(a,t),s=t.catalogs,l={type:"panel",items:V([r,o,i,ft([s.anchor.map(bt.createUi("anchor","Anchors")),s.rels.map(bt.createUi("rel","Rel")),s.targets.map(bt.createUi("target","Open link in...")),s.link.map(bt.createUi("link","Link list")),s.classes.map(bt.createUi("linkClass","Class"))])])};return{title:"Insert/Edit Link",size:"normal",body:l,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:a,onChange:function(t,e){var n=e.name;c.onChange(t.getData,{name:n}).each((function(e){t.setData(e)}))},onSubmit:e}},se=function(t){var e=ue(t);e.map((function(e){var n=ie(t,e,w.assumeExternalTargets(t));return ce(e,n,t)})).get((function(e){t.windowManager.open(e)}))},le={open:se},fe=function(t,e){return t.dom.getParent(e,"a[href]")},de=function(t){return fe(t,t.selection.getStart())},me=function(t){return!0===t.altKey&&!1===t.shiftKey&&!1===t.ctrlKey&&!1===t.metaKey},ge=function(t,e){if(e){var n=lt.getHref(e);if(/^#/.test(n)){var r=t.$(n);r.length&&t.selection.scrollIntoView(r[0],!0)}else S.open(e.href)}},pe=function(t){return function(){le.open(t)}},he=function(t){return function(){ge(t,de(t))}},ve=function(t){return function(e){var n,r,o;return!!(w.hasContextToolbar(t)&&lt.isLink(e)&&(n=t.selection,r=n.getRng(),o=r.startContainer,3===o.nodeType&&n.isCollapsed()&&r.startOffset>0&&r.startOffset<o.data.length))}},be=function(t){t.on("click",(function(e){var n=fe(t,e.target);n&&r.metaKeyPressed(e)&&(e.preventDefault(),ge(t,n))})),t.on("keydown",(function(e){var n=de(t);n&&13===e.keyCode&&me(e)&&(e.preventDefault(),ge(t,n))}))},ye=function(t){return function(e){var n=function(n){return e.setActive(!t.readonly&&!!lt.getAnchorElement(t,n.element))};return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}},we=function(t){return function(e){e.setDisabled(!lt.hasLinks(t.dom.getParents(t.selection.getStart())));var n=function(t){return e.setDisabled(!lt.hasLinks(t.parents))};return t.on("NodeChange",n),function(){return t.off("NodeChange",n)}}},xe={openDialog:pe,gotoSelectedLink:he,leftClickedOnAHref:ve,setupGotoLinks:be,toggleActiveState:ye,toggleEnabledState:we},Ce=function(t){t.addCommand("mceLink",(function(){w.useQuickLink(t)?t.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):xe.openDialog(t)()}))},Se={register:Ce},ke=function(t){t.addShortcut("Meta+K","",(function(){t.execCommand("mceLink")}))},Oe={setup:ke},Te=function(t){t.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:xe.openDialog(t),onSetup:xe.toggleActiveState(t)}),t.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:xe.gotoSelectedLink(t),onSetup:xe.toggleEnabledState(t)}),t.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return lt.unlink(t)},onSetup:xe.toggleEnabledState(t)})},Ee=function(t){t.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:xe.gotoSelectedLink(t),onSetup:xe.toggleEnabledState(t)}),t.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:xe.openDialog(t)}),t.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return lt.unlink(t)},onSetup:xe.toggleEnabledState(t)})},De=function(t){var e="link unlink openlink",n="link";t.ui.registry.addContextMenu("link",{update:function(r){return lt.hasLinks(t.dom.getParents(r,"a"))?e:n}})},Ae=function(t){var e=function(t){t.selection.collapse(!1)},n=function(e){var n=t.selection.getNode();return e.setDisabled(!lt.getAnchorElement(t,n)),function(){}};t.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:xe.toggleActiveState(t)},label:"Link",predicate:function(e){return!!lt.getAnchorElement(t,e)&&w.hasContextToolbar(t)},initValue:function(){var e=lt.getAnchorElement(t);return e?lt.getHref(e):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(e){var n=t.selection.getNode();return e.setActive(!!lt.getAnchorElement(t,n)),xe.toggleActiveState(t)(e)},onAction:function(n){var r=lt.getAnchorElement(t),o=n.getValue();if(r)t.dom.setAttrib(r,"href",o),e(t),n.hide();else{var i={href:o,attach:function(){}},u=lt.isOnlyTextSelected(t.selection.getContent()),a=u?I.some(lt.getAnchorText(t.selection,r)).filter((function(t){return t.length>0})).or(I.from(o)):I.none();lt.link(t,i,{href:o,text:a,title:I.none(),rel:I.none(),target:I.none(),class:I.none()}),n.hide()}}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:n,onAction:function(e){lt.unlink(t),e.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:n,onAction:function(e){xe.gotoSelectedLink(t)(),e.hide()}}]})},_e={setupButtons:Te,setupMenuItems:Ee,setupContextMenu:De,setupContextToolbars:Ae};function Re(){n.add("link",(function(t){_e.setupButtons(t),_e.setupMenuItems(t),_e.setupContextMenu(t),_e.setupContextToolbars(t),xe.setupGotoLinks(t),Se.register(t),Oe.setup(t)}))}Re()})(window)}).call(this,n("c8ba"))},c437:function(t,e,n){var r,o,i=n("e1f4"),u=n("2366"),a=0,c=0;function s(t,e,n){var s=e&&n||0,l=e||[];t=t||{};var f=t.node||r,d=void 0!==t.clockseq?t.clockseq:o;if(null==f||null==d){var m=i();null==f&&(f=r=[1|m[0],m[1],m[2],m[3],m[4],m[5]]),null==d&&(d=o=16383&(m[6]<<8|m[7]))}var g=void 0!==t.msecs?t.msecs:(new Date).getTime(),p=void 0!==t.nsecs?t.nsecs:c+1,h=g-a+(p-c)/1e4;if(h<0&&void 0===t.clockseq&&(d=d+1&16383),(h<0||g>a)&&void 0===t.nsecs&&(p=0),p>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");a=g,c=p,o=d,g+=122192928e5;var v=(1e4*(268435455&g)+p)%4294967296;l[s++]=v>>>24&255,l[s++]=v>>>16&255,l[s++]=v>>>8&255,l[s++]=255&v;var b=g/4294967296*1e4&268435455;l[s++]=b>>>8&255,l[s++]=255&b,l[s++]=b>>>24&15|16,l[s++]=b>>>16&255,l[s++]=d>>>8|128,l[s++]=255&d;for(var y=0;y<6;++y)l[s+y]=f[y];return e||u(l)}t.exports=s},c64e:function(t,e,n){var r=n("e1f4"),o=n("2366");function i(t,e,n){var i=e&&n||0;"string"==typeof t&&(e="binary"===t?new Array(16):null,t=null),t=t||{};var u=t.random||(t.rng||r)();if(u[6]=15&u[6]|64,u[8]=63&u[8]|128,e)for(var a=0;a<16;++a)e[i+a]=u[a];return e||o(u)}t.exports=i},cdd9:function(t,e,n){(function(t){(function(e){"use strict";var n=tinymce.util.Tools.resolve("tinymce.PluginManager"),r=function(){},o=function(t){return function(){return t}},i=function(t){return t},u=function(t){return function(){throw new Error(t)}},a=o(!1),c=o(!0),s=function(){return l},l=function(){var t=function(t){return t.isNone()},e=function(t){return t()},n=function(t){return t},i={fold:function(t,e){return t()},is:a,isSome:a,isNone:c,getOr:n,getOrThunk:e,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:n,orThunk:e,map:s,each:r,bind:s,exists:a,forall:c,filter:s,equals:t,equals_:t,toArray:function(){return[]},toString:o("none()")};return Object.freeze&&Object.freeze(i),i}(),f=function(t){var e=o(t),n=function(){return i},r=function(e){return e(t)},i={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:c,isNone:a,getOr:e,getOrThunk:e,getOrDie:e,getOrNull:e,getOrUndefined:e,or:n,orThunk:n,map:function(e){return f(e(t))},each:function(e){e(t)},bind:r,exists:r,forall:r,filter:function(e){return e(t)?i:l},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(a,(function(e){return n(t,e)}))}};return i},d=function(t){return null===t||void 0===t?l:f(t)},m={some:f,none:s,from:d},g=function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":e},p=function(t){return function(e){return g(e)===t}},h=p("string"),v=p("object"),b=p("array"),y=p("boolean"),w=p("function"),x=Array.prototype.slice,C=Array.prototype.push,S=function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];e(o,n)}},k=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!b(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);C.apply(e,t[n])}return e},O=function(t){return 0===t.length?m.none():m.some(t[0])},T=(w(Array.from)&&Array.from,function(){return T=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n],e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},T.apply(this,arguments)}),E={},D={exports:E};(function(e,n,r,o){(function(o){if("object"===typeof n&&"undefined"!==typeof r)r.exports=o();else if("function"===typeof e&&e.amd)e([],o);else{var i;i="undefined"!==typeof window?window:"undefined"!==typeof t?t:"undefined"!==typeof self?self:this,i.EphoxContactWrapper=o()}})((function(){return function(){function t(e,n,r){function i(a,c){if(!n[a]){if(!e[a]){var s="function"==typeof o&&o;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var f=n[a]={exports:{}};e[a][0].call(f.exports,(function(t){var n=e[a][1][t];return i(n||t)}),f,f.exports,t,e,n,r)}return n[a].exports}for(var u="function"==typeof o&&o,a=0;a<r.length;a++)i(r[a]);return i}return t}()({1:[function(t,e,n){var r,o,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(t){if(r===setTimeout)return setTimeout(t,0);if((r===u||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}function s(t){if(o===clearTimeout)return clearTimeout(t);if((o===a||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(function(){try{r="function"===typeof setTimeout?setTimeout:u}catch(t){r=u}try{o="function"===typeof clearTimeout?clearTimeout:a}catch(t){o=a}})();var l,f=[],d=!1,m=-1;function g(){d&&l&&(d=!1,l.length?f=l.concat(f):m=-1,f.length&&p())}function p(){if(!d){var t=c(g);d=!0;var e=f.length;while(e){l=f,f=[];while(++m<e)l&&l[m].run();m=-1,e=f.length}l=null,d=!1,s(t)}}function h(t,e){this.fun=t,this.array=e}function v(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];f.push(new h(t,e)),1!==f.length||d||c(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(t,e,n){(function(t){(function(n){var r=setTimeout;function o(){}function i(t,e){return function(){t.apply(e,arguments)}}function u(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(t,this)}function a(t,e){while(3===t._state)t=t._value;0!==t._state?(t._handled=!0,u._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var r;try{r=n(t._value)}catch(o){return void s(e.promise,o)}c(e.promise,r)}else(1===t._state?c:s)(e.promise,t._value)}))):t._deferreds.push(e)}function c(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof u)return t._state=3,t._value=e,void l(t);if("function"===typeof n)return void d(i(n,e),t)}t._state=1,t._value=e,l(t)}catch(r){s(t,r)}}function s(t,e){t._state=2,t._value=e,l(t)}function l(t){2===t._state&&0===t._deferreds.length&&u._immediateFn((function(){t._handled||u._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function f(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function d(t,e){var n=!1;try{t((function(t){n||(n=!0,c(e,t))}),(function(t){n||(n=!0,s(e,t))}))}catch(r){if(n)return;n=!0,s(e,r)}}u.prototype["catch"]=function(t){return this.then(null,t)},u.prototype.then=function(t,e){var n=new this.constructor(o);return a(this,new f(t,e,n)),n},u.all=function(t){var e=Array.prototype.slice.call(t);return new u((function(t,n){if(0===e.length)return t([]);var r=e.length;function o(i,u){try{if(u&&("object"===typeof u||"function"===typeof u)){var a=u.then;if("function"===typeof a)return void a.call(u,(function(t){o(i,t)}),n)}e[i]=u,0===--r&&t(e)}catch(c){n(c)}}for(var i=0;i<e.length;i++)o(i,e[i])}))},u.resolve=function(t){return t&&"object"===typeof t&&t.constructor===u?t:new u((function(e){e(t)}))},u.reject=function(t){return new u((function(e,n){n(t)}))},u.race=function(t){return new u((function(e,n){for(var r=0,o=t.length;r<o;r++)t[r].then(e,n)}))},u._immediateFn="function"===typeof t?function(e){t(e)}:function(t){r(t,0)},u._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},u._setImmediateFn=function(t){u._immediateFn=t},u._setUnhandledRejectionFn=function(t){u._unhandledRejectionFn=t},"undefined"!==typeof e&&e.exports?e.exports=u:n.Promise||(n.Promise=u)})(this)}).call(this,t("timers").setImmediate)},{timers:3}],3:[function(t,e,n){(function(e,r){var o=t("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(t,e){this._id=t,this._clearFn=e}n.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},n.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},n.clearTimeout=n.clearInterval=function(t){t.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},n.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},n.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},n._unrefActive=n.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n.setImmediate="function"===typeof e?e:function(t){var e=c++,r=!(arguments.length<2)&&u.call(arguments,1);return a[e]=!0,o((function(){a[e]&&(r?t.apply(null,r):t.call(null),n.clearImmediate(e))})),e},n.clearImmediate="function"===typeof r?r:function(t){delete a[t]}}).call(this,t("timers").setImmediate,t("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(t,e,n){var r=t("promise-polyfill"),o=function(){return"undefined"!==typeof window?window:Function("return this;")()}();e.exports={boltExport:o.Promise||r}},{"promise-polyfill":2}]},{},[4])(4)}))})(void 0,E,D,void 0);var A=D.exports.boltExport,_=function(t){var n=m.none(),r=[],o=function(t){return _((function(e){i((function(n){e(t(n))}))}))},i=function(t){a()?s(t):r.push(t)},u=function(t){n=m.some(t),c(r),r=[]},a=function(){return n.isSome()},c=function(t){S(t,s)},s=function(t){n.each((function(n){e.setTimeout((function(){t(n)}),0)}))};return t(u),{get:i,map:o,isReady:a}},R=function(t){return _((function(e){e(t)}))},B={nu:_,pure:R},I=function(t){e.setTimeout((function(){throw t}),0)},N=function(t){var e=function(e){t().then(e,I)},n=function(e){return N((function(){return t().then(e)}))},r=function(e){return N((function(){return t().then((function(t){return e(t).toPromise()}))}))},o=function(e){return N((function(){return t().then((function(){return e.toPromise()}))}))},i=function(){return B.nu(e)},u=function(){var e=null;return N((function(){return null===e&&(e=t()),e}))},a=t;return{map:n,bind:r,anonBind:o,toLazy:i,toCached:u,toPromise:a,get:e}},P=function(t){return N((function(){return new A(t)}))},M=function(t){return N((function(){return A.resolve(t)}))},F={nu:P,pure:M},L=function(t){var e=function(e){return t===e},n=function(e){return L(t)},r=function(e){return L(t)},i=function(e){return L(e(t))},u=function(e){return L(t)},s=function(e){e(t)},l=function(e){return e(t)},f=function(e,n){return n(t)},d=function(e){return e(t)},g=function(e){return e(t)},p=function(){return m.some(t)};return{is:e,isValue:c,isError:a,getOr:o(t),getOrThunk:o(t),getOrDie:o(t),or:n,orThunk:r,fold:f,map:i,mapError:u,each:s,bind:l,exists:d,forall:g,toOption:p}},H=function(t){var e=function(t){return t()},n=function(){return u(String(t))()},o=function(t){return t},s=function(t){return t()},l=function(e){return H(t)},f=function(e){return H(e(t))},d=function(e){return H(t)},g=function(e,n){return e(t)};return{is:a,isValue:a,isError:c,getOr:i,getOrThunk:e,getOrDie:n,or:o,orThunk:s,fold:g,map:l,mapError:f,each:r,bind:d,exists:a,forall:c,toOption:m.none}},z=function(t,e){return t.fold((function(){return H(e)}),L)},j={value:L,error:H,fromOption:z},V=function(t){var n=function(){return V(t.toCached())},r=function(e){return V(t.bind((function(t){return t.fold((function(t){return F.pure(j.error(t))}),(function(t){return e(t)}))})))},o=function(e){return V(t.map((function(t){return t.bind(e)})))},i=function(e){return V(t.map((function(t){return t.map(e)})))},u=function(e){return V(t.map((function(t){return t.mapError(e)})))},a=function(e,n){return t.map((function(t){return t.fold(e,n)}))},c=function(n,r){return V(F.nu((function(o){var i=!1,u=e.setTimeout((function(){i=!0,o(j.error(r()))}),n);t.get((function(t){i||(e.clearTimeout(u),o(t))}))})))};return T(T({},t),{toCached:n,bindFuture:r,bindResult:o,mapResult:i,mapError:u,foldResult:a,withTimeout:c})},U=function(t){return V(F.nu(t))},W=function(t){return V(F.pure(j.value(t)))},G=function(t){return V(F.pure(j.error(t)))},q=function(t){return V(F.pure(t))},X=function(t){return V(t.map(j.value))},$=function(t){return U((function(e){t.then((function(t){e(j.value(t))}),(function(t){e(j.error(t))}))}))},Y={nu:U,wrap:V,pure:W,value:W,error:G,fromResult:q,fromFuture:X,fromPromise:$},K=Object.prototype.hasOwnProperty,J=function(t,e){return e},Q=function(t,e){var n=v(t)&&v(e);return n?tt(t,e):e},Z=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)K.call(i,u)&&(r[u]=t(r[u],i[u]))}return r}},tt=Z(Q),et=Z(J),nt=function(t){var e={name:"src",type:"urlinput",filetype:"image",label:"Source"},n=t.imageList.map((function(t){return{name:"images",type:"selectbox",label:"Image list",items:t}})),r={name:"alt",type:"input",label:"Image description"},o={name:"title",type:"input",label:"Image title"},i={name:"dimensions",type:"sizeinput"},u=t.classList.map((function(t){return{name:"classes",type:"selectbox",label:"Class",items:t}})),a={type:"label",label:"Caption",items:[{type:"checkbox",name:"caption",label:"Show caption"}]};return k([[e],n.toArray(),t.hasDescription?[r]:[],t.hasImageTitle?[o]:[],t.hasDimensions?[i]:[],[{type:"grid",columns:2,items:k([u.toArray(),t.hasImageCaption?[a]:[]])}]])},rt=function(t){return{title:"General",name:"general",items:nt(t)}},ot={makeTab:rt,makeItems:nt},it=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),ut=tinymce.util.Tools.resolve("tinymce.util.Promise"),at=tinymce.util.Tools.resolve("tinymce.util.XHR"),ct=function(t){return t.getParam("image_dimensions",!0,"boolean")},st=function(t){return t.getParam("image_advtab",!1,"boolean")},lt=function(t){return t.getParam("image_uploadtab",!0,"boolean")},ft=function(t){return t.getParam("image_prepend_url","","string")},dt=function(t){return t.getParam("image_class_list")},mt=function(t){return t.getParam("image_description",!0,"boolean")},gt=function(t){return t.getParam("image_title",!1,"boolean")},pt=function(t){return t.getParam("image_caption",!1,"boolean")},ht=function(t){return t.getParam("image_list",!1)},vt=function(t){return!!yt(t)},bt=function(t){return!!wt(t)},yt=function(t){return t.getParam("images_upload_url","","string")},wt=function(t){return t.getParam("images_upload_handler",void 0,"function")},xt=function(t){return t.getParam("images_upload_base_path",void 0,"string")},Ct=function(t){return t.getParam("images_upload_credentials",!1,"boolean")},St={hasDimensions:ct,hasUploadTab:lt,hasAdvTab:st,getPrependUrl:ft,getClassList:dt,hasDescription:mt,hasImageTitle:gt,hasImageCaption:pt,getImageList:ht,hasUploadUrl:vt,hasUploadHandler:bt,getUploadUrl:yt,getUploadHandler:wt,getUploadBasePath:xt,getUploadCredentials:Ct},kt=function(t,e){return Math.max(parseInt(t,10),parseInt(e,10))},Ot=function(t,n){var r=e.document.createElement("img"),o=function(t){r.parentNode&&r.parentNode.removeChild(r),n(t)};r.onload=function(){var t=kt(r.width,r.clientWidth),e=kt(r.height,r.clientHeight),n={width:t,height:e};o(j.value(n))},r.onerror=function(){o(j.error("Failed to get image dimensions for: "+t))};var i=r.style;i.visibility="hidden",i.position="fixed",i.bottom=i.left="0px",i.width=i.height="auto",e.document.body.appendChild(r),r.src=t},Tt=function(t){return t&&(t=t.replace(/px$/,"")),t},Et=function(t){return t.length>0&&/^[0-9]+$/.test(t)&&(t+="px"),t},Dt=function(t){if(t.margin){var e=String(t.margin).split(" ");switch(e.length){case 1:t["margin-top"]=t["margin-top"]||e[0],t["margin-right"]=t["margin-right"]||e[0],t["margin-bottom"]=t["margin-bottom"]||e[0],t["margin-left"]=t["margin-left"]||e[0];break;case 2:t["margin-top"]=t["margin-top"]||e[0],t["margin-right"]=t["margin-right"]||e[1],t["margin-bottom"]=t["margin-bottom"]||e[0],t["margin-left"]=t["margin-left"]||e[1];break;case 3:t["margin-top"]=t["margin-top"]||e[0],t["margin-right"]=t["margin-right"]||e[1],t["margin-bottom"]=t["margin-bottom"]||e[2],t["margin-left"]=t["margin-left"]||e[1];break;case 4:t["margin-top"]=t["margin-top"]||e[0],t["margin-right"]=t["margin-right"]||e[1],t["margin-bottom"]=t["margin-bottom"]||e[2],t["margin-left"]=t["margin-left"]||e[3]}delete t.margin}return t},At=function(t,e){var n=St.getImageList(t);"string"===typeof n?at.send({url:n,success:function(t){e(JSON.parse(t))}}):"function"===typeof n?n(e):e(n)},_t=function(t,e,n){var r=function(){n.onload=n.onerror=null,t.selection&&(t.selection.select(n),t.nodeChanged())};n.onload=function(){e.width||e.height||!St.hasDimensions(t)||t.dom.setAttribs(n,{width:String(n.clientWidth),height:String(n.clientHeight)}),r()},n.onerror=r},Rt=function(t){return new ut((function(n,r){var o=new e.FileReader;o.onload=function(){n(o.result)},o.onerror=function(){r(o.error.message)},o.readAsDataURL(t)}))},Bt=function(t){return"IMG"===t.nodeName&&(t.hasAttribute("data-mce-object")||t.hasAttribute("data-mce-placeholder"))},It={getImageSize:Ot,removePixelSuffix:Tt,addPixelSuffix:Et,mergeMargins:Dt,createImageList:At,waitLoadImage:_t,blobToDataUri:Rt,isPlaceholderImage:Bt},Nt=it.DOM,Pt=function(t){return t.style.marginLeft&&t.style.marginRight&&t.style.marginLeft===t.style.marginRight?It.removePixelSuffix(t.style.marginLeft):""},Mt=function(t){return t.style.marginTop&&t.style.marginBottom&&t.style.marginTop===t.style.marginBottom?It.removePixelSuffix(t.style.marginTop):""},Ft=function(t){return t.style.borderWidth?It.removePixelSuffix(t.style.borderWidth):""},Lt=function(t,e){return t.hasAttribute(e)?t.getAttribute(e):""},Ht=function(t,e){return t.style[e]?t.style[e]:""},zt=function(t){return null!==t.parentNode&&"FIGURE"===t.parentNode.nodeName},jt=function(t,e,n){t.setAttribute(e,n)},Vt=function(t){var e=Nt.create("figure",{class:"image"});Nt.insertAfter(e,t),e.appendChild(t),e.appendChild(Nt.create("figcaption",{contentEditable:"true"},"Caption")),e.contentEditable="false"},Ut=function(t){var e=t.parentNode;Nt.insertAfter(t,e),Nt.remove(e)},Wt=function(t){zt(t)?Ut(t):Vt(t)},Gt=function(t,e){var n=t.getAttribute("style"),r=e(null!==n?n:"");r.length>0?(t.setAttribute("style",r),t.setAttribute("data-mce-style",r)):t.removeAttribute("style")},qt=function(t,e){return function(t,n,r){t.style[n]?(t.style[n]=It.addPixelSuffix(r),Gt(t,e)):jt(t,n,r)}},Xt=function(t,e){return t.style[e]?It.removePixelSuffix(t.style[e]):Lt(t,e)},$t=function(t,e){var n=It.addPixelSuffix(e);t.style.marginLeft=n,t.style.marginRight=n},Yt=function(t,e){var n=It.addPixelSuffix(e);t.style.marginTop=n,t.style.marginBottom=n},Kt=function(t,e){var n=It.addPixelSuffix(e);t.style.borderWidth=n},Jt=function(t,e){t.style.borderStyle=e},Qt=function(t){return Ht(t,"borderStyle")},Zt=function(t){return"FIGURE"===t.nodeName},te=function(t){return"IMG"===t.nodeName},ee=function(){return{src:"",alt:"",title:"",width:"",height:"",class:"",style:"",caption:!1,hspace:"",vspace:"",border:"",borderStyle:""}},ne=function(t,n){var r=e.document.createElement("img");return jt(r,"style",n.style),(Pt(r)||""!==n.hspace)&&$t(r,n.hspace),(Mt(r)||""!==n.vspace)&&Yt(r,n.vspace),(Ft(r)||""!==n.border)&&Kt(r,n.border),(Qt(r)||""!==n.borderStyle)&&Jt(r,n.borderStyle),t(r.getAttribute("style"))},re=function(t,n){var r=e.document.createElement("img");if(ae(t,et(n,{caption:!1}),r),jt(r,"alt",n.alt),n.caption){var o=Nt.create("figure",{class:"image"});return o.appendChild(r),o.appendChild(Nt.create("figcaption",{contentEditable:"true"},"Caption")),o.contentEditable="false",o}return r},oe=function(t,e){return{src:Lt(e,"src"),alt:Lt(e,"alt"),title:Lt(e,"title"),width:Xt(e,"width"),height:Xt(e,"height"),class:Lt(e,"class"),style:t(Lt(e,"style")),caption:zt(e),hspace:Pt(e),vspace:Mt(e),border:Ft(e),borderStyle:Ht(e,"borderStyle")}},ie=function(t,e,n,r,o){n[r]!==e[r]&&o(t,r,n[r])},ue=function(t,e){return function(n,r,o){t(n,o),Gt(n,e)}},ae=function(t,e,n){var r=oe(t,n);ie(n,r,e,"caption",(function(t,e,n){return Wt(t)})),ie(n,r,e,"src",jt),ie(n,r,e,"alt",jt),ie(n,r,e,"title",jt),ie(n,r,e,"width",qt("width",t)),ie(n,r,e,"height",qt("height",t)),ie(n,r,e,"class",jt),ie(n,r,e,"style",ue((function(t,e){return jt(t,"style",e)}),t)),ie(n,r,e,"hspace",ue($t,t)),ie(n,r,e,"vspace",ue(Yt,t)),ie(n,r,e,"border",ue(Kt,t)),ie(n,r,e,"borderStyle",ue(Jt,t))},ce=function(t,e){var n=t.dom.styles.parse(e),r=It.mergeMargins(n),o=t.dom.styles.parse(t.dom.styles.serialize(r));return t.dom.styles.serialize(o)},se=function(t){var e=t.selection.getNode(),n=t.dom.getParent(e,"figure.image");return n?t.dom.select("img",n)[0]:e&&("IMG"!==e.nodeName||It.isPlaceholderImage(e))?null:e},le=function(t,e){var n=t.dom,r=n.getParent(e.parentNode,(function(e){return t.schema.getTextBlockElements()[e.nodeName]}),t.getBody());return r?n.split(r,e):e},fe=function(t){var e=se(t);return e?oe((function(e){return ce(t,e)}),e):ee()},de=function(t,e){var n=re((function(e){return ce(t,e)}),e);t.dom.setAttrib(n,"data-mce-id","__mcenew"),t.focus(),t.selection.setContent(n.outerHTML);var r=t.dom.select('*[data-mce-id="__mcenew"]')[0];if(t.dom.setAttrib(r,"data-mce-id",null),Zt(r)){var o=le(t,r);t.selection.select(o)}else t.selection.select(r)},me=function(t,e){t.dom.setAttrib(e,"src",e.getAttribute("src"))},ge=function(t,e){if(e){var n=t.dom.is(e.parentNode,"figure.image")?e.parentNode:e;t.dom.remove(n),t.focus(),t.nodeChanged(),t.dom.isEmpty(t.getBody())&&(t.setContent(""),t.selection.setCursorLocation())}},pe=function(t,e){var n=se(t);if(ae((function(e){return ce(t,e)}),e,n),me(t,n),Zt(n.parentNode)){var r=n.parentNode;le(t,r),t.selection.select(n.parentNode)}else t.selection.select(n),It.waitLoadImage(t,e,n)},he=function(t,e){var n=se(t);n?e.src?pe(t,e):ge(t,n):e.src&&de(t,e)},ve=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return m.none()},be=tinymce.util.Tools.resolve("tinymce.util.Tools"),ye=function(t){return h(t.value)?t.value:""},we=function(t,e){var n=[];return be.each(t,(function(t){var r=h(t.text)?t.text:h(t.title)?t.title:"";if(void 0!==t.menu){var o=we(t.menu,e);n.push({text:r,items:o})}else{var i=e(t);n.push({text:r,value:i})}})),n},xe=function(t){return void 0===t&&(t=ye),function(e){return e?m.from(e).map((function(e){return we(e,t)})):m.none()}},Ce=function(t){return xe(ye)(t)},Se=function(t){return Object.prototype.hasOwnProperty.call(t,"items")},ke=function(t,e){return ve(t,(function(t){return Se(t)?ke(t.items,e):t.value===e?m.some(t):m.none()}))},Oe=function(t,e){return t.bind((function(t){return ke(t,e)}))},Te={sanitizer:xe,sanitize:Ce,findEntry:Oe},Ee=function(t,e){return t?t.replace(/\/$/,"")+"/"+e.replace(/^\//,""):e};function De(t){var n=function(n,r,o,i){var u,a;u=new e.XMLHttpRequest,u.open("POST",t.url),u.withCredentials=t.credentials,u.upload.onprogress=function(t){i(t.loaded/t.total*100)},u.onerror=function(){o("Image upload failed due to a XHR Transport error. Code: "+u.status)},u.onload=function(){var e;u.status<200||u.status>=300?o("HTTP Error: "+u.status):(e=JSON.parse(u.responseText),e&&"string"===typeof e.location?r(Ee(t.basePath,e.location)):o("Invalid JSON: "+u.responseText))},a=new e.FormData,a.append("file",n.blob(),n.filename()),u.send(a)},o=function(t,e){return new ut((function(n,o){try{e(t,n,o,r)}catch(i){o(i.message)}}))},i=function(t){return t===n},u=function(e){return!t.url&&i(t.handler)?ut.reject("Upload url missing from the settings."):o(e,t.handler)};return t=be.extend({credentials:!1,handler:n},t),{upload:u}}var Ae=function(t){return{title:"Advanced",name:"advanced",items:[{type:"input",label:"Style",name:"style"},{type:"grid",columns:2,items:[{type:"input",label:"Vertical space",name:"vspace",inputMode:"numeric"},{type:"input",label:"Horizontal space",name:"hspace",inputMode:"numeric"},{type:"input",label:"Border width",name:"border",inputMode:"numeric"},{type:"selectbox",name:"borderstyle",label:"Border style",items:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]}]}]}},_e={makeTab:Ae},Re=function(t){var e=Te.sanitizer((function(e){return t.convertURL(e.value||e.url,"src")})),n=F.nu((function(n){It.createImageList(t,(function(t){n(e(t).map((function(t){return k([[{text:"None",value:""}],t])})))}))})),r=Te.sanitize(St.getClassList(t)),o=St.hasAdvTab(t),i=St.hasUploadTab(t),u=St.hasUploadUrl(t),a=St.hasUploadHandler(t),c=fe(t),s=St.hasDescription(t),l=St.hasImageTitle(t),f=St.hasDimensions(t),d=St.hasImageCaption(t),g=St.getUploadUrl(t),p=St.getUploadBasePath(t),v=St.getUploadCredentials(t),b=St.getUploadHandler(t),y=m.some(St.getPrependUrl(t)).filter((function(t){return h(t)&&t.length>0}));return n.map((function(t){return{image:c,imageList:t,classList:r,hasAdvTab:o,hasUploadTab:i,hasUploadUrl:u,hasUploadHandler:a,hasDescription:s,hasImageTitle:l,hasDimensions:f,hasImageCaption:d,url:g,basePath:p,credentials:v,handler:b,prependURL:y}}))},Be=function(t){var e=[{type:"dropzone",name:"fileinput"}];return{title:"Upload",name:"upload",items:e}},Ie={makeTab:Be},Ne=function(t){return{prevImage:Te.findEntry(t.imageList,t.image.src),prevAlt:t.image.alt,open:!0}},Pe=function(t){return{src:{value:t.src,meta:{}},images:t.src,alt:t.alt,title:t.title,dimensions:{width:t.width,height:t.height},classes:t.class,caption:t.caption,style:t.style,vspace:t.vspace,border:t.border,hspace:t.hspace,borderstyle:t.borderStyle,fileinput:[]}},Me=function(t){return{src:t.src.value,alt:t.alt,title:t.title,width:t.dimensions.width,height:t.dimensions.height,class:t.classes,style:t.style,caption:t.caption,hspace:t.hspace,vspace:t.vspace,border:t.border,borderStyle:t.borderstyle}},Fe=function(t,e){return/^(?:[a-zA-Z]+:)?\/\//.test(e)?m.none():t.prependURL.bind((function(t){return e.substring(0,t.length)!==t?m.some(t+e):m.none()}))},Le=function(t,e){var n=e.getData();Fe(t,n.src.value).each((function(t){e.setData({src:{value:t,meta:n.src.meta}})}))},He=function(t,e,n){t.hasDescription&&h(n.alt)&&(e.alt=n.alt),t.hasImageTitle&&h(n.title)&&(e.title=n.title),t.hasDimensions&&(h(n.width)&&(e.dimensions.width=n.width),h(n.height)&&(e.dimensions.height=n.height)),h(n.class)&&Te.findEntry(t.classList,n.class).each((function(t){e.classes=t.value})),t.hasImageCaption&&y(n.caption)&&(e.caption=n.caption),t.hasAdvTab&&(h(n.vspace)&&(e.vspace=n.vspace),h(n.border)&&(e.border=n.border),h(n.hspace)&&(e.hspace=n.hspace),h(n.borderstyle)&&(e.borderstyle=n.borderstyle))},ze=function(t,e){var n=e.getData(),r=n.src.meta;if(void 0!==r){var o=tt({},n);He(t,o,r),e.setData(o)}},je=function(t,e,n,r){var o=r.getData(),i=o.src.value,u=o.src.meta||{};u.width||u.height||!e.hasDimensions||t.imageSize(i).get((function(t){t.each((function(t){n.open&&r.setData({dimensions:t})}))}))},Ve=function(t,e,n){var r=n.getData(),o=Te.findEntry(t.imageList,r.src.value);e.prevImage=o,n.setData({images:o.map((function(t){return t.value})).getOr("")})},Ue=function(t,e,n,r){Le(e,r),ze(e,r),je(t,e,n,r),Ve(e,n,r)},We=function(t,e,n,r){var o=r.getData(),i=Te.findEntry(e.imageList,o.images);i.each((function(t){var e=""===o.alt||n.prevImage.map((function(t){return t.text===o.alt})).getOr(!1);e?""===t.value?r.setData({src:t,alt:n.prevAlt}):r.setData({src:t,alt:t.text}):r.setData({src:t})})),n.prevImage=i,Ue(t,e,n,r)},Ge=function(t){var e=t["margin-top"]&&t["margin-bottom"]&&t["margin-top"]===t["margin-bottom"];return e?It.removePixelSuffix(String(t["margin-top"])):""},qe=function(t){var e=t["margin-right"]&&t["margin-left"]&&t["margin-right"]===t["margin-left"];return e?It.removePixelSuffix(String(t["margin-right"])):""},Xe=function(t){return t["border-width"]?It.removePixelSuffix(String(t["border-width"])):""},$e=function(t){return t["border-style"]?String(t["border-style"]):""},Ye=function(t,e,n){return e(t(e(n)))},Ke=function(t,e,n){var r=It.mergeMargins(t(n.style)),o=tt({},n);return o.vspace=Ge(r),o.hspace=qe(r),o.border=Xe(r),o.borderstyle=$e(r),o.style=Ye(t,e,r),o},Je=function(t,e){var n=e.getData(),r=Ke(t.parseStyle,t.serializeStyle,n);e.setData(r)},Qe=function(t,e,n){var r=tt(Pe(e.image),n.getData()),o=ne(t.normalizeCss,Me(r));n.setData({style:o})},Ze=function(t,n,r,o){var i=o.getData();o.block("Uploading image"),O(i.fileinput).fold((function(){o.unblock()}),(function(i){var u=e.URL.createObjectURL(i),a=De({url:n.url,basePath:n.basePath,credentials:n.credentials,handler:n.handler}),c=function(){o.unblock(),e.URL.revokeObjectURL(u)};It.blobToDataUri(i).then((function(e){var s=t.createBlobCache(i,u,e);a.upload(s).then((function(e){o.setData({src:{value:e,meta:{}}}),o.showTab("general"),Ue(t,n,r,o),c()})).catch((function(e){c(),t.alertErr(o,e)}))}))}))},tn=function(t,e,n){return function(r,o){"src"===o.name?Ue(t,e,n,r):"images"===o.name?We(t,e,n,r):"alt"===o.name?n.prevAlt=r.getData().alt:"style"===o.name?Je(t,r):"vspace"===o.name||"hspace"===o.name||"border"===o.name||"borderstyle"===o.name?Qe(t,e,r):"fileinput"===o.name&&Ze(t,e,n,r)}},en=function(t){return function(){t.open=!1}},nn=function(t){if(t.hasAdvTab||t.hasUploadUrl||t.hasUploadHandler){var e={type:"tabpanel",tabs:k([[ot.makeTab(t)],t.hasAdvTab?[_e.makeTab(t)]:[],t.hasUploadTab&&(t.hasUploadUrl||t.hasUploadHandler)?[Ie.makeTab(t)]:[]])};return e}var n={type:"panel",items:ot.makeItems(t)};return n},rn=function(t){return function(e){var n=Ne(e);return{title:"Insert/Edit Image",size:"normal",body:nn(e),buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:Pe(e.image),onSubmit:t.onSubmit(e),onChange:tn(t,e,n),onClose:en(n)}}},on=function(t){return function(e){return function(n){var r=tt(Pe(e.image),n.getData());t.undoManager.transact((function(){he(t,Me(r))})),t.editorUpload.uploadImagesAuto(),n.close()}}},un=function(t){return function(e){return Y.nu((function(n){It.getImageSize(t.documentBaseURI.toAbsolute(e),(function(t){var e=t.map((function(t){return{width:String(t.width),height:String(t.height)}}));n(e)}))}))}},an=function(t){return function(e,n,r){return t.editorUpload.blobCache.create({blob:e,blobUri:n,name:e.name?e.name.replace(/\.[^\.]+$/,""):null,base64:r.split(",")[1]})}},cn=function(t){return function(e,n){t.windowManager.alert(n,e.close)}},sn=function(t){return function(e){return ce(t,e)}},ln=function(t){return function(e){return t.dom.parseStyle(e)}},fn=function(t){return function(e,n){return t.dom.serializeStyle(e,n)}},dn=function(t){var e={onSubmit:on(t),imageSize:un(t),createBlobCache:an(t),alertErr:cn(t),normalizeCss:sn(t),parseStyle:ln(t),serializeStyle:fn(t)},n=function(){return Re(t).map(rn(e)).get((function(e){t.windowManager.open(e)}))};return{open:n}},mn=function(t){t.addCommand("mceImage",dn(t).open)},gn={register:mn},pn=function(t){var e=t.attr("class");return e&&/\bimage\b/.test(e)},hn=function(t){return function(e){var n=e.length,r=function(e){e.attr("contenteditable",t?"true":null)};while(n--){var o=e[n];pn(o)&&(o.attr("contenteditable",t?"false":null),be.each(o.getAll("figcaption"),r))}}},vn=function(t){t.on("PreInit",(function(){t.parser.addNodeFilter("figure",hn(!0)),t.serializer.addNodeFilter("figure",hn(!1))}))},bn={setup:vn},yn=function(t){t.ui.registry.addToggleButton("image",{icon:"image",tooltip:"Insert/edit image",onAction:dn(t).open,onSetup:function(e){return t.selection.selectorChangedWithUnbind("img:not([data-mce-object],[data-mce-placeholder]),figure.image",e.setActive).unbind}}),t.ui.registry.addMenuItem("image",{icon:"image",text:"Image...",onAction:dn(t).open}),t.ui.registry.addContextMenu("image",{update:function(t){return Zt(t)||te(t)&&!It.isPlaceholderImage(t)?["image"]:[]}})},wn={register:yn};function xn(){n.add("image",(function(t){bn.setup(t),wn.register(t),gn.register(t)}))}xn()})(window)}).call(this,n("c8ba"))},cfb0:function(t,e,n){n("43fc")},e1f4:function(t,e){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);t.exports=function(){return n(r),r}}else{var o=new Array(16);t.exports=function(){for(var t,e=0;e<16;e++)0===(3&e)&&(t=4294967296*Math.random()),o[e]=t>>>((3&e)<<3)&255;return o}}},ef1f:function(t,e){(function(){"use strict";var t=tinymce.util.Tools.resolve("tinymce.PluginManager"),e=function(t,e){t.focus(),t.undoManager.transact((function(){t.setContent(e)})),t.selection.setCursorLocation(),t.nodeChanged()},n=function(t){return t.getContent({source_view:!0})},r={setContent:e,getContent:n},o=function(t){var e=r.getContent(t);t.windowManager.open({title:"Source Code",size:"large",body:{type:"panel",items:[{type:"textarea",name:"code"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:{code:e},onSubmit:function(e){r.setContent(t,e.getData().code),e.close()}})},i={open:o},u=function(t){t.addCommand("mceCodeEditor",(function(){i.open(t)}))},a={register:u},c=function(t){t.ui.registry.addButton("code",{icon:"sourcecode",tooltip:"Source code",onAction:function(){return i.open(t)}}),t.ui.registry.addMenuItem("code",{icon:"sourcecode",text:"Source code",onAction:function(){return i.open(t)}})},s={register:c};function l(){t.add("code",(function(t){return a.register(t),s.register(t),{}}))}l()})()},f872:function(t,e,n){"use strict";n.r(e),function(t){n("99af");var e=n("b85c"),r=(n("e623"),n("e379"),n("5dc8"),n("37e1"),n("e562")),o=n.n(r),i=(n("0d68"),n("4237"),n("84ec"),n("4ea8"),n("07d1"),n("64d8"),n("bc54"),n("3aea"),n("cfb0"),n("1123")),u=window.VERIFIED||window.SUP;function a(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=["link","lists","image","table","paste"],r="undo redo removeformat | styleselect | h1 h2 | bold italic underline | numlist bullist indent outdent | table blockquote link image removeformat";u&&(r+=" | footnote media checkAlly",n.push("media")),e&&(n.push("code"),r+=" | code");var a="".concat(t.type,"#").concat(t.id),c='img[alt=""] {outline: 4px solid red;}.footnote-ref {font-size: 16px;vertical-align: super;}.footnote-body {margin-left: 2rem;}.footnote-label {float:left;margin-left:-1rem;} .footnote-label::after{content: ".";} .footnote-footer {border-top: 1px solid black;}';o.a.init({selector:a,plugins:n,skin_url:"/static/tinymce_skin",content_style:c,menubar:!1,branding:!1,toolbar:r,image_uploadtab:u,images_upload_handler:i["b"],images_upload_credentials:!0,automatic_uploads:!0,contextmenu_never_use_native:!1,contextmenu:!1,paste_auto_cleanup_on_paste:!0,paste_remove_styles:!0,paste_remove_styles_if_webkit:!0,paste_strip_class_attributes:"all",extended_valid_elements:"div[class|title|style|tabindex|id|class|data-custom-style],span[class|title|style|tabindex|id|class|data-custom-style]",setup:function(t){u&&(Object(i["d"])(t),Object(i["a"])(t),Object(i["c"])(t))}})}var c,s=Object(e["a"])(document.querySelectorAll(".richtext-editor"));try{for(s.s();!(c=s.n()).done;){var l=c.value;a(l)}}catch(g){s.e(g)}finally{s.f()}var f,d=Object(e["a"])(document.querySelectorAll(".richtext-editor-src"));try{for(d.s();!(f=d.n()).done;){var m=f.value;a(m,!0)}}catch(g){d.e(g)}finally{d.f()}t.initRichTextEditor=a}.call(this,n("c8ba"))}});
//# sourceMappingURL=rich_text_editor.9c13fdbc.js.map